
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id><journal-id journal-id-type="publisher-id">pcbi</journal-id><journal-id journal-id-type="publisher-id">plcb</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">1848003</article-id><article-id pub-id-type="pmid">17397256</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.0030061</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0200R3</article-id><article-id pub-id-type="sici">plcb-03-03-20</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Eukaryotes</subject></subj-group></article-categories><title-group><article-title><SecTag type="TITLE"><text><SENT sid="0" pm="."><plain>DNA Familial Binding Profiles Made Easy: Comparison of Various Motif Alignment and Clustering Strategies </plain></SENT>
</text></SecTag></article-title><alt-title alt-title-type="running-head">STAMP: Comparing<italic>cis</italic>-Regulatory Motifs</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Mahony</surname><given-names>Shaun</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref></contrib><contrib contrib-type="author"><name><surname>Auron</surname><given-names>Philip E</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Benos</surname><given-names>Panayiotis V</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="corresp" rid="cor1">*</xref></contrib></contrib-group><aff id="aff1"><label>1</label> Department of Computational Biology, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
</aff><aff id="aff2"><label>2</label> Department of Computer Science, Faculty of Arts and Sciences, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
</aff><aff id="aff3"><label>3</label> Department of Biological Sciences, Duquesne University, Pittsburgh, Pennsylvania, United States of America
</aff><aff id="aff4"><label>4</label> Department of Molecular Genetics and Biochemistry, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
</aff><aff id="aff5"><label>5</label> Department of Human Genetics, Graduate School of Public Health, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
</aff><aff id="aff6"><label>6</label> University of Pittsburgh Cancer Institute, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Stormo</surname><given-names>Gary</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Washington University, United States of America</aff><author-notes><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email>shaun.mahony@ccbb.pitt.edu</email> (SM); <email>benos@pitt.edu</email> (PVB)</corresp></author-notes><pub-date pub-type="ppub"><month>3</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>30</day><month>3</month><year>2007</year></pub-date><pub-date pub-type="epreprint"><day>15</day><month>2</month><year>2007</year></pub-date><volume>3</volume><issue>3</issue><elocation-id>e61</elocation-id><history><date date-type="received"><day>23</day><month>5</month><year>2006</year></date><date date-type="accepted"><day>15</day><month>2</month><year>2007</year></date></history><permissions><copyright-statement> © 2007 Mahony et al.</copyright-statement><copyright-year>2007</copyright-year><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p></license></permissions><abstract><p><SecTag type="ABS"><text><SENT sid="1" pm="."><plain>Transcription factor (TF) proteins recognize a small number of DNA sequences with high specificity and control the expression of neighbouring genes. </plain></SENT>
<SENT sid="2" pm="."><plain>The evolution of TF binding preference has been the subject of a number of recent studies, in which generalized binding profiles have been introduced and used to improve the prediction of new target sites. </plain></SENT>
<SENT sid="3" pm="."><plain>Generalized profiles are generated by aligning and merging the individual profiles of related TFs. </plain></SENT>
<SENT sid="4" pm="."><plain>However, the distance metrics and alignment algorithms used to compare the binding profiles have not yet been fully explored or optimized. </plain></SENT>
<SENT sid="5" pm="."><plain>As a result, binding profiles depend on TF structural information and sometimes may ignore important distinctions between subfamilies. </plain></SENT>
<SENT sid="6" pm="."><plain>Prediction of the identity or the structural class of a protein that binds to a given DNA pattern will enhance the analysis of microarray and ChIP–chip data where frequently multiple putative targets of usually unknown TFs are predicted. </plain></SENT>
<SENT sid="7" pm="."><plain>Various comparison metrics and alignment algorithms are evaluated (a total of 105 combinations). </plain></SENT>
<SENT sid="8" pm="."><plain>We find that local alignments are generally better than global alignments at detecting eukaryotic DNA motif similarities, especially when combined with the sum of squared distances or Pearson's correlation coefficient comparison metrics. </plain></SENT>
<SENT sid="9" pm="."><plain>In addition, multiple-alignment strategies for binding profiles and tree-building methods are tested for their efficiency in constructing generalized binding models. </plain></SENT>
<SENT sid="10" pm="."><plain>A new method for automatic determination of the optimal number of clusters is developed and applied in the construction of a new set of familial binding profiles which improves upon TF classification accuracy. </plain></SENT>
<SENT sid="11" pm="."><plain>A software tool, STAMP, is developed to host all tested methods and make them publicly available. </plain></SENT>
<SENT sid="12" pm="."><plain>This work provides a high quality reference set of familial binding profiles and the first comprehensive platform for analysis of DNA profiles. </plain></SENT>
<SENT sid="13" pm="."><plain>Detecting similarities between DNA motifs is a key step in the comparative study of transcriptional regulation, and the work presented here will form the basis for tool and method development for future transcriptional modeling studies. </plain></SENT>
</text></SecTag></p></abstract><abstract abstract-type="summary"><title><text><SENT sid="14" pm="."><plain>Author Summary </plain></SENT>
</text></title><sec id="st1"><title/><p><SecTag type="ABS"><text><SENT sid="15" pm="."><plain>Transcription factors are primary regulators of gene expression. </plain></SENT>
<SENT sid="16" pm="."><plain>They usually recognize short DNA sequences in gene promoters and subsequently alter their transcription rate. </plain></SENT>
<SENT sid="17" pm="."><plain>It is known that structurally related transcription factors often recognize similar DNA-binding patterns (or motifs). </plain></SENT>
<SENT sid="18" pm="."><plain>Comparison of these motifs not only provides insights into the evolutionary process they undergo, but it also has many important practical applications. </plain></SENT>
<SENT sid="19" pm="."><plain>For example, motifs that are found to be “similar” can be combined to form generalized profiles, which can be used to improve our ability to predict novel DNA signals in the promoters of co-expressed genes, and thus facilitate a more accurate mapping of gene-regulatory networks. </plain></SENT>
<SENT sid="20" pm="."><plain>However, to date there is no comprehensive platform that will allow for an efficient analysis of DNA motifs. </plain></SENT>
<SENT sid="21" pm="."><plain>Furthermore, the efficiency of the methods used to assign similarity between DNA motifs has not been thoroughly tested. </plain></SENT>
<SENT sid="22" pm="."><plain>This paper takes an important first step towards this goal by evaluating available comparison strategies as applied to DNA motifs and by generating an improved familial profile dataset. </plain></SENT>
</text></SecTag></p></sec></abstract><counts><page-count count="14"/></counts><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Mahony S, Auron PE, Benos PV (2007) DNA familial binding profiles made easy: Comparison of various motif alignment and clustering strategies. PLoS Comput Biol 3(3): e61. doi:<ext-link ext-link-type="doi" xlink:href="10.1371/journal.pcbi.0030061">10.1371/journal.pcbi.0030061</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><SecTag type="INTRO"><sec id="s1"><title><text><SENT sid="23" pm="."><plain>Introduction </plain></SENT>
</text></title><p><text><SENT sid="24" pm="."><plain>Transcription factor (TF) proteins usually recognize a small number of DNA targets via the formation of sequence-specific and nonspecific molecular interactions. </plain></SENT>
<SENT sid="25" pm="."><plain>Understanding the evolution of TF DNA-binding preferences will not only provide useful insights on the mechanism of DNA recognition, it will also allow more accurate prediction of genomic regulatory elements, which still constitutes a major hurdle in understanding cellular gene regulatory networks. </plain></SENT>
<SENT sid="26" pm="."><plain>Furthermore, high-throughput studies, such as microarray and ChIP–chip, generate a number of DNA motifs that are putative targets of usually unknown TFs. </plain></SENT>
<SENT sid="27" pm="."><plain>In this study, we present an alignment and comparison platform that is optimized for DNA motifs, thereby allowing for their efficient analysis and enabling and formalizing their evolutionary study. </plain></SENT>
<SENT sid="28" pm="."><plain>This platform is called STAMP, for similarity, tree-building, and alignment of DNA motifs and profiles. </plain></SENT>
</text></p><p><text><SENT sid="29" pm="."><plain>TF DNA-binding preferences are usually modeled via frequency matrices, derived from alignments of known sites (see Methods). </plain></SENT>
<SENT sid="30" pm="."><plain>Typically, these position-specific scoring matrices (PSSMs) assume independency between the base positions [1]. </plain></SENT>
<SENT sid="31" pm="."><plain>It has been recognized that structurally related TFs often share similarities in their DNA-binding motifs, although the extent to which this happens depends on the TF family [2–5]. </plain></SENT>
<SENT sid="32" pm="."><plain>Generalized binding models or familial binding profiles (FBPs), a term coined by Sandelin and Wasserman [6], constitute an “average” binding specificity of a family of TFs (see Figure 1 for an illustration of the FBP concept). </plain></SENT>
<SENT sid="33" pm="."><plain>FBPs can be incorporated in pattern-finding algorithms as prior knowledge in order to bias them towards motifs from a particular TF family [6–8]. </plain></SENT>
<SENT sid="34" pm="."><plain>This is useful if the investigator expects to find motifs from a particular class of TFs. </plain></SENT>
<SENT sid="35" pm="."><plain>The use of FBPs as prior information focuses the motif search on biologically relevant patterns, offering a way to improve upon the currently limited performance of DNA motif-finders [9]. </plain></SENT>
<SENT sid="36" pm="."><plain>FBPs have been used to infer the identity of the TF family bound to predicted novel motifs [6,8,10], and to remove degeneracy between related motifs in the motif repositories [11–13]. </plain></SENT>
<SENT sid="37" pm="."><plain>More recently, FBPs have been used to help estimate the binding specificity of regulatory proteins from ChIP–chip data [14]. </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pcbi-0030061-g001" position="float"><label>Figure 1</label><caption><title><text><SENT sid="38" pm="."><plain>Illustration of Familial Binding Profile Construction </plain></SENT>
</text></title><p><text><SENT sid="39" pm="."><plain>In this example, the binding motifs for four bZIP–CREB transcription factors are aligned in a multiple-motif alignment. </plain></SENT>
<SENT sid="40" pm="."><plain>The generalized familial binding profiles correspond to the weighted average of the individual profiles. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g001"/></fig></SecTag><p><text><SENT sid="41" pm="."><plain>The early studies introducing FBPs demonstrated their potential in regulatory DNA analysis. </plain></SENT>
<SENT sid="42" pm="."><plain>However, the methods employed to compare and align DNA-binding motifs, a key aspect in constructing FBPs, have not been thoroughly studied. </plain></SENT>
<SENT sid="43" pm="."><plain>Currently, the construction of FBPs is based on (semi)-empirical clustering methods and ad hoc distance metrics. </plain></SENT>
<SENT sid="44" pm="."><plain>Ungapped local motif alignments [6,7] or enumeration of subsequence frequencies across related motifs' members [10,11] are typically used to compare PSSMs, although it is not yet known if these strategies are optimal. </plain></SENT>
<SENT sid="45" pm="."><plain>Even the definition of binding motif families and subgroups is currently problematic. </plain></SENT>
<SENT sid="46" pm="."><plain>Structural information and protein sequence comparisons have been previously used to guide manual clustering of TF binding profiles [6,8], although automatic methods have been recently introduced [7]. </plain></SENT>
</text></p><p><text><SENT sid="47" pm="."><plain>For more reliable FBP construction methods, and in order to expand the area of applications for generalized binding models, a detailed evaluation of a variety of motif alignment strategies is required. </plain></SENT>
<SENT sid="48" pm="."><plain>Motif evolution and the motif dependence on the proteins' structural properties need to be investigated. </plain></SENT>
<SENT sid="49" pm="."><plain>Sandelin and Wasserman [6] did an important first step when they created a set of 11 FBPs for the nonzinc finger families. </plain></SENT>
<SENT sid="50" pm="."><plain>During the FBP construction, they noticed that the bZIP family exhibited two different DNA-binding patterns, so they partitioned it into CCAAT/enhancer binding protein (C/EBP)- and cAMP response element-binding (CREB)-related proteins. </plain></SENT>
<SENT sid="51" pm="."><plain>However, their FBP clustering was done manually and other (sub)family characteristics may have been missed. </plain></SENT>
<SENT sid="52" pm="."><plain>On the other side of the spectrum, two families may have similar binding preferences, and although they may not belong to the same structural group, it may be reasonable to cluster their binding profiles together, so that the overall number of false positive predictions is reduced. </plain></SENT>
<SENT sid="53" pm="."><plain>Finally, a detailed analysis of the structural properties of the protein–DNA complexes, together with automatic clustering and classification results, is hoped to shed more light on the evolution of the DNA preferences and their utility in prediction and classification studies. </plain></SENT>
</text></p><p><text><SENT sid="54" pm="."><plain>Schones et al. have compared the effectiveness of three profile distance metrics [13]. </plain></SENT>
<SENT sid="55" pm="."><plain>We expand their study by evaluating combinations of six distance metrics, three pairwise alignment methods, two multiple-alignment strategies, and two tree-building algorithms. </plain></SENT>
<SENT sid="56" pm="."><plain>In addition, we develop a new statistic for automatically deciding the optimal number of clusters in a given motif tree. </plain></SENT>
<SENT sid="57" pm="."><plain>We use this statistic on the tree obtained from the optimal distance metrics and alignment strategies combination to generate a new set of FBPs without prior knowledge of TF structural classification. </plain></SENT>
<SENT sid="58" pm="."><plain>The new collection of FBPs exhibits better TF classification accuracy than previous manually derived clusters [6] and identifies similarities and differences in the binding preferences of TF (sub)families. </plain></SENT>
</text></p><p><text><SENT sid="59" pm="."><plain>Although species-specific binding preference may emerge for some TFs [15], in general structurally related TFs often share similarities in their DNA-binding preferences. </plain></SENT>
<SENT sid="60" pm="."><plain>Exploring this trend, Narlikar and Hartemink built a Bayesian TF structural family classifier based on the DNA motifs [10]. </plain></SENT>
<SENT sid="61" pm="."><plain>We found that the same accuracy of this sophisticated method can be achieved with simple motif similarity searches when the appropriate alignment algorithms are used. </plain></SENT>
<SENT sid="62" pm="."><plain>Correctly predicting the TF structural class for novel motifs will be a crucial step in the interpretation of experiments that aim to systematically estimate regulatory motifs in entire mammalian genomes (e.g., [16]). </plain></SENT>
</text></p></sec></SecTag><SecTag type="RESULTS"><sec id="s2"><title><text><SENT sid="63" pm="."><plain>Results </plain></SENT>
</text></title><sec id="s2a"><title><text><SENT sid="64" pm="."><plain>Distributions of Similarity Scores in PSSM Columns from Known TFs </plain></SENT>
</text></title><p><text><SENT sid="65" pm="."><plain>All columns from the known PSSM models in the TRANSFAC database [17] were compared with each other using the six metrics presented in Table 1 (see Methods). Figure 2 shows the great variability in the range and distribution of the scores. </plain></SENT>
<SENT sid="66" pm="."><plain>Both Pearson's correlation coefficient (PCC) and average log likelihood ratio (ALLR) have negative expected values, which makes them especially suitable for use in alignment algorithms (although, negative mean values can be obtained from any metric by subtracting an appropriate number). </plain></SENT>
<SENT sid="67" pm="."><plain>Three of the methods, namely PCC, sum of squared distances (SSD), and p-value of chi-square (pCS), have peaks of very small variance, with PCC having two distinct peaks. </plain></SENT>
<SENT sid="68" pm="."><plain>Comparison of JASPAR [18] columns gave similar results (unpublished data). </plain></SENT>
</text></p><SecTag type="TABLE"><table-wrap id="pcbi-0030061-t001" content-type="1col" position="float"><label>Table 1</label><caption><p><text><SENT sid="69" pm="."><plain>The Six Similarity Metrics Used in This Study for PSSM Column Similarity and Motif Alignments </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.t001"/></table-wrap></SecTag><SecTag type="FIG"><fig id="pcbi-0030061-g002" position="float"><label>Figure 2</label><caption><title><text><SENT sid="70" pm="."><plain>Distribution of the Observed Scores of Column-to-Column Comparisons for the Five Main Similarity Metrics </plain></SENT>
</text></title><p><text><SENT sid="71" pm="."><plain>Columns are obtained from the TRANSFAC database [17]. </plain></SENT>
<SENT sid="72" pm="."><plain>The ALLR_LL distribution is identical to ALLR for every point ≥2 (unpublished data). </plain></SENT>
<SENT sid="73" pm="."><plain>Comparison of the JASPAR motif columns yielded similar results. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g002"/></fig></SecTag></sec><sec id="s2b"><title><text><SENT sid="74" pm="."><plain>Evaluation of the Similarity Metrics in PSSM Column Comparisons </plain></SENT>
</text></title><p><text><SENT sid="75" pm="."><plain>Each of the six metrics was tested for its ability to discriminate between columns randomly sampled from two distinct distributions: an information content–specific distribution and a background (reference) distribution. </plain></SENT>
<SENT sid="76" pm="."><plain>For information content, I, Figure 3 plots the percent of the  -sampled columns that were included in the area around  when a false discovery rate (FDR) of 1% was reached. </plain></SENT>
<SENT sid="77" pm="."><plain>For lower information content, ALLR and SSD perform best at discriminating columns sampled around  and  . </plain></SENT>
<SENT sid="78" pm="."><plain>The finding that ALLR is a better discriminator than pCS metric may seem to contradict the findings of Schones et al. [13]. </plain></SENT>
<SENT sid="79" pm="."><plain>However, apart from our sampling size being larger, their evaluation focused on the whole motif level. </plain></SENT>
<SENT sid="80" pm="."><plain>As we will see later, the advantageous performance of ALLR in column-to-column comparisons does not seem to extend to motif-to-motif comparisons. </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pcbi-0030061-g003" position="float"><label>Figure 3</label><caption><title><text><SENT sid="81" pm="."><plain>Performance of the Five Main Similarity Metrics in Discriminating between Columns Sampled from Dirichlet Distributions around Information Content I and a Background Distribution </plain></SENT>
</text></title><p><text><SENT sid="82" pm="."><plain>The plot shows the positive predictive rate for an FDR of 1% as a function of the information content. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g003"/></fig></SecTag></sec><sec id="s2c"><title><text><SENT sid="83" pm="."><plain>Comparing Motif Alignment Strategies: The “Best-Hit” Evaluation </plain></SENT>
</text></title><p><text><SENT sid="84" pm="."><plain>It is difficult to construct an unbiased artificial dataset for the evaluation of motif alignment strategies. </plain></SENT>
<SENT sid="85" pm="."><plain>However, an indication of performance may be gained from similarity searches of a motif against all motifs in a database. </plain></SENT>
<SENT sid="86" pm="."><plain>Generally, in databases with good representation, the best match to a given motif is expected to be a motif associated with a member of the same structural class [6]. </plain></SENT>
<SENT sid="87" pm="."><plain>The “best-hit” approach can be used to assess the relative effectiveness of column-scoring metrics and alignment-method combinations by finding the proportion of motifs that match another member of the same structural class using each strategy. </plain></SENT>
</text></p><p><text><SENT sid="88" pm="."><plain>One hundred and five combinations of similarity metrics, alignment methods, and gap penalty values were tested over two datasets: the JASPAR- and TRANSFAC-derived models (see Methods). </plain></SENT>
<SENT sid="89" pm="."><plain>The top 15 and bottom 15 performing strategies/combinations are presented in Table 2, and a full table of results is available in Table S1. </plain></SENT>
<SENT sid="90" pm="."><plain>Smith–Waterman local alignments populate the list of best performing results, indicating that they are generally better than Needleman–Wunsch global alignments in motif alignment applications. </plain></SENT>
<SENT sid="91" pm="."><plain>The results also suggest that the PCC and SSD metrics are on average more effective than the AKL, pCS, and ALLR metrics (including ALLR_LL) for whole-motif comparison. </plain></SENT>
<SENT sid="92" pm="."><plain>The best-performing combination is Smith–Waterman local alignment using the SSD metric and gap open = 1 (average accuracy 0.811), whereas Smith–Waterman local alignment using the PCC metric also scores highly (seventh-best score; average accuracy 0.805). </plain></SENT>
<SENT sid="93" pm="."><plain>The first strategy that uses the AKL metric appears at position 28 of the list, and the first strategy using ALLR_LL appears at position 37. </plain></SENT>
<SENT sid="94" pm="."><plain>Strategies using the standard ALLR metric first appear at position 48, and strategies using the pCS metric first appear at position 60. </plain></SENT>
</text></p><SecTag type="TABLE"><table-wrap id="pcbi-0030061-t002" content-type="1col" position="float"><label>Table 2</label><caption><p><text><SENT sid="95" pm="."><plain>The Top 15 and Bottom 15 Performing Alignment Strategies </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.t002"/></table-wrap></SecTag></sec><sec id="s2d"><title><text><SENT sid="96" pm="."><plain>Predicting the TF Structural Class from its Binding Preferences </plain></SENT>
</text></title><p><text><SENT sid="97" pm="."><plain>In the study of Narlikar and Hartemink [10], a sparse Bayesian learning algorithm was used to predict the structural class of the TF that binds to a given DNA motif. </plain></SENT>
<SENT sid="98" pm="."><plain>The test dataset in that study consisted of the six largest motif families in TRANSFAC, and Narlikar and Hartemink's algorithm was able to correctly predict the TF structural family for 86% of these DNA-binding motifs. </plain></SENT>
<SENT sid="99" pm="."><plain>By analyzing the same dataset, we found that the best-hit approach (with ungapped Smith–Waterman alignment and the PCC metric) yields practically the same performance (87%). </plain></SENT>
<SENT sid="100" pm="."><plain>The best-hit searches perform better in predicting the bZIP, C4 zinc finger, and Forkhead families, whereas the Bayesian learning is better in the more diverse (in terms of DNA binding motifs) C2H2 zinc finger, homeodomain, and bHLH families (Table 3). </plain></SENT>
<SENT sid="101" pm="."><plain>We will later show that the appropriate clustering of DNA motifs can help improve the classification accuracy. </plain></SENT>
</text></p><SecTag type="TABLE"><table-wrap id="pcbi-0030061-t003" content-type="1col" position="float"><label>Table 3</label><caption><p><text><SENT sid="102" pm="."><plain>Performance of TF Structural Family Classification Based on DNA-Binding Preferences in the Six Largest Motif Families in TRANSFAC </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.t003"/></table-wrap></SecTag></sec><sec id="s2e"><title><text><SENT sid="103" pm="."><plain>Performance of Motif Tree-Building Methods </plain></SENT>
</text></title><p><text><SENT sid="104" pm="."><plain>Sandelin and Wasserman manually constructed FBPs for those ten nonzinc-finger structural families for which four or more motifs exist in the JASPAR database (71 motifs) [6]. </plain></SENT>
<SENT sid="105" pm="."><plain>One of the ten families, bZIP, produced two distinct FBPs: one related to C/EBP and one related to the CREB proteins. </plain></SENT>
<SENT sid="106" pm="."><plain>The set of 71 profiles provides an appropriate dataset for testing tree-building strategies and automatic clustering methods. </plain></SENT>
<SENT sid="107" pm="."><plain>In this study, an agglomerative (UPGMA) and a divisive (SOTA) strategy were compared (see Methods). </plain></SENT>
<SENT sid="108" pm="."><plain>The most effective alignment strategy for the nonzinc-finger JASPAR dataset, the ungapped Smith–Waterman alignment, was used with each of the six similarity metrics in conjunction with UPGMA or SOTA. </plain></SENT>
<SENT sid="109" pm="."><plain>Performance was measured as the average homogeneity of the families at each leaf node on the tree and with respect to the tree growth. </plain></SENT>
<SENT sid="110" pm="."><plain>For a given node, a performance average homogeneity score of 1 denotes that only one family is represented in the motifs clustered at that node (perfect homogeneity); a score of 0.5 denotes that two equally represented families are clustered in that node; etc. </plain></SENT>
<SENT sid="111" pm="."><plain>The point at which the average homogeneity of the leaf nodes reaches 1 is the point where motifs have been successfully separated on the basis of structural class (although a class might be split into multiple nodes). </plain></SENT>
<SENT sid="112" pm="."><plain>As can be seen in Figure 4, UPGMA generally performs better than the neural tree method (SOTA), regardless of the similarity metric. </plain></SENT>
<SENT sid="113" pm="."><plain>Ungapped Smith–Waterman alignment using the PCC metric is by far the most successful metric on this dataset, managing to separate all ten structural families (100% average homogeneity) with only 25 leaf nodes. </plain></SENT>
<SENT sid="114" pm="."><plain>In addition, ungapped Smith–Waterman alignment using the SSD metric achieves 95% average homogeneity with 26 leaf nodes. </plain></SENT>
<SENT sid="115" pm="."><plain>The actual tree resulting from the combination of ungapped Smith–Waterman alignment, the PCC metric, and the UPGMA tree construction method displays a high degree of separation of the TF structural classes (Figure 5). </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pcbi-0030061-g004" position="float"><label>Figure 4</label><caption><title><text><SENT sid="116" pm="."><plain>Average Homogeneity of Families Represented at Each Tree Node as a Factor of the Growth of the Tree </plain></SENT>
</text></title><p><text><SENT sid="117" pm="."><plain>Six scoring metrics and two different tree-building methods are tested with ungapped Smith–Waterman alignments. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g004"/></fig></SecTag><SecTag type="FIG"><fig id="pcbi-0030061-g005" position="float"><label>Figure 5</label><caption><title><text><SENT sid="118" pm="."><plain>The Tree Resulting from a UPGMA Tree Construction of Ten JASPAR Families (71 Motifs Total) Using the PCC Scoring Metric and Smith–Waterman (Ungapped) Alignment Method </plain></SENT>
</text></title><p><text><SENT sid="119" pm="."><plain>The red line represents the level at which the CH log metric estimates the optimal number of data clusters on the tree. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g005"/></fig></SecTag></sec><sec id="s2f"><title><text><SENT sid="120" pm="."><plain>Automatic Construction of Familial Binding Profiles </plain></SENT>
</text></title><p><text><SENT sid="121" pm="."><plain>Estimating the optimal number of data clusters on a tree of binding motifs is of significant interest in classification and familial binding property analysis applications. </plain></SENT>
<SENT sid="122" pm="."><plain>It is well-known, however, that this is an inherently arbitrary procedure; different criteria on where to “split” the tree will give different estimates of cluster number. </plain></SENT>
<SENT sid="123" pm="."><plain>A number of statistics have been described that aim to estimate the optimal number of clusters (e.g., [19–21]), usually by seeking an optimal balance between intercluster and intracluster variability. </plain></SENT>
</text></p><p><text><SENT sid="124" pm="."><plain>We used a subset of the JASPAR motifs to understand how different metrics perform in determining the optimal number of clusters in a tree. </plain></SENT>
<SENT sid="125" pm="."><plain>For this purpose, only closely related members of the ETS, REL, Forkhead, high mobility group (HMG), and MADS families were used. </plain></SENT>
<SENT sid="126" pm="."><plain>The statistics we compared were: the Gap statistic of Hastie, Tibshirani, and Walter (HTW) [22], the standard Calinski and Harabasz (CH) [19], and a derivative (CH log) we developed (Table 4). </plain></SENT>
<SENT sid="127" pm="."><plain>When tested on the tree of the five well-defined families, the standard CH statistic didn't yield any local maximum number of clusters. </plain></SENT>
<SENT sid="128" pm="."><plain>We believe this is because this statistic performs well when the number of clusters is small compared with the number of points. </plain></SENT>
<SENT sid="129" pm="."><plain>Otherwise, the within-cluster difference goes quickly to zero, driving the CH to infinity. </plain></SENT>
<SENT sid="130" pm="."><plain>The CH log, by design, avoids this problem. HTW and CH log both gave the correct optimal number of clusters in the five-family dataset. </plain></SENT>
<SENT sid="131" pm="."><plain>When tested on the full nonzinc-finger JASPAR dataset (71 motifs) (Figure 5), however, HTW and CH yielded no optimum number of clusters, whereas CH log gave 17 (Figure 6), which is a reasonable number (compared with 11 of Sandelin and Wasserman). </plain></SENT>
<SENT sid="132" pm="."><plain>For the most part, the identified clusters of motifs seemed reasonable both in terms of binding motif conservation (manual examination) and in terms of TF subfamily classification. </plain></SENT>
<SENT sid="133" pm="."><plain>More information is provided in the Discussion section. </plain></SENT>
<SENT sid="134" pm="."><plain>The suitability of CH log was also tested in trees with two, three, four, and six well-defined clusters (from the above set of JASPAR PSSMs) and always yielded the correct answer. </plain></SENT>
</text></p><SecTag type="TABLE"><table-wrap id="pcbi-0030061-t004" content-type="1col" position="float"><label>Table 4</label><caption><p><text><SENT sid="135" pm="."><plain>The Four Statistics Tested on Automatic Clustering of the 71 JASPAR Motifs </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.t004"/></table-wrap></SecTag><SecTag type="FIG"><fig id="pcbi-0030061-g006" position="float"><label>Figure 6</label><caption><title><text><SENT sid="136" pm="."><plain>The Behaviour of the Calinski and Harabasz–Based Log-Metric (CH log) for the Tree in Figure 5 as the Number of Clusters (g) Is Varied </plain></SENT>
</text></title><p><text><SENT sid="137" pm="."><plain>The value of g = 17 produces a global minimum in the value of CH log. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g006"/></fig></SecTag><p><text><SENT sid="138" pm="."><plain>We test the hypothesis that the 17 automatically generated FBPs are a more accurate representation of motif diversity in the JASPAR set than the 11 manually constructed motifs using leave-one-out cross-validation (LOOCV). </plain></SENT>
<SENT sid="139" pm="."><plain>In this test, we treat the set of FBP clusters as static multiple alignments and remove the contribution of each motif from its appropriate FBP in turn. </plain></SENT>
<SENT sid="140" pm="."><plain>The removed motif is then compared against all regenerated FBPs, and treated as correctly classified if it most closely matches the FBP from which it was withdrawn. </plain></SENT>
<SENT sid="141" pm="."><plain>LOOCV using Sandelin and Wasserman's 11 manually defined FBPs results in nine misclassifications, or a classification performance of 62/71 = 87% (this performance rate was also reported in [6]). </plain></SENT>
<SENT sid="142" pm="."><plain>By comparison, in our dataset of 17 automatically defined FBPs, LOOCV resulted in two misclassifications, which, combined with the two unclassifiable singleton clusters, suggests a classification performance of 94% (67/71). </plain></SENT>
</text></p><p><text><SENT sid="143" pm="."><plain>JASPAR also contains three zinc-finger motifs that were not used in the Sandelin and Wasserman FBP construction. </plain></SENT>
<SENT sid="144" pm="."><plain>One of them, C2H2, includes TF proteins with highly divergent patterns of contacts (see Discussion). </plain></SENT>
<SENT sid="145" pm="."><plain>The other two, DOF (a C4 zinc-finger family) and GATA, have quite conserved DNA-binding patterns. </plain></SENT>
<SENT sid="146" pm="."><plain>We repeated the above analysis by including the DOF and GATA motifs in JASPAR (four motifs in each family). </plain></SENT>
<SENT sid="147" pm="."><plain>Our method determined 18 clusters (including two singletons), and a LOOCV test resulted in 72/79 correct classifications (91%). </plain></SENT>
<SENT sid="148" pm="."><plain>Sandelin's and Wasserman's method on the 13 clusters (the previous 11 and the two zinc fingers) resulted in 60/79 correct classifications in the LOOCV test (76%). </plain></SENT>
<SENT sid="149" pm="."><plain>Compared with the 71-motif tree (Figure 5), the new tree is identical in 15 of the clusters (Figure 7). </plain></SENT>
<SENT sid="150" pm="."><plain>The main difference is that the two-member cluster of the heterodimeric bHLH proteins, TAL1-TCF3 and HAND1-TCF3, is now split. </plain></SENT>
<SENT sid="151" pm="."><plain>The TAL1-TCF3 motif is part of a new cluster with the (previously singleton) FOXL1 and the GATA-1 zinc-finger protein motif. </plain></SENT>
<SENT sid="152" pm="."><plain>The remaining three GATA proteins formed a new cluster. </plain></SENT>
<SENT sid="153" pm="."><plain>All four DOF proteins are co-clustered with the IRF proteins. </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pcbi-0030061-g007" position="float"><label>Figure 7</label><caption><title><text><SENT sid="154" pm="."><plain>The Tree Resulting from a UPGMA Tree Construction of 12 JASPAR Families (79 Motifs Total) Using the PCC Scoring Metric and Smith–Waterman (Ungapped) Alignment Method </plain></SENT>
</text></title><p><text><SENT sid="155" pm="."><plain>This tree includes the two zinc-finger families (GATA and DOF). </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g007"/></fig></SecTag></sec><sec id="s2g"><title><text><SENT sid="156" pm="."><plain>The STAMP Platform </plain></SENT>
</text></title><p><text><SENT sid="157" pm="."><plain>All described methods have been compiled in a software platform (STAMP) (Mahony S, Benos PV, STAMP: A web tool for exploring DNA-binding motif similarities, unpublished). </plain></SENT>
<SENT sid="158" pm="."><plain>STAMP is modularly designed to allow any combination of column–column scoring metric, alignment method, tree-building algorithm, and multiple-alignment strategy to be used. </plain></SENT>
<SENT sid="159" pm="."><plain>Its potential uses range from simple motif database searches to identify the TF that may bind to a particular motif to a full-scale analysis of multiple-aligned genomic regions. </plain></SENT>
<SENT sid="160" pm="."><plain>In the section below, examples of both these uses are provided. </plain></SENT>
<SENT sid="161" pm="."><plain>STAMP is publicly accessible from <ext-link ext-link-type="uri" xlink:href="http://www.benoslab.pitt.edu/stamp/">http://www.benoslab.pitt.edu/stamp/</ext-link>. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="DISCUSS"><sec id="s3"><title><text><SENT sid="162" pm="."><plain>Discussion </plain></SENT>
</text></title><sec id="s3a"><title><text><SENT sid="163" pm="."><plain>Comparison of PSSM Column Distance Metrics and Alignment Strategies </plain></SENT>
</text></title><p><text><SENT sid="164" pm="."><plain>Six PSSM column similarity metrics were evaluated together with three pairwise alignment methods (two gapped and one ungapped), two multiple-alignment strategies, and two tree-building strategies on motif datasets. </plain></SENT>
<SENT sid="165" pm="."><plain>The results showed that the Smith–Waterman local alignment algorithm used with the PCC or SSD metrics generally performs better in aligning the currently available PSSM models with models for which the associated TF belongs to the same structural family. </plain></SENT>
<SENT sid="166" pm="."><plain>We also discovered that the high efficiency of some metrics in column-to-column comparison does not extend to the alignment of whole motifs, which is a surprising and previously overlooked outcome. </plain></SENT>
<SENT sid="167" pm="."><plain>In the case of the ALLR metric, we believe that this inconsistency is due to the metric's very negatively skewed scoring distribution (Figure 2). </plain></SENT>
<SENT sid="168" pm="."><plain>Although such a distribution might be advantageous in distinguishing between PSSM columns with low information content, it also makes motif alignment more difficult, especially when the motifs contain low-scoring regions that can rigorously negate the overall score. </plain></SENT>
<SENT sid="169" pm="."><plain>The difficulties in using ALLR became more apparent with the Needleman–Wunsch global alignment, as low scores that are frequently observed in the beginning and/or at the end of the alignment could not be adequately subsidized by the positive scores in the alignable areas. </plain></SENT>
<SENT sid="170" pm="."><plain>The use of the alternative ALLR_LL metric (i.e., ALLR with a lower limit of −2) improved the results slightly. </plain></SENT>
<SENT sid="171" pm="."><plain>However, ALLR is the only metric that takes into consideration the background distribution when it compares two columns, which, in combination with the fact that it distinguishes better between columns of low information content (Figure 3), can be advantageous in identifying the correct PSSM model among closely related models (e.g., those belonging to the same family). </plain></SENT>
</text></p><p><text><SENT sid="172" pm="."><plain>Smith–Waterman local alignments were found to be more effective than Needleman–Wunsch global alignments for DNA motifs. </plain></SENT>
<SENT sid="173" pm="."><plain>This is expected given the current status of the motif databases. </plain></SENT>
<SENT sid="174" pm="."><plain>Motifs in existing databases usually result from some automated method that runs on a set of unaligned sequences recorded in these databases. </plain></SENT>
<SENT sid="175" pm="."><plain>These motifs frequently consist of a “core” area of columns with high information content, surrounded by columns of low(er) information content. </plain></SENT>
<SENT sid="176" pm="."><plain>On such motifs, local motif alignment methods will tend to perform better than global alignment methods. </plain></SENT>
<SENT sid="177" pm="."><plain>Structurally, this also makes sense, since binding sites are often recognized by a single structural sequence recognition element (e.g., α-helix) either surrounded by or adjacent to a less-specific element that provides additional binding energy. </plain></SENT>
<SENT sid="178" pm="."><plain>Interestingly, ungapped algorithms or gapped algorithms with high gap-opening penalties generally performed better with the same metric (Table 2). </plain></SENT>
<SENT sid="179" pm="."><plain>This is probably due to the fact that the motifs for TF families in JASPAR and TRANSFAC share ungapped regions of similarity. </plain></SENT>
<SENT sid="180" pm="."><plain>However, the difference between ungapped/high penalty and gapped with lower-gap penalty algorithms is marginal in the JASPAR and TRANSFAC databases. </plain></SENT>
<SENT sid="181" pm="."><plain>Gapped alignment methods are expected to be more effective when aligning families of motifs that share common half-sites with variable length spacer regions, like many prokaryotic sites. </plain></SENT>
</text></p></sec><sec id="s3b"><title><text><SENT sid="182" pm="."><plain>Differences in Classification Efficiency between TF Structural Families </plain></SENT>
</text></title><p><text><SENT sid="183" pm="."><plain>An unexpected finding was that the current multiclass motif classifiers perform no better than simple best-hit similarity queries against a motif database when appropriate motif alignment methods are used. </plain></SENT>
<SENT sid="184" pm="."><plain>Interestingly, the two zinc-finger families (C2H2 and C4) are predicted with the worst and the best efficiency, respectively, which reflects their binding geometries. </plain></SENT>
<SENT sid="185" pm="."><plain>The C4 factors form extensive networks of contacts along the length of an α-helix embedded in a B-DNA major groove. </plain></SENT>
<SENT sid="186" pm="."><plain>As a result, their target sequences are very conserved and thus their predictions easier. </plain></SENT>
<SENT sid="187" pm="."><plain>The C2H2 zinc fingers on the other hand contact the DNA helix at an angle using only few amino acid side-chains extending from the end of a less intimately associated helix. </plain></SENT>
<SENT sid="188" pm="."><plain>This results in less binding dependence upon individual amino acid sequences. </plain></SENT>
<SENT sid="189" pm="."><plain>Changes in certain “key” amino acid positions can drastically alter the DNA-binding specificity, thus yielding highly variable targets. </plain></SENT>
</text></p><p><text><SENT sid="190" pm="."><plain>bZIP factors bind to DNA as dimers in palindromic targets and they select individual half-sites in the process. </plain></SENT>
<SENT sid="191" pm="."><plain>The monomers readily dissociate from the dimeric form, binding DNA initially as half-site monomers [23]. </plain></SENT>
<SENT sid="192" pm="."><plain>This kinetic selection process, along with the intimate association of the recognition helix with the major groove (similar to C4 Zn fingers) likely provides exquisite selectivity. </plain></SENT>
<SENT sid="193" pm="."><plain>The same selectivity may not be realized for the bHLH proteins. </plain></SENT>
<SENT sid="194" pm="."><plain>Although these factors also select out half-sites, their monomers, in contrast to bZIPs, have very low dissociation rates and act more like covalently linked DNA-binding domains (similar to C2H2 factors). </plain></SENT>
<SENT sid="195" pm="."><plain>Also, the angle of interaction between the recognition helix and the major groove is more obtuse for bHLH than for bZIP (23 versus 20 degrees), resulting in less interaction with half-sites (3 bp instead of 4 bp). </plain></SENT>
<SENT sid="196" pm="."><plain>These differences may explain why a bHLH behaves more like a C2H2 in target heterogeneity. </plain></SENT>
</text></p><p><text><SENT sid="197" pm="."><plain>The relatively poor prediction specificity exhibited for the Homeo HTH domain proteins stems from the binding of these factors to highly divergent targets (usually recognizing mostly an “AT” motif), probably due to their dependence upon partner domains that are either dissociable (like Hox-Pbx, Ubx-Exd, and Mat a1-alpha2) or covalently linked (like Oct, Pax, and Pit). </plain></SENT>
<SENT sid="198" pm="."><plain>Member families of the monomeric wHTH subtype have strong consensus correlations (like the ETS and Forkhead families with consensus GGAA and TAAACA, respectively). </plain></SENT>
<SENT sid="199" pm="."><plain>This results in higher prediction efficiency for Forkhead than for the more variable Homeo class. </plain></SENT>
<SENT sid="200" pm="."><plain>It is this idea of variability, perhaps dependent upon multimerization-related constraints, that may be a useful basis for the distinctions we observe. </plain></SENT>
</text></p><p><text><SENT sid="201" pm="."><plain>Another problem that may impose a limit in the classification efficiency of any method (regardless of the TF family) is the quality of the TFBS alignment and the resulting PSSM models. </plain></SENT>
<SENT sid="202" pm="."><plain>It is hoped that with the accumulation of new data, this will become less of a problem in the future. </plain></SENT>
</text></p></sec><sec id="s3c"><title><text><SENT sid="203" pm="."><plain>Clustering of DNA Profiles: Automatic FBP Construction </plain></SENT>
</text></title><p><text><SENT sid="204" pm="."><plain>Sandelin and Wasserman [6] had previously built 11 FBPs from 71 nonzinc-finger PSSM models (ten TF families) available in the JASPAR database. </plain></SENT>
<SENT sid="205" pm="."><plain>Their manual clustering of the PSSM models was based on prior knowledge of the structural class of the corresponding TF. </plain></SENT>
<SENT sid="206" pm="."><plain>An exception to this general rule was the bZIP family, for which they constructed two FBPs (CREB- and C/EBP-related) after observing very different DNA patterns. </plain></SENT>
<SENT sid="207" pm="."><plain>The FBP corresponding to each structural class was calculated from a multiple-motif alignment where the contributions from outlying motifs were negatively weighted. </plain></SENT>
<SENT sid="208" pm="."><plain>The 11 familial binding profiles and the 71 motifs in the training set are available to view from the JASPAR database website (<ext-link ext-link-type="uri" xlink:href="http://mordor.cgb.ki.se/cgi-bin/jaspar2005/jaspar_db.pl">http://mordor.cgb.ki.se/cgi-bin/jaspar2005/jaspar_db.pl</ext-link>). </plain></SENT>
<SENT sid="209" pm="."><plain>Sandelin and Wasserman's manual approach is suitable for relatively small sets of binding motifs where the structural class corresponding to each motif is known, and where the representatives from each component structural class bind a set of closely related target motifs. </plain></SENT>
<SENT sid="210" pm="."><plain>However, in the more general case, where families that bind diverse target motifs are included or where the structural class of certain motifs is unknown, it may be useful to attempt automatic generation of the appropriate familial binding motifs. </plain></SENT>
</text></p><p><text><SENT sid="211" pm="."><plain>We developed a fully automated method for PSSM clustering, based on the combinations of metric, alignment strategies, and tree building examined in this study. </plain></SENT>
<SENT sid="212" pm="."><plain>The advantages of the automatic clustering are obvious. </plain></SENT>
<SENT sid="213" pm="."><plain>By remaining ignorant to the prior knowledge of the structural class of each motif, we can find cases where motifs from diverse structural classes are more suitably grouped together, if they have similar binding preferences. </plain></SENT>
<SENT sid="214" pm="."><plain>Similarly, the automatic approach avoids the temptation of forcing together subfamilies of the same structural class with different binding preferences. </plain></SENT>
<SENT sid="215" pm="."><plain>Also, “outlier” PSSMs can be easily detected through an automatic clustering and subsequently be excluded from the FBP. </plain></SENT>
</text></p><p><text><SENT sid="216" pm="."><plain>The method we used to determine the optimal number of clusters is similar to the Calinski and Harabasz statistic [19], but the intercluster and intracluster variability is calculated on the log-scale. </plain></SENT>
<SENT sid="217" pm="."><plain>We found this method to compare favourably with other methods on datasets with a known, well-defined small number of clusters and in the whole dataset. </plain></SENT>
<SENT sid="218" pm="."><plain>When applied on the 71 JASPAR PSSM models of our dataset, this method yielded 17 clusters, two of which are singletons and another two of which contain a pair of heterologous TFs each (Figure 8). </plain></SENT>
<SENT sid="219" pm="."><plain>Overall, the automatic clustering method divides the dataset into homogeneous clusters with respect to the structural group of the corresponding TF (note that the clusters are based solely on the binding preferences of the TFs). </plain></SENT>
<SENT sid="220" pm="."><plain>This agrees with the general notion that structurally similar TFs tend to have similar binding specificities. </plain></SENT>
<SENT sid="221" pm="."><plain>The MADS domain proteins and the wHTH ETS proteins are two examples of TF families with very conserved DNA-binding preferences. </plain></SENT>
<SENT sid="222" pm="."><plain>Also, homeobox and nuclear receptor family clusters are homogeneous, although some members of these families can be found in other clusters. </plain></SENT>
<SENT sid="223" pm="."><plain>Interestingly, our algorithm split the patterns of the members of the (so-called) TRP family into Myb-related proteins and IRF proteins. </plain></SENT>
<SENT sid="224" pm="."><plain>This may not be surprising, since these two HTH-like proteins exhibit distinct DNA-binding geometries. </plain></SENT>
<SENT sid="225" pm="."><plain>Myb proteins contain three HTH domains, only one of which is involved in the target recognition (with reported consensus YAAC[G/T]G). </plain></SENT>
<SENT sid="226" pm="."><plain>The IRF family consists of wHTH proteins that bind as homodimers via nonpalindromic direct repeats [24] or as monomers cooperatively with other proteins, like ETS [25]. </plain></SENT>
<SENT sid="227" pm="."><plain>The IRF motif (Figure 8) contains a repeat of the commonly reported [A/G]NGAAA consensus, which we attribute to the homodimerization binding of these proteins. </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pcbi-0030061-g008" position="float"><label>Figure 8</label><caption><title><text><SENT sid="228" pm="."><plain>Optimal Number of Clusters of the 71 JASPAR Motifs, According to Our Method </plain></SENT>
</text></title><p><text><SENT sid="229" pm="."><plain>PCC with Smith–Waterman ungapped alignment was used as a scoring function. </plain></SENT>
<SENT sid="230" pm="."><plain>Examples of protein–DNA complexes are provided for comparison. </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g008"/></fig></SecTag><p><text><SENT sid="231" pm="."><plain>Our algorithm also correctly recognized three subfamilies in the major bHLH family. </plain></SENT>
<SENT sid="232" pm="."><plain>The six members of the bHLH-zip subclass (e.g., USF1, MAX, etc.) are clustered together, whereas the remaining four “standard” bHLH proteins (Myf, NHLH1) and bHLH complexes (HAND1-TCF3, TAL1-TCF3) form two separate clusters. </plain></SENT>
<SENT sid="233" pm="."><plain>Examination of the FBPs of these clusters (Figure 8) shows clearly that binding preferences are substantially different, reflecting their corresponding mode of DNA recognition. </plain></SENT>
<SENT sid="234" pm="."><plain>The bZIP binding motifs were also automatically split into two clusters, identical to the (manually) classified JASPAR FBPs: one with the CREB-like and one with the C/EBP-like proteins. </plain></SENT>
<SENT sid="235" pm="."><plain>We note the striking similarity between the bZIP/CREB and the nuclear receptor binding patterns. </plain></SENT>
<SENT sid="236" pm="."><plain>Still, since the only base position they differ in is one of high information content, our clustering method was able to distinguish between the two patterns. </plain></SENT>
</text></p><p><text><SENT sid="237" pm="."><plain>The HMG proteins are represented by three protein families that bind chromosomal DNA. </plain></SENT>
<SENT sid="238" pm="."><plain>The two families represented in the JASPAR database are HMGA/HMGI/Y and HMGB/SOX/SRY, whereas the HMGN family is not represented. </plain></SENT>
<SENT sid="239" pm="."><plain>The HMGA proteins are members of the AT-hook family of TFs [26]. </plain></SENT>
<SENT sid="240" pm="."><plain>The HMGB proteins are structurally distinct HMG-box proteins [27]. </plain></SENT>
<SENT sid="241" pm="."><plain>Both families prefer to bind to AT-rich sequences in the minor groove with low selectivity. </plain></SENT>
<SENT sid="242" pm="."><plain>This is probably the reason that our algorithm clustered them together with the Forkhead family, which also binds to AT-rich sequences, but in the major groove. </plain></SENT>
<SENT sid="243" pm="."><plain>There is no structural similarity among these classes of proteins, and the mode of their interaction with the DNA suggests that the target similarity is coincidental. </plain></SENT>
<SENT sid="244" pm="."><plain>In fact, the two motifs are not identical, but they show significant overlap in four highly informative nucleotide positions (consensus: AACA) (Figure 9). </plain></SENT>
<SENT sid="245" pm="."><plain>Nevertheless, for those that use the FBPs for predicting the TF that binds to a given DNA motif, this provides an example where generating individual FBPs might lead to misclassification due to coincidental target similarity. </plain></SENT>
<SENT sid="246" pm="."><plain>Thus, for prediction purposes, we propose to keep these two families in the same cluster (FBP), since distinguishing between the two may be difficult (Figure 9). </plain></SENT>
<SENT sid="247" pm="."><plain>Notably, our algorithm identified another cluster composed of members of both families, suggesting there is a relationship between their motifs. </plain></SENT>
<SENT sid="248" pm="."><plain>Both these clusters contain members of the HMGB subgroup. </plain></SENT>
<SENT sid="249" pm="."><plain>The only member of the distinct HMGA subgroup, HMG-I/Y, clusters together with a homeodomain protein, Pax4. </plain></SENT>
<SENT sid="250" pm="."><plain>Pax proteins have two covalently linked HTH domains separated by a long linker and they also bind AT-rich sequences. </plain></SENT>
<SENT sid="251" pm="."><plain>The HTHs bind to 5-bp and 6-bp recognition sequences with an interpositioned 6-bp spacer that interacts with the linker [28]. </plain></SENT>
<SENT sid="252" pm="."><plain>This explains the long recognition sequence revealed in the FBP in this cluster. </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pcbi-0030061-g009" position="float"><label>Figure 9</label><caption><title><text><SENT sid="253" pm="."><plain>Similarity between the HMG and Forkhead Motifs </plain></SENT>
</text></title><p><text><SENT sid="254" pm="."><plain>These families are grouped together on the HMG/Forkhead Group I cluster (Figure 8). </plain></SENT>
</text></p></caption><graphic xlink:href="pcbi.0030061.g009"/></fig></SecTag><p><text><SENT sid="255" pm="."><plain>When the two zinc-finger families were included in the analysis, the overall structure of the tree and the clusters remained the same, pointing to the stability of our multiple alignment and clustering algorithm. </plain></SENT>
<SENT sid="256" pm="."><plain>Most of the GATA proteins formed a new cluster, whereas all DOF proteins joined the cluster of the two IRF proteins. </plain></SENT>
<SENT sid="257" pm="."><plain>This is because the DOF consensus target sequence (AAAG) is part of the IRF motif (Figure 8). </plain></SENT>
<SENT sid="258" pm="."><plain>The cross-validation results in the extended family tree/clustering remained very high (91% compared with 94% in the smaller tree). </plain></SENT>
</text></p></sec><sec id="s3d"><title><text><SENT sid="259" pm="."><plain>The STAMP Platform </plain></SENT>
</text></title><p><text><SENT sid="260" pm="."><plain>The STAMP platform, introduced in this study, contains all tested algorithms and can be efficiently used in BLAST-like searches against a database of PSSM models. </plain></SENT>
<SENT sid="261" pm="."><plain>Various datasets (including TRANSFAC and JASPAR motifs) are currently supported. </plain></SENT>
<SENT sid="262" pm="."><plain>In the future, it would be useful to incorporate other similarity metrics, alignment methods, and tree-building algorithms into the platform in order to allow for further exploration of optimal methods. </plain></SENT>
<SENT sid="263" pm="."><plain>Note, however, that it may not be possible to implement all of the known tree-building algorithms for motif alignment. </plain></SENT>
<SENT sid="264" pm="."><plain>Other distance-based methods (such as neighbour-joining [29]) rely heavily on additivity of the distance metric, which was not possible to define using our comparison metrics. </plain></SENT>
<SENT sid="265" pm="."><plain>Parsimony-based methods [30] rely on the estimation of substitution rates between sites, which is also not easily definable for frequency matrices. </plain></SENT>
<SENT sid="266" pm="."><plain>However, a substitution matrix has recently been defined for DNA-binding consensus sequences [31], so application of alternative tree-building methods may yet be possible in the DNA-binding motif domain (albeit not for PSSMs per se). </plain></SENT>
</text></p><p><text><SENT sid="267" pm="."><plain>In summary, we expect that the methods and the results described in this study will facilitate the exploration of DNA-binding preference evolution amongst related transcription factors and will have a significant impact in many areas of gene research. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="METHODS"><sec id="s4"><title><text><SENT sid="268" pm="."><plain>Materials and Methods </plain></SENT>
</text></title><sec id="s4a"><title/><sec id="s4a1"><title><text><SENT sid="269" pm="."><plain>PSSM column-scoring metrics. </plain></SENT>
</text></title><p><text><SENT sid="270" pm="."><plain>A PSSM model of length L is composed of a set of 4 × L weights (columns). </plain></SENT>
<SENT sid="271" pm="."><plain>Each column, X, follows a probability distribution, {px(b)}b ∈{A,C,G,T}, with the base-probability values reflecting the preference of the TF for the corresponding base in this position. </plain></SENT>
<SENT sid="272" pm="."><plain>The probability values can be estimated from the observed base counts {nx(b)}b ∈{A,C,G,T}. </plain></SENT>
<SENT sid="273" pm="."><plain>We denote the estimated values f(X) = {fx(b)}b ∈{A,C,G,T}. </plain></SENT>
<SENT sid="274" pm="."><plain>In practice, pX are estimated from nX plus some pseudocounts to reduce small-sample biases and to avoid zero probabilities. </plain></SENT>
<SENT sid="275" pm="."><plain>The assumption of independence between positions is not entirely accurate, but acts as a useful approximation [32–34]. </plain></SENT>
<SENT sid="276" pm="."><plain>In this study, only position-independent PSSM models are considered. </plain></SENT>
</text></p><p><text><SENT sid="277" pm="."><plain>Six metrics (Table 1) are compared with respect to their efficiency in capturing similarities between PSSM columns and in aligning PSSM motifs. </plain></SENT>
<SENT sid="278" pm="."><plain>Let us suppose one wants to compare two columns X and Y , with total number of aligned sequences NX and NY and (estimated) frequency distributions of f̂(X) = (XA, XC, XG, XT) and f̂ (Y) = (YA, YC, YG, YT), respectively. </plain></SENT>
<SENT sid="279" pm="."><plain>We denote X̄ and Ȳ the average frequencies in the two columns. </plain></SENT>
</text></p><p><text><SENT sid="280" pm="."><plain>Pearson Correlation Coefficient (PCC). PCC is a popular similarity metric that has been used by us and others in comparing DNA models [7,32,35]. </plain></SENT>
<SENT sid="281" pm="."><plain>PCC gives a measure of agreement between two (unweighted) sets of observations by means of their covariance. </plain></SENT>
<SENT sid="282" pm="."><plain>Pietrokovski [36] found PCC to be the most effective among four metrics for protein profiles. </plain></SENT>
</text></p><p><text><SENT sid="283" pm="."><plain>p-Value of chi-square test (pCS). Schones et al. [13] used the chi-square statistic as an approximation of the Fisher–Irwin exact test to investigate whether two columns are samples from the same multinomial distribution. </plain></SENT>
<SENT sid="284" pm="."><plain>In Table 1, nK(b) in the pCS formula represents the observed count of base b in column K (K ∈ {X, Y}) plus one pseudocount. </plain></SENT>
<SENT sid="285" pm="."><plain>The expected occurrence of base b in column K is given by  = (NK·Nb)/N, where NK is the total number of counts in column K, Nb is the total number of counts for base b in the two columns, and N is the sum of counts in both columns. </plain></SENT>
<SENT sid="286" pm="."><plain>The p-value is calculated from the  statistic and subtracted from 1 to yield a similarity score. </plain></SENT>
<SENT sid="287" pm="."><plain>We note that the pCS metric does not hold as an approximation of the Fisher–Irwin exact test when one or more bases has fewer than five observed counts in a column [13]. </plain></SENT>
<SENT sid="288" pm="."><plain>This condition occurs often in PSSM models. </plain></SENT>
</text></p><p><text><SENT sid="289" pm="."><plain>Average Kullback–Leibler (AKL). The Kullback–Leibler distance (or relative entropy) is the weighted log-likelihood ratio distance between two distributions. </plain></SENT>
<SENT sid="290" pm="."><plain>The standard Kullback–Leibler is noncommutative and hence is not a true metric. </plain></SENT>
<SENT sid="291" pm="."><plain>However, it is frequently used in comparing TF–DNA preference probability distributions since it has an important quality: more weight is placed in the high-probability bases, where TF–DNA modeling algorithms need to be more accurate. </plain></SENT>
<SENT sid="292" pm="."><plain>Kullback–Leibler distance has been employed in the T-Reg Comparator motif similarity software tool and elsewhere [32,37,38]. </plain></SENT>
<SENT sid="293" pm="."><plain>In our study, we subtract the average Kullback–Leibler score from an arbitrarily defined maximum (10.0) to convert it to a similarity score. </plain></SENT>
<SENT sid="294" pm="."><plain>A theoretical maximum score cannot be defined for the AKL column distances, but more than 99% of the column-to-column scores in the TRANSFAC database [17] were found to have an AKL of less than 10.0. </plain></SENT>
</text></p><p><text><SENT sid="295" pm="."><plain>Sum of squared distances (SSD). SSD is a simple scoring metric that was employed by Sandelin and Wasserman in their construction of FBPs [6]. </plain></SENT>
<SENT sid="296" pm="."><plain>Note that in this metric, the basic distance measure is subtracted from the maximum possible score (2.0) to convert it to similarity measure. </plain></SENT>
</text></p><p><text><SENT sid="297" pm="."><plain>Average Log Likelihood Ratio (ALLR and ALLR_LL). The ALLR statistic was introduced by Wang and Stormo [31,39] as a way to measure similarity between two informative (i.e., different from the background) column distributions. Table 1 presents the formula for ALLR, where nK(b) is the observed count of base b in column K (K ∈ {X, Y}) and pref(b) is the background probability of base b. </plain></SENT>
<SENT sid="298" pm="."><plain>In this study, pref(b) is assumed to be 0.25 for all bases. </plain></SENT>
<SENT sid="299" pm="."><plain>The ALLR metric has a skewed scoring distribution; the minimum score (≤−10) is much smaller than the maximum score (2). </plain></SENT>
<SENT sid="300" pm="."><plain>Therefore, we also tested a modified ALLR measure, termed ALLR_LL, in which the lower score was bounded by −2. </plain></SENT>
</text></p></sec><sec id="s4a2"><title><text><SENT sid="301" pm="."><plain>Comparing columns. </plain></SENT>
</text></title><p><text><SENT sid="302" pm="."><plain>Information content–specific PSSM columns were constructed with fI(C) = fI(G) = fI(T) and fI(A) set such that the column information content had a specified value I. </plain></SENT>
<SENT sid="303" pm="."><plain>This column is denoted the “true” column centre, or  . </plain></SENT>
<SENT sid="304" pm="."><plain>One million columns were sampled independently from a Dirichlet distribution centered on  (Dirichlet α parameter = 20). </plain></SENT>
<SENT sid="305" pm="."><plain>The sum of nucleotide counts in each of the random columns was set to 30 to reflect the mean number of binding site instances used to construct TRANSFAC PSSMs. </plain></SENT>
<SENT sid="306" pm="."><plain>Another one million columns were sampled from a Dirichlet distribution centered on the zero information content column , where fref(A) = fref(C) = fref(G) = fref(T) = 0.25. </plain></SENT>
</text></p></sec><sec id="s4a3"><title><text><SENT sid="307" pm="."><plain>Comparing motifs of different lengths: p-Values. </plain></SENT>
</text></title><p><text><SENT sid="308" pm="."><plain>To avoid length biases when comparing motifs of different lengths, we used the method of Sandelin and Wasserman for the calculation of empirical p-values based on simulated PSSMs [6]. </plain></SENT>
<SENT sid="309" pm="."><plain>Construction of a dataset of 10,000 simulated PSSMs was performed according to the instructions of Sandelin and Wasserman (<ext-link ext-link-type="uri" xlink:href="http://forkhead2.cgb.ki.se/jaspar/additional">http://forkhead2.cgb.ki.se/jaspar/additional</ext-link>) that reflected the properties of PSSMs in the JASPAR database. </plain></SENT>
</text></p></sec><sec id="s4a4"><title><text><SENT sid="310" pm="."><plain>Pairwise and multiple-motif alignment and tree-building methods. </plain></SENT>
</text></title><p><text><SENT sid="311" pm="."><plain>Pairwise motif alignment. Needleman–Wunsch global alignment [40,41] and Smith–Waterman local alignment [42] were tested. </plain></SENT>
<SENT sid="312" pm="."><plain>Both methods allow for affine gap penalties. </plain></SENT>
<SENT sid="313" pm="."><plain>For this study, the gap-extension penalty is set to be half the value of the gap-opening penalty. </plain></SENT>
<SENT sid="314" pm="."><plain>Smith–Waterman alignments also allow the user to specify a minimum overlap length for the local alignment. </plain></SENT>
<SENT sid="315" pm="."><plain>In cases where we tested the performance of Smith–Waterman alignments with required overlap, the minimum overlap length was set to three columns. </plain></SENT>
<SENT sid="316" pm="."><plain>We also implemented an ungapped, extended Smith–Waterman alignment method, in which the “motif cores” of the PSSM models under comparison are aligned before extending the local alignment. </plain></SENT>
<SENT sid="317" pm="."><plain>A “core” is defined as the longest of (a) the four most informative adjacent columns; and (b) the “trimmed” motif (starting and ending at a position with information content of at least 0.3). </plain></SENT>
<SENT sid="318" pm="."><plain>The ungapped extended Smith–Waterman alignment was found to have advantages in aligning groups of short motifs. </plain></SENT>
<SENT sid="319" pm="."><plain>Optimal alignment is sought in both forward and reverse motif directions. </plain></SENT>
</text></p><p><text><SENT sid="320" pm="."><plain>Multiple-motif alignment. Two multiple-alignment strategies are tested. </plain></SENT>
<SENT sid="321" pm="."><plain>One is a progressive profile alignment strategy, which relies on the preconstruction of an approximate guide tree using UPGMA. </plain></SENT>
<SENT sid="322" pm="."><plain>The multiple alignment is built up by progressively aligning the nodes on the guide tree in order of decreasing similarity. </plain></SENT>
<SENT sid="323" pm="."><plain>In this way, each internal node contains a “familial” profile. </plain></SENT>
<SENT sid="324" pm="."><plain>The alignment at the root node will represent the final multiple alignment. </plain></SENT>
<SENT sid="325" pm="."><plain>The second implemented strategy is iterative refinement alignment, which aims to combat the problem of local minima, common in the progressive alignment methods due to “frozen” subalignments [43]. </plain></SENT>
<SENT sid="326" pm="."><plain>Iterative refinement builds a rough multiple alignment by progressively adding to the current alignment the most similar input PSSM (and taking the most similar pair as the start point of the multiple alignment). </plain></SENT>
<SENT sid="327" pm="."><plain>Once the initial alignment is built, each PSSM is removed from the alignment in turn and realigned to a profile of the other aligned sequences. </plain></SENT>
<SENT sid="328" pm="."><plain>Iteration of the realignment continues a fixed number of times. </plain></SENT>
<SENT sid="329" pm="."><plain>For gapped multiple alignments, gaps are encouraged to open in the same positions as previous gaps by negatively weighting the gap-open and gap-extend penalties in positions of the alignment that already contain gaps. </plain></SENT>
</text></p><p><text><SENT sid="330" pm="."><plain>Tree-building algorithms. We implemented two similarity-based tree-building algorithms: an agglomerative method (UPGMA [44]) and a divisive method that is based on a self-organizing tree algorithm (SOTA [45]). </plain></SENT>
<SENT sid="331" pm="."><plain>UPGMA begins by assigning each input PSSM its own leaf node. </plain></SENT>
<SENT sid="332" pm="."><plain>At each timestep, the two nodes with the maximum average pairwise similarity are joined. </plain></SENT>
<SENT sid="333" pm="."><plain>The tree is built up through successive combinations of nodes until only one node (the root) remains. </plain></SENT>
<SENT sid="334" pm="."><plain>SOTA follows the opposite strategy. </plain></SENT>
<SENT sid="335" pm="."><plain>The tree is initialized with only one node (the root), which contains a rough alignment of all input PSSMs, and the node model is generated from this alignment. </plain></SENT>
<SENT sid="336" pm="."><plain>The root node then produces two identical offspring leaf nodes. </plain></SENT>
<SENT sid="337" pm="."><plain>During each timestep, the algorithm assigns the PSSMs to their most similar leaf nodes and then allows the node model to be updated in accordance with their current contents. </plain></SENT>
<SENT sid="338" pm="."><plain>As is characteristic of self-organizing neural algorithms, SOTA also allows for small contributions from neighboring nodes during the update step. </plain></SENT>
<SENT sid="339" pm="."><plain>These contributions are designed to keep neighboring nodes similar. </plain></SENT>
<SENT sid="340" pm="."><plain>After a number of timesteps, the node with the highest degree of dissimilarity amongst its members is allowed to produce two identical offspring nodes. </plain></SENT>
<SENT sid="341" pm="."><plain>This competitive learning scheme continues until each leaf node contains a single PSSM. </plain></SENT>
<SENT sid="342" pm="."><plain>While we denote this algorithm SOTA to reflect its similarity to the concepts presented by Dopazo and Carazo [45], the neural tree algorithm implemented here may also be thought of as a weighted hierarchical binary k-means algorithm. </plain></SENT>
</text></p><p><text><SENT sid="343" pm="."><plain>Estimating the number of data clusters in a PSSM tree. In this study, we tested two known statistics: Hastie, Tibshirani, Walter (HTW) [22] and Calinski and Harabasz (CH) [19], and one derivative of the latter (Table 4). </plain></SENT>
<SENT sid="344" pm="."><plain>For the given dataset, we found that CH log performed the best. </plain></SENT>
<SENT sid="345" pm="."><plain>The CH log formula is given in Table 4, with B and W representing the between and within cluster sum of squared errors, n is the number of matrices (i.e., 71 for the JASPAR dataset), and g is the current number of clusters in the hierarchy. </plain></SENT>
<SENT sid="346" pm="."><plain>Error here refers to the negative logarithm of the motif comparison p-value (described above). </plain></SENT>
<SENT sid="347" pm="."><plain>In contrast to the original Calinski and Harabasz statistic, the B and W are log-transformed to avoid the tendency of the denominator towards zero, which results from the relatively small size of the datasets in which we operate. </plain></SENT>
<SENT sid="348" pm="."><plain>This logarithm transformation means that the estimate for the optimal number of clusters on the tree (K) is the value of g that minimizes CH log (in the original Calinski and Harabasz formula, the maximum value of CH log was sought). </plain></SENT>
<SENT sid="349" pm="."><plain>The suitability of the above metric to the current application domain was confirmed by evaluating its performance in a dataset with a small number of tightly clustered motif groups (see Results). </plain></SENT>
</text></p></sec><sec id="s4a5"><title><text><SENT sid="350" pm="."><plain>Motif datasets and structures. </plain></SENT>
</text></title><p><text><SENT sid="351" pm="."><plain>For the purposes of testing the accuracy of various motif-alignment and tree-building strategies, we compiled two datasets that contain the motifs of the families with four or more profiles in JASPAR [18] and TRANSFAC (release 9.3 [17]) databases. </plain></SENT>
<SENT sid="352" pm="."><plain>JASPAR contained 96 such motifs in 13 such families (of which 25 motifs belong to three zinc finger families). </plain></SENT>
<SENT sid="353" pm="."><plain>TRANSFAC contained 586 motifs in 25 families (of which 160 motifs belong to five zinc-finger families). </plain></SENT>
<SENT sid="354" pm="."><plain>The edges of the motifs were “trimmed” down to the first position with information content 0.4 or more. </plain></SENT>
</text></p></sec></sec></sec></SecTag><SecTag type="SUPPL"><sec sec-type="supplementary-material" id="s5"><title><text><SENT sid="355" pm="."><plain>Supporting Information </plain></SENT>
</text></title><supplementary-material content-type="local-data" id="pcbi-0030061-st001"><label>Table S1</label><caption><title><text><SENT sid="356" pm="."><plain>Relative Performance of All Tested Motif Alignment Strategies </plain></SENT>
</text></title><p><text><SENT sid="357" pm="."><plain>Performance is measured as the percent of motifs whose structural class are correctly recovered via the best hit in database searches. </plain></SENT>
<SENT sid="358" pm="."><plain>The two datasets used in this comparison are taken from JASPAR and TRANSFAC. </plain></SENT>
<SENT sid="359" pm="."><plain>While accuracy was measured over the complete dataset, the results below report separately the performance for the nonzinc-finger families (non-ZNF; ten families in JASPAR, 20 in TRANSFAC) and the zinc-finger families (ZNF; three in JASPAR, five in TRANSFAC). Average is the weighted average. </plain></SENT>
<SENT sid="360" pm="."><plain>Overlapping (overlap) and ungapped (ungapped) alignments are specified. </plain></SENT>
<SENT sid="361" pm="."><plain>Gap extension is equal to half the gap opening. </plain></SENT>
</text></p><p><text><SENT sid="362" pm="."><plain>(243 KB DOC) </plain></SENT>
</text></p></caption><media xlink:href="pcbi.0030061.st001.doc"><caption><p><text><SENT sid="363" pm="."><plain>Click here for additional data file. </plain></SENT>
</text></p></caption></media></supplementary-material><sec id="s5a"><title><text><SENT sid="364" pm="."><plain>Accession Numbers </plain></SENT>
</text></title><p><text><SENT sid="365" pm="."><plain>The structures we used in Figure 8 have the following Protein Data Bank (<ext-link ext-link-type="uri" xlink:href="http://www.pdb.org">http://www.pdb.org</ext-link>) accession numbers: 9ANT, 2EZD, 1HRY, 1IF1, 1DH3, 1BC8, 2NLL, 1H88, 1PDN, 1SVC, 1SRS, 1MDY, 1AN2. </plain></SENT>
<SENT sid="366" pm="."><plain>The HNF3_Mod structure was provided by Kirk L. </plain></SENT>
<SENT sid="367" pm="."><plain>Clark and Stephen K. </plain></SENT>
<SENT sid="368" pm="."><plain>Burley (personal communication). </plain></SENT>
</text></p></sec></sec></SecTag></body><back><SecTag type="ACK_FUND"><ack><p><text4fund><text><SENT sid="369" pm="."><plain>We are grateful to the anonymous reviewers whose comments led us to substantially improve this manuscript. </plain></SENT>
<SENT sid="370" pm="."><plain>PVB was supported by US National Institutes of Health grants 1R01LM007994–01 and RR014214 and by TATRC/DoD USAMRAA Prime Award W81XWH-05-2-0066. </plain></SENT>
<SENT sid="371" pm="."><plain>PEA was supported by NIH grant CA06668544. </plain></SENT>
</text></text4fund></p></ack></SecTag><fn-group><fn id="ack3" fn-type="COI-statement"><p><text><SENT sid="372" pm="."><plain>Competing interests. The authors have declared that no competing interests exist. </plain></SENT>
</text></p></fn><fn id="n102" fn-type="previously-at"><p><text><SENT sid="373" pm="."><plain>A previous version of this article appeared as an Early Online Release on February 15, 2007 (doi:<ext-link ext-link-type="doi" xlink:href="10.1371/journal.pcbi.0030061.eor">10.1371/journal.pcbi.0030061.eor</ext-link>). </plain></SENT>
</text></p></fn><SecTag type="AUTH_CONT"><fn id="ack1" fn-type="con"><p><text><SENT sid="374" pm="."><plain>Author contributions. SM and PVB conceived and designed the experiments. </plain></SENT>
<SENT sid="375" pm="."><plain>SM performed the experiments and contributed reagents/materials/analysis tools. </plain></SENT>
<SENT sid="376" pm="."><plain>SM, PEA, and PVB analyzed the data and wrote the paper. </plain></SENT>
</text></p></fn></SecTag><SecTag type="ACK_FUND"><fn id="ack2" fn-type="financial-disclosure"><p><text4fund><text><SENT sid="377" pm="."><plain>Funding. This work was supported by US National Science Foundation grant MCB0316255, by US National Institutes of Health-NIAID contract N01-AI50018, and by Pittsburgh Foundation grant M2005–0046. </plain></SENT>
</text></text4fund></p></fn></SecTag></fn-group><SecTag type="ABBR"><glossary><title>Abbreviations</title><def-list><def-item><term>AKL</term><def><p>average Kullback–Leibler (metric)</p></def></def-item><def-item><term>ALLR</term><def><p>average log-likelihood ratio (metric)</p></def></def-item><def-item><term>C/EBP</term><def><p>CCAAT/enhancer binding protein</p></def></def-item><def-item><term>CREB</term><def><p>cAMP response element-binding</p></def></def-item><def-item><term>FBP</term><def><p>familial binding profile</p></def></def-item><def-item><term>HMG</term><def><p>high mobility group</p></def></def-item><def-item><term>LOOCV</term><def><p>leave-one-out cross-validation</p></def></def-item><def-item><term>PCC</term><def><p>Pearson's correlation coefficient (metric)</p></def></def-item><def-item><term>pCS</term><def><p>
<italic>p</italic>-value of chi-square (metric)</p></def></def-item><def-item><term>PSSM</term><def><p>position-specific scoring matrix</p></def></def-item><def-item><term>SOTA</term><def><p>self-organizing tree algorithm</p></def></def-item><def-item><term>SSD</term><def><p>sum of squared distances (metric)</p></def></def-item><def-item><term>STAMP</term><def><p>similarity, tree-building, and alignment of DNA motifs and profiles</p></def></def-item><def-item><term>TF</term><def><p>transcription factor</p></def></def-item><def-item><term>UPGMA</term><def><p>unweighted pair group method with arithmetic mean</p></def></def-item></def-list></glossary></SecTag><SecTag type="REF"><ref-list><title>References</title><ref id="pcbi-0030061-b001"><text><SENT sid="378" pm="."><plain> StormoGD 2000 DNA binding sites: Representation and discovery Bioinformatics 16 16 23 10812473 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b002"><text><SENT sid="379" pm="."><plain> SuzukiMYagiN 1994 DNA recognition code of transcription factors in the helix-turn-helix, probe helix, hormone receptor, and zinc finger families Proc Natl Acad Sci U S A 91 12357 12361 7809040 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b003"><text><SENT sid="380" pm="."><plain> RudolphMJGergenJP 2001 DNA-binding by Ig-fold proteins Nat Struct Biol 8 384 386 11323707 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b004"><text><SENT sid="381" pm="."><plain> PaboCOPeisachEGrantRA 2001 Design and selection of novel Cys2His2 zinc finger proteins Annu Rev Biochem 70 313 340 11395410 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b005"><text><SENT sid="382" pm="."><plain> AuronPE 2004 DNA sequence-specific transcription factors LotzeMTThomsonAW Measuring immunity: Basic science and clinical practice. </plain></SENT>
<SENT sid="383" pm="."><plain>1st edition London Elsevier 91 109  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b006"><text><SENT sid="384" pm="."><plain> SandelinAWassermanWW 2004 Constrained binding site diversity within families of transcription factors enhances pattern discovery bioinformatics J Mol Biol 338 207 215 15066426 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b007"><text><SENT sid="385" pm="."><plain> MahonySGoldenASmithTJBenosPV 2005 Improved detection of DNA motifs using a self-organized clustering of familial binding profiles Bioinformatics 21 Supplement 1 i283 291 15961468 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b008"><text><SENT sid="386" pm="."><plain> XingEPKarpRM 2004 MotifPrototyper: A Bayesian profile model for motif families Proc Natl Acad Sci U S A 101 10523 10528 15252200 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b009"><text><SENT sid="387" pm="."><plain> TompaMLiNBaileyTLChurchGMDe MoorB 2005 Assessing computational tools for the discovery of transcription factor binding sites Nat Biotechnol 23 137 144 15637633 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b010"><text><SENT sid="388" pm="."><plain> NarlikarLHarteminkAJ 2006 Sequence features of DNA binding sites reveal structural class of associated transcription factor Bioinformatics 22 157 163 16267080 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b011"><text><SENT sid="389" pm="."><plain> CarthariusKFrechKGroteKKlockeBHaltmeierM 2005 MatInspector and beyond: Promoter analysis based on transcription factor binding sites Bioinformatics 21 2933 2942 15860560 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b012"><text><SENT sid="390" pm="."><plain> KielbasaSMGonzeDHerzelH 2005 Measuring similarities between transcription factor binding sites BMC Bioinformatics 6 237 16191190 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b013"><text><SENT sid="391" pm="."><plain> SchonesDESumazinPZhangMQ 2005 Similarity of position frequency matrices for transcription factor binding sites Bioinformatics 21 307 313 15319260 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b014"><text><SENT sid="392" pm="."><plain> MacisaacKDGordonDBNekludovaLOdomDTSchreiberJ 2006 A hypothesis-based approach for identifying the binding specificity of regulatory proteins from chromatin immunoprecipitation data Bioinformatics 22 423 429 16332710 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b015"><text><SENT sid="393" pm="."><plain> CorcoranDLFeingoldEDominickJWrightMHarnahaJ 2005 Footer: A quantitative comparative genomics method for efficient recognition of cis-regulatory elements Genome Res 15 840 847 15930494 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b016"><text><SENT sid="394" pm="."><plain> XieXLuJKulbokasEJGolubTRMoothaV 2005 Systematic discovery of regulatory motifs in human promoters and 3′ UTRs by comparison of several mammals Nature 434 338 345 15735639 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b017"><text><SENT sid="395" pm="."><plain> MatysVFrickeEGeffersRGosslingEHaubrockM 2003 TRANSFAC: Transcriptional regulation, from patterns to profiles Nucleic Acids Res 31 374 378 12520026 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b018"><text><SENT sid="396" pm="."><plain> SandelinAAlkemaWEngstromPWassermanWWLenhardB 2004 JASPAR: An open-access database for eukaryotic transcription factor binding profiles Nucleic Acids Res 32 D91 D94 14681366 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b019"><text><SENT sid="397" pm="."><plain> CalinskiTHarabaszJ 1974 A dendrite method for cluster analysis Communications Statistics 3 1 27  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b020"><text><SENT sid="398" pm="."><plain> DaviesDLBouldinDW 1979 A cluster separation measure IEEE Trans Patt Anal Mach Intell 1 224 227  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b021"><text><SENT sid="399" pm="."><plain> TibshiraniRWaltherGHastieT 2001 Estimating the number of data clusters via the Gap statistic J Roy Stat Soc B 63 411 423  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b022"><text><SENT sid="400" pm="."><plain> HastieTTibshiraniRWalterG 2001 Estimating the number of data clusters via the Gap statistic J Roy Stat Soc B 63 411 423  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b023"><text><SENT sid="401" pm="."><plain> KohlerJJMetalloSJSchneiderTLSchepartzA 1999 DNA specificity enhanced by sequential binding of protein monomers Proc Natl Acad Sci U S A 96 11735 11739 10518519 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b024"><text><SENT sid="402" pm="."><plain> MoustakasAHeldinCH 2003 The nuts and bolts of IRF structure Nat Struct Biol 10 874 876 14583734 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b025"><text><SENT sid="403" pm="."><plain> EscalanteCRBrassALPongubalaJMShatovaEShenL 2002 Crystal structure of PU.1/IRF-4/DNA ternary complex Mol Cell 10 1097 1105 12453417 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b026"><text><SENT sid="404" pm="."><plain> ReevesRBeckerbauerL 2001 HMGI/Y proteins: Flexible regulators of transcription and chromatin structure Biochim Biophys Acta 1519 13 29 11406267 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b027"><text><SENT sid="405" pm="."><plain> StottKTangGSLeeKBThomasJO 2006 Structure of a complex of tandem HMG boxes and DNA J Mol Biol 360 90 104 16813837 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b028"><text><SENT sid="406" pm="."><plain> XuHERouldMAXuWEpsteinJAMaasRL 1999 Crystal structure of the human Pax6 paired domain–DNA complex reveals specific roles for the linker region and carboxy-terminal subdomain in DNA binding Genes Dev 13 1263 1275 10346815 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b029"><text><SENT sid="407" pm="."><plain> SaitouNNeiM 1987 The neighbor-joining method: A new method for reconstructing phylogenetic trees Mol Biol Evol 4 406 425 3447015 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b030"><text><SENT sid="408" pm="."><plain> FitchWM 1971 Toward defining the course of evolution: Minimum change for a specified tree topology Syst Zool 20 406 416  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b031"><text><SENT sid="409" pm="."><plain> WangTStormoGD 2005 Identifying the conserved network of cis-regulatory sites of a eukaryotic genome Proc Natl Acad Sci U S A 102 17400 17405 16301543 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b032"><text><SENT sid="410" pm="."><plain> BenosPVBulykMLStormoGD 2002 Additivity in protein–DNA interactions: How good an approximation is it? Nucleic Acids Res 30 4442 4451 12384591 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b033"><text><SENT sid="411" pm="."><plain> BenosPVLapedesASFieldsDSStormoGD 2001 SAMIE: Statistical algorithm for modeling interaction energies Pac Symp Biocomput 115 126 11262933 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b034"><text><SENT sid="412" pm="."><plain> BenosPVLapedesASStormoGD 2002 Probabilistic code for DNA recognition by proteins of the EGR family J Mol Biol 323 701 727 12419259 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b035"><text><SENT sid="413" pm="."><plain> HughesJDEstepPWTavazoieSChurchGM 2000 Computational identification of cis-regulatory elements associated with groups of functionally related genes in Saccharomyces cerevisiae  J Mol Biol 296 1205 1214 10698627 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b036"><text><SENT sid="414" pm="."><plain> PietrokovskiS 1996 Searching databases of conserved sequence regions by aligning protein multiple-alignments Nucleic Acids Res 24 3836 3845 8871566 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b037"><text><SENT sid="415" pm="."><plain> AertsSVan LooPThijsGMoreauYDe MoorB 2003 Computational detection of cis-regulatory modules Bioinformatics 19 Supplement 2 II5 II14 14534164 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b038"><text><SENT sid="416" pm="."><plain> RoepckeSGrossmannSRahmannSVingronM 2005 T-Reg Comparator: An analysis tool for the comparison of position weight matrices Nucleic Acids Res 33 W438 W441 15980506 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b039"><text><SENT sid="417" pm="."><plain> WangTStormoGD 2003 Combining phylogenetic data with co-regulated genes to identify regulatory motifs Bioinformatics 19 2369 2380 14668220 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b040"><text><SENT sid="418" pm="."><plain> GotohO 1982 An improved algorithm for matching biological sequences J Mol Biol 162 705 708 7166760 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b041"><text><SENT sid="419" pm="."><plain> NeedlemanSBWunschCD 1970 A general method applicable to the search for similarities in the amino acid sequence of two proteins J Mol Biol 48 443 453 5420325 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b042"><text><SENT sid="420" pm="."><plain> SmithTFWatermanMS 1981 Identification of common molecular subsequences J Mol Biol 147 195 197 7265238 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b043"><text><SENT sid="421" pm="."><plain> BartonGJSternbergMJ 1987 A strategy for the rapid multiple alignment of protein sequences. </plain></SENT>
<SENT sid="422" pm="."><plain>Confidence levels from tertiary structure comparisons J Mol Biol 198 327 337 3430611 </plain></SENT>
</text></ref><ref id="pcbi-0030061-b044"><text><SENT sid="423" pm="."><plain> SokalRRMichenerCD 1958 A statistical method for evaluating systematic relationships U Kansas Scientific Bull 28 1409 1438  </plain></SENT>
</text></ref><ref id="pcbi-0030061-b045"><text><SENT sid="424" pm="."><plain> DopazoJCarazoJM 1997 Phylogenetic reconstruction using an unsupervised growing neural network that adopts the topology of a phylogenetic tree J Mol Evol 44 226 233 9069183 </plain></SENT>
</text></ref></ref-list></SecTag></back></article>
