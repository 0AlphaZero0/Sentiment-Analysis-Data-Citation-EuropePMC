<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-archivearticle1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3835832</article-id><article-id pub-id-type="pmid">24278162</article-id><article-id pub-id-type="publisher-id">PONE-D-13-11594</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0079720</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Discovering Subgroups of Patients from DNA Copy Number Data Using NMF on Compacted Matrices</article-title><alt-title alt-title-type="running-head">Discovering Subgroups of Patients with Compact-NMF</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>de Campos</surname><given-names>Cassio P.</given-names></name><xref ref-type="aff" rid="aff1">
<sup>1</sup>
</xref><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref><xref ref-type="corresp" rid="cor1">
<sup>*</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Rancoita</surname><given-names>Paola M. V.</given-names></name><xref ref-type="aff" rid="aff1">
<sup>1</sup>
</xref><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref><xref ref-type="aff" rid="aff3">
<sup>3</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Kwee</surname><given-names>Ivo</given-names></name><xref ref-type="aff" rid="aff1">
<sup>1</sup>
</xref><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref><xref ref-type="aff" rid="aff4">
<sup>4</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Zucca</surname><given-names>Emanuele</given-names></name><xref ref-type="aff" rid="aff5">
<sup>5</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Zaffalon</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="aff1">
<sup>1</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Bertoni</surname><given-names>Francesco</given-names></name><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref><xref ref-type="aff" rid="aff5">
<sup>5</sup>
</xref></contrib></contrib-group><aff id="aff1">
<label>1</label>
<addr-line>Dalle Molle Institute for Artificial Intelligence (IDSIA), Manno, Switzerland</addr-line>
</aff><aff id="aff2">
<label>2</label>
<addr-line>Lymphoma and Genomics Research Program, Institute of Oncology Research (IOR), Bellinzona, Switzerland</addr-line>
</aff><aff id="aff3">
<label>3</label>
<addr-line>University Centre of Statistics for Biomedical Sciences (CUSSB), Vita-Salute San Raffaele University, Milan, Italy</addr-line>
</aff><aff id="aff4">
<label>4</label>
<addr-line>Swiss Institute of Bioinformatics (SIB), Lausanne, Switzerland</addr-line>
</aff><aff id="aff5">
<label>5</label>
<addr-line>Lymphoma Unit, Oncology Institute of Southern Switzerland (IOSI), Bellinzona, Switzerland</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Khanin</surname><given-names>Raya</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>Memorial Sloan Kettering Cancer Center, United States of America</addr-line>
</aff><author-notes><corresp id="cor1">* E-mail: <email>cassio@idsia.ch</email></corresp><fn fn-type="COI-statement"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con"><p>Conceived and designed the experiments: CPdC PMVR IK MZ. Performed the experiments: CPdC PMVR IK FB. Analyzed the data: CPdC PMVR IK EZ MZ FB. Contributed reagents/materials/analysis tools: EZ FB. Wrote the paper: CPdC PMVR FB. Acquired data sets: PMVR EZ FB. Designed software tools used in the analysis: CPdC PMVR IK. Revised the manuscript critically: IK EZ MZ.</p></fn></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>20</day><month>11</month><year>2013</year></pub-date><volume>8</volume><issue>11</issue><elocation-id>e79720</elocation-id><history><date date-type="received"><day>19</day><month>3</month><year>2013</year></date><date date-type="accepted"><day>4</day><month>10</month><year>2013</year></date></history><permissions><copyright-statement>&#169; 2013 de Campos et al</copyright-statement><copyright-year>2013</copyright-year><copyright-holder>de Campos et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p></license></permissions><abstract><p>In the study of complex genetic diseases, the identification of subgroups of patients sharing similar genetic characteristics represents a challenging task, for example, to improve treatment decision. One type of genetic lesion, frequently investigated in such disorders, is the change of the DNA copy number (CN) at specific genomic traits. Non-negative Matrix Factorization (NMF) is a standard technique to reduce the dimensionality of a data set and to cluster data samples, while keeping its most relevant information in meaningful components. Thus, it can be used to discover subgroups of patients from CN profiles. It is however computationally impractical for very high dimensional data, such as CN microarray data. Deciding the most suitable number of subgroups is also a challenging problem. The aim of this work is to derive a procedure to compact high dimensional data, in order to improve NMF applicability without compromising the quality of the clustering. This is particularly important for analyzing high-resolution microarray data. Many commonly used quality measures, as well as our own measures, are employed to decide the number of subgroups and to assess the quality of the results. Our measures are based on the idea of identifying robust subgroups, inspired by biologically/clinically relevance instead of simply aiming at well-separated clusters. We evaluate our procedure using four real independent data sets. In these data sets, our method was able to find accurate subgroups with individual molecular and clinical features and outperformed the standard NMF in terms of accuracy in the factorization fitness function. Hence, it can be useful for the discovery of subgroups of patients with similar CN profiles in the study of heterogeneous diseases.</p></abstract><funding-group><funding-statement>This work was partially supported by: Oncosuisse (grant OCS-1939-8-2006); Swiss National Science Foundation (grants 205321-112430, 205320-121886/1); Canton Ticino (Computational life science-Ticino in rete program); Swiss National Supercomputing Centre; Nelia et Amadeo Barletta Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Discovery of disease subtypes or of subgroups of patients sharing common characteristics is a challenging task in biomedical research, especially in the study of complex and heterogeneous genetic disorders. The purpose of these analyses is, for example, to allow for a better prediction of the survival time and treatment decision, to understand the reasons for drug resistance, or to provide general insights about the biological mechanisms of the disease for finding diagnostic biomarkers or drug targets that are specific to a subgroup.</p><p>One type of genetic aberration is the change in the DNA copy number (CN). In human beings, the normal CN is two for the majority of the genome since, for each chromosome, one inherits a copy from each of their parents. Thus, CN changes are defined as lesions in which the number of copies is different from two. We can classify these CN aberrations into the following four categories: homozygous deletion (loss of two copies), heterozygous loss (loss of one copy), gain (number of copies equal to three or four), amplification (number of copies greater than four), see <xref ref-type="table" rid="pone-0079720-t001">Table 1</xref>. The identification of these types of lesions is important, for example, in cancer studies. In fact, the gain or the amplification of an oncogene would determine the overexpression of the corresponding protein and thus, for example, to uncontrolled cell growth. The loss of a tumor suppressor gene can make, for instance, the cells resistant to apoptosis. Another type of genetic lesion can be identified through the values assumed by single-nucleotide polymorphisms (SNPs). A SNP is a variation of the DNA sequence at a single base-pair location (there is a pair of nucleotides at each genomic locus, since normal CN is two). The two paired nucleotides can assume only two possible alleles (for simplicity, we call them A and B) among the four basis. If they assume the same allele, then the value of the SNP is AA or BB and the SNP is called homozygous, otherwise its value is AB and the SNP is called heterozygous. The loss of heterozygosity (LOH) lesion can be displayed as a long stretch of homozygous SNPs. SNP microarrays are able to measure both the CN and the LOH at hundred thousands or even millions of SNPs along the genome <xref rid="pone.0079720-Maciejewski1" ref-type="bibr">[1]</xref>.</p><table-wrap id="pone-0079720-t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.t001</object-id><label>Table 1</label><caption><title>Summary of copy number lesions that are considered.</title></caption><alternatives><graphic id="pone-0079720-t001-1" xlink:href="pone.0079720.t001"/></alternatives><table-wrap-foot><fn id="nt101"><label/><p>This table shows the definition of the four types of copy number (CN) aberrations that are considered in this work.</p></fn></table-wrap-foot></table-wrap><p>In order to identify subgroups of patients with common patterns of CN and LOH lesions, non-negative matrix factorization (NMF) is a well-known approach <xref rid="pone.0079720-Lee1" ref-type="bibr">[2]</xref>, <xref rid="pone.0079720-Devarajan1" ref-type="bibr">[3]</xref>. It has been widely used in a variety of areas and problems, including many in Computational Biology (we refer to <xref rid="pone.0079720-Devarajan1" ref-type="bibr">[3]</xref> for a broad view of its applications). While NMF has been mostly applied to continuous data such as gene expression, it can also be used with discrete data such as CN lesions by optimizing an appropriate divergence function <xref rid="pone.0079720-Lee2" ref-type="bibr">[4]</xref>. NMF is particularly suitable for high-dimensional CN and LOH data because of sparseness and repetitiveness in the matrices representing these lesions <xref rid="pone.0079720-Devarajan1" ref-type="bibr">[3]</xref>, <xref rid="pone.0079720-Chigrinova1" ref-type="bibr">[5]</xref>&#8211;<xref rid="pone.0079720-Taslaman1" ref-type="bibr">[9]</xref>. Because of that, it is able to produce clustering results where the most important characteristics of the data set are emphasized. However, as the dimension of data increases with new microarray technology, the harder (in both time and accuracy) becomes to run NMF over the full data matrix (we refer to the matrix rows as patients/samples and to the matrix columns as their CN information at different physical genomic locations). Current computers can perform one run of NMF in about one day (note that we need to perform hundreds of runs) with matrices in the order of 10<sup>4</sup> columns, which represents at least two orders of magnitude less than what current microarray technology can output. The most common approach to address this problem is to restrict the attention to a smaller number of pre-selected columns, and perform the NMF analysis only with such columns. These columns are either selected in some ad-hoc manner (for example, one every few columns, usually because of their physical proximity), or by applying some procedure which identifies groups of similar columns (using statistical tests or other methods with the same aim, such as minimum common regions, principal component analysis, etc) and keep only one column for each group. Such ideas make it possible to apply the factorization to such large matrices of data, otherwise computationally unfeasible. We analyze this task and propose a way of &#8220;compacting&#8221; the columns such that the additional error introduced by such a compaction is minimized. Our so called <italic>Compact-NMF</italic> differs from previous uses in an essential way: we aim at factorizing the data matrix in a way that the divergence to the whole data matrix is minimized, while a naive approach, not being able to run NMF over the whole data matrix, would work on a submatrix of it, and thus would produce a factorization that minimizes the divergence to that submatrix (we call this idea <italic>Standard-NMF</italic>). Using real data, we show that Compact-NMF produces results that are in line with running NMF over the whole data matrix, while Standard-NMF has a considerable degraded accuracy, which we will define as the fitness of the factorization later on. The implementation of Compact-NMF is available at <ext-link ext-link-type="uri" xlink:href="http://www.idsia.ch/~cassio/compactnmf/">http://www.idsia.ch/~cassio/compactnmf/</ext-link>.</p><p>Using these techniques, we analyze data sets of patients affected by diffuse large B-cell lymphoma (DLBCL), by breast cancer with the <italic>HER2</italic> gene amplification, and by medulloblastoma. The first data set consists of SNP microarray data (Affymetrix GeneChip Human Mapping 250K NspI) from 166 DLBCL samples <xref rid="pone.0079720-Scandurra1" ref-type="bibr">[10]</xref>. Since genomic aberrations can be shared by different lymphoma subtypes, we enlarge the data set by adding data from patients affected by other types of B-cell leukemia and lymphomas <xref rid="pone.0079720-Kwee1" ref-type="bibr">[11]</xref>. The use of a large data set of 533 samples with similar diseases (which increases the number of rows in the matrix) may improve the clustering, similarly to what was shown for the definition of recurrently aberrated regions in <xref rid="pone.0079720-Kwee1" ref-type="bibr">[11]</xref>. The second data set regards aCGH data (NimbleGen Human CGH 385K Whole-Genome Tiling v1.0 Array) from 201 DLBCL patients of <xref rid="pone.0079720-Lenz1" ref-type="bibr">[12]</xref>. The third data set consists of 200 breast cancer patients' data <xref rid="pone.0079720-Staaf1" ref-type="bibr">[13]</xref> obtained with BAC microarrays (produced by the SCIBLU Genomics Center), in three resolution formats (32K, 33K, and 38K). Finally, the fourth data set is a huge collection of very high-throughput microarray CN profiles. In fact, it comprises the data of 1087 medulloblastoma patients <xref rid="pone.0079720-Northcott1" ref-type="bibr">[14]</xref> obtained with the Affymetrix Genome-Wide Human SNP Array 6.0 platform (about 1.8 million probes). With the aim of evaluating the quality of the separation, we show that the subgroups identified by our clustering procedure are associated with other known clinical information of the patients (not disclosed to the clustering procedure itself), such as molecular subtypes of the corresponding diseases. As with most unsupervised clustering techniques, the choice of the <italic>correct</italic> number of subgroups is a problem by itself and has to be analyzed with attention. We employ a wide selection of well-established quality measures and discuss some new criteria. All of them are unsupervised, which reduces the chance of overfitting.</p></sec><sec sec-type="methods" id="s2"><title>Methods</title><p>Non-negative Matrix Factorization <xref rid="pone.0079720-Lee1" ref-type="bibr">[2]</xref> is a technique to reduce the dimensionality of a data set, and can be justified as a clustering algorithm given its non-negative characteristic (Principal Component Analysis, for instance, is much faster but does not have the same properties because it allows negative values in its decomposed matrices and makes the result non-interpretable for clustering). The goal is to produce a pair of matrices of smaller rank than the original one which multiplied produce a good approximation of the latter. Let <inline-formula><inline-graphic xlink:href="pone.0079720.e001.jpg"/></inline-formula> denote the space of matrices with dimension <inline-formula><inline-graphic xlink:href="pone.0079720.e002.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0079720.e003.jpg"/></inline-formula> the real numbers and <inline-formula><inline-graphic xlink:href="pone.0079720.e004.jpg"/></inline-formula> the natural numbers. A matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e005.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0079720.e006.jpg"/></inline-formula> can be seen as a function <inline-formula><inline-graphic xlink:href="pone.0079720.e007.jpg"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="pone.0079720.e008.jpg"/></inline-formula>. Thus, an element in the position <inline-formula><inline-graphic xlink:href="pone.0079720.e009.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0079720.e010.jpg"/></inline-formula> is simply denoted by <inline-formula><inline-graphic xlink:href="pone.0079720.e011.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0079720.e012.jpg"/></inline-formula> be defined as follows: <inline-formula><inline-graphic xlink:href="pone.0079720.e013.jpg"/></inline-formula>&#8202;=&#8202;<italic>W&#8901;H</italic>, that is,<disp-formula id="pone.0079720.e014"><graphic xlink:href="pone.0079720.e014.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0079720.e015.jpg"/></inline-formula> is a given integer with the desired rank of the factorization, <inline-formula><inline-graphic xlink:href="pone.0079720.e016.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e017.jpg"/></inline-formula> are decomposed matrices with dimensions <inline-formula><inline-graphic xlink:href="pone.0079720.e018.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e019.jpg"/></inline-formula>, respectively. The standard cost/divergence function used within NMF when it is seen as a maximum likelihood estimation and data are assumed to be produced by a Poisson distribution (which is our case, given that we consider the estimated number of DNA copies at each SNP probe) is:<disp-formula id="pone.0079720.e020"><graphic xlink:href="pone.0079720.e020.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>subject to <inline-formula><inline-graphic xlink:href="pone.0079720.e021.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0079720.e022.jpg"/></inline-formula> is the given <inline-formula><inline-graphic xlink:href="pone.0079720.e023.jpg"/></inline-formula> input matrix and <inline-formula><inline-graphic xlink:href="pone.0079720.e024.jpg"/></inline-formula> is the estimated matrix. This divergence function measures the quality of <inline-formula><inline-graphic xlink:href="pone.0079720.e025.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e026.jpg"/></inline-formula> as a decomposition of <inline-formula><inline-graphic xlink:href="pone.0079720.e027.jpg"/></inline-formula>, and can be interpreted as the Kullback-Leibler (KL) divergence between distributions represented in the matrices <inline-formula><inline-graphic xlink:href="pone.0079720.e028.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e029.jpg"/></inline-formula> (if one normalizes these matrices). Hence, the accuracy of NMF can be defined as the result of <xref ref-type="disp-formula" rid="pone.0079720.e020">Equation (1</xref>) that is achieved by the factorization.</p><p>The problem of optimizing the divergence function (that is, solving NMF) is known to be a computationally hard task (in computational complexity terms, it is known to be NP-hard for <inline-formula><inline-graphic xlink:href="pone.0079720.e030.jpg"/></inline-formula>
<xref rid="pone.0079720-Vavasis1" ref-type="bibr">[15]</xref>). The function is non-convex and there are multiple local optima. In fact, under the KL divergence, NMF has been shown to be a similar task as the Expectation&#8211;Maximization technique for learning parameters of multinomial distributions with latent variables <xref rid="pone.0079720-Gaussier1" ref-type="bibr">[16]</xref>. This justifies the development and use of efficient local optimization techniques, as well as multiple-start methods to avoid being trapped in a local minimum of the divergence function. The starting point for the optimization is the initial solution that one can choose to fill up the matrices <inline-formula><inline-graphic xlink:href="pone.0079720.e031.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e032.jpg"/></inline-formula> with values. Moreover, it is known that the problem is not identifiable, that is, there might be multiple global optimal solutions <xref rid="pone.0079720-Xu1" ref-type="bibr">[17]</xref>. Hence, multiple-start methods can not only avoid local minima, but should be integrated somehow to produce a better overall solution for the optimization problem, as finding a single global minimum solution is not the best one can do <xref rid="pone.0079720-Corani1" ref-type="bibr">[18]</xref>. Essentially, when one takes the most accurate run of NMF as the final result, they would be relying on a single solution, even if there might be many distinct solutions which achieve equal or only barely worse accuracy than the best one, and yet these solutions might be composed of quite different matrices <inline-formula><inline-graphic xlink:href="pone.0079720.e033.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e034.jpg"/></inline-formula>. This issue can be explained by the aforementioned relation between NMF and learning parameters of multinomial distributions with latent variables <xref rid="pone.0079720-Gaussier1" ref-type="bibr">[16]</xref>.</p><sec id="s2a"><title>NMF as a Clustering Method</title><p>NMF can be used for clustering by considering each row <inline-formula><inline-graphic xlink:href="pone.0079720.e035.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0079720.e036.jpg"/></inline-formula>, of the matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e037.jpg"/></inline-formula> as an element to be clustered, and the row itself as weights by which element <inline-formula><inline-graphic xlink:href="pone.0079720.e038.jpg"/></inline-formula> should be assigned to each cluster <inline-formula><inline-graphic xlink:href="pone.0079720.e039.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0079720.e040.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0079720.e041.jpg"/></inline-formula> is the number of clusters/groups). The simplest idea is to assign each element <inline-formula><inline-graphic xlink:href="pone.0079720.e042.jpg"/></inline-formula> to the cluster <inline-formula><inline-graphic xlink:href="pone.0079720.e043.jpg"/></inline-formula> with largest weight, that is, the clustering <inline-formula><inline-graphic xlink:href="pone.0079720.e044.jpg"/></inline-formula> for the <inline-formula><inline-graphic xlink:href="pone.0079720.e045.jpg"/></inline-formula> elements (rows) of the input is defined as <inline-formula><inline-graphic xlink:href="pone.0079720.e046.jpg"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="pone.0079720.e047.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0079720.e048.jpg"/></inline-formula> is just an index to identify results from distinct NMF runs.</p><p>Using NMF for clustering leads to the <italic>permutation</italic> problem, if one wants to put together the results of many runs of NMF from multiple distinct starting points. This problem regards the fact that different runs of NMF can lead to distinct assignments of clusters that differ only by a permutation of the columns of <inline-formula><inline-graphic xlink:href="pone.0079720.e049.jpg"/></inline-formula> (respectively rows of <inline-formula><inline-graphic xlink:href="pone.0079720.e050.jpg"/></inline-formula>), while achieving the same value of the divergence function. Moreover, it is not trivial to combine different runs of NMF, for example, by combining the corresponding positions of the matrices <inline-formula><inline-graphic xlink:href="pone.0079720.e051.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e052.jpg"/></inline-formula> of the runs, as each run might regard a distinct permutation of the matrices. In order to address the permutation problem, we follow the standard post-NMF approach of combining clustering results by building up an overall similarity matrix, which contains the number of times the elements were clustered in the same cluster. As this approach performs calculations that are separate for each run of a multiple-start NMF, the result is coherent. More formally, let <inline-formula><inline-graphic xlink:href="pone.0079720.e053.jpg"/></inline-formula>, for <inline-formula><inline-graphic xlink:href="pone.0079720.e054.jpg"/></inline-formula>, denote the clustering result of the NMF procedure in run <inline-formula><inline-graphic xlink:href="pone.0079720.e055.jpg"/></inline-formula>. The similarity matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e056.jpg"/></inline-formula> with dimension <inline-formula><inline-graphic xlink:href="pone.0079720.e057.jpg"/></inline-formula> is defined as<disp-formula id="pone.0079720.e058"><graphic xlink:href="pone.0079720.e058.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0079720.e059.jpg"/></inline-formula> is the indicator function. Now, the similarity matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e060.jpg"/></inline-formula> can be used as input of another clustering technique, such as hierarchical clustering <xref rid="pone.0079720-WardJr1" ref-type="bibr">[19]</xref> or partition around medoids <xref rid="pone.0079720-Kauffman1" ref-type="bibr">[20]</xref>, in order to produce a final clustering result. Note that any clustering technique that is able to produce a clustering out of a similarity matrix might be employed here. In fact, there is no significant difference between the methods we just mentioned, since the matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e061.jpg"/></inline-formula> produced by many runs of NMF is already a robust measurement of the similarity of the elements to be clustered, and thus the effect of using distinct clustering methods over <inline-formula><inline-graphic xlink:href="pone.0079720.e062.jpg"/></inline-formula> is greatly reduced. We denote by <inline-formula><inline-graphic xlink:href="pone.0079720.e063.jpg"/></inline-formula> the final result of the clustering over <inline-formula><inline-graphic xlink:href="pone.0079720.e064.jpg"/></inline-formula>, associating each row of the initial matrix to a cluster number between <inline-formula><inline-graphic xlink:href="pone.0079720.e065.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e066.jpg"/></inline-formula>. In this work, we employ hierarchical clustering for this purpose.</p><p>Another important issue with NMF is its scalability to large matrices. Obviously this depends intrinsically on the method to optimize the divergence function. The most traditional method to optimize it is the iterative procedure of <xref rid="pone.0079720-Lee2" ref-type="bibr">[4]</xref> (<inline-formula><inline-graphic xlink:href="pone.0079720.e067.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e068.jpg"/></inline-formula> are given as the starting point to the algorithm):<disp-formula id="pone.0079720.e069"><graphic xlink:href="pone.0079720.e069.jpg" position="anchor" orientation="portrait"/></disp-formula>
<disp-formula id="pone.0079720.e070"><graphic xlink:href="pone.0079720.e070.jpg" position="anchor" orientation="portrait"/></disp-formula>for <inline-formula><inline-graphic xlink:href="pone.0079720.e071.jpg"/></inline-formula> until convergence (or until a maximum number of steps is reached). Finally, <inline-formula><inline-graphic xlink:href="pone.0079720.e072.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e073.jpg"/></inline-formula>. This method is proved to converge to a stationary point (usually a local optimum) of the minimization problem. Note that the most expensive operation executed by the algorithm while updating <inline-formula><inline-graphic xlink:href="pone.0079720.e074.jpg"/></inline-formula> is the multiplication of matrices <inline-formula><inline-graphic xlink:href="pone.0079720.e075.jpg"/></inline-formula> (respectively <inline-formula><inline-graphic xlink:href="pone.0079720.e076.jpg"/></inline-formula> in the computation of <inline-formula><inline-graphic xlink:href="pone.0079720.e077.jpg"/></inline-formula>). Even with an optimized implementation, each step takes approximately cubic time in the matrix dimensions. We provide an optimized C++ implementation of this algorithm, which also works as a library package for the R language (see <ext-link ext-link-type="uri" xlink:href="http://www.idsia.ch/">http://www.idsia.ch/</ext-link>&#8764;cassio/compactnmf/). The implementation is fast and can be directly invoked as a stand-alone application, which is desirable when running it on a grid or parallel computer environment (given the need of running the optimization several times with distinct starting points to obtain a robust similarity matrix).</p></sec><sec id="s2b"><title>Compact-NMF</title><p>Even if we use a fast implementation and a computer grid to parallelize the runs of the algorithm, the maximum matrix dimension that current computers can handle is quite limited, because of the intrinsic complexity of the problem. Hence, we propose to reduce the dimension of the matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e078.jpg"/></inline-formula> by compacting the information of some of its columns (that is, SNP probes in the case of dealing with CN data) even before applying NMF. The idea is that we are given computational resources that are able to solve an NMF instance up to matrices <inline-formula><inline-graphic xlink:href="pone.0079720.e079.jpg"/></inline-formula> of dimension <inline-formula><inline-graphic xlink:href="pone.0079720.e080.jpg"/></inline-formula>, but we still want to approximate the (eventually much larger) <inline-formula><inline-graphic xlink:href="pone.0079720.e081.jpg"/></inline-formula> matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e082.jpg"/></inline-formula>. This situation occurs often, since current computers have severe limitations in both memory and time when the dimension is too large. For instance, a few thousands of columns are feasible for running NMF, but hundreds of thousands are not. In such cases, the most widely used preprocessing ideas that are applied before running NMF discard part of the columns, using either a systematic method (for example, choosing one every 50 probes, or performing feature selection, etc) or a statistical approach until the number of remaining columns becomes computationally solvable. However, when one applies NMF after any procedure that discards columns without a proper procedure to keep some guarantees, they are in fact approximating the reduced matrix in a non-optimal way, instead of approximating the original larger matrix. We propose here a formulation called <italic>Compact-NMF</italic> that directly approximates the original matrix <inline-formula><inline-graphic xlink:href="pone.0079720.e083.jpg"/></inline-formula>, still by solving the smaller NMF over <inline-formula><inline-graphic xlink:href="pone.0079720.e084.jpg"/></inline-formula>. A detailed explanation of the reasoning behind the method is given in the Supporting <xref ref-type="supplementary-material" rid="pone.0079720.s001">File S1</xref>. The Compact-NMF method solves the problem:<disp-formula id="pone.0079720.e085"><graphic xlink:href="pone.0079720.e085.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0079720.e086.jpg"/></inline-formula> is being optimized, <inline-formula><inline-graphic xlink:href="pone.0079720.e087.jpg"/></inline-formula>, and<disp-formula id="pone.0079720.e088"><graphic xlink:href="pone.0079720.e088.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="pone.0079720.e089.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e090.jpg"/></inline-formula> being a partition of the <inline-formula><inline-graphic xlink:href="pone.0079720.e091.jpg"/></inline-formula> columns of <inline-formula><inline-graphic xlink:href="pone.0079720.e092.jpg"/></inline-formula> into <inline-formula><inline-graphic xlink:href="pone.0079720.e093.jpg"/></inline-formula> bins. In words, it means that we sum columns that are put together in the same bin <inline-formula><inline-graphic xlink:href="pone.0079720.e094.jpg"/></inline-formula>, defined by the partition <inline-formula><inline-graphic xlink:href="pone.0079720.e095.jpg"/></inline-formula>. Expression (3) is justified in more details in the Supporting <xref ref-type="supplementary-material" rid="pone.0079720.s001">File S1</xref>. We define the partition <inline-formula><inline-graphic xlink:href="pone.0079720.e096.jpg"/></inline-formula> using the hamming distance between columns, that is, <inline-formula><inline-graphic xlink:href="pone.0079720.e097.jpg"/></inline-formula> whenever <inline-formula><inline-graphic xlink:href="pone.0079720.e098.jpg"/></inline-formula>, with the operation <inline-formula><inline-graphic xlink:href="pone.0079720.e099.jpg"/></inline-formula> (for a given non-negative integer <inline-formula><inline-graphic xlink:href="pone.0079720.e100.jpg"/></inline-formula>) defined as the condition that the Hamming distance between the columns is not superior to <inline-formula><inline-graphic xlink:href="pone.0079720.e101.jpg"/></inline-formula>:</p><p>
<disp-formula id="pone.0079720.e102"><graphic xlink:href="pone.0079720.e102.jpg" position="anchor" orientation="portrait"/></disp-formula>with <inline-formula><inline-graphic xlink:href="pone.0079720.e103.jpg"/></inline-formula> generic columns (each containing <inline-formula><inline-graphic xlink:href="pone.0079720.e104.jpg"/></inline-formula> values). Then we choose <inline-formula><inline-graphic xlink:href="pone.0079720.e105.jpg"/></inline-formula> that yields matrices of reasonable size according to our computational resources. When dealing with categorical or discrete features, for example, the presence or the absence of an aberration, or the number of copies of DNA (which can only assume a few distinct numbers), hamming distance is a natural choice to measure the similarity between columns. Finally, even <inline-formula><inline-graphic xlink:href="pone.0079720.e106.jpg"/></inline-formula> would (possibly) produce great speed up, as equal columns would be merged together, and the NMF over <inline-formula><inline-graphic xlink:href="pone.0079720.e107.jpg"/></inline-formula> would solve the very same problem as the original NMF over <inline-formula><inline-graphic xlink:href="pone.0079720.e108.jpg"/></inline-formula> (see the Supporting <xref ref-type="supplementary-material" rid="pone.0079720.s001">File S1</xref> for details). We call this particular version <italic>Full-NMF</italic>, as it minimizes the divergence of the whole matrix, but still runs NMF over the smallest possible lossless matrix. In our experiments with real data sets, we perform a slightly more aggressive reduction than lossless by allowing columns to differ in at most 1% from each other in order to consider them equivalent. The choice of 1% was taken empirically in order to obtain matrices of about <inline-formula><inline-graphic xlink:href="pone.0079720.e109.jpg"/></inline-formula> columns, which is the size that computation could be performed in a reasonable amount of time (about one day for one NMF run over all ranks). In other words, we compact the original matrix into a new (much smaller) matrix that represents almost the same information. In the worst case, this corresponds to losing the information of about 1% of the original data. Some loss of data is inevitable if it is to run the method in feasible time, as this is a very demanding computational task. Yet, this procedure loses less information than other ideas mentioned in the beginning of this section. In order to select which columns to put together, we use a straightforward greedy algorithm that goes through the columns and looks for those that have a small Hamming distance among each other, but any other idea would equally suffice. Mainly, the benefit of the proposed compaction is that it is optimal towards minimizing the divergence function, so theoretically preferred to other preprocessing ideas that reduce the matrix dimension before running NMF. Its main limitation regards the amount of similarity between columns of the original matrix: if all columns are very different from each other, then the only way to compact the matrix is to combine columns that are not necessarily similar, which might decrease accuracy. This is not a particular issue of this compaction but of any preprocessing idea to reduce the matrix dimension. We empirically demonstrate the accuracy of such ideas later on by comparing the different versions of NMF.</p></sec><sec id="s2c"><title>Choosing the Number of Clusters</title><p>An important problem in clustering is the choice of the number of clusters <inline-formula><inline-graphic xlink:href="pone.0079720.e110.jpg"/></inline-formula> (also called rank in the case of NMF). Many criteria have been proposed in the literature, such as the cophenetic correlation coefficient (if one is using hierarchical clustering to put NMF runs together) <xref rid="pone.0079720-WardJr1" ref-type="bibr">[19]</xref>, the elbow of the Mean Squared Error (MSE) and of the Area Under the Curve (AUC) <xref rid="pone.0079720-Simpson1" ref-type="bibr">[21]</xref>, the Davies-Bouldin index <xref rid="pone.0079720-Davies1" ref-type="bibr">[22]</xref>, the Gamma statistic <xref rid="pone.0079720-Hubert1" ref-type="bibr">[23]</xref>, the Hubert-Levin test <xref rid="pone.0079720-Hubert2" ref-type="bibr">[24]</xref>, the intra-cluster scatter <xref rid="pone.0079720-Maimon1" ref-type="bibr">[25]</xref>, Silhouette plots and averages <xref rid="pone.0079720-Rousseeuw1" ref-type="bibr">[26]</xref>, among others. These criteria do not necessarily agree with each other. One might simply pick the criterion of their preference, but this is an arbitrary choice. Even if the criteria agree, they are not designed to discriminate a cluster that might be strongly different from the others in a given clustering of rank <inline-formula><inline-graphic xlink:href="pone.0079720.e111.jpg"/></inline-formula>, but only to score the separation quality of the rank as a whole (that is, all clusters against each other). In other words, if there is a single cluster that considerably differs from the others, while the remaining clusters are not well-separated, these criteria will probably fail to identify it. Nevertheless, identifying a single well-separated cluster within a rank is in general an important task, sometimes more important than choosing the best rank itself. Fortunately, most of these criteria are decomposable, that is, they define an overall quality measure of a clustering result based on the quality of each of its clusters, so they can be adapted to account for such strong clusters. We propose the following criterion, which is based on an <italic>intra-cluster similarity</italic>
<xref rid="pone.0079720-Rousseeuw1" ref-type="bibr">[26]</xref>:<disp-formula id="pone.0079720.e112"><graphic xlink:href="pone.0079720.e112.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p><p>In words, for each cluster <inline-formula><inline-graphic xlink:href="pone.0079720.e113.jpg"/></inline-formula> in the rank <inline-formula><inline-graphic xlink:href="pone.0079720.e114.jpg"/></inline-formula>, the average similarity between the elements of cluster <inline-formula><inline-graphic xlink:href="pone.0079720.e115.jpg"/></inline-formula> is computed (this is the internal ratio in the formula), and finally we take the mean of these averaged similarities. When using this criterion with NMF, the value <inline-formula><inline-graphic xlink:href="pone.0079720.e116.jpg"/></inline-formula> from the similarity matrices can be seen as the probability of rows <inline-formula><inline-graphic xlink:href="pone.0079720.e117.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0079720.e118.jpg"/></inline-formula> to be grouped together, so the average value within each cluster corresponds to the mean probability of two elements (patients in our case) to be together. This measure is permutation invariant. Moreover, <inline-formula><inline-graphic xlink:href="pone.0079720.e119.jpg"/></inline-formula> can easily be adapted to use, instead of the mean, the median or the maximum values over the clusters. For the purpose of identifying robust subgroups (even when the overall rank is not robustly separated), we are especially interested in the maximum value obtained by a subgroup, as this particular subgroup might represent some important characteristics of the population. We refer to this idea as <italic>maximum intra-cluster similarity</italic>. It is a relevant criterion when one wants to compare the performance of a given subgroup (in a given rank) against the others (of the same rank). However, we emphasize that it does not consider the inter-cluster similarity in its formula, thus it tends to value subgroups that have very similar samples, regardless of other samples (not in the same subgroup) that might be also similar to them. All in all, we do not intend to propose <inline-formula><inline-graphic xlink:href="pone.0079720.e120.jpg"/></inline-formula> as a solution to the selection of the number of clusters, but as another relevant measure that may be suitable depending on what the analysis is aiming at. So far, we believe that the most general way to address the problem is to consider many measures that evaluate different aspects (in the sense of what they measure) and choose the number of clusters that best agrees with them altogether, including the just defined intra-cluster similarities.</p></sec><sec id="s2d"><title>Assessing the Quality of the Factorization</title><p>In order to assess the quality of the factorization and the overall results, we perform two verifications: (i) the number of NMF runs with random initial guesses is checked to show that the fitting has reached a stable good solution; (ii) the subgroups generated by NMF are analyzed against two distinct features, namely disease subtypes and survival outcome of patients. As described before, many NMF runs are used to build the similarity matrix. Obviously, the more runs the more precise is the similarity matrix, because each run is expected to produce a good factorization of the initial matrix. Given a certain number <inline-formula><inline-graphic xlink:href="pone.0079720.e121.jpg"/></inline-formula> of runs and their outputs, one might check the amount of change in the similarity matrix by running NMF once more, that is, increasing <inline-formula><inline-graphic xlink:href="pone.0079720.e122.jpg"/></inline-formula> by one. To assess the need of additional runs, we take subsets of the <inline-formula><inline-graphic xlink:href="pone.0079720.e123.jpg"/></inline-formula> runs and compute the mean squared error between their similarity matrices and the one created by <inline-formula><inline-graphic xlink:href="pone.0079720.e124.jpg"/></inline-formula> runs. If the difference is small, then the similarity matrix probably will not change considerably if more NMF runs were included, meaning that we have already reached a sufficient number of runs.</p><p>With the aim of checking the meaningfulness of the clustering produced by NMF from genomic data, we verify whether it correlates with some clinical or biological characteristics. When these characteristics are categorical, such as disease types and subtypes, we perform a Fisher exact test on the contingency table. When correlating right-censored survival outcome, we estimate survival curves using the Kaplan-Meier estimator and perform log-rank test and Peto &amp; Peto's generalization of the Wilcoxon test to assess the differences among curves. Because no clinical information is used during the factorization (NMF is applied as an unsupervised method), there is no overfitting regarding this information, and the tests show how strong is the association between the NMF clustering of genomic data and the biological/clinical data.</p></sec></sec><sec id="s3"><title>Results and Discussion</title><p>We show the performance of our procedure in the analysis of two data sets of patients with diffuse large B-cell lymphoma (DLBCL), one with breast cancer and one with medulloblastoma. In the first data set (called Data set 1), the data of 166 DLBCL cases<xref rid="pone.0079720-Scandurra1" ref-type="bibr">[10]</xref> were analyzed together with additional 367 B-cell neoplasia in order to achieve a more reliable clustering <xref rid="pone.0079720-Kwee1" ref-type="bibr">[11]</xref>. For each sample, the CN and LOH data (approximately 250,000 probes, each interrogating a single SNP) were obtained with Affymetrix GeneChip Human Mapping 250K NspI array, and then preprocessed with CNAT 4.01 <xref rid="pone.0079720-Kwee1" ref-type="bibr">[11]</xref>. After that, the CN profiles have been estimated with the modified Bayesian Piecewise Regression (mBPCR) method <xref rid="pone.0079720-Rancoita1" ref-type="bibr">[27]</xref>. Finally, the CN aberrations were divided into two major categories corresponding to a decrease or increase of number of copies, that is, CN <inline-formula><inline-graphic xlink:href="pone.0079720.e125.jpg"/></inline-formula> and CN <inline-formula><inline-graphic xlink:href="pone.0079720.e126.jpg"/></inline-formula>. As a consequence, for each probe, the CN information was separated into two different features (defined as columns in the NMF formulation), each corresponding to one of the two major categories. In the features representing CN <inline-formula><inline-graphic xlink:href="pone.0079720.e127.jpg"/></inline-formula> (respectively CN <inline-formula><inline-graphic xlink:href="pone.0079720.e128.jpg"/></inline-formula>), we encoded the aberrations in the following way: normal is 0, heterozygous loss (respectively gain) is 1, homozygous deletion (respectively amplification) is 2. The choice of these numbers was motivated by their clear counting interpretation in terms of severity of aberrations, which fits with the use of the NMF under the assumption that data are generated from a Poisson distribution. Moreover, the separation of the aberrations into two features was necessary because the Poisson distribution is not symmetric, so keeping all of them together in one feature (with the natural encoding from 0 (homozygous deletion) to 4 (amplification)), would imply a preference towards lesions of the type CN <inline-formula><inline-graphic xlink:href="pone.0079720.e129.jpg"/></inline-formula>, which we obviously do not want. The LOH profiles were estimated with dChip <xref rid="pone.0079720-Beroukhim1" ref-type="bibr">[28]</xref> and copy-neutral LOH lesions (that is, regions with LOH but normal CN) were denoted by 0.5 in the feature representing CN <inline-formula><inline-graphic xlink:href="pone.0079720.e130.jpg"/></inline-formula>, due to the biological effect of this type of lesion.</p><p>Regarding the 201 DLBCL patients of <xref rid="pone.0079720-Lenz1" ref-type="bibr">[12]</xref> (named Data set 2), we obtained the aCGH data from the Progenetix database (<xref rid="pone.0079720-Baudis1" ref-type="bibr">[29]</xref>; <ext-link ext-link-type="uri" xlink:href="http://www.progenetix.org">www.progenetix.org</ext-link>). The data were already preprocessed, segmented and discretized in normal CN, increased CN (CN <inline-formula><inline-graphic xlink:href="pone.0079720.e131.jpg"/></inline-formula> 3) and decreased CN (CN <inline-formula><inline-graphic xlink:href="pone.0079720.e132.jpg"/></inline-formula> 1). Furthermore, the profiles of 200 <italic>HER2</italic>-amplified (<italic>HER2+</italic>) breast cancer patients <xref rid="pone.0079720-Staaf1" ref-type="bibr">[13]</xref> (Data set 3) were obtained from the ArrayExpress database (E-GEOD-21259, <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress">www.ebi.ac.uk/arrayexpress</ext-link>). The data were only already preprocessed, thus, we segmented and discretized them in normal, increased and decreased CN, by following the methods described in <xref rid="pone.0079720-Staaf1" ref-type="bibr">[13]</xref>. Finally, the copy number SNP microarray data of 1087 patients affected by medulloblastoma <xref rid="pone.0079720-Northcott1" ref-type="bibr">[14]</xref> were obtained again from the Progenetix database. The data were already preprocessed, segmented and discretized as for Data set 2. In all of these cases (Data sets 2, 3 and 4), and similarly to the analysis of Data set 1, for each probe, we separated the CN data into two features corresponding to the two major categories of aberrations (CN <inline-formula><inline-graphic xlink:href="pone.0079720.e133.jpg"/></inline-formula> 3 and CN <inline-formula><inline-graphic xlink:href="pone.0079720.e134.jpg"/></inline-formula> 1). For each feature, we encoded the normal state as 0 and the presence of the aberration as 1 (in this case, we did not have information to distinguish between gain and amplification, and between loss and homozygous deletion).</p><sec id="s3a"><title>Compact-NMF versus Standard-NMF</title><p>In order to assess the relevance of Compact-NMF, we have analyzed the divergence value (from <xref ref-type="disp-formula" rid="pone.0079720.e020">Equation (1</xref>)) that Compact-NMF and Standard-NMF achieved in comparison to Full-NMF (the lossless NMF procedure representing the accuracy obtained by running NMF without discarding any information). We have worked with Data Set 1 for this purpose, as it is a large data set (both in number of patients and probes) but still manageable in order to perform many rounds of tests. <xref ref-type="fig" rid="pone-0079720-g001">Figure 1</xref> shows the number of columns (probes) that are obtained from Data set 1 when applying the merging procedure for Compact-NMF, using the similarity function with Hamming distances as defined in the Section Methods. Notice that, for a fair comparison, the number of remaining columns is the same for both Compact-NMF and Standard-NMF (so <xref ref-type="fig" rid="pone-0079720-g001">Figure 1</xref> shows a single curve), because we employ the same similarity function to both cases in order to decide the merging (or discarding in the case of Standard-NMF), even though Compact-NMF and Standard-NMF handle differently how to treat them.</p><fig id="pone-0079720-g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.g001</object-id><label>Figure 1</label><caption><title>Size of matrices to run NMF according to the Hamming distance to consider equivalent columns.</title><p>The matrix produced by using the DLBCL samples of Data set 1 as rows and their DNA copy number profiles as columns was subjected to the compaction procedure, according to the similarity between columns based on Hamming distance. As higher the maximum allowed Hamming distance used to merge columns as lower the number of resulting columns. Later, matrices of those dimensions are used as input for the NMF.</p></caption><graphic xlink:href="pone.0079720.g001"/></fig><p>From a total of more than 500 thousand columns (twice 250 thousand probes because CN data have been separated into two features as described previously), a lossless compaction (that is, using <inline-formula><inline-graphic xlink:href="pone.0079720.e135.jpg"/></inline-formula> with Compact-NMF) generated a matrix with around 33 thousand columns, as shown in the first point of the curve (the same number of columns is achieved by Standard-NMF, but it is not lossless). The figure shows the curve representing the number of columns for different values of <inline-formula><inline-graphic xlink:href="pone.0079720.e136.jpg"/></inline-formula>, the maximum Hamming distance for which columns are merged. The curve rapidly decreases with the increase of the maximum allowed Hamming distance, as expected. Merging columns with Hamming distance at most 5 already produces a matrix with less than six thousand columns (two orders of magnitude less than the original matrix), which indicates the high amount of similar features/redundancies in the data.</p><p>Using matrices according to these compactions, we have run Compact-NMF and Standard-NMF. <xref ref-type="fig" rid="pone-0079720-g002">Figure 2</xref> shows the accuracy of Compact-NMF over Full-NMF, while <xref ref-type="fig" rid="pone-0079720-g003">Figure 3</xref> shows the accuracy of Standard-NMF over Full-NMF, in terms of the achieved divergence with respect to the whole original matrix. The curves represent the ratios between the divergence achieved by the corresponding NMF and the divergence achieved by Full-NMF, on matrices generated from Data set 1 by applying the different maximum Hamming distances. To have a more accurate analysis, these ratios are in fact averaged over one hundred multiple-start runs, for each analyzed Hamming distance (variance has not been plotted because it was negligible). We see that the accuracy of Compact-NMF was essentially the same as Full-NMF for ranks between 2 and 12 and Hamming distances from 0 to 10. As a worth note, <xref ref-type="fig" rid="pone-0079720-g002">Figure 2</xref> seems to show that Compact-NMF can even be slightly better than Full-NMF (see for instance rank 8 and Hamming distance 8, where the curve is slightly below 1). This is only possible because the internal optimization of NMF is in essence local, so the compaction of some columns kept the same quality of Full-NMF and even showed some slightly better accuracy. Such case would be obviously impossible if the internal optimization of NMF could be run to a global optimal solution (which however cannot be guaranteed).</p><fig id="pone-0079720-g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.g002</object-id><label>Figure 2</label><caption><title>Comparison of Compact-NMF and Full-NMF over the DLBCL data of Data set 1.</title><p>The matrix produced by using the DLBCL samples of Data set 1 as rows and their DNA copy number profiles as columns was used to test the distinct manners of running NMF. Full-NMF stands for the procedure which runs over all data, while Compact-NMF stands for our procedure that merge similar columns. The graphs show the ratio between the divergence (the objective function we minimize) of the Compact-NMF over the divergence of the Full-NMF, so higher values mean greater error. Results are shown for different factorization ranks.</p></caption><graphic xlink:href="pone.0079720.g002"/></fig><fig id="pone-0079720-g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.g003</object-id><label>Figure 3</label><caption><title>Comparison of Standard-NMF and Full-NMF over the DLBCL data of Data set 1.</title><p>The matrix produced by using the DLBCL samples of Data set 1 as rows and their DNA copy number profiles as columns was used to test the distinct manners of running NMF. Full-NMF stands for the procedure which runs over all data, while Standard-NMF stands for the procedure that keeps only one of each group of similar columns. The graphs show the ratio between the divergence (the objective function we minimize) of the Standard-NMF over the divergence of the Full-NMF, so higher values mean greater error of Standard-NMF. Results are shown for different factorization ranks.</p></caption><graphic xlink:href="pone.0079720.g003"/></fig><p>On the other hand, Standard-NMF has much worse divergence in all cases. For example, the rank 3 curve starts with around 7% worse accuracy than Full-NMF, even for Hamming distance zero (remind that, in this case, Compact-NMF is lossless), and increases to more than 12% for Hamming distance 10. Compact-NMF and Standard-NMF have spent roughly the same amount of resources in each corresponding test case, because they basically differ in the way the matrices are built, but not in their dimensions. Finally, Full-NMF has not been run over the whole original matrix but by using Compact-NMF with Hamming distance zero (implying a lossless compaction), otherwise Full-NMF would be impractical (even with 33 thousand columns, which is the size for Compact-NMF with zero Hamming distance, it is already a quite slow and memory consuming procedure &#8211; it took around one day and 10GB of RAM in a modern desktop to perform a single factorization).</p></sec><sec id="s3b"><title>NMF Runs and Rank Selection</title><p>As discussed in the previous section, Compact-NMF provides an accurate way to run NMF over large matrices. In order to perform cluster analysis over the four data sets, we employed the Compact-NMF method to determine the similarity matrices of patients within each data set, and subgroups were later obtained with hierarchical clustering, as described in the Section Methods. We selected Hamming distances that corresponded to approximately 1% of the information in a column, as this amount provided a good compromise of accuracy and computational time. For example, in Data Set 1, this amounts to merging probes with a maximum Hamming distance <inline-formula><inline-graphic xlink:href="pone.0079720.e137.jpg"/></inline-formula>. Besides that, we only grouped together probes that were not more than 500 probes distant from each other, so as to keep all the genomic profile well represented. For example, in Data set 1, the approximately 500 thousand columns were reduced to around 6 thousand columns, so as to run the experiment in a feasible time (less than half a day per factorization; total time of less than one day to run all analyses using a grid of computers) and available memory (4GB of RAM per execution). In Data set 4, the approximately 3.6 million columns were reduced to about 12 thousand columns. The total number of executions to achieve a good result was decided by analyzing the stability curve of the resulting similarity matrix with respect to the number of NMF executions, defined as the root mean-squared difference between resulting matrices of two consecutive number of executions (this was performed for each possible rank). Starting from 200 NMF executions, there was no significant difference in the resulting similarity matrix. We stopped at 300 executions, with the mean-squared difference around <inline-formula><inline-graphic xlink:href="pone.0079720.e138.jpg"/></inline-formula> and standard deviation of <inline-formula><inline-graphic xlink:href="pone.0079720.e139.jpg"/></inline-formula>. The same procedure was applied to the other data sets.</p><p>In order to select the appropriate clustering rank in each data set, the two measures that are detailed in the Section Methods have been used. For Data sets 1 and 4, they have selected rank 3, while for Data sets 2 and 3 they have chosen rank 2. These choices agree with most well-known quality measures in the literature (results are shown in Table S1 of the <xref ref-type="supplementary-material" rid="pone.0079720.s001">File S1</xref>) <xref rid="pone.0079720-WardJr1" ref-type="bibr">[19]</xref>&#8211;<xref rid="pone.0079720-Rousseeuw1" ref-type="bibr">[26]</xref>. As illustration, <xref ref-type="fig" rid="pone-0079720-g004">Figure 4</xref> shows the frequencies of CN aberrations of the three subgroups in DLBCL patients of Data set 1 (for simplicity, in the figure we considered CN <inline-formula><inline-graphic xlink:href="pone.0079720.e140.jpg"/></inline-formula> as loss and CN <inline-formula><inline-graphic xlink:href="pone.0079720.e141.jpg"/></inline-formula> as gain). For each of the four analyzed data sets, the clustering performance measures discussed earlier have clearly indicated the rank to be used in further analyses (Table S1 in the <xref ref-type="supplementary-material" rid="pone.0079720.s001">File S1</xref>).</p><fig id="pone-0079720-g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.g004</object-id><label>Figure 4</label><caption><title>Frequency plots of CN aberrations of DLBCL patients of Data set 1, according to the clustering results.</title><p>The DLBCL samples of Data set 1 were divided into three subgroups, according to the clustering results of rank 3. Clusters 1, 2 and 3 have 86, 54 and 26 cases, respectively. The frequency of samples with gain in copy number is given in red, while the frequency of losses is in blue (the scale into negative numbers is just for plotting purposes).</p></caption><graphic xlink:href="pone.0079720.g004"/></fig></sec><sec id="s3c"><title>Association with Molecular Subtypes and Survival Outcome</title><p>In order to show the reliability of the clustering results, we decided to evaluate their correlation with clinical and biological information of the patients. For the DLBCL data sets (Data sets 1 and 2), we considered the molecular subtypes by the cell of origin, obtained by gene expression profiling (as described in <xref rid="pone.0079720-Scandurra1" ref-type="bibr">[10]</xref>, <xref rid="pone.0079720-Kwee1" ref-type="bibr">[11]</xref>). Indeed, seminal gene expression profiling studies have identified at least two main subtypes of DLBCL: germinal center B-cell like (GCB) and activated B-cell like (ABC), and demonstrated that primary mediastinal B-cell lymphoma (PMBCL) is a separate disease entity <xref rid="pone.0079720-Lenz2" ref-type="bibr">[30]</xref>. Importantly, the three groups have differences in their clinical outcome and response to treatment <xref rid="pone.0079720-Lenz2" ref-type="bibr">[30]</xref>. The correlation of the clustered subgroups with cell-of-origin subtypes was tested using a Fisher exact test, according to the contingency table in <xref ref-type="table" rid="pone-0079720-t002">Table 2</xref>. In the Data set 1, the subtype information (annotated only as ABC or GCB) was available for 57 out of 166 DLBCL cases. Even if reducing the sample size for the analysis, the smaller number of samples with subtype information does not constitute a problem, because the missingness was non-informative. We obtained p-value 0.031, indicating the existence of an association between the clustering and the cell-of-origin subtypes. From <xref ref-type="table" rid="pone-0079720-t002">Table 2</xref>, we see that cluster 2 is particularly enriched in GCB, while cluster 3 is enriched with the ABC subtype. One can also note that cluster 1 has no predominant subtypes, which can be explained by the fact that it contains many profiles with small amount of aberrations (these samples might not even be true DLBCLs, but we prefer to refrain ourselves about such discussion, which would deviate from the goal of this paper). In the Data set 2, the data about cell-of-origin subtypes were available for 175 out of 201 patients (again, missingness is non-informative) and we obtained p-value <inline-formula><inline-graphic xlink:href="pone.0079720.e142.jpg"/></inline-formula> when testing the association between the two clusters and the three cell-of-origin subtypes, and p-value <inline-formula><inline-graphic xlink:href="pone.0079720.e143.jpg"/></inline-formula> when testing the association of the two clusters with ABC vs non-ABC. In fact, we can see in <xref ref-type="table" rid="pone-0079720-t002">Table 2</xref> that cluster 1 is highly enriched by ABC patients. In order to better understand the division of the patients obtained with the clustering, we evaluated with the Fisher exact test the possible association between the clusters and several CN lesions known to be correlated with DLBCL cell-of-origin subtypes <xref rid="pone.0079720-Lenz1" ref-type="bibr">[12]</xref>, <xref rid="pone.0079720-Lenz2" ref-type="bibr">[30]</xref>. Due to the heterogeneity of this disease, many of these aberrations are not present in the majority of the cases of any subtype. Thus, depending on the particular set of patients under examination, the subsets of lesions selected to define the clusters may differ. Regarding the DLBCL samples of Data set 1, cluster 3 (mostly enriched by ABC cases) was characterized by a significant higher frequency of gains of genes <italic>FOXP1</italic> (p-value&#8202;=&#8202;0.009) and <italic>BCL2</italic> (p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e144.jpg"/></inline-formula>), which are associated with the ABC subtype. Instead, cluster 2 (mostly enriched by GCB cases) differed from the other clusters specially in a higher presence of gains of genes <italic>REL</italic> (p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e145.jpg"/></inline-formula>), <italic>MDM2</italic> (p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e146.jpg"/></inline-formula>) and 9p24 (p-value&#8202;=&#8202;0.008), which are more associated with GCB and PMBCL subtypes. Similar patterns were observed for Data set 2. Cluster 1 (mostly enriched by ABC cases) was significantly characterized by a higher frequency of gains of genes <italic>FOXP1</italic> (p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e147.jpg"/></inline-formula>), <italic>BCL2</italic> (p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e148.jpg"/></inline-formula>) and <italic>SPIB</italic> (p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e149.jpg"/></inline-formula>), and of deletions of gene <italic>PRDM1</italic> (p-value&#8202;=&#8202;0.003), which are all lesions correlated with the ABC subtype. Instead, cluster 2 had a significant higher proportion of gains of gene <italic>MDM2</italic> (p-value&#8202;=&#8202;0.0006). Cluster 1 presented also a significant higher frequency (16.3% vs. 7%) of deletions of gene <italic>PTEN</italic> (p-value&#8202;=&#8202;0.042), which is instead more associated with the GCB subtype.</p><table-wrap id="pone-0079720-t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.t002</object-id><label>Table 2</label><caption><title>Association between the clusters and the molecular subtypes in the DLBCL data sets.</title></caption><alternatives><graphic id="pone-0079720-t002-2" xlink:href="pone.0079720.t002"/></alternatives><table-wrap-foot><fn id="nt102"><label/><p>This table shows the distribution of the DLBCL samples in each cluster (of rank 3 and 2, for Data set 1 and 2, respectively), with respect to the classification in molecular subtypes.</p></fn></table-wrap-foot></table-wrap><p>Since GCB and ABC subtypes respond differently to conventional treatments and the ABC patients have a poorer outcome <xref rid="pone.0079720-Lenz2" ref-type="bibr">[30]</xref>, we also tested the association of the clustered subgroups with the survival outcome. For the evaluation, we considered the subset of Data set 1 with 124 DLBCL patients of <xref rid="pone.0079720-Scandurra1" ref-type="bibr">[10]</xref>, all treated with R-CHOP-21 (rituximab, cyclophosphamide, doxorubicin, vincristine and prednisone repeated every 21 days) in which both progression-free survival (that is, time to first progression or death, PFS) and overall survival (that is, time to death, OS) were available. The Kaplan-Meier estimates of the survival functions showed a similar survival behavior for clusters 1 and 2, while cluster 3, which is associated with ABC DLBCL, had a poorer outcome (for both PFS and OS). The curves are shown in <xref ref-type="fig" rid="pone-0079720-g005">Figure 5</xref>. Therefore, we applied both log-rank test and the Peto &amp; Peto's generalization of the Wilcoxon test to compare the differences between the survival functions defined by cluster 3 and clusters 1 and 2 altogether. The tests for PFS obtained p-values 0.034 and 0.029, respectively, which suggest that patients in cluster 3 have a significant poorer PFS outcome than the others. Similar result, but not anymore significant, was achieved for OS, with p-values 0.063 and 0.051, respectively. In Data set 2, the cluster significantly presenting a profile compatible with ABC DLBCL showed a poorer overall outcome too (even if not statistically significant at level 0.05).</p><fig id="pone-0079720-g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.g005</object-id><label>Figure 5</label><caption><title>Prognostic significance of NMF-identified clusters among R-CHOP-21 treated DLBCL.</title><p>Subfigures A and B show Kaplan-Meier estimates of OS (left panel, log-rank test p-value&#8202;=&#8202;0.063) and PFS (right panel, log-rank test p-value&#8202;=&#8202;0.034) in R-CHOP-21 treated DLBCL patients from Data set 1.</p></caption><graphic xlink:href="pone.0079720.g005"/></fig><p>Of clinical relevance, the identification of cases with ABC-like and GCB-like profiles with related effects on the clinical outcome suggests that genomic DNA profiling could be evaluated in combination with immunohistochemistry, as a surrogate to predict the DLBCL subtype by cell of origin, since gene expression profiling is technically more demanding (also due to the higher stability of DNA versus RNA) and immunohistochemistry algorithms alone have not been so far fully satisfactory <xref rid="pone.0079720-Salles1" ref-type="bibr">[31]</xref>.</p><p>We also analogously analyzed the clustering results obtained with Data set 3. In this case, we tested the association between the clustering of the patients into the two groups and the status of the estrogen receptor (ER), which was available in 198 out of 200 patients. We obtained p-value 0.0375 with the Fisher exact test and, in fact, we can see in <xref ref-type="table" rid="pone-0079720-t003">Table 3</xref> that cluster 2 is enriched of ER-negative patients. We also tested the association between the clusters and the presence of some CN aberrations usually related to the ER-positive status <xref rid="pone.0079720-Hu1" ref-type="bibr">[32]</xref>. Cluster 2, mostly consisting of ER-negative patients, was in fact characterized by a lower frequency of the 6q22 loss (4.8% in cluster 2 vs. 24.8% in cluster 1, with p-value&#8202;=&#8202;<inline-formula><inline-graphic xlink:href="pone.0079720.e150.jpg"/></inline-formula>). As expected, the gains of the 17q21 and 17q23 regions were equally presented in the two groups, since all patients had the amplification of gene <italic>HER2</italic> (situated at cytoband 17q12).</p><table-wrap id="pone-0079720-t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.t003</object-id><label>Table 3</label><caption><title>Association between the clusters and the molecular subtypes in the breast cancer data set.</title></caption><alternatives><graphic id="pone-0079720-t003-3" xlink:href="pone.0079720.t003"/></alternatives><table-wrap-foot><fn id="nt103"><label/><p>This table shows the distribution of the breast cancer patients (Data set 3) in each cluster of rank 2, with respect to the classification in molecular subtypes in estrogen receptor positive (ER+) and negative (ER&#8722;).</p></fn></table-wrap-foot></table-wrap><p>Finally, we have applied Compact-NMF to patients of Data set 4, whose copy number data were obtained in <xref rid="pone.0079720-Northcott1" ref-type="bibr">[14]</xref> by the Affymetrix Genome-Wide Human SNP Array 6.0 platform, thus consisting of about 1.8 million probes each. Medulloblastoma is a heterogeneous disease, and using gene expression it is possible to identify four main molecular subtypes: WNT, Sonic hedgehog (SHH), Group 3 and Group 4. This subtype information was available in 826 out of 1087 patients (non-informative missingness). The three clusters identified by Compact-NMF were significantly associated with the four subtypes (p-value <inline-formula><inline-graphic xlink:href="pone.0079720.e151.jpg"/></inline-formula> 0.0001 by Fisher exact test, see <xref ref-type="table" rid="pone-0079720-t004">Table 4</xref>). In particular, cluster 3 was highly enriched with Group 4 patients, while clusters 1 and 2 were mainly composed of SHH patients and a varying percentage of patients of the other subtypes. For this particular disease, differences between the subtypes in terms of patterns of CN aberrations are still a matter of study, and some of the few established lesions are common to more than one subtype <xref rid="pone.0079720-Northcott1" ref-type="bibr">[14]</xref>, <xref rid="pone.0079720-Taylor1" ref-type="bibr">[33]</xref>. For instance, gain of chromosomes 7, 17q and 18q may characterize both Group 3 and Group 4, and the presence of these lesions has been significantly associated with our clustering subdivision (p-value <inline-formula><inline-graphic xlink:href="pone.0079720.e152.jpg"/></inline-formula> 0.0001 for all of them), showing a higher frequency in cluster 3 (the one consisting mainly of these two subtypes). Also, the gain of <italic>CDK6</italic> is usually associated with the Group 4 subtype and is more frequent in cluster 3 (p-value <inline-formula><inline-graphic xlink:href="pone.0079720.e153.jpg"/></inline-formula> 0.0001). Instead, cluster 2 is enriched of cases with gain of <italic>GLI2</italic>, 1q, <italic>MYC</italic> and loss of 5q (p-value <inline-formula><inline-graphic xlink:href="pone.0079720.e154.jpg"/></inline-formula> 0.0001 for all of them). These aberrations are all associated with the Group 3 subtype, apart from the first of them, which has been associated with the SHH subtype.</p><table-wrap id="pone-0079720-t004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0079720.t004</object-id><label>Table 4</label><caption><title>Association between the clusters and the molecular subtypes in the medulloblastoma data set.</title></caption><alternatives><graphic id="pone-0079720-t004-4" xlink:href="pone.0079720.t004"/></alternatives><table-wrap-foot><fn id="nt104"><label/><p>This table shows the distribution of the medulloblastoma patients (Data set 4) in each cluster of rank 3, with respect to the classification in the following molecular subtypes: WNT, SHH, Group 3 and Group 4.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4"><title>Conclusions</title><p>In this work we presented the Compact-NMF procedure, which specially targets the factorization of high-dimensional data sets, providing greater quality of clustering results when compared to the direct application of NMF. Using real data, we showed that Compact-NMF delivers results that are very similar to the full application of NMF over the whole data set, which cannot be done directly because of the impractical computational demand. Compact-NMF can be used to discover subgroups of patients with similar CN aberrations, which is an important task in the study of some complex and heterogeneous diseases. Our derivations were performed to work with discrete data, such as CN data, but they might extend to continuous data. For instance, if data are assumed to be generated from a Gaussian distribution, the divergence function shall be appropriately changed and Compact-NMF should be slightly modified, but the overall results would probably continue to hold.</p><p>A vast number of quality measures exist to decide the number of subgroups in an unsupervised clustering analysis. We have introduced a new quality measure to decide the appropriate number of subgroups based on the existence of robust subgroups, rather than only looking to the overall measurement obtained for each rank of the factorization (that is, for each number of subgroups). This concept is particularly suitable when we want to find biologically and/or clinically relevant subgroups that are embedded within a clustering of low quality over all subgroups, but high quality for a specific subgroup. We suggested that using many distinct quality measures that target different aspects of the clustering is the most appropriate way to choose the number of subgroups.</p><p>Four data sets of real cases were analyzed and we have obtained meaningful clustering results for all of them. In the two DLBCL data sets, the identified subgroups were associated with the cell-of-origin molecular subtypes, which have different clinical and prognostic characteristics. The subgroups identified in the breast cancer data set appeared to reflect the status of the estrogen receptor, which is a helpful biomarker for treatment decision. Finally, the subgroups found in the medulloblastoma data set were associated with the four main molecular subtypes, whose possible different targeted therapies are still under investigation. These results indicate that Compact-NMF is able to produce biological meaningful clusters in distinct scenarios.</p></sec><sec sec-type="supplementary-material" id="s5"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0079720.s001"><label>File S1</label><caption><p>
<bold>This file contains a detailed explanation of the reasoning behind the Compact-NMF method, including the mathematical justification for the expressions used by it.</bold> The file also contains Table S1 with the results of well-known clustering quality measures for the data sets studied in this work.</p><p>(PDF)</p></caption><media xlink:href="pone.0079720.s001.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list><title>References</title><ref id="pone.0079720-Maciejewski1"><label>1</label><mixed-citation publication-type="journal">
<name><surname>Maciejewski</surname><given-names>J</given-names></name>, <name><surname>Tiu</surname><given-names>R</given-names></name>, <name><surname>O&#1036;eefe</surname><given-names>C</given-names></name> (<year>2009</year>) <article-title>Application of array-based whole genome scanning technologies as a cytogenetic tool in haematological malignancies</article-title>. <source>British Journal of Haematology</source>
<volume>146</volume>: <fpage>479</fpage>&#8211;<lpage>488</lpage>.<pub-id pub-id-type="pmid">19563474</pub-id></mixed-citation></ref><ref id="pone.0079720-Lee1"><label>2</label><mixed-citation publication-type="journal">
<name><surname>Lee</surname><given-names>DD</given-names></name>, <name><surname>Seung</surname><given-names>HS</given-names></name> (<year>1999</year>) <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>
<volume>401</volume>: <fpage>788</fpage>&#8211;<lpage>791</lpage>.<pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation></ref><ref id="pone.0079720-Devarajan1"><label>3</label><mixed-citation publication-type="journal">
<name><surname>Devarajan</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Nonnegative matrix factorization: An analytical and interpretive tool in computational biology</article-title>. <source>PLOS Computational Biology</source>
<volume>4(7)</volume>: <fpage>e1000029</fpage>.<pub-id pub-id-type="pmid">18654623</pub-id></mixed-citation></ref><ref id="pone.0079720-Lee2"><label>4</label><mixed-citation publication-type="other">Lee DD, Seung HS (2001) Algorithms for non-negative matrix factorization. In: Advances in neural information processing systems (NIPS). pp. 556&#8211;562.</mixed-citation></ref><ref id="pone.0079720-Chigrinova1"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Chigrinova</surname><given-names>E</given-names></name>, <name><surname>Kwee</surname><given-names>I</given-names></name>, <name><surname>Rinaldi</surname><given-names>A</given-names></name>, <name><surname>Poretti</surname><given-names>G</given-names></name>, <name><surname>Pruneri</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Non-negative matrix factorization to perform unsupervised clustering of genome wide DNA profiles in mature B cell lymphoid neoplasms</article-title>. <source>British Journal of Haematology</source>
<volume>150</volume>: <fpage>229</fpage>&#8211;<lpage>232</lpage>.<pub-id pub-id-type="pmid">20433677</pub-id></mixed-citation></ref><ref id="pone.0079720-Lee3"><label>6</label><mixed-citation publication-type="journal">
<name><surname>Lee</surname><given-names>CM</given-names></name>, <name><surname>Mudaliar</surname><given-names>MAV</given-names></name>, <name><surname>Haggart</surname><given-names>DR</given-names></name>, <name><surname>Wolf</surname><given-names>CR</given-names></name>, <name><surname>Miele</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Simultaneous non-negative matrix factorization for multiple large scale gene expression datasets in toxicology</article-title>. <source>PLOS ONE</source>
<volume>7(12)</volume>: <fpage>e48238</fpage>.<pub-id pub-id-type="pmid">23272042</pub-id></mixed-citation></ref><ref id="pone.0079720-Schachtner1"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Schachtner</surname><given-names>R</given-names></name>, <name><surname>Lutter</surname><given-names>D</given-names></name>, <name><surname>Knollm&#252;ller</surname><given-names>P</given-names></name>, <name><surname>Tom&#233;</surname><given-names>AM</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Knowledge-based gene expression classification via matrix factorization</article-title>. <source>Bioinformatics</source>
<volume>24</volume>: <fpage>1688</fpage>&#8211;<lpage>1697</lpage>.<pub-id pub-id-type="pmid">18535085</pub-id></mixed-citation></ref><ref id="pone.0079720-Qi1"><label>8</label><mixed-citation publication-type="journal">
<name><surname>Qi</surname><given-names>Q</given-names></name>, <name><surname>Zhao</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Simon</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Non-negative matrix factorization of gene expression profiles: a plug-in for BRB-ArrayTools</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>545</fpage>&#8211;<lpage>547</lpage>.<pub-id pub-id-type="pmid">19131367</pub-id></mixed-citation></ref><ref id="pone.0079720-Taslaman1"><label>9</label><mixed-citation publication-type="journal">
<name><surname>Taslaman</surname><given-names>L</given-names></name>, <name><surname>Nilsson</surname><given-names>B</given-names></name> (<year>2012</year>) <article-title>A framework for regularized non-negative matrix factorization, with application to the analysis of gene expression data</article-title>. <source>PLOS ONE</source>
<volume>7(11)</volume>: <fpage>e46331</fpage>.<pub-id pub-id-type="pmid">23133590</pub-id></mixed-citation></ref><ref id="pone.0079720-Scandurra1"><label>10</label><mixed-citation publication-type="journal">
<name><surname>Scandurra</surname><given-names>M</given-names></name>, <name><surname>Mian</surname><given-names>M</given-names></name>, <name><surname>Greiner</surname><given-names>TC</given-names></name>, <name><surname>Rancoita</surname><given-names>PMV</given-names></name>, <name><surname>de Campos</surname><given-names>CP</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Genomic lesions associated with a different clinical outcome in diffuse large B-cell lymphoma treated with R-CHOP-21</article-title>. <source>British Journal of Heamatology</source>
<volume>151</volume>: <fpage>221</fpage>&#8211;<lpage>231</lpage>.</mixed-citation></ref><ref id="pone.0079720-Kwee1"><label>11</label><mixed-citation publication-type="journal">
<name><surname>Kwee</surname><given-names>I</given-names></name>, <name><surname>Capello</surname><given-names>D</given-names></name>, <name><surname>Rinaldi</surname><given-names>A</given-names></name>, <name><surname>Rancoita</surname><given-names>PMV</given-names></name>, <name><surname>Bhagat</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Genomic aberrations affecting the outcome of immunodeficiency-related diffuse large B-cell lymphoma</article-title>. <source>Leukemia &amp; Lymphoma</source>
<volume>53</volume>: <fpage>71</fpage>&#8211;<lpage>76</lpage>.<pub-id pub-id-type="pmid">21787262</pub-id></mixed-citation></ref><ref id="pone.0079720-Lenz1"><label>12</label><mixed-citation publication-type="journal">
<name><surname>Lenz</surname><given-names>G</given-names></name>, <name><surname>Wright</surname><given-names>GW</given-names></name>, <name><surname>Emre</surname><given-names>NCT</given-names></name>, <name><surname>Kohlhammer</surname><given-names>H</given-names></name>, <name><surname>Dave</surname><given-names>SS</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Molecular subtypes of diffuse large B-cell lymphoma arise by distinct genetic pathways</article-title>. <source>Proceedings of the National Academy of Sciences</source>
<volume>105</volume>: <fpage>13520</fpage>&#8211;<lpage>13525</lpage>.</mixed-citation></ref><ref id="pone.0079720-Staaf1"><label>13</label><mixed-citation publication-type="journal">
<name><surname>Staaf</surname><given-names>J</given-names></name>, <name><surname>J&#246;nsson</surname><given-names>G</given-names></name>, <name><surname>Ringn&#233;r</surname><given-names>M</given-names></name>, <name><surname>Vallon-Christersson</surname><given-names>J</given-names></name>, <name><surname>Grabau</surname><given-names>D</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>High-resolution genomic and expression analyses of copy number alterations in HER2-amplified breast cancer</article-title>. <source>Breast Cancer Research</source>
<volume>12</volume>: <fpage>R25</fpage>.<pub-id pub-id-type="pmid">20459607</pub-id></mixed-citation></ref><ref id="pone.0079720-Northcott1"><label>14</label><mixed-citation publication-type="journal">
<name><surname>Northcott</surname><given-names>P</given-names></name>, <name><surname>Shih</surname><given-names>D</given-names></name>, <name><surname>Peacock</surname><given-names>J</given-names></name>, <name><surname>Garzia</surname><given-names>L</given-names></name>, <name><surname>Morrissy</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Subgroup-specific structural variation across 1,000 medulloblastoma genomes</article-title>. <source>Nature</source>
<volume>488</volume>: <fpage>49</fpage>&#8211;<lpage>56</lpage>.<pub-id pub-id-type="pmid">22832581</pub-id></mixed-citation></ref><ref id="pone.0079720-Vavasis1"><label>15</label><mixed-citation publication-type="journal">
<name><surname>Vavasis</surname><given-names>SA</given-names></name> (<year>2009</year>) <article-title>On the complexity of nonnegative matrix factorization</article-title>. <source>SIAM Journal on Optimization</source>
<volume>20</volume>: <fpage>1364</fpage>&#8211;<lpage>1377</lpage>.</mixed-citation></ref><ref id="pone.0079720-Gaussier1"><label>16</label><mixed-citation publication-type="other">Gaussier E, Goutte C (2005) Relation between PLSA and NMF and implications. In: Proceedings of the 28th International ACM Conference on Research and Development in Information Retrieval. pp. 601&#8211;602.</mixed-citation></ref><ref id="pone.0079720-Xu1"><label>17</label><mixed-citation publication-type="other">Xu W, Liu X, Gong Y (2003) Document clustering based on non-negative matrix factorization. In: Proceedings of the 26th International ACM Conference on Research and Development in Informaion Retrieval. 267&#8211;273.</mixed-citation></ref><ref id="pone.0079720-Corani1"><label>18</label><mixed-citation publication-type="other">Corani G, de Campos CP (2011) Improving parameter learning of Bayesian networks from incomplete data. CoRR abs/1110.3239.</mixed-citation></ref><ref id="pone.0079720-WardJr1"><label>19</label><mixed-citation publication-type="journal">
<name><surname>Ward Jr</surname><given-names>JH</given-names></name> (<year>1963</year>) <article-title>Hierarchical grouping to optimize an objective function</article-title>. <source>Journal of the American Statistical Association</source>
<volume>58(301)</volume>: <fpage>236</fpage>&#8211;<lpage>244</lpage>.</mixed-citation></ref><ref id="pone.0079720-Kauffman1"><label>20</label><mixed-citation publication-type="other">Kauffman L, Rousseeuw PJ (2005) Finding Groups in Data: An Introduction to Cluster Analysis. Wiley Series in Probability and Statistics. Wiley.</mixed-citation></ref><ref id="pone.0079720-Simpson1"><label>21</label><mixed-citation publication-type="journal">
<name><surname>Simpson</surname><given-names>TI</given-names></name>, <name><surname>Armstrong</surname><given-names>JD</given-names></name>, <name><surname>Jarman</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>Merged consensus clustering to assess and improve class discovery with microarray data</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>: <fpage>590</fpage>.<pub-id pub-id-type="pmid">21129181</pub-id></mixed-citation></ref><ref id="pone.0079720-Davies1"><label>22</label><mixed-citation publication-type="journal">
<name><surname>Davies</surname><given-names>DL</given-names></name>, <name><surname>Bouldin</surname><given-names>DW</given-names></name> (<year>1979</year>) <article-title>A cluster separation measure</article-title>. <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>
<volume>1</volume>: <fpage>224</fpage>&#8211;<lpage>227</lpage>.<pub-id pub-id-type="pmid">21868852</pub-id></mixed-citation></ref><ref id="pone.0079720-Hubert1"><label>23</label><mixed-citation publication-type="journal">
<name><surname>Hubert</surname><given-names>L</given-names></name> (<year>1974</year>) <article-title>Approximate evaluation technique for the single-link and complete-link hierarchical clustering procedures</article-title>. <source>Journal of the American Statistical Association</source>
<volume>69(347)</volume>: <fpage>698</fpage>&#8211;<lpage>704</lpage>.</mixed-citation></ref><ref id="pone.0079720-Hubert2"><label>24</label><mixed-citation publication-type="journal">
<name><surname>Hubert</surname><given-names>LJ</given-names></name>, <name><surname>Levin</surname><given-names>JR</given-names></name> (<year>1976</year>) <article-title>Evaluating object set partitions: Free-sort analysis and some generalizations</article-title>. <source>Journal of Verbal Learning and Verbal Behavior</source>
<volume>15</volume>: <fpage>459</fpage>&#8211;<lpage>470</lpage>.</mixed-citation></ref><ref id="pone.0079720-Maimon1"><label>25</label><mixed-citation publication-type="other">Maimon O, Rokach L, editors (2010) Data Mining and Knowledge Discovery Handbook. Springer.</mixed-citation></ref><ref id="pone.0079720-Rousseeuw1"><label>26</label><mixed-citation publication-type="journal">
<name><surname>Rousseeuw</surname><given-names>PJ</given-names></name> (<year>1987</year>) <article-title>Silhouettes: A graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>Journal of Computational and Applied Mathematics</source>
<volume>20</volume>: <fpage>53</fpage>&#8211;<lpage>65</lpage>.</mixed-citation></ref><ref id="pone.0079720-Rancoita1"><label>27</label><mixed-citation publication-type="journal">
<name><surname>Rancoita</surname><given-names>PMV</given-names></name>, <name><surname>Hutter</surname><given-names>M</given-names></name>, <name><surname>Bertoni</surname><given-names>F</given-names></name>, <name><surname>Kwee</surname><given-names>I</given-names></name> (<year>2009</year>) <article-title>Bayesian DNA copy number analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>: <fpage>10</fpage>.<pub-id pub-id-type="pmid">19133123</pub-id></mixed-citation></ref><ref id="pone.0079720-Beroukhim1"><label>28</label><mixed-citation publication-type="journal">
<name><surname>Beroukhim</surname><given-names>R</given-names></name>, <name><surname>Lin</surname><given-names>M</given-names></name>, <name><surname>Park</surname><given-names>Y</given-names></name>, <name><surname>Hao</surname><given-names>K</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <etal>et al</etal> (<year>2006</year>) <article-title>Inferring loss-of-heterozygosity from unpaired tumors using high-density oligonucleotide SNP arrays</article-title>. <source>PLOS Computational Biology</source>
<volume>2</volume>: <fpage>323</fpage>&#8211;<lpage>332</lpage>.</mixed-citation></ref><ref id="pone.0079720-Baudis1"><label>29</label><mixed-citation publication-type="journal">
<name><surname>Baudis</surname><given-names>M</given-names></name>, <name><surname>Cleary</surname><given-names>ML</given-names></name> (<year>2001</year>) <article-title>Progenetix.net: an online repository for molecular cytogenetic aberration data</article-title>. <source>Bioinformatics</source>
<volume>17</volume>: <fpage>1228</fpage>&#8211;<lpage>1229</lpage>.<pub-id pub-id-type="pmid">11751233</pub-id></mixed-citation></ref><ref id="pone.0079720-Lenz2"><label>30</label><mixed-citation publication-type="journal">
<name><surname>Lenz</surname><given-names>G</given-names></name>, <name><surname>Staudt</surname><given-names>LM</given-names></name> (<year>2010</year>) <article-title>Aggressive lymphomas</article-title>. <source>New England Journal of Medicine</source>
<volume>362(15)</volume>: <fpage>1417</fpage>&#8211;<lpage>29</lpage>.<pub-id pub-id-type="pmid">20393178</pub-id></mixed-citation></ref><ref id="pone.0079720-Salles1"><label>31</label><mixed-citation publication-type="journal">
<name><surname>Salles</surname><given-names>G</given-names></name>, <name><surname>de Jong</surname><given-names>D</given-names></name>, <name><surname>Xie</surname><given-names>W</given-names></name>, <name><surname>Rosenwald</surname><given-names>A</given-names></name>, <name><surname>Chhanabhai</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Prognostic significance of immunohistochemical biomarkers in diffuse large B-cell lymphoma: a study from the Lunenburg lymphoma biomarker consortium</article-title>. <source>Blood</source>
<volume>117</volume>: <fpage>7070</fpage>&#8211;<lpage>7078</lpage>.<pub-id pub-id-type="pmid">21536860</pub-id></mixed-citation></ref><ref id="pone.0079720-Hu1"><label>32</label><mixed-citation publication-type="journal">
<name><surname>Hu</surname><given-names>X</given-names></name>, <name><surname>Stern</surname><given-names>HM</given-names></name>, <name><surname>Ge</surname><given-names>L</given-names></name>, <name><surname>O'Brien</surname><given-names>C</given-names></name>, <name><surname>Haydu</surname><given-names>L</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Genetic alterations and oncogenic pathways associated with breast cancer subtypes</article-title>. <source>Molecular Cancer Research</source>
<volume>7</volume>: <fpage>511</fpage>&#8211;<lpage>522</lpage>.<pub-id pub-id-type="pmid">19372580</pub-id></mixed-citation></ref><ref id="pone.0079720-Taylor1"><label>33</label><mixed-citation publication-type="journal">
<name><surname>Taylor</surname><given-names>M</given-names></name>, <name><surname>Northcott</surname><given-names>P</given-names></name>, <name><surname>Korshunov</surname><given-names>A</given-names></name>, <name><surname>Remke</surname><given-names>M</given-names></name>, <name><surname>Cho</surname><given-names>Y</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Molecular subgroups of medulloblastoma: the current consensus</article-title>. <source>Acta Neuropathologica</source>
<volume>123</volume>: <fpage>465</fpage>&#8211;<lpage>472</lpage>.<pub-id pub-id-type="pmid">22134537</pub-id></mixed-citation></ref></ref-list></back></article>