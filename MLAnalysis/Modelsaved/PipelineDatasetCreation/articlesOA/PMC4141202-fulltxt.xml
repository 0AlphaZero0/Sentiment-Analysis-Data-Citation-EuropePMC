<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Syst Biol</journal-id><journal-id journal-id-type="iso-abbrev">Syst. Biol</journal-id><journal-id journal-id-type="publisher-id">sysbio</journal-id><journal-id journal-id-type="hwp">sysbio</journal-id><journal-title-group><journal-title>Systematic Biology</journal-title></journal-title-group><issn pub-type="ppub">1063-5157</issn><issn pub-type="epub">1076-836X</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4141202</article-id><article-id pub-id-type="pmid">24789072</article-id><article-id pub-id-type="doi">10.1093/sysbio/syu031</article-id><article-id pub-id-type="publisher-id">syu031</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software for Systematics and Evolution</subject></subj-group></article-categories><title-group><article-title>A Gateway for Phylogenetic Analysis Powered by Grid Computing Featuring GARLI 2.0</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bazinet</surname><given-names>Adam L.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Zwickl</surname><given-names>Derrick J.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Cummings</surname><given-names>Michael P.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><aff id="AFF1"><sup>1</sup>Center for Bioinformatics and Computational Biology, University of Maryland, College Park, MD, 20742-3360, USA, and <sup>2</sup>Department of Ecology and Evolutionary Biology, University of Arizona, Tucson, AZ, 85721-0088, USA</aff></contrib-group><author-notes><corresp id="COR1">*Correspondence to be sent to: Center for Bioinformatics and Computational Biology, University of Maryland, Biomolecular Sciences Building, College Park, MD, 20742-3360, USA; E-mail: <email>adam.bazinet@umiacs.umd.edu</email>.</corresp><fn id="FN100"><p>Associate Editor: David Posada</p></fn></author-notes><pub-date pub-type="ppub"><month>9</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>30</day><month>4</month><year>2014</year></pub-date><pub-date pub-type="pmc-release"><day>30</day><month>4</month><year>2014</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>63</volume><issue>5</issue><fpage>812</fpage><lpage>818</lpage><history><date date-type="received"><day>2</day><month>2</month><year>2014</year></date><date date-type="rev-request"><day>21</day><month>3</month><year>2014</year></date><date date-type="accepted"><day>22</day><month>4</month><year>2014</year></date></history><permissions><copyright-statement>&#169; The Author(s) 2014. Published by Oxford University Press, on behalf of the Society of Systematic Biologists.</copyright-statement><copyright-year>2014</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<uri xlink:type="simple" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</uri>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com.</license-p></license></permissions><abstract><p>We introduce molecularevolution.org, a publicly available gateway for high-throughput, maximum-likelihood phylogenetic analysis powered by grid computing. The gateway features a <sc>garli</sc> 2.0 web service that enables a user to quickly and easily submit thousands of maximum likelihood tree searches or bootstrap searches that are executed in parallel on distributed computing resources. The <sc>garli</sc> web service allows one to easily specify partitioned substitution models using a graphical interface, and it performs sophisticated post-processing of phylogenetic results. Although the <sc>garli</sc> web service has been used by the research community for over three years, here we formally announce the availability of the service, describe its capabilities, highlight new features and recent improvements, and provide details about how the grid system efficiently delivers high-quality phylogenetic results. [<sc>garli</sc>, gateway, grid computing, maximum likelihood, molecular evolution portal, phylogenetics, web service.]</p></abstract><counts><page-count count="7"/></counts></article-meta></front><body><p>The most widely used modern statistical methods of phylogenetic inference fall into two broad classes: maximum likelihood methods and Bayesian inference methods. Depending on the number of sequences, the number of characters, and the chosen evolutionary model, both maximum likelihood and Bayesian tree inference methods can be computationally intensive, thus creating the need for strategies that speed up computation and decrease time to results. One such strategy is parallelization, which distributes a logical unit of computation over multiple processors. Maximum likelihood methods are generally more amenable to parallelization than Bayesian inference methods, since the hundreds or thousands of searches for the maximum likelihood tree and bootstrap trees that are required for a typical phylogenetic analysis may be run independently of one another. We have developed a grid computing system that features the maximum likelihood-based program <sc>garli</sc> (Genetic Algorithm for Rapid Likelihood Inference; <xref rid="B23" ref-type="bibr">Zwickl 2006</xref>) for high-throughput phylogenetic analysis. Here we describe this publicly available system, in particular focusing on the user-friendly <sc>garli</sc> web interface available at molecularevolution.org.</p><p><sc>garli</sc> is an open-source phylogenetic inference program that uses the maximum likelihood criterion and a stochastic evolutionary algorithm to search for optimal solutions within the joint space of tree topologies, branch length parameter values, and model parameter values. <sc>garli</sc> was developed with the goal of increasing both the speed of maximum likelihood tree inference and the size of data sets that can be reasonably analyzed. <sc>garli</sc> 2.0 implements models for the analysis of biological sequence data (at the level of nucleotides, amino acids, or codons), as well as morphology and (not officially released) insertion&#8211;deletion characters. Version 2.0 introduced support for partitioned models, allowing simultaneous use of different data types or assignment of differing model parameters and rates to individual loci or codon positions. The program design focuses on flexibility of model choice and rigor in parameter estimation.</p><p>Searches through phylogenetic tree space may become entrapped in local optima, and therefore it is necessary to perform multiple <sc>garli</sc> searches for the tree with the highest likelihood, which we simply call the <italic>best tree</italic>. This could entail hundreds of searches depending on the difficulty of the problem. Furthermore, one typically conducts hundreds or thousands of bootstrap replicate searches to assess confidence in the bipartitions found in the best tree. Depending on the number of sequences, the number of unique alignment columns, the evolutionary models employed, various <sc>garli</sc> configuration settings, and the capability of the designated computational resource, it can take hours or even days to complete a single <sc>garli</sc> search replicate. Thus, running many search replicates in parallel on a grid computing system greatly reduces the amount of time required to complete a set of analyses.</p><p>Grid computing is a model of distributed computing that seamlessly links geographically and administratively disparate computational resources, allowing users to access them without having to consider location, operating system, or account administration (<xref rid="B5" ref-type="bibr">Cummings and Huskamp 2005</xref>). The Lattice Project, our grid computing system based on Globus software (<xref rid="B6" ref-type="bibr">Foster and Kesselman 1999</xref>), incorporates volunteer computers running <sc>boinc</sc> (<xref rid="B1" ref-type="bibr">Anderson 2004</xref>) as well as traditional grid computing resources such as Condor pools (<xref rid="B11" ref-type="bibr">Litzkow et al. 1988</xref>) and compute clusters. The architecture and functionality of the grid system is described extensively elsewhere (<xref rid="B2" ref-type="bibr">Bazinet 2009</xref>); fundamentally, however, The Lattice Project provides access to scientific applications (which we term grid services), as well as the means to distribute the computation required by these services over thousands of processors. In recent years, the system has been enhanced by the development of a web interface to the <sc>garli</sc> grid service (<xref rid="B3" ref-type="bibr">Bazinet and Cummings 2011</xref>, currently available at molecularevolution.org). The <sc>garli</sc> grid service has been used in at least 50 published phylogenetic studies, with usage having increased dramatically since the release of the <sc>garli</sc> web interface (e.g., <xref rid="B13" ref-type="bibr">Myers and Cummings 2003</xref>; <xref rid="B18" ref-type="bibr">Regier et al. 2009</xref>; <xref rid="B8" ref-type="bibr">Kawahara et al. 2011</xref>; <xref rid="B4" ref-type="bibr">Bazinet et al. 2013</xref>; <xref rid="B17" ref-type="bibr">Regier et al. 2013</xref>; <xref rid="B21" ref-type="bibr">Sohn et al. 2013</xref>, see Supplemental Material for the full list, available on Dryad <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>). As of April 2, 2014, 843 distinct web service users have completed 4835 analyses comprising 2,306,159 individual <sc>garli</sc> search replicates.</p><p>In this article, we compare The Lattice Project to other scientific gateways and describe the features of the <sc>garli</sc> web service. In addition, we provide details about how the grid system efficiently processes computationally intensive phylogenetic analyses.</p><sec><title>F<sc>eatures</sc></title><sec><title>The Lattice Project Compared to other Scientific Gateways</title><p>There are a number of other scientific gateways that provide bioinformatics tools and services, including those for phylogenetic analysis. These include the Cyberinfrastructure for Phylogenetic Research (<sc>cipres</sc>) Gateway (<xref rid="B12" ref-type="bibr">Miller et al. 2010</xref>), the University of Oslo Bioportal (<xref rid="B9" ref-type="bibr">Kumar et al. 2009</xref>, which has recently closed), the Cornell Computational Biology Service Unit (cbsuapps.tc.cornell.edu), Phylemon (<xref rid="B20" ref-type="bibr">S&#225;nchez et al. 2011</xref>), and Mobyle (<xref rid="B14" ref-type="bibr">N&#233;ron et al. 2009</xref>). Although each of these other systems has proved to be of use in phylogenetic research, our grid system has some distinguishing characteristics.
<list list-type="order"><list-item><p><bold>GARLI version 2.0&#8212;</bold>Of the gateways supporting phylogenetic analysis, only The Lattice Project and the <sc>cipres</sc> gateways offer a <sc>garli</sc> 2.0 (<xref rid="B24" ref-type="bibr">Zwickl 2011</xref>) service.</p></list-item><list-item><p><bold>Unlimited computation&#8212;</bold>The <sc>garli</sc> service on molecularevolution.org currently allows an unlimited number of submissions, up to 100 best tree or 2000 bootstrap search replicates per submission, and no resource or runtime limitations. We are able to offer this level of service due to our implementation of stringent error checking, advanced scheduling mechanisms, and inclusion of novel resources such as our public computing pool of <sc>boinc</sc> clients.</p></list-item><list-item><p><bold>Facile user interface and resource abstraction&#8212;</bold>Fully embracing the grid computing model, the computing resources backing the <sc>garli</sc> service are abstracted from the user, facilitated by an elegant user interface. In contrast, the <sc>cipres</sc> gateway requires the user to become familiar with their computing resources and to specify their analysis in such a way that it will complete on the allocated resource (usually only a small number of processors) within an allotted period of time.</p></list-item><list-item><p><bold>Sophisticated and relevant post-processing&#8212;</bold>The use of stochastic algorithms, multiple search replicates, and bootstrap analyses generates a large number of individual results that must be compiled and processed for evaluation and subsequent use. We perform much of this post-processing automatically, including computation of the best tree found or bootstrap majority rule consensus tree, and the calculation of various summary statistics and graphical representations (see <italic>Post-processing routines</italic>).</p></list-item><list-item><p><bold>Large-scale public participation&#8212;</bold>The Lattice Project is the only phylogenetic analysis system that provides an easy and meaningful opportunity for public participation in research, which is achieved by using our <sc>boinc</sc> project (boinc.umiacs.umd.edu). Volunteers simply download a lightweight client to their personal computer, thus enabling it to process <sc>garli</sc> workunits for The Lattice Project. As of April 2, 2014, more than 16,956 people from 146 countries have participated.</p></list-item><list-item><p><bold>Minimal energy usage&#8212;</bold><italic>Emergy</italic>, the energy embodied in computing components (which includes manufacture and transportation), accounts for the majority of power consumed in computing (<xref rid="B16" ref-type="bibr">Raghavan and Ma 2011</xref>). Put another way, the &#8220;greenest&#8221; computer is one that is never built. Apart from a few servers for web, database, and middleware services, no hardware is purchased specifically for our grid system. The institutional resources we use are comprised largely of desktop systems and clusters purchased for other purposes (e.g., teaching labs and research, respectively), and we use these resources only when they are not being used for their primary purpose. In addition, more than 38,481 computers from the general public have been volunteered at various stages of the project. For all of these resources, the <italic>emergy</italic> investment has already been made, and our use of these resources amortizes this investment over a greater usage basis. In contrast, phylogenetic analyses through other gateways compete for limited resources on high-capacity clusters, where the jobs often do not take advantage of the high-bandwidth, low-latency interconnects and other special hardware features offered. Furthermore, the widely distributed, low-density computing model of our grid system results in almost no additional energy use for cooling compared with the substantial energy costs of cooling computer data centers.</p></list-item></list>
No other openly accessible phylogenetic computing system collectively shares these attributes. Although dedicated high-performance computing resources have their place in scientific research, a substantial share of phylogenetic analyses can be performed very effectively, and more energy efficiently, by means of grid and public computing.</p></sec><sec><title>GARLI Web Service: User Interface and Functionality</title><p>We have recently upgraded the user interface to our grid system from a Unix command-line interface to a web-based one. This greatly reduces the entry barrier for potential non-technical users. Researchers were previously required to use command-line tools to upload data, submit analyses to a particular grid service (e.g., <sc>garli</sc>), and download subsequent results. Basic utilities were also available to query the status of jobs or cancel them.</p><p>Although the command-line interface is still available, we anticipate that the web-based interfaces to our services will generate considerably more interest; the <sc>garli</sc> web service is the first of these to be developed. The following sections describe the modes of use and the basic functionality of the <sc>garli</sc> web service on molecularevolution.org.</p><sec><title>Modes of use</title><p>A <sc>garli</sc> web service user may register an account or choose to remain anonymous. Anonymous users are only required to provide an email address (used to notify them of job status updates) and to fill out a <sc>captcha</sc> (Completely Automated Public Turing test to tell Computers and Humans Apart) for each job submission to prevent spam. Anonymous use of the web service is a convenient way to try out the service with minimal effort. However, registration on molecularevolution.org confers several advantages: (1) one does not have to fill out a <sc>captcha</sc> for each job submission; (2) one gains access to a file repository that can be used to store and reuse input files (Supplementary Fig. 1, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>; and (3) one gains the ability to view a list of their jobs and manage them.</p></sec><sec><title>Create job page</title><p>Submitting a <sc>garli</sc> analysis via the <bold>create job</bold> page (Supplementary Fig. 2, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>) consists of the following general steps: (1) specification of a job name, analysis type (best tree or bootstrap search), and number of replicates (up to 2000); (2) upload or specification of necessary input files (sequence data, starting tree, and/or constraint file); and (3) specification of model parameters and other program settings. Upon job submission, the system uses a special validation mode of the <sc>garli</sc> program to ensure that there are no problems with the user-supplied data file and the parameters specified; for example, very large data sets may require more <sc>ram</sc> than the system currently allows (i.e., 24,000 <sc>mb</sc>). <sc>garli</sc> search replicates are then scheduled to run in parallel on one or more grid system resources that meet the job requirements (e.g., that have enough <sc>ram</sc>). The user is notified by email if their job was submitted successfully or if it failed for some reason.</p></sec><sec><title>Job status page</title><p>The <bold>job status</bold> page (Supplementary Fig. 3, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>) allows a registered user to view and manage a list of their jobs. For each job listed, the following attributes are displayed: job id, job name, number of replicates complete, job status, and time the job was created. The dropdown at the top of the page allows one to filter jobs by a particular job status (&#8220;idle&#8221;, &#8220;running&#8221;, &#8220;retrieved&#8221;, &#8220;failed&#8221;, or &#8220;removed&#8221;). Finally, using the button at the bottom of the page, one may remove jobs that are no longer of interest. If the jobs to be removed are in the process of running, they will be canceled.</p></sec><sec><title>Job details page</title><p>When a registered user selects a particular job from the <bold>job status</bold> page, or an anonymous user enters a valid e-mail address/job id combination on the same page, the <bold>job details</bold> page is shown (Supplementary Fig. 4, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>). This page contains a section for job input files (both user-provided and system-generated) and a section for job output files. The job output files section always includes a <sc>zip</sc> file that contains all of the currently available output associated with the analysis. If all of the replicates for a particular analysis are complete, then the job output files section will also include the results of post-processing (see <italic>Post-processing routines</italic>).</p></sec></sec><sec><title>Partitioned Analysis Specification</title><p>Support for partitioned substitution models is the most significant new feature of <sc>garli</sc> 2.0. However, partitioned analysis specification can be a relatively complicated and error-prone process. We have made the specification of modestly-sized partitioned analyses easier by introducing a <italic>guided mode</italic> that allows the user to specify the details of the partitioned analysis with graphical form elements (Supplementary Fig. 5, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>), rather than by manually composing a <sc>nexus</sc> sets block and <sc>garli</sc> model blocks. Guided mode is enabled once the user has selected a valid <sc>nexus</sc> data file, which the system processes with the Nexus Class Library (<xref rid="B10" ref-type="bibr">Lewis 2003</xref>). The user then creates one or more character sets (<italic>charsets</italic>), each consisting of a name, a start position, and an end position; charsets may also be specified by codon position using a checkbox. Once the user specifies one or more valid charsets they will be made available to be added to <italic>data subsets</italic>. Each data subset must contain at least one charset, but may contain more than one. The service currently allows the definition of up to ten data subsets in guided mode. For each data subset, a particular substitution model (or particular model parameters) may be specified. When the partitioned analysis is submitted, the service will automatically transform the charset and subset data into a <sc>nexus</sc> sets block and include it in the data file, and will likewise produce the appropriate model blocks and add them to the <sc>garli</sc> configuration file. For users who prefer to provide their own <sc>nexus</sc> sets block and <sc>garli</sc> model blocks, we provide an <italic>expert mode</italic> that allows the user to input them directly.</p></sec><sec><title>Post-processing Routines</title><p>Due to the difficulty of inferring large phylogenetic trees, multiple searches for the best tree are typically performed with <sc>garli</sc>. This increases the thoroughness of the search for the best tree, but the resulting large number of files and analysis results can be overwhelming. To ease the burden on the end user, our web-based system performs some post-processing routines, which include graphical and quantitative characterizations of the set of trees inferred from multiple search replicates.</p><p>Post-processing generates a textual summary for all analyses (Supplementary Fig. 6, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>). This file contains the following general information: (1) the data file used; (2) the number of replicates performed; (3) the cumulative <sc>garli</sc> runtime; and (4) suggestions for citing the <sc>garli</sc> web service (omitted from Supplementary Fig. 6, available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>). The analysis summary for a best tree search also contains summary statistics that characterize the distribution of log-likelihood scores and symmetric tree distances (<xref rid="B19" ref-type="bibr">Robinson and Foulds 1981</xref>, absolute and normalized), as well as estimates of the number of search replicates required to recover the best tree topology at three probability levels (see <italic>Calculating the required number of GARLI search replicates</italic>).</p><p>In the case of a best tree search, post-processing generates the following files in addition to the analysis summary: (1) a <sc>nexus</sc> file containing the single tree with the highest likelihood score; (2) a file containing all of the trees found across search replicates, as well as a file containing only the unique trees found (both files in <sc>nexus</sc> format); (3) a file containing a sorted list of the likelihood scores of the trees found by the analysis and a file containing a sorted list of the likelihood scores of the unique trees found; (3) a <sc>pdf</sc> file showing the distribution of likelihood scores among trees (<xref ref-type="fig" rid="F1">Fig. 1</xref>a); and (4) a <sc>pdf</sc> file showing the distribution of symmetric tree distances (<xref ref-type="fig" rid="F1">Fig. 1</xref>b).</p><fig id="F1" position="float"><label>F<sc>igure</sc> 1.</label><caption><p>Properties of trees from multiple search replicates for a representative analysis using <sc>garli</sc>. a) The distribution of likelihood scores. b) The distribution of symmetric tree distances (as a fraction of the maximum possible value for the data set). Both measures are given as frequency and proportion.</p></caption><graphic xlink:href="syu031f1"/></fig><p>In the case of a bootstrap analysis, post-processing uses DendroPy (<xref rid="B22" ref-type="bibr">Sukumaran and Holder 2010</xref>) to generate the following files in addition to the analysis summary: (1) a <sc>nexus</sc> file containing all of the bootstrap trees from the analysis; (2) a <sc>nexus</sc> file containing the majority rule bootstrap consensus tree with bootstrap probability values embedded; (3) a <sc>pdf</sc> file showing the 0.90, 0.95, and 0.99 confidence intervals for the bootstrap probabilities observed in the majority rule bootstrap consensus tree, calculated using the formulas given in <xref rid="B7" ref-type="bibr">Hedges (1992)</xref> (<xref ref-type="fig" rid="F2">Fig. 2</xref>); and (4) a table giving the 0.90, 0.95, and 0.99 confidence intervals for the bootstrap probabilities observed in the majority rule bootstrap consensus tree.</p><fig id="F2" position="float"><label>F<sc>igure</sc> 2.</label><caption><p>Confidence intervals associated with the bootstrap probabilities observed in the majority rule consensus tree computed from 500 <sc>garli</sc> bootstrap replicates. Confidence intervals are given for three probabilities (0.90, 0.95, and 0.99).</p></caption><graphic xlink:href="syu031f2"/></fig><sec><title>Calculating the required number of GARLI search replicates</title><p>Our post-processing routines for a best tree search include the calculation of the number of search replicates necessary to guarantee a particular probability (e.g., 0.95) of recovering the tree topology with the highest observed likelihood score (<xref rid="B18" ref-type="bibr">Regier et al. 2009</xref>). This statistic, based on properties of the binomial distribution, is calculated using the number of replicates that find the same best topology (<italic>x</italic>), where &#8220;same topology&#8221; is defined as having symmetric distance from the best topology equal to zero.</p><p>For example, if the topology of the best tree out of 100 is unique among all topologies found (<italic>x</italic>&#8201;=&#8201;1), then 298 replicates are required in order to recover the best topology with a probability of at least 0.95 (<xref ref-type="fig" rid="F3">Fig. 3</xref>). Of course, it is entirely possible that upon running 298 replicates, the statistical estimate would be revised upwards; e.g., if the topology of the best tree were still unique among the set of topologies, then yet more replicates would be required.</p><fig id="F3" position="float"><label>F<sc>igure</sc> 3.</label><caption><p>Relationship between the number of search replicates (out of 100) returning the same topology as that of the best tree found and the estimated number of search replicates necessary to guarantee a particular probability of recovering that topology. Estimates are given at three probabilities (0.90, 0.95, 0.99).</p></caption><graphic xlink:href="syu031f3"/></fig><p>This statistical estimate of the number of search replicates required to guarantee a particular probability of obtaining the best tree found is intended to inform users about the joint behavior of their data and the <sc>garli</sc> search algorithm, and consequently how many search replicates they should perform. This introduces an objective decision process into the analysis design that eliminates guesswork and the need to evaluate intermediate output, thus saving investigator time and improving analytical results. It also reduces waste of grid resources and energy by suggesting that the user run only the number of replicates needed.</p><p>Eventually, we intend to have the system automatically and adaptively run the appropriate number of search replicates on behalf of the user. It may also be possible to do something similar for bootstrap replicates, perhaps based on a desired level of precision (<xref ref-type="fig" rid="F2">Fig. 2</xref>) or other criteria (<xref rid="B15" ref-type="bibr">Pattengale et al. 2010</xref>).</p></sec></sec></sec><sec><title>S<sc>ystem</sc> P<sc>erformance</sc></title><p>The performance of any distributed computing system depends on how efficiently its resources are utilized. We have implemented a number of scheduling optimizations that enable efficient use of our grid computing resources (<xref rid="B2" ref-type="bibr">Bazinet 2009</xref>). These include a round-robin scheduling algorithm to distribute load evenly among resources; a scheme for benchmarking resources and prioritizing job assignments so that faster resources receive jobs before slower resources; use of predicted job runtime to ensure that long-running jobs are placed on resources where they are unlikely to be interrupted; and a mechanism for combining many short-running jobs into a single job with an &#8220;optimal&#8221; aggregate runtime to maximize system throughput. These last two features depend on a framework we developed for <sc>garli</sc> runtime prediction using random forests (<xref rid="B3" ref-type="bibr">Bazinet and Cummings 2011</xref>), a machine learning method. We have improved this framework so that the runtime prediction model is continuously updated as new jobs are run. In supplemental material (<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>) we describe two system performance improvements in some detail: use of optimal-length jobs for grid computing, and automatic measurement of resource throughput.</p><p>It is important to keep in mind that our grid system is designed for high-throughput computing rather than high-performance computing. As a result, while any one analysis might run more quickly on a dedicated high-performance platform, the system described here allows many such analyses to run concurrently and still complete in a relatively modest amount of time (<xref ref-type="fig" rid="F4">Fig. 4</xref>). In addition, use of a high-performance system may not necessarily yield decreased time to results once allocation processes, system availability, queue waiting times, scheduling policies, and other considerations commonly associated with the use of high-performance resources are factored in. The high-throughput computing gateway at molecularevolution.org is well matched to the requirements of many typical phylogenetic analyses, and it has already proven useful to many researchers conducting maximum likelihood phylogenetic analyses using <sc>garli</sc> 2.0.</p><fig id="F4" position="float"><label>F<sc>igure</sc> 4.</label><caption><p>Completion times of 719 analyses submitted to the <sc>garli</sc> web service for a recent six month period (2013-07-23 to 2014-01-23). Despite great variation in analysis parameters (e.g., data matrix size, substitution model used, number of replicates requested), &#8776;97% of analyses were completed in less than 24 hours.</p></caption><graphic xlink:href="syu031f4"/></fig></sec><sec><title>S<sc>upplementary material</sc></title><p>Data available from the Dryad Digital Repository: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d7639">http://dx.doi.org/10.5061/dryad.d7639</ext-link>.</p></sec><sec><title>F<sc>unding</sc></title><p>This work was supported by the <funding-source id="cs1" rid="cn1">National Science Foundation</funding-source> (<award-id id="cn1" rid="cs1">DBI-0755048</award-id>).</p></sec></body><back><ack><title>A<sc>cknowledgments</sc></title><p>We thank Barry Dutton, Yevgeny Deviatov, and Derrick Hinkle for their efforts developing various aspects of the grid system and the <sc>garli</sc> web service; Charles Mitter for developing the statistical determination of the number of required <sc>garli</sc> search replicates; and Mike Landavere, Christopher Camacho, Ahmed El-Haggan, Wasay Taha Mohammed Abdul, Patrick Beach, Matthew Kweskin, Kevin Hildebrand, and Fritz McCall for connecting and administering grid system resources. We also thank the associate editor and one anonymous reviewer for their helpful suggestions.</p></ack><ref-list><title>R<sc>eferences</sc></title><ref id="B1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>D.P.</given-names></name></person-group><article-title>BOINC: A system for public-resource computing and storage</article-title><source>Proceedings of the 5th IEEE/ACM International Workshop on Grid Computing GRID '04 IEEE Computer Society</source><year>2004</year><publisher-loc>Washington, DC, USA</publisher-loc><fpage>4</fpage><lpage>10</lpage></element-citation></ref><ref id="B2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bazinet</surname><given-names>A.L.</given-names></name></person-group><source>The Lattice Project: A Multi-model Grid Computing System</source><year>2009</year><publisher-loc>College Park</publisher-loc><publisher-name>University of Maryland</publisher-name><comment>Master's thesis</comment></element-citation></ref><ref id="B3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bazinet</surname><given-names>A.L.</given-names></name><name><surname>Cummings</surname><given-names>M P.</given-names></name></person-group><article-title>Computing the tree of life: Leveraging the power of desktop and service grids</article-title><source>2011 IEEE International Symposium on Parallel and Distributed Processing Workshops and PhD Forum</source><year>2011</year><fpage>1896</fpage><lpage>1902</lpage></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazinet</surname><given-names>A.L.</given-names></name><name><surname>Cummings</surname><given-names>M.P.</given-names></name><name><surname>Mitter</surname><given-names>K.T.</given-names></name><name><surname>Mitter</surname><given-names>C.W.</given-names></name></person-group><article-title>Can RNA-Seq resolve the rapid radiation of advanced moths and butterflies (Hexapoda: Lepidoptera: Apoditrysia)? An exploratory study</article-title><source>PLoS ONE</source><year>2013</year><volume>8</volume><fpage>e82615</fpage><pub-id pub-id-type="pmid">24324810</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cummings</surname><given-names>M.</given-names></name><name><surname>Huskamp</surname><given-names>J.</given-names></name></person-group><article-title>Grid computing</article-title><source>EDUCAUSE Review</source><year>2005</year><volume>40</volume><fpage>116</fpage><lpage>117</lpage></element-citation></ref><ref id="B6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>I.</given-names></name><name><surname>Kesselman</surname><given-names>C.</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Foster</surname><given-names>I.</given-names></name><name><surname>Kesselman</surname><given-names>C.</given-names></name></person-group><article-title>Globus: a toolkit-based grid architecture</article-title><source>The grid: blueprint for a new computing infrastructure Morgan-Kaufmann</source><year>1999</year><fpage>259</fpage><lpage>278</lpage></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedges</surname><given-names>S.B.</given-names></name></person-group><article-title>The number of replications needed for accurate estimation of the bootstrap P value in phylogenetic studies</article-title><source>Mol. Biol. Evol.</source><year>1992</year><volume>9</volume><fpage>366</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">1560769</pub-id></element-citation></ref><ref id="B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawahara</surname><given-names>A.</given-names></name><name><surname>Ohshima</surname><given-names>I.</given-names></name><name><surname>Kawakita</surname><given-names>A.</given-names></name><name><surname>Regier</surname><given-names>J.</given-names></name><name><surname>Mitter</surname><given-names>C.</given-names></name><name><surname>Cummings</surname><given-names>M.</given-names></name><name><surname>Davis</surname><given-names>D.</given-names></name><name><surname>Wagner</surname><given-names>D.</given-names></name><name><surname>De Prinis</surname><given-names>J.</given-names></name><name><surname>Lopez-Vaamonde</surname><given-names>C.</given-names></name></person-group><article-title>Increased gene sampling provides stronger support for higher-level groups within gracillariid leaf mining moths and relatives (Lepidoptera: Gracillariidae)</article-title><source>BMC Evol. Biol.</source><year>2011</year><volume>11</volume><fpage>182</fpage><pub-id pub-id-type="pmid">21702958</pub-id></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>S.</given-names></name><name><surname>Skjaeveland</surname><given-names>A.</given-names></name><name><surname>Orr</surname><given-names>R.J.S.</given-names></name><name><surname>Enger</surname><given-names>P.</given-names></name><name><surname>Ruden</surname><given-names>T.</given-names></name><name><surname>Mevik</surname><given-names>B.-H.</given-names></name><name><surname>Burki</surname><given-names>F.</given-names></name><name><surname>Botnen</surname><given-names>A.</given-names></name><name><surname>Shalchian-Tabrizi</surname><given-names>K.</given-names></name></person-group><article-title>AIR: a batch-oriented web program package for construction of supermatrices ready for phylogenomic analyses</article-title><source>BMC Bioinformatics</source><year>2009</year><volume>10</volume><fpage>357</fpage><pub-id pub-id-type="pmid">19863793</pub-id></element-citation></ref><ref id="B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>P.O.</given-names></name></person-group><article-title>NCL: a C&#8201;+&#8201;&#8201;+&#8201; class library for interpreting data files in NEXUS format</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>2330</fpage><lpage>2331</lpage><pub-id pub-id-type="pmid">14630669</pub-id></element-citation></ref><ref id="B11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Litzkow</surname><given-names>M.</given-names></name><name><surname>Livny</surname><given-names>M.</given-names></name><name><surname>Mutka</surname><given-names>M.</given-names></name></person-group><article-title>Condor&#8211;a hunter of idle workstations</article-title><source>Distributed Computing Systems, 1988., 8th International Conference on</source><year>1988</year><fpage>104</fpage><lpage>111</lpage></element-citation></ref><ref id="B12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>M.</given-names></name><name><surname>Pfeiffer</surname><given-names>W.</given-names></name><name><surname>Schwartz</surname><given-names>T.</given-names></name></person-group><article-title>Creating the CIPRES science gateway for inference of large phylogenetic trees</article-title><source>Gateway Computing Environments Workshop (GCE), 2010</source><year>2010</year><fpage>1</fpage><lpage>8</lpage></element-citation></ref><ref id="B13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>D.</given-names></name><name><surname>Cummings</surname><given-names>M.</given-names></name></person-group><article-title>Necessity is the mother of invention: a simple grid computing system using commodity tools</article-title><source>J. Parallel Distr. Com.</source><year>2003</year><volume>63</volume><fpage>578</fpage><lpage>589</lpage></element-citation></ref><ref id="B14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>N&#233;ron</surname><given-names>B.</given-names></name><name><surname>M&#233;nager</surname><given-names>H.</given-names></name><name><surname>Maufrais</surname><given-names>C.</given-names></name><name><surname>Joly</surname><given-names>N.</given-names></name><name><surname>Maupetit</surname><given-names>J.</given-names></name><name><surname>Letort</surname><given-names>S.</given-names></name><name><surname>Carrere</surname><given-names>S.</given-names></name><name><surname>Tuffery</surname><given-names>P.</given-names></name><name><surname>Letondal</surname><given-names>C.</given-names></name></person-group><article-title>Mobyle: a new full web bioinformatics framework</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>3005</fpage><lpage>11</lpage><pub-id pub-id-type="pmid">19689959</pub-id></element-citation></ref><ref id="B15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pattengale</surname><given-names>N.D.</given-names></name><name><surname>Alipour</surname><given-names>M.</given-names></name><name><surname>Bininda-Emonds</surname><given-names>O.R.P.</given-names></name><name><surname>Moret</surname><given-names>B.M.E.</given-names></name><name><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group><article-title>How many bootstrap replicates are necessary?</article-title><source>J. Comput. Biol.</source><year>2010</year><volume>17</volume><fpage>337</fpage><lpage>54</lpage><pub-id pub-id-type="pmid">20377449</pub-id></element-citation></ref><ref id="B16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Raghavan</surname><given-names>B.</given-names></name><name><surname>Ma</surname><given-names>J.</given-names></name></person-group><article-title>The energy and emergy of the Internet</article-title><source>HotNets</source><year>2011</year><fpage>9</fpage></element-citation></ref><ref id="B17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regier</surname><given-names>J.C.</given-names></name><name><surname>Mitter</surname><given-names>C.</given-names></name><name><surname>Zwick</surname><given-names>A.</given-names></name><name><surname>Bazinet</surname><given-names>A.L.</given-names></name><name><surname>Cummings</surname><given-names>M.P.</given-names></name><name><surname>Kawahara</surname><given-names>A.Y.</given-names></name><name><surname>Sohn</surname><given-names>J.-C.</given-names></name><name><surname>Zwickl</surname><given-names>D.J.</given-names></name><name><surname>Cho</surname><given-names>S.</given-names></name><name><surname>Davis</surname><given-names>D.R.</given-names></name><name><surname>Baixeras</surname><given-names>J.</given-names></name><name><surname>Brown</surname><given-names>J.</given-names></name><name><surname>Parr</surname><given-names>C.</given-names></name><name><surname>Weller</surname><given-names>S.</given-names></name><name><surname>Lees</surname><given-names>D.C.</given-names></name><name><surname>Mitter</surname><given-names>K.T.</given-names></name></person-group><article-title>A large-scale, higher-level, molecular phylogenetic study of the insect order Lepidoptera (moths and butterflies)</article-title><source>PLoS ONE</source><year>2013</year><volume>8</volume><fpage>e58568</fpage><pub-id pub-id-type="pmid">23554903</pub-id></element-citation></ref><ref id="B18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regier</surname><given-names>J.C.</given-names></name><name><surname>Zwick</surname><given-names>A.</given-names></name><name><surname>Cummings</surname><given-names>M.P.</given-names></name><name><surname>Kawahara</surname><given-names>A.Y.</given-names></name><name><surname>Cho</surname><given-names>S.</given-names></name><name><surname>Weller</surname><given-names>S.</given-names></name><name><surname>Roe</surname><given-names>A.</given-names></name><name><surname>Baixeras</surname><given-names>J.</given-names></name><name><surname>Brown</surname><given-names>J.W.</given-names></name><name><surname>Parr</surname><given-names>C.</given-names></name><name><surname>Davis</surname><given-names>D.R.</given-names></name><name><surname>Epstein</surname><given-names>M.</given-names></name><name><surname>Hallwachs</surname><given-names>W.</given-names></name><name><surname>Hausmann</surname><given-names>A.</given-names></name><name><surname>Janzen</surname><given-names>D.H.</given-names></name><name><surname>Kitching</surname><given-names>I.J.</given-names></name><name><surname>Solis</surname><given-names>M.A.</given-names></name><name><surname>Yen</surname><given-names>S.-H.</given-names></name><name><surname>Bazinet</surname><given-names>A.L.</given-names></name><name><surname>Mitter</surname><given-names>C.</given-names></name></person-group><article-title>Toward reconstructing the evolution of advanced moths and butterflies (Lepidoptera: Ditrysia): an initial molecular study</article-title><source>BMC Evol. Biol.</source><year>2009</year><volume>9</volume><fpage>280</fpage><pub-id pub-id-type="pmid">19954545</pub-id></element-citation></ref><ref id="B19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>D.R.</given-names></name><name><surname>Foulds</surname><given-names>L.R.</given-names></name></person-group><article-title>Comparison of phylogenetic trees</article-title><source>Math. Biosci.</source><year>1981</year><volume>53</volume><fpage>131</fpage><lpage>147</lpage></element-citation></ref><ref id="B20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>S&#225;nchez</surname><given-names>R.</given-names></name><name><surname>Serra</surname><given-names>F.</given-names></name><name><surname>T&#225;rraga</surname><given-names>J.</given-names></name><name><surname>Medina</surname><given-names>I.</given-names></name><name><surname>Carbonell</surname><given-names>J.</given-names></name><name><surname>Pulido</surname><given-names>L.</given-names></name><name><surname>de Mar&#237;a</surname><given-names>A.</given-names></name><name><surname>Capella-Gut&#237;errez</surname><given-names>S.</given-names></name><name><surname>Huerta-Cepas</surname><given-names>J.</given-names></name><name><surname>Gabald&#243;n</surname><given-names>T.</given-names></name><name><surname>Dopazo</surname><given-names>J.</given-names></name><name><surname>Dopazo</surname><given-names>H.</given-names></name></person-group><article-title>Phylemon 2.0: a suite of web-tools for molecular evolution, phylogenetics, phylogenomics and hypotheses testing</article-title><source>Nucleic Acids Res</source><year>2011</year><volume>39</volume><fpage>W470</fpage><lpage>W474</lpage><pub-id pub-id-type="pmid">21646336</pub-id></element-citation></ref><ref id="B21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sohn</surname><given-names>J.-C.</given-names></name><name><surname>Regier</surname><given-names>J.C.</given-names></name><name><surname>Mitter</surname><given-names>C.</given-names></name><name><surname>Davis</surname><given-names>D.</given-names></name><name><surname>Landry</surname><given-names>J.-F.</given-names></name><name><surname>Zwick</surname><given-names>A.</given-names></name><name><surname>Cummings</surname><given-names>M.P.</given-names></name></person-group><article-title>A molecular phylogeny for Yponomeutoidea (Insecta, Lepidoptera, Ditrysia) and its implications for classification, biogeography and the evolution of host plant use</article-title><source>PLoS ONE</source><year>2013</year><volume>8</volume><fpage>e55066</fpage><pub-id pub-id-type="pmid">23383061</pub-id></element-citation></ref><ref id="B22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sukumaran</surname><given-names>J.</given-names></name><name><surname>Holder</surname><given-names>M.T.</given-names></name></person-group><article-title>DendroPy: a Python library for phylogenetic computing</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>1569</fpage><lpage>1571</lpage><pub-id pub-id-type="pmid">20421198</pub-id></element-citation></ref><ref id="B23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zwickl</surname><given-names>D.J.</given-names></name></person-group><source>Genetic algorithm approaches for the phylogenetic analysis of large biological sequence datasets under the maximum likelihood criterion</source><year>2006</year><publisher-name>The University of Texas at Austin</publisher-name><comment>Ph.D. thesis</comment></element-citation></ref><ref id="B24"><element-citation publication-type="other"><comment>Zwickl D.J. 2011. GARLI 2.0 <ext-link ext-link-type="uri" xlink:href="https://www.nescent.org/wg_garli/main_page">https://www.nescent.org/wg_garli/main_page</ext-link>.</comment></element-citation></ref></ref-list></back></article>