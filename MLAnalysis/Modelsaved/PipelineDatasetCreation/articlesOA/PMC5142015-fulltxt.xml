<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id><journal-id journal-id-type="iso-abbrev">Brief. Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bib</journal-id><journal-id journal-id-type="hwp">bib</journal-id><journal-title-group><journal-title>Briefings in Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1467-5463</issn><issn pub-type="epub">1477-4054</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5142015</article-id><article-id pub-id-type="doi">10.1093/bib/bbv110</article-id><article-id pub-id-type="publisher-id">bbv110</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software Review</subject></subj-group></article-categories><title-group><article-title>A comprehensive comparison of tools for differential ChIP-seq analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Steinhauser</surname><given-names>Sebastian</given-names></name><xref ref-type="bio" rid="d35e37">*</xref></contrib><contrib contrib-type="author"><name><surname>Kurzawa</surname><given-names>Nils</given-names></name><xref ref-type="bio" rid="d35e48">*</xref></contrib><contrib contrib-type="author"><name><surname>Eils</surname><given-names>Roland</given-names></name><xref ref-type="bio" rid="d35e59">*</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Herrmann</surname><given-names>Carl</given-names></name><xref ref-type="bio" rid="d35e70">*</xref></contrib></contrib-group><author-notes><corresp>Corresponding author: Carl Herrmann, IPMB Universit&#15520;Heidelberg and Department of Theoretical Bioinformatics, DKFZ, Im Neuenheimer Feld 364, D-69120 Heidelberg, Tel.: (+49) 6221 423612; E-mail: <email>carl.herrmann@uni-heidelberg.de</email></corresp></author-notes><pub-date pub-type="ppub"><month>11</month><year>2016</year></pub-date><pub-date pub-type="epub"><day>13</day><month>1</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>1</month><year>2016</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>17</volume><issue>6</issue><fpage>953</fpage><lpage>966</lpage><history><date date-type="received"><day>9</day><month>10</month><year>2015</year></date><date date-type="rev-recd"><day>21</day><month>11</month><year>2015</year></date></history><permissions><copyright-statement>&#169; The Author 2016. Published by Oxford University Press.</copyright-statement><copyright-year>2015</copyright-year><license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><abstract><p>ChIP-seq has become a widely adopted genomic assay in recent years to determine binding sites for transcription factors or enrichments for specific histone modifications. Beside detection of enriched or bound regions, an important question is to determine differences between conditions. While this is a common analysis for gene expression, for which a large number of computational approaches have been validated, the same question for ChIP-seq is particularly challenging owing to the complexity of ChIP-seq data in terms of noisiness and variability. Many different tools have been developed and published in recent years. However, a comprehensive comparison and review of these tools is still missing. Here, we have reviewed 14 tools, which have been developed to determine differential enrichment between two conditions. They differ in their algorithmic setups, and also in the range of applicability. Hence, we have benchmarked these tools on real data sets for transcription factors and histone modifications, as well as on simulated data sets to quantitatively evaluate their performance. Overall, there is a great variety in the type of signal detected by these tools with a surprisingly low level of agreement. Depending on the type of analysis performed, the choice of method will crucially impact the outcome.</p></abstract><kwd-group><kwd>ChIP-seq</kwd><kwd>differential analysis</kwd><kwd>software</kwd></kwd-group><counts><page-count count="14"/></counts></article-meta></front><body><sec sec-type="intro"><title>Introduction</title><p>High-throughput sequencing (HTS) has become a standard method in genomics research and has almost completely superseded array-based technologies, owing to the ever-decreasing costs and the variety of different assays that are based on short read sequencing. Most array-based assays have now a counterpart based on HTS, with a generally improved dynamic range in the signal. Genome sequence (whole genome or exome), DNA-methylation (whole genome bisulfite sequencing), gene expression (RNA-seq, CAGE-seq), chromatin accessibility (DNAse1-seq, ATAC-seq, FAIRE-seq) or chromatin interaction (ChIP-seq) all belong to the standard repertoire of genomic studies, and follow standardized protocols. However, the broad availability of these approaches should not hide the fact that they are still highly complex, requiring a number of experimental steps that can lead to considerable differences in the readout for a same assay performed by different groups [<xref rid="bbv110-B1" ref-type="bibr">1</xref>, <xref rid="bbv110-B2" ref-type="bibr">2</xref>]. Large-scale consortia such as ENCODE or Roadmap, Epigenomics, which rely on different sequencing centers for the data collection, have faced the problem of harmonizing the results obtained by different centers, which require systematic bias correction before data integration can be achieved in a meaningful way. Clearly, the more complex the experimental setup is, the more it is subject to biases, which can be introduced in the different steps of the experimental protocol or the downstream analysis [<xref rid="bbv110-B3" ref-type="bibr">3</xref>, <xref rid="bbv110-B4" ref-type="bibr">4</xref>]. Among the approaches listed previously, those based on immunoprecipitation are the more complex ones, as the antibody-based precipitation usually represents a critical step, and leads to variations in the precipitation efficiency, the cross-reaction probability, conditioned by the quality of the antibody. Hence, the reproducibility of the assays is often limited, especially in cases with additional constraints, for example low input material. The amount of noise in the data can be substantial: a standard measure of the signal-to-noise ratio is the FRiP (fraction of reads in peaks), which measures how many sequencing reads are located in enriched regions, compared with the total amount [<xref rid="bbv110-B1" ref-type="bibr">1</xref>]. In the ENCODE project, this ratio was in the range of a few percent, indicating that the amount of noise is &gt;90%. To detect consistent signal between replicates, special statistical methods have been developed such as the Irreproducible Discovery Rate [<xref rid="bbv110-B5" ref-type="bibr">5</xref>], which allow to detect consistent signal between replicates.</p><p>Detecting differential gene expression between several conditions is one of the most common analysis steps since the advent of genome-wide expression measurements based on microarrays, and a considerable literature has been dedicated to the development of solid statistical procedures. Expression measurements based on HTS has also lead to the development of new tools or the adjustment of existing procedures. Differential analysis are however not restricted to gene expression but can in principle be extended to any quantitative assay, such as the measurement of DNA methylation levels or the enrichment of ChIP signal. Accordingly, many tools are available either to detect differential gene expression or to delimit differentially methylated regions (DMRs). Similarly, a number of tools and methods have been published to detect differences in ChIP signal between several conditions [<xref rid="bbv110-B6" ref-type="bibr">6&#8211;19</xref>]. If the underlying question is similar for ChIP-seq experiments (where are the regions showing significant differential signal between two conditions?), there are a number of particularities that make this simple question particularly challenging in the case of ChIP-seq data sets, as compared with RNA-seq or whole-genome bisulfite sequencing. In the case of RNA-seq, most of the signal is concentrated in regions that are either annotated as genes or easily recognized as enriched regions, representing unannotated transcripts. Hence, the search space for differential signal is well defined. In the case of differential DNA methylation, the search space is extended to the complete genome, as CpGs occur virtually everywhere. However, the signal range is constrained to a finite interval (between 0% and 100% methylation) and the amount of noise is low, two properties which make the search for DMRs a tractable problem. In the case of ChIP-seq, we are facing multiple challenges: (i) the search space is not limited to a particular region of the genome, as differential binding can occur everywhere; this implies that regions of interest, in which differential signal should be looked for, need to be defined first; (ii) the range of the signal is not constrained to a finite interval and requires transformation such that standard statistical tools can be applied; (iii) the amount of noise in considerable, making variations in the signal challenging to detect, especially when these differences are subtle, and (iv) the properties of the enriched regions (in particular their length) differ substantially depending on the protein or epigenetic modification targeted by the immunoprecipitation.</p><p>In this article, we have performed a comprehensive comparison of a large number of tools, which have been published to detect differential signals in ChIP-seq assays. Our criterion for tool selection was the availability of a working software that could be implemented without the need for extensive efforts for porting the code. These tools differ in many ways, and this diversity reflects the diverse challenges listed previously: some require preliminary detection of enriched regions by external peak-calling algorithms, while others implement their own detection method or work using sliding windows; others differ in the underlying statistical modeling of the signal distribution, based either on Poisson distribution or on a more flexible negative binomial distribution. Finally, some tools work in the absence of replicates for each condition, and others require replicates to provide differential analysis. Importantly, some tools have been specifically designed for particular ChIP-seq data, such as histone modifications or transcription factor (TF) binding. We have indicated this in the tool description (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link>); however, we have tried to apply these tools to all types of data sets to verify their behavior. For the evaluation, and given the absence of a gold standard for differential enrichment in ChIP signal, we have adopted a multistep strategy. First, the tools have been compared using various published ChIP-seq data sets, to compare global statistics on the sets of differential regions (DR) detect by each tool, such as the number of DR, their length distribution and the pairwise overlap between the outputs. We have made the distinction between tools that do not require replicates for the definition of DR (single-replicate) and those that only work when replicates are available (multi-replicates), and performed all analysis for both categories separately. To estimate rates of true positives and false positives, we have performed a simulation of synthetic data sets, but made sure that these simulated data sets are as close as possible to real data sets and represent realistic and fair test sets. Using these data sets, we have compared the sensitivity and specificity of each tool. In particular, we have investigated the threshold in differential signal that is required for each tool to start detecting a significant difference. Finally, we have conducted a functional annotation of the sets of DR and related the DR to differentially expressed genes (DEG). This last analysis is meant to address typical biological questions that are mostly focused at difference in gene expression driven by differential enrichments.</p><p>Overall, we have seen considerable differences between the tools, which can be traced back to the underlying statistical assumptions or the way the initial search space is defined, either based on peak calling or using a windowing approach. Researchers that are interested in finding DR in their study should be aware of these differences, and should adapt the choice of the tool to their particular experimental question. We believe that our extensive study can help in making a motivated choice and avoid obvious pitfalls.</p></sec><sec sec-type="materials"><title>Material and methods</title><sec><title>Tools</title><p>We have selected 14 available tools for differential peak calling, based on a variety of algorithmic approaches [<xref rid="bbv110-B6" ref-type="bibr">6&#8211;19</xref>]. A detailed description of each tool is given in <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Text 1</ext-link>, whereas the parameters used are described in <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link>.</p></sec><sec><title>Data set sources</title><p>A summary of the data sets used and statistics on the number of reads is given in <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S2</ext-link>.</p><sec><title>Transcription factor data</title><p>We obtained FoxA1 ChIP-seq data from a previously published study for two experimental conditions including estradiol (E2)- and vehicle (Veh)-treated MCF7 cells each in two biological replicates (GEO: GSE59530). Additionally, expression data as already aligned reads for both conditions derived from global run-on sequencing (GRO-seq) were taken from this study (GEO:GSE59531) [<xref rid="bbv110-B20" ref-type="bibr">20</xref>].</p></sec><sec><title>Sharp histone post translational modification (PTM) data</title><p>Two biological replicates of H3K27ac ChIP-seq were retrieved from a study that differentiates embryonic stem cells (hESC-H1) to mesenchymal stem cells (GEO: GSE16256) [<xref rid="bbv110-B21" ref-type="bibr">21</xref>].</p></sec><sec><title>Broad histone PTM data</title><p>Moreover, we collected data sets in two biological replicates for H3K36me3 in an MMSET (multiple myeloma SET domain) overexpression (TKO) against physiological expression (NTKO) setup in myeloma cells (GEO: GSE57632) [<xref rid="bbv110-B22" ref-type="bibr">22</xref>].</p></sec><sec><title>Simulated sharp signal data</title><p>As an example of data with localized signal giving rise to sharp peaks, we used the merged replicates of the previously described FoxA1 ChIP in E2-treated MCF7 cells as a source for our simulation of a sharp signal data set (GEO: GSE59530) [<xref rid="bbv110-B20" ref-type="bibr">20</xref>].</p></sec><sec><title>Simulated broad signal data</title><p>Moreover, two biological replicates of H3K36me3 in MCF7 cells were downloaded and pooled, which was used as source for the simulation of a broad signal data set (GEO: GSE31755) [<xref rid="bbv110-B22" ref-type="bibr">22</xref>].</p></sec><sec><title>Input data for background simulation</title><p>As a control data set, we used DNA, which is not precipitated (&#8216;input DNA'), which represents the standard control in ChIP-seq experiments. Five input experiments from different MCF7 studies were collected and further used to generate an additive background model (GEO: GSM1059389, GSM1089816, GSM1143667, GSM1241757 and GSM1383864). We performed a genome-wide correlation of the input signals to verify their similarities and pooled them together as source for our background signal simulation. Data simulation was then performed as described in the section &#8216;Simulation of a differential dataset'.</p></sec><sec><title>ChIP-seq preprocessing and analysis</title><p>The data sets were downloaded as sra files from the <italic>Sequence Read Archive</italic> (<italic>SRA</italic>) and converted to fastq with the SRA Toolkit. Reads were aligned to the hg19 reference genome using BWA aln with default settings [<xref rid="bbv110-B23" ref-type="bibr">23</xref>]. Subsequently, duplicated reads and reads with bad mapping quality (-q 1) were removed from alignments.</p><p>We performed peak calling on all ChIP-seq data sets using MACS2 with additional parameters according to underlying signal type as followed: for sharp peaks &#8216;-g hs -q 0.1 &#8211;call-summits' and for broad peaks &#8216;-g hs -q 0.1 &#8211;broad' [<xref rid="bbv110-B24" ref-type="bibr">24</xref>]. Resulting peak sets were used as input for tools that require peaks/regions as input for differential enrichment analysis.</p></sec><sec><title>Differential peak calling</title><p>We performed differential peak calling with each tool according to the settings recommended by the developers of the tools or, if not indicated explicitly, with default settings as listed in <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link>.</p><p>Moreover, tools were classified into two categories according to their ability to use biological replicates or only single samples (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link>).</p><p>For the tools that do not consider replicates, the replicates of each ChIP-seq experiment were pooled to create a single data set for each condition. Because each of these tools calculates different significant measures, a general significant threshold for all of them could not be defined (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link>). However, for tools using an false-discovery rate (FDR) or <italic>P</italic>-value measure, we decided to set the thresholds as FDR &#8804; = 0.01 or <italic>P</italic>-value &#8804; = 0.05.</p></sec><sec><title>GRO-seq analysis</title><p>We obtained already aligned GRO-seq reads for the FoxA1 data set as an input for groHMM, which is an R pipeline for the analysis of GRO-seq data [<xref rid="bbv110-B25" ref-type="bibr">25</xref>]. Differential GRO-seq analysis was performed according to the manual of groHMM using edgeR with a significance threshold of <italic>P</italic> &#8804; = 0.05 [<xref rid="bbv110-B25" ref-type="bibr">25</xref>, <xref rid="bbv110-B26" ref-type="bibr">26</xref>]. Resulting list of DEGs between E2- and Veh-treated MCF7 cells was used for further integration with differential peak data sets.</p></sec><sec><title>DEG enrichment analysis</title><p>Lists of DEGs for the H3K27ac and H3K36me3 data sets were taken from the corresponding studies to integrate them with computed differential peak sets. For FoxA1, we used the results of the GRO-seq analysis described above. Additionally, a list of house-keeping genes (HKGs) was obtained (<ext-link ext-link-type="uri" xlink:href="http://www.wikicell.org/index.php/HK_Gene">http://www.wikicell.org/index.php/HK_Gene</ext-link>) and used as a control to compare enrichment of DEGs with HKGs.</p><p>First, DR were ranked for each tool according to the associated significance measure, and the top 1000 unique nearby genes assigned to DR were kept for this analysis. We performed a cumulative recovery analysis of DEGs as well as HKGs in each gene ranking. The resulting DEG (respectively HKG) ranks were used to compute the area under curve (AUC) for each tool. Moreover, a background model was computed for each ranking by randomly sampling 10,000 times a new gene ranking from all human genes (UCSC Known Gene Annotation) followed by the same cumulative recovery analysis. The resulting background AUC distributions were used to compute the normalized enrichment score (NES) with following formula:
<disp-formula><mml:math id="MM1"><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>&#8722;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>&#963;</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM2"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">&#175;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> corresponds to the mean and to <inline-formula><mml:math id="MM3"><mml:mrow><mml:msub><mml:mi>&#963;</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>the standard deviation of the background model.</p><p>In addition, we introduced for each ChIP-seq data set another control experiment: we ranked all genes using the coverage fold-change within gene bodies (H3K36me3) and promoters (FoxA1 / H3K27Ac). We used these rankings to perform the same recovery analysis.</p></sec></sec><sec><title>Gene ontology enrichment analysis</title><p>As large variations in terms of &#8216;number of differential peaks' were observable for all data sets, we decided to use a &#8216;gene centric' approach, focusing on the top 1000 genes that were close to a differential region. Therefore, each peak was annotated with its nearest gene using the R-package ChIPseeker [<xref rid="bbv110-B27" ref-type="bibr">27</xref>]. We ranked these genes according to corresponding peak significance measures and obtained the top 1000 unique genes for each differential peak set. Regions &#177;1.5 kb around the consensus transcription start side (TSS) were used as input for the annotation tool GREAT with the setting 'single nearest gene' [<xref rid="bbv110-B28" ref-type="bibr">28</xref>].</p><p>As the transcription factors or histone modifications studied here are considered to be positively correlated with gene expression, we used DEGs as a positive control. Therefore, regions &#177;1.5 kb around the consensus TSS of these genes were used as an input for a GREAT analysis with the setting &#8216;single nearest gene'.</p></sec><sec><title>Differential peak calling data presentation</title><p>Signal tracks were generated for each replicate using deepTools [<xref rid="bbv110-B29" ref-type="bibr">29</xref>]. For sharp signal data, scaling factors were estimated with the signal extraction scaling (SES) option, and further log2 ratios of ChIP over input signal were computed [<xref rid="bbv110-B30" ref-type="bibr">30</xref>]. Broad signal data were scaled according to the total number of reads and again log2 ratios were calculated.</p><p>Additionally, all differential peaks can be displayed in a single genome-wide coverage track, which was generated using the bedtools <italic>genomecov</italic> function [<xref rid="bbv110-B31" ref-type="bibr">31</xref>].</p><p>All differential peak sets, signal tracks and genome-wide coverage tracks can be displayed using following UCSC genome browser trackhubs:
<list list-type="simple"><list-item><p><ext-link ext-link-type="uri" xlink:href="http://goo.gl/5WI5w3">http://goo.gl/5WI5w3</ext-link> (FoxA1); <ext-link ext-link-type="uri" xlink:href="http://goo.gl/HyfooK">http://goo.gl/HyfooK</ext-link> (H3K36me3); <ext-link ext-link-type="uri" xlink:href="http://goo.gl/5uYXsn">http://goo.gl/5uYXsn</ext-link> (H3K27ac).</p></list-item></list>
</p></sec><sec><title>Simulation of a differential data sets</title><p>To simulate a realistic &#8216;gold standard' data set for differential ChIP enrichment, we started from real ChIP data sets: one data set targeting FoxA1, as an example of a data set with sharp signal, and a H3K36me3 data set as an example of a broad enrichment. In each case (FoxA1 and H3K36me3), we simulated two &#8216;treatment' data sets (<italic>T<sup>1</sup></italic> and <italic>T<sup>2</sup></italic>) representing the reference condition and the comparison condition, as well as &#8216;control' data sets (<italic>C<sup>1</sup></italic> and <italic>C<sup>2</sup></italic>), corresponding to input. The treatment data sets (<italic>T</italic>) were obtained by merging regions corresponding to real signal (<italic>S</italic>) with background noise (<italic>B</italic>) (hence, <italic>T</italic> = <italic>S</italic> + <italic>B</italic>) The signal data set was obtained as follows: we performed peak calling using MACS2, using the provided input data set as a control. We selected the top 20,000 peaks identified by the peak caller, as they are most likely to represent truly enriched regions. In a first step, only the reads located in these regions were considered, and represent the reference signal data set (<italic>S<sup>1</sup></italic>). To simulate the second condition, these peak regions were split into two groups: 10,000 peaks were kept as is (<italic>S<sup>2</sup><sub>0</sub></italic>), and represent nondifferential peaks. The remaining 10,000 peaks were divided into 10 groups of 1000 peaks each, which were downsampled by random read sampling by 10%, 20%, etc. (<italic>S<sup>2</sup><sub>10</sub></italic>,<italic>S<sup>2</sup><sub>20</sub></italic>,&#8230;). These represent sets of differential peaks in which the level of differential enrichment is variable. Next, we simulated realistic background signal <italic>B</italic>: several public input data sets for the MCF7 cell line were downloaded, aligned and compared. The input data set showing the highest correlation with the original input was used to sample reads, until the library size of the real ChIP-seq experiment was reached. If not enough reads were available in one input, it was merged with a second similar one. This is done twice, to simulate a background for the reference and the second condition (<italic>B<sup>1</sup></italic> and <italic>B<sup>2</sup></italic>). In summary, our two data sets are composed of <italic>T<sup>1</sup></italic> = <italic>S<sup>1</sup></italic> + <italic>B<sup>1</sup></italic> and <italic>T<sup>2</sup></italic> = <italic>S<sup>2</sup></italic> + <italic>B<sup>2</sup></italic>, where <italic>S<sup>2</sup></italic> = <italic>S<sup>2</sup><sub>0</sub></italic> + &#931;<sub>i = 10 &#8594; 100</sub>
<italic>S<sup>2</sup><sub>i</sub></italic>. Comparing these two data sets should ideally yield 10,000 differential peaks, which represents our gold standard.</p><p>The Bioconductor packages <italic>IRanges</italic> and <italic>GenomicRanges</italic> [<xref rid="bbv110-B32" ref-type="bibr">32</xref>] were used to detect overlapping peak regions. For the simulated data set, a <italic>GenomicRanges</italic> object comprising all true differential binding events (n = 10,000) was implemented as a reference to find overlaps with DR called by the respective tools. We considered a called DR to be a true event if at least 25% of its length overlapped with a real DR.</p><p>Using this data set, we computed two different measures to infer sensitivity and specificity of the analyzed tools. For differential ChIP-seq analysis, the number of negatives outnumbers by far the number of positives, as most of the genome is not differentially enriched. Hence, the specificity is not a good measure, as all tools will have artificially high specificity, given the large number of true negatives. We therefore prefer using a &#8216;precision'-like measure. To take into account the fact that some tools call large DR, we defined the &#8216;Jaccard index precision' as <inline-formula><mml:math id="MM4"><mml:mrow><mml:mfrac><mml:mtext>1</mml:mtext><mml:mi>N</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mtext>1</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#8745;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#8746;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> as a more stringent precision measure, penalizing imprecise peak calling (either over- or under-calling). Here, <italic>A<sub>i</sub></italic> represents a DR called by a tool and <italic>B<sub>j(i)</sub></italic> represents the true DR that intersects <italic>A<sub>i</sub></italic>. The norm is meant as the genomic length of the intersection or the union, and N indicates the number of DR called by the tool considered. We define the recall as the proportion of true DR that intersects a called DR with a 25% overlap.</p></sec></sec><sec sec-type="results"><title>Results</title><sec><title>Comparison using real data sets</title><p>We applied the single and multi-replicates pipelines to selected data sets, using the default or recommended settings for the tools (see <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link> for methods and parameters used). As mentioned in the Introduction, a major distinction can be made between tools that require a predefined set of regions of interest (for example, peaks) and those that implement an internal procedure to define these regions of interest. We call the first set of tools EROI (for external regions of interest), and the second IROI (for internal regions of interest), and distinguish these two groups (in addition to the requirement for replicates or not) in the subsequent analysis.</p><p>Our first question was whether the tools would report consistent sets of differential peaks.</p><p>For both types of ChIP-seq data sets (sharp TF binding and broad histone modification enrichment), we observed considerable differences in the number of reported DR (<xref ref-type="fig" rid="bbv110-F1">Figure 1</xref>A and B). The sets of DR ranged from no detected differential peak (QChIPat) to about 150,000 DR for ODIN-poisson for the FoxA1 data set. Five of the methods had a relatively consistent number of DR, in the range of 25,000&#8211;35,000 peaks. Among the tools that were given the same set of predetermined regions using an external peak caller (MACS2 in this case), the number of DR does not show particular consistency, with MAnorm having about 23,000 DR and QChIPat only a handful, indicating that the number of input regions is not the primary determinant of the number of detected DR. Obviously, the number of DR depends on the choice of parameters, which we have chosen in a consistent way across tools. We were interested in determining how sensitive the number of peaks is on this choice. Hence, we have varied the threshold on the <italic>P</italic>-value or FDR, and recorded the number of DR (<xref ref-type="fig" rid="bbv110-F1">Figures 1</xref>C and <xref ref-type="fig" rid="bbv110-F2">2</xref>C). Surprisingly, the IROI tools from the single replicate pipeline show a step-like behavior, with a pronounced jump at small <italic>P</italic>-values, and a quasi saturation beyond this threshold. Other tools show a more progressive increase. Hence, the choice of <italic>P</italic>-value threshold is crucial for the first class of tools, as this number can vary abruptly by several orders of magnitude. As for the tools with a small number of DR (MMDiff, DBChIP), this number indeed increases when relaxing the threshold, but remains at a low level, much lower than other tools from the same class, indicating an intrinsic difference in the internal statistical procedure to call DR.
<fig id="bbv110-F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Overview of the DR called by the single and multi-replicate pipelines for the FoxA1 data set: (<bold>A</bold>) Number (barplots) and size distribution (violin plots) of detected DR in each condition and size distribution for the single replicate pipeline. (<bold>B</bold>) Same as shown in A for the multi-replicate pipeline. (<bold>C</bold>) Plots showing the number of DR returned by each method as a function of the <italic>P</italic>-value threshold (plain lines) or FDR (dotted lines). (<bold>D</bold>) An example of a region, highlighting the difference between the different tools in terms of length of DR. A colour version of this figure is available online at BIB online: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p></caption><graphic xlink:href="bbv110f1p"/></fig>
<fig id="bbv110-F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>Same as <xref ref-type="fig" rid="bbv110-F1">Figure 1</xref> for the H3K36me3 data set. A colour version of this figure is available online at BIB online: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p></caption><graphic xlink:href="bbv110f2p"/></fig>
</p><p>Whereas the total number of DR is subject to the choice of parameters, we expected that, beyond the amount of DR, the proportion in each condition should be consistent between the tools, showing, for example, systematically more DR in one direction. To our surprise, there was a lack of consistency in this respect, with four tools predicting a higher number of DR enriched in the vehicle condition compared with the estrogen-treated condition, while five tools predicted more DR enriched in the estrogen-treated condition. The naive approach based on the number of unique peaks predicts indeed more specific peaks in the treated condition, and hence, we tend to have greater confidence in the prediction of the five tools that confirm this tendency. Additionally, this is in accordance with the biological expectation, as it was previously reported that FoxA1 shows increased binding on estrogen treatment [<xref rid="bbv110-B20" ref-type="bibr">20</xref>].</p><p>The number of DR is related to the size of the reported regions: some tools might call a large number of small regions, while others would aggregate them into larger domains. Here also, we observe huge differences, related to the underlying method (<xref ref-type="fig" rid="bbv110-F1">Figure 1</xref>A and B, lower panel). Some tools report small regions, while others like diffReps or SICER identify large regions of up to 2 kb as being differentially enriched. While this might be realistic for histone modifications, it appears to be a clear overestimation of the real size in the case of TFs (<xref ref-type="fig" rid="bbv110-F1">Figure 1</xref>C). In particular, this overestimation implies that any subsequent analysis of enriched DNA motifs in the DR will be obscured by noise. Tools based on fixed windows approaches (diffReps, SICER,&#8230;) generally call broader regions, compared with the tools based on an initial peak calling step.</p><p>The tools included in the multi-replicate pipeline consistently report a much lower number of DR. diffReps, which can handle either single or multiple replicates, reports less than half of the DR in the multiple replicates setting, compared with the single replicate in which the data sets were pooled. Hence, the tools including the replicates appear to be much more conservative, at least with the default parameters we applied. Interestingly, all tools from the multi-replicate pipeline agree in predicting more peaks enriched in the estrogen-treated condition.</p><p>Despite the difference in the type of regions, the same observations hold true for the data sets for H3K36me3 (<xref ref-type="fig" rid="bbv110-F2">Figure 2</xref>), a histone modification characterized by broad domains of enrichment, especially in the gene body of transcribed genes, as well as for H3K27ac (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Figure S1</ext-link>), a mark associated with active regulatory regions. The length distribution is variable among tools, and for H3K36me3 does not reflect the size distribution of transcripts, as could have been anticipated for this histone mark. <xref ref-type="fig" rid="bbv110-F2">Figure 2</xref>D shows how different the lengths of DR are on the example of the HLX gene, indicating that the differential signal does not cover the whole transcript. The proportion of DR between the two conditions is not consistent either for both histone data sets, with some tools predicting more DR in one direction while other predict the opposite (<xref ref-type="fig" rid="bbv110-F2">Figure 2</xref>, <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Figure S1</ext-link>). PePr, for example, predicts a 12-fold higher number of peaks enriched in the NTKO condition, while diffBind predicts an 8-fold enrichment in the other direction.</p><p>Unlike the FoxA1 data set, in the H3K36me3 data set, the tools in the replicate pipeline do not agree regarding the number of enriched peaks in each condition. Both IROI tools (diffreps-nb and PePr) do agree, while the discrepancy is greater among the EROI tools, despite the fact that they were supplied the same set of regions. Surprisingly, the three algorithms implemented in diffBind yield contradictory results, which might be related to the different normalization approaches used by DESeq and edgeR. They do, however, agree for the H3K27ac data set, indicating that the broad signal of H3K36me3 enrichment represents a particular challenge to these tools.</p><p>Next, we asked to what extent the sets of DR were overlapping between tools. Given the broad range of DR sizes between tools described previously, it is not obvious to determine whether two peaks agree. Instead, we considered the genomic range covered by the peak sets of each algorithm.</p><p>We first determined the genomic regions covered by the union of all DR from all tools (differential genomic loci or DGL), and determined the coverage of these regions, i.e. the proportion that is covered by peaks from <italic>n</italic> tools. For FoxA1, 71% of the regions that have been called as differential by any tool arise from one single tool (<xref ref-type="fig" rid="bbv110-F3">Figure 3</xref>A). We call these regions &#8216;private DR', as they are specific to one single tool. Less than 14% of the total DGL is covered by two or more tools. These proportions are more or less consistent between the data sets, with between 71% and 80% of the DGL being private.
<fig id="bbv110-F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>Comparison of the sets of DR between tools for the FoxA1 E2 treatment condition (<bold>A</bold>) and H3K36me3 NTKO data sets (<bold>B</bold>). We consider the union of all regions determined as being differential by any of the tools, and determine which proportion is called by 1,2,&#8230; tools (upper barplot). For each tool, we determine which proportion of the differential genomic locus (DGL) is called by this tool alone, or corresponds to regions called by several tools (heatmap). We indicate the total size of the DGL as a barplot on the right. A colour version of this figure is available online at BIB online: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p></caption><graphic xlink:href="bbv110f3p"/></fig>
</p><p>Next, we wanted to determine whether a tool has a propensity to call private DR, or rather has a higher agreement with other tools. We therefore determined what proportion of the DGL of a given tool has coverage <italic>n</italic> (<xref ref-type="fig" rid="bbv110-F3">Figure 3</xref>B and D). We expect that tools that call many more DR than others will have a tendency to call more private peaks. Hence, we ordered the tools according to the size of the DGL. As anticipated, we observed that the tools with the largest DGL tend to call more private DR (e.g. for PePr, 41.6% of the DGL are specific to this tool). ODIN-binom calls few private DR, and shows a good agreement with other tools. On the other hand, more than two-thirds of the DR called by SICER on the FoxA1 Vehicle data set are private DR, which is related to the large size of the regions, and indicates that the fixed windows settings of SICER, even using parameters indicated for sharp transcription factors, are not adapted to detect accurately small-scale variations.</p><p>As a conclusion, we observe striking differences in the number and sizes of DR detected by the different tools, and inconsistencies in the direction of the differential enrichment. Tools based on multiple replicates call less DR, which seems to indicate that the proportion of false positives might be lower, however, possibly at the expense of the sensitivity. Also, these tools show a more progressive increase in the number of DR when relaxing the threshold, compared with the single-replicate tools, which have a sharp increase followed by a saturation. For data sets with broader signal, we observe a clear difference between tools calling a large number of small peaks (e.g. ODIN), and others that aggregate these into broader domains (e.g. RSEG or SICER), which better reflects the true signal.</p></sec><sec><title>Comparison using simulated data sets</title><p>As no golden standard is available apart from a limited number of qPCR-validated regions, no assessment of the rate of true/false positives can be made using real data sets. Hence, we simulated differential data sets. Several other studies have addressed the question of simulating ChIP-seq data sets [<xref rid="bbv110-B33" ref-type="bibr">33</xref>, <xref rid="bbv110-B34" ref-type="bibr">34</xref>]. These procedures have focused on simulating ChIP-seq data sets for transcription factors only, and they rely on a theoretical statistical model to describe the expected distribution of reads from a ChIP-seq experiment. To avoid biasing the benchmark toward one or the other tool, our simulation does no rely on a particular theoretical model of read distribution. Instead, we used real data sets as a basis for this simulation, and reasoned that the best ranking peaks identified by MACS2 most probably represent true binding/enriched regions. We therefore considered the 20,000 best ranking peaks, of which we downscaled 10,000 in a stepwise manner, while maintaining a set of 10,000 nondifferential binding events (see &#8216;Methods' section). These true binding events were merged with real input data sets, to ensure that no binding event occurs outside of the selected regions, while providing a realistic background (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Figures S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">S3</ext-link>). Hence, we can evaluate for each tool how many true/false positives/negatives have been detected.</p><p>In the ideal case, the tools should detect 10,000 DR. For the single replicate pipeline, ODIN-binom and SICER returned the largest number of DR for the FoxA1 simulated data set (<xref ref-type="fig" rid="bbv110-F4">Figure 4</xref>A). Given that ODIN outnumbered by far the other tools in the number of DR detected in the real FoxA1 data set, it is likely that the high recall rate of ODIN is at the expense of a high number of false positives. Indeed, both versions of ODIN had an important proportion of false positives. Both tools called &gt;300,000 DR, of which more than 95% are false positives. We believe that the HMM approach taken by ODIN renders it extremely sensitive to small fluctuations in the background, hence leading to many false-positive hits. On the other end of the scale, QChIPAT only returned a limited number of DR. As expected, most tools were able to detect at least partially the strongest differential peaks (100% down-sampling). HOMER only detected DR, which were down-sampled by &#8805;80%. This is likely owing to the additional filtering parameter implemented by HOMER, which requires a minimum fold-change (by default 4) in addition to a <italic>P</italic>-value cutoff to call differential peaks.
<fig id="bbv110-F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Proportion of true and false positives for each tool on the simulated FoxA1 data set (<bold>A</bold>, <bold>B</bold>) and H3K36me3 data set (<bold>C</bold>, <bold>D</bold>). The percentages in the legend indicate the level of downsampling performed. A colour version of this figure is available online at BIB online: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p></caption><graphic xlink:href="bbv110f4p"/></fig>
</p><p>For the multi-replicate pipeline, the ranking in the number of detected DR follows what has been observed in the real data set, with PePr detecting the largest number of regions, of which most are true positives, with a small fraction of false positives (<xref ref-type="fig" rid="bbv110-F4">Figure 4</xref>B). The different variants of the diffBind tool detected around 30% of the true DR, with no false positives, while all other tools had a high proportion of false negatives. This confirms our assumption of the first section, that the much lower number of DR from the tools in the replicate pipeline comes at the expense of a much reduced sensitivity. Considering the H3K36me3 simulation, the overall number of detected DR agreed with the real data set (<xref ref-type="fig" rid="bbv110-F4">Figures 4</xref>C, D and <xref ref-type="fig" rid="bbv110-F2">2</xref>), with ODIN-poisson showing the highest number of regions, followed by the two variants of diffReps. As expected previously, this comes at the expense of a high proportion of false positives, at least with our parameter settings. On the other hand, RSEG and SICER with the various settings show excellent performances with a high recall rate and a limited number of false positives. In the multi-replicate pipeline, the tools call a much lower number of peaks, corresponding to a high rate of false negatives, with two exceptions: diffReps-nb performs well on this simulation with a decent recall, whereas PePr calls many false positives.</p><p>As the number of regions returned by each tool depends on the parameter settings, we decided to compare the precision and recall of each tool at various stringency levels: for each tool, we selected the top 10, 50, 100, 250, 500, 750, 1000, 1500, 2000, 3000, 5000, 10,000 and all peaks, and computed the recall (i.e. the proportion of true differential peaks detected) and an adapted version of the precision, for which we computed the proportion of the total length of predicted DR that coincides with a true differential region. The rational of this Jaccard index (abbreviated JI in the following) is to avoid providing a biased advantage to those tools that tend to call large regions, which automatically increases the probability to hit a true differential region. For the single replicate tools on the simulated FoxA1 data set, we see that ODIN shows a good overall recall of above 75% when taking into account all peaks, but a low JI of 25% (<xref ref-type="fig" rid="bbv110-F5">Figure 5</xref>A). The best performing approach appears to be the naive approach based on the set of unique peaks between the two conditions. However, this results from a bias of our approach, which used MACS2 to define the initial set of 20,000 binding events, and used MACS2 again to determine the sets of peaks in both conditions in the simulated data set, hence giving an obvious advantage to this approach. Overall, SICER and MAnorm show a good trade-off between recall and JI; however, MAnorm also relies on MACS2 peaks and hence has an advantage in this simulation. Strikingly, most tools show a rapid drop in the JI with increasing sets of DR, indicating that even tools with a limited number of DR tend to overcall DR. The difference is striking for the multi-replicate pipeline (<xref ref-type="fig" rid="bbv110-F5">Figure 5</xref>B), where diffBind shows a perfect precision of 100% up to 2000 DR, before dropping as more peaks are included. Together with PePr, these are the only tools that achieve decent performance, and a relatively stable precision rate.
<fig id="bbv110-F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>JI (<italic>y</italic>-axis) and recall (<italic>x</italic>-axis) for the tools in the single replicate (left column) and multiple-replicate pipeline (right column) for the FoxA1 (<bold>A</bold>, <bold>B</bold>) and H3K36me3 (<bold>C</bold>, <bold>D</bold>) simulated data sets. We make the distinction between tools that require external regions of interest (EROI) and those that determine them internally (IROI). A colour version of this figure is available online at BIB online: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p></caption><graphic xlink:href="bbv110f5p"/></fig>
</p><p>The overall performances are better on the H3K36me3 data set (<xref ref-type="fig" rid="bbv110-F5">Figure 5</xref>C and D), with a high recall rate here and a reasonable JI. The higher average values of JI comes from the fact that the simulated regions are larger, and hence, they intersect a higher proportion of the predicted DR. Note that despite the higher number of false positives in PePr, the final JI is similar between diffReps-nb and PePr, when considering all DR, whereas PePr has a much higher JI when considering only the top 5000 peaks. This indicates that the false-positive peaks called by PePr are among the lower-ranking peaks, while the top peaks contain a high proportion of true positives.</p><p>In summary, our analysis on simulated data sets confirms that (1) the replicate tools have a higher rate of false negatives, but (2) fewer false positives, and that (3) most tool seem to perform better on the broad histone mark than on the sharp TF binding peaks.</p></sec><sec><title>Functional annotation</title><p>When comparing two biological conditions, one often aims at relating the observed changes to genes to obtain a functional interpretation of the conditions under study, in terms of enriched functional categories. This is particularly the case when performing differential expression analysis based on transcriptome data, and a plethora of tools have been developed to turn lists of DEGs into functional categories or pathways mostly affected by the changes. In the case of ChIP-seq, similar questions can be asked, by looking at genes that are potentially affected by differential binding sites or enriched regions, thus generating biological hypothesis about affected biological processes. Assigning a gene to a genomic region, however, introduces an additional uncertainty, as regulatory regions, for example, can act over large distance [<xref rid="bbv110-B35" ref-type="bibr">35</xref>]. Various approaches have been proposed to make the assignment more accurate, based e.g. on published interaction data sets or looking at the correlation between the ChIP signal and the expression of surrounding genes [<xref rid="bbv110-B36" ref-type="bibr">36&#8211;38</xref>]. However, we still expect that for most of the cases, relating a differential peak to the closest gene(s) will be a reasonable proxy, especially if the differential region lies close to gene promoters. If expression data are available for the same condition, one can compare the two differential data sets (expression and ChIP binding/enrichment) and validate to what extent the biological interpretation based on differential expression and differential enrichment are compatible. In this section, we used the DR obtained in the first section, and performed functional enrichment of the detected regions for each of the tools. This adds an additional layer of validation. Indeed, irrespective of whether DR overlap, if they lie in proximity to the same genes, the biological interpretation will be similar. We made the assumption that FoxA1 represents a transcriptional activator, hence the direction of the differential ChIP enrichment and the differential expression should be the same.</p><p>First, we checked if the DEGs can be recovered from the DR. As a negative control, we used housekeeping genes (HKG) that are not differentially expressed. For each tool, we ranked the DR according to their significance, and assigned to each DR the closest gene, up to 1000 genes. Using these rankings, we computed the enrichment of DEG versus HKG using a NES, which represents a normalized version of the AUC (see &#8216;Methods' section). We compared the performance of the tools with a naive approach, consisting in ranking the genes according to their log-fold enrichment on the gene body (H3K36me3) or on the promoter (FoxA1 and H3K27ac). The results are shown in <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Figure S4</ext-link> for the FoxA1,H3K36me3 and H3K27ac data sets. As noticed previously, some tools have a low number of DR and therefore associate to a small number of genes. Overall, most of the tools show a good performance in recovering DEG from DR for FoxA1, better than the naive approach based on promoter enrichment alone, possibly reflecting the fact that FoxA1 also binds outside of promoters and acts over longer distances. Somewhat unexpectedly, the results are worse for the H3K36me3 data set, especially for DR enriched in the TKO condition. Here, the tools from the single-replicate pipeline show particularly poor performance, as can be seen from the small difference in NES score between the DEG and the HKGs. Most tools, however, perform better than the naive approach, which seems to indicate that small differences in the enrichment, possibly restricted to a portion of the transcript, are better captured by the tools. For H3K27ac, the performance of most tools is good, with some unexpected behaviors: for one of the conditions, we note again the difference between the DESeq, DESeq2 and edgeR algorithms implemented in diffBind, possibly reflecting the different normalizations applied and the greater stringency of the original DESeq algorithm.</p><p>Next, we asked whether the sets of DR would lead to similar biological interpretations. For each method, as previously, we selected the first 1000 genes that were nearby a DR (DR were ordered by decreasing significance). We submitted the promoters of these genes to GREAT, and collected for each tool the top 3 enriched functional terms, and displayed the union of these terms over all tools in a heatmap. As a gold standard, we also performed the same analysis using the set of DEGs, by submitting their promoter to GREAT.</p><p>Comparing the output for each set of tool (<xref ref-type="fig" rid="bbv110-F6">Figure 6</xref>A and B), we observe a good consistency between the tools for some terms such as &#8216;response to hormone stimulus', which is also found among the DEG. Most tools indeed show enrichment for these terms, except the tools from the single-replicate/EROI group (Manorm, QChIPat) and PePr.For QChIPat, and this can be explained by the low number of DR and hence the small set of affected genes. The functional enrichments obtained from the DR do not necessarily correspond to the terms obtained from the DEG, with, for example, &#8216;epithelial cell development' being highly enriched among the DR of many tools, but showing only a minor enrichment among the DEG. Given that FoxA1 has been described as being involved in epithelial lung cell differentiation [<xref rid="bbv110-B39" ref-type="bibr">39</xref>], the presence of this term makes sense in this context. It is striking that the approaches from the single replicate with external regions of interest show a clear depletion in enrichments; while this can be explained by the small number of DR returned by QChIPat, this is more surprising for MAnorm. It also highlights that the naive approach based on taking the unique peaks in each condition also fails to find most of the interesting functional enrichments.
<fig id="bbv110-F6" orientation="portrait" position="float"><label>Figure 6.</label><caption><p>Functional enrichment obtained by a GREAT analysis on the sets of DR and using the promoters of the DEG as a baseline. Shown heatmaps are based on DR derived from FoxA1 E2- and Veh-treated data sets. Stars indicate tools for which &lt;1000 genes were available in either condition. The arrows highlight terms discussed in the text. A colour version of this figure is available online at BIB online: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p></caption><graphic xlink:href="bbv110f6p"/></fig>
</p></sec></sec><sec><title>Discussion and conclusion</title><p>We have performed a comprehensive comparison of a large number of tools developed for the detection of differentially enriched regions from ChIP-seq experiments. As ChIP-seq is a widely applicable method and can target many transcription factors or epigenetic modifications, the type of signal is diverse, and makes the detection of DR a challenging task. Hence, we would not expect that these tools be universally applicable to any type of ChIP-seq, from transcription factor ChIP to broad histone modifications such as H3K36me3 or H3K27me3. Indeed, several of the tools we have included in this study have been specifically designed for either of these data sets; MultiGPS, for example, is specifically designed for transcription factors, while tools such as diffReps or RSEG have been developed to detect differential histone modifications and indeed show poor performances on the transcription factor data set. Hence, these tools cannot be used universally. On the other hand, most other tools appear to be applicable in both cases, in particular if an external set of regions of interest is provided. We have summarized in <xref ref-type="fig" rid="bbv110-F7">Figure 7</xref> and <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplemental Table S1</ext-link> the main characteristics of the tools, and this can be used as a guide for selection of a tool specifically suited for a particular application.
<fig id="bbv110-F7" orientation="portrait" position="float"><label>Figure 7.</label><caption><p>Decision tree indicating the proper choice of tool depending on the data set: shape of the signal (sharp peaks or broad enrichments), presence of replicates and presence of an external set of regions of interest. We have indicated in dark the name of the tools that give good results using default settings, and in gray the tools that would require parameter tuning to achieve optimal results: some tools suffer from an excessive number of DR (PePr, ODIN-pois), an insufficient number of DR (QChIPat, MMDiff, DBChIP) or from an imprecise definition of the DR for sharp signal (SICER, diffReps-nb). *MultiGPS has been explicitly developed for transcription factor ChIP-seq.</p></caption><graphic xlink:href="bbv110f7p"/></fig>
</p><p>The proper choice of the algorithm also depends on the types of questions: if the study is primarily gene centric, i.e. aims at identifying genes in the vicinity of the DR to derive a biological interpretation based on the annotation of the genes, the tools offer rather consistent results, as is shown from the recovery analysis of DEG and the analysis of term enrichments using tools such as GREAT. On the other hand, if one is more interested in chromatin organization and dynamics on treatment, and focuses on the properties of the differential enriched regions (such as size, exact localization, etc&#8230;), then the differences in the tools will have a huge impact on the results. Similarly, any analysis that focuses on enriched motifs within the DR is also sensitive to the proper definition of the DR, as any over-estimation of the size of the DR will decrease the signal-to-noise ratio and result in less accurate motif inference. For example, SICER, even with the parameters recommended for TF binding, yields large regions, which might introduce a high level of noise for motif analysis. A similar problem arises in single-condition peak calling for ChIP-seq, for which differences in peak properties impact the accuracy of motif discovery.</p><p>Each tool involves several ad hoc filtering steps, with the number of tunable parameters being often substantial. In this analysis, scanning the full parameter space for all tools over all data sets was beyond our scope. Of course, we cannot exclude that some results would have differed if, for example, the developers of the individual tools would have optimized the parameters using their insight knowledge of their own tool. <xref ref-type="fig" rid="bbv110-F1">Figures 1</xref>C and <xref ref-type="fig" rid="bbv110-F2">2</xref>C show that the number of DR is more or less sensitive to the choice of threshold, which should be taken into account when using one or the other tool. This type of comparative studies is for example applied in the DREAM challenges or in a motif discovery benchmark [<xref rid="bbv110-B40" ref-type="bibr">40</xref>]. As we had no bias toward any of the analyzed tools, we reasoned that a moderately expert user would most likely rely on the recommendations and default parameters suggested by the developers in the documentation of the tool. Hence, we took this approach to determine the parameters that should be applied, and believe that this represents a fair option for an unbiased comparison. For example, some tools did report a limited number of DR. This is probably a consequence of our parameter choice, and different results would probably have been obtained using other values. However, this also indicates that these tools do require optimization, and cannot be used with the standard settings, whereas others give reasonable results &#8216;out-of-the-box' (<xref ref-type="fig" rid="bbv110-F7">Figure 7</xref>).</p><p>In the workflow from bam files down to list of DR, several steps have a strong impact on the results: first, the tools differ in their approach to define the regions to test for differential enrichment. We can broadly categorize them into three categories, with the exception of MultiGPS: (1) the tools that rely on an external set of regions provided by the user, generally based on the output of a peak caller algorithm, (2) the tools that use a fixed window-based approach to compare enrichments, and (3) the tools that implement a hidden-Markov approach. Another crucial point is the normalization of the data sets, either treatment versus control or both treated data set against each other. As indicated in <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary Table S1</ext-link>, the tools use different normalization strategies, from the simple library size normalization to more sophisticated approaches such as the SES method. Recently, a publication has compared the impact of normalization schemes on different data sets and shown differences especially when data sets are based on genomes with chromosomal aberrations [<xref rid="bbv110-B41" ref-type="bibr">41</xref>]. Most tools presented in this study are based on normalization methods initially developed for gene expression analysis with the underlying assumption that only a small number of regions are truly differential. However, this is not suitable in case of global epigenome changes, e.g. owing to inhibition of epigenetic enzymes. Therefore, a number of ChIP-seq protocols are now being published using as internal experimental control a spiking-in of a known amount of chromatin from a different species (<italic>D</italic><italic>rosophila melanogaster</italic> or <italic>M</italic><italic>us </italic><italic>musculus</italic>) [<xref rid="bbv110-B42" ref-type="bibr">42</xref>, <xref rid="bbv110-B43" ref-type="bibr">43</xref>]. This internal reference allows to precisely determine a sample-specific normalization factor and therefore enables a more robust genome-wide quantitative comparison across samples.</p><p>However, in our comparison, the largest difference comes from the availability of replicates. Tools that handle replicates call a much smaller number of DR, and achieve a much better precision, yet at the expense of the recall. Importantly, if multiple replicates are available, they should be considered independently using one of the multiple replicate tools, rather than pooled, as the level of false positives is generally much lower for this category, owing to the implementation of robust statistical tests. In the absence of replicates, the user should be aware that most tools in the single replicate category require extensive parameter fine-tuning to achieve a good trade-off between precision and recall.</p><p>According to our results, it is crucial to generate replicate ChIP-seq data sets when looking for differential enrichment, as is now an established procedure when looking for DEGs from RNA-seq data, to achieve a sufficient specificity.</p><p>Note that we have not here addressed the question of comparing multiple conditions, as none of the tools presented here allow this type of analysis. For that, novel methods need to be developed, for example, based on an ANOVA testing of variable regions [<xref rid="bbv110-B44" ref-type="bibr">44</xref>].</p><p>In conclusion, our study highlights the general lack of consistency between the tools considered here, in terms of number and location of DR. Depending on the biological focus, this might yield substantially different interpretations. We therefore recommend to use and compare several of these tools to obtain a confident consensus set of DR, but most importantly our study highlights the importance of generating biological replicates for ChIP-seq, like what has become standard practice for RNA-seq.</p><p><boxed-text id="bbv110-BOX1" position="float" orientation="portrait"><caption><p>Key Points</p></caption><p>
<list list-type="bullet"><list-item><p>Tools for differential ChIP-seq analysis show important differences in the number and size of detected differential regions (DR).</p></list-item><list-item><p>Methods taking into account replicates appear to be more robust than those handling single replicate data sets.</p></list-item><list-item><p>Inconsistent sets of DR will affect results based on sequence analysis, like detection of enriched transcription factor binding sites.</p></list-item><list-item><p>However, analysis of functional enrichments based on neighboring genes appears to be more robust.</p></list-item><list-item><p>Some tools give good results with default parameters, like ChIPComp or diffBind when replicates are available, or MAnorm, Homer, macs2bdgdiff and RSEG with single replicates. The other tools would require more extensive fine-tuning of parameters to achieve satisfactory results.</p></list-item></list>
</p></boxed-text></p></sec><sec sec-type="supplementary-material"><title>Supplementary Data</title><p><ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv110/-/DC1">Supplementary data</ext-link> are available online at <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bib">https://academic.oup.com/bib</ext-link>.</p>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>Supplementary Data</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_17_6_953__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_bbv110_suppl_data.zip"/>
</supplementary-material>
</sec></body><back><ack><title>Acknowledgments</title><p>We thank Karsten Rippe and Jan-Phillip Mallm for discussions, and Morgane Thomas-Chollier for comments on the manuscript.</p></ack><bio id="d35e37"><p><bold>Sebastian Steinhauser</bold> is a master's student in the Cancer Regulatory Genomics group headed by Carl Herrmann in the Division of Theoretical Bioinformatics, DKFZ, Heidelberg, Germany.</p></bio><bio id="d35e48"><p><bold>Nils Kurzawa</bold> is a master's student in the Cancer Regulatory Genomics group headed by Carl Herrmann in the Division of Theoretical Bioinformatics, DKFZ, Heidelberg, Germany.</p></bio><bio id="d35e59"><p><bold>Roland Eils</bold> is Professor at the Institute for Pharmacy and Molecular Biotechnologies, University Heidelberg, and Head of the Division of Theoretical Bioinformatics at the DKFZ, Heidelberg.</p></bio><bio id="d35e70"><p><bold>Carl Herrmann</bold> is assistant professor at the Institute for Pharmacy and Molecular Biotechnologies, University Heidelberg, and heads the Cancer Regulatory Genomics group in the Division of Theoretical Bioinformatics, DKFZ, Heidelberg.</p></bio><sec><title>Funding</title><p>Funding for open access charge: DKFZ internal funding.</p></sec><ref-list><title>References</title><ref id="bbv110-B1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Landt</surname><given-names>SG</given-names></name><name><surname>Marinov</surname><given-names>GK</given-names></name><name><surname>Kundaje</surname><given-names>A</given-names></name><etal/></person-group>
<article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Res</source>
<year>2012</year>;<volume>22</volume>:<fpage>1813</fpage>&#8211;<lpage>31</lpage>.<pub-id pub-id-type="pmid">22955991</pub-id></mixed-citation></ref><ref id="bbv110-B2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Negre</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><etal/></person-group>
<article-title>Systematic evaluation of factors influencing ChIP-seq fidelity</article-title>. <source>Nat Methods</source>
<year>2012</year>;<volume>9</volume>:<fpage>1</fpage>&#8211;<lpage>9</lpage>.<pub-id pub-id-type="pmid">22312634</pub-id></mixed-citation></ref><ref id="bbv110-B3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diaz</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>K</given-names></name><name><surname>Lim</surname><given-names>DA</given-names></name><etal/></person-group>
<article-title>Normalization, bias correction, and peak calling for ChIP-seq</article-title>. <source>Stat Appl Genet Mol Biol</source>
<year>2012</year>;<volume>11</volume>:<fpage>Article 9</fpage>.</mixed-citation></ref><ref id="bbv110-B4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>K</given-names></name><name><surname>Keles</surname><given-names>S</given-names></name></person-group>
<article-title>Normalization of ChIP-seq data with control</article-title>. <source>BMC Bioinformatics</source>
<year>2012</year>;<volume>13</volume>:<fpage>199</fpage>.<pub-id pub-id-type="pmid">22883957</pub-id></mixed-citation></ref><ref id="bbv110-B5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Brown</surname><given-names>JB</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><etal/></person-group>
<article-title>Measuring reproducibility of high-throughput experiments</article-title>. <source>Ann Appl Stat</source>
<year>2006</year>;<volume>5</volume>:<fpage>1752</fpage>&#8211;<lpage>79</lpage>.</mixed-citation></ref><ref id="bbv110-B6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zang</surname><given-names>C</given-names></name><name><surname>Schones</surname><given-names>DE</given-names></name><name><surname>Zeng</surname><given-names>C</given-names></name><etal/></person-group>
<article-title>A clustering approach for identification of enriched domains from histone modification ChIP-Seq data</article-title>. <source>Bioinformatics</source>
<year>2009</year>;<volume>25</volume>:<fpage>1952</fpage>&#8211;<lpage>8</lpage>.<pub-id pub-id-type="pmid">19505939</pub-id></mixed-citation></ref><ref id="bbv110-B7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Qin</surname><given-names>ZS</given-names></name><etal/></person-group>
<article-title>A novel statistical method for quantitative comparison of multiple ChIP-seq datasets</article-title>. <source>Bioinformatics</source>
<year>2015</year>;<volume>31</volume>:<fpage>1889</fpage>&#8211;<lpage>96</lpage>.<pub-id pub-id-type="pmid">25682068</pub-id></mixed-citation></ref><ref id="bbv110-B8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahony</surname><given-names>S</given-names></name><name><surname>Edwards</surname><given-names>MD</given-names></name><name><surname>Mazzoni</surname><given-names>EO</given-names></name><etal/></person-group>
<article-title>An Integrated model of multiple-condition ChIP-seq data reveals predeterminants of Cdx2 binding</article-title>. <source>PLoS Comput Biol</source>
<year>2014</year>;<volume>10</volume>:<fpage>e1003501</fpage>.<pub-id pub-id-type="pmid">24675637</pub-id></mixed-citation></ref><ref id="bbv110-B9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>K</given-names></name><name><surname>Keles</surname><given-names>S</given-names></name></person-group>
<article-title>Detecting differential binding of transcription factors with chiP-seq</article-title>. <source>Bioinformatics</source>
<year>2012</year>;<volume>28</volume>:<fpage>121</fpage>&#8211;<lpage>2</lpage>.<pub-id pub-id-type="pmid">22057161</pub-id></mixed-citation></ref><ref id="bbv110-B10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allhoff</surname><given-names>M</given-names></name><name><surname>Sere</surname><given-names>K</given-names></name><name><surname>Chauvistre</surname><given-names>H</given-names></name><etal/></person-group>
<article-title>Detecting differential peaks in ChIP-seq signals with ODIN</article-title>. <source>Bioinformatics</source>
<year>2014</year>;<volume>30</volume>:<fpage>3467</fpage>&#8211;<lpage>75</lpage>.<pub-id pub-id-type="pmid">25371479</pub-id></mixed-citation></ref><ref id="bbv110-B11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross-Innes</surname><given-names>CS</given-names></name><name><surname>Stark</surname><given-names>R</given-names></name><name><surname>Teschendorff</surname><given-names>AE</given-names></name><etal/></person-group>
<article-title>Differential oestrogen receptor binding is associated with clinical outcome in breast cancer</article-title>. <source>Nature</source>
<year>2012</year>;<volume>481</volume>:<fpage>389</fpage>&#8211;<lpage>93</lpage>.<pub-id pub-id-type="pmid">22217937</pub-id></mixed-citation></ref><ref id="bbv110-B12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>L</given-names></name><name><surname>Shao</surname><given-names>N-YY</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><etal/></person-group>
<article-title>diffReps: detecting differential chromatin modification sites from ChIP-seq data with biological replicates</article-title>. <source>PLoS One</source>
<year>2013</year>;<volume>8</volume>:<fpage>e65598</fpage>.<pub-id pub-id-type="pmid">23762400</pub-id></mixed-citation></ref><ref id="bbv110-B13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Q</given-names></name><name><surname>Smith</surname><given-names>AD</given-names></name></person-group>
<article-title>Identifying dispersed epigenomic domains from ChIP-Seq data</article-title>. <source>Bioinformatics</source>
<year>2011</year>;<volume>27</volume>:<fpage>870</fpage>&#8211;<lpage>1</lpage>.<pub-id pub-id-type="pmid">21325299</pub-id></mixed-citation></ref><ref id="bbv110-B14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shao</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name><etal/></person-group>
<article-title>MAnorm: a robust model for quantitative comparison of ChIP-Seq data sets</article-title>. <source>Genome Biol</source>
<year>2012</year>;<volume>13</volume>:<fpage>R16</fpage>.<pub-id pub-id-type="pmid">22424423</pub-id></mixed-citation></ref><ref id="bbv110-B15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schweikert</surname><given-names>G</given-names></name><name><surname>Cseke</surname><given-names>B</given-names></name><name><surname>Clouaire</surname><given-names>T</given-names></name><etal/></person-group>
<article-title>MMDiff: quantitative testing for shape changes in ChIP-Seq data sets</article-title>. <source>BMC Genomics</source>
<year>2013</year>;<volume>14</volume>:<fpage>826</fpage>.<pub-id pub-id-type="pmid">24267901</pub-id></mixed-citation></ref><ref id="bbv110-B16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Meyer</surname><given-names>CA</given-names></name><etal/></person-group>
<article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>
<year>2008</year>;<volume>9</volume>:<fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation></ref><ref id="bbv110-B17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Lin</surname><given-names>Y-H</given-names></name><name><surname>Johnson</surname><given-names>TD</given-names></name><etal/></person-group>
<article-title>PePr: a peak-calling prioritization pipeline to identify consistent or differential peaks from replicated ChIP-Seq data</article-title>. <source>Bioinformatics</source>
<year>2014</year>;<volume>30</volume>:<fpage>2568</fpage>&#8211;<lpage>75</lpage>.<pub-id pub-id-type="pmid">24894502</pub-id></mixed-citation></ref><ref id="bbv110-B18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Yi</surname><given-names>J</given-names></name><name><surname>Sv</surname><given-names>A</given-names></name><etal/></person-group>
<article-title>QChIPat: a quantitative method to identify distinct binding patterns for two biological ChIP-seq samples in different experimental conditions</article-title>. <source>BMC Genomics</source>
<year>2013</year>;<volume>14</volume> (<issue>Suppl 8</issue>):<fpage>S3</fpage>.</mixed-citation></ref><ref id="bbv110-B19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinz</surname><given-names>S</given-names></name><name><surname>Benner</surname><given-names>C</given-names></name><name><surname>Spann</surname><given-names>N</given-names></name><etal/></person-group>
<article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>. <source>Mol Cell</source>
<year>2010</year>;<volume>38</volume>:<fpage>576</fpage>&#8211;<lpage>89</lpage>.<pub-id pub-id-type="pmid">20513432</pub-id></mixed-citation></ref><ref id="bbv110-B20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franco</surname><given-names>HL</given-names></name><name><surname>Nagari</surname><given-names>A</given-names></name><name><surname>Kraus</surname><given-names>WL</given-names></name></person-group>
<article-title>TNF<italic>&#945;</italic> signaling exposes latent estrogen receptor binding sites to alter the breast cancer cell transcriptome</article-title>. <source>Mol Cell</source>
<year>2015</year>;<volume>58</volume>:<fpage>21</fpage>&#8211;<lpage>34</lpage>.<pub-id pub-id-type="pmid">25752574</pub-id></mixed-citation></ref><ref id="bbv110-B21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>W</given-names></name><name><surname>Schultz</surname><given-names>MD</given-names></name><name><surname>Lister</surname><given-names>R</given-names></name><etal/></person-group>
<article-title>Epigenomic analysis of multilineage differentiation of human embryonic stem cells</article-title>. <source>Cell</source>
<year>2013</year>;<volume>153</volume>:<fpage>1134</fpage>&#8211;<lpage>48</lpage>.<pub-id pub-id-type="pmid">23664764</pub-id></mixed-citation></ref><ref id="bbv110-B22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popovic</surname><given-names>R</given-names></name><name><surname>Martinez-Garcia</surname><given-names>E</given-names></name><name><surname>Giannopoulou</surname><given-names>EG</given-names></name><etal/></person-group>
<article-title>Histone Methyltransferase MMSET/NSD2 alters EZH2 binding and reprograms the myeloma epigenome through global and focal changes in H3K36 and H3K27 methylation</article-title>. <source>PLoS Genet</source>
<year>2014</year>;<volume>10</volume>:<fpage>e1004566</fpage>.<pub-id pub-id-type="pmid">25188243</pub-id></mixed-citation></ref><ref id="bbv110-B23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group>
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>&#8211;<lpage>60</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation></ref><ref id="bbv110-B24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Meyer</surname><given-names>CA</given-names></name><etal/></person-group>
<article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>
<year>2008</year>;<volume>9</volume>:<fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation></ref><ref id="bbv110-B25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hah</surname><given-names>N</given-names></name><name><surname>Danko</surname><given-names>CG</given-names></name><name><surname>Core</surname><given-names>L</given-names></name><etal/></person-group>
<article-title>A rapid, extensive, and transient transcriptional response to estrogen signaling in breast cancer cells</article-title>. <source>Cell</source>
<year>2011</year>;<volume>145</volume>:<fpage>622</fpage>&#8211;<lpage>34</lpage>.<pub-id pub-id-type="pmid">21549415</pub-id></mixed-citation></ref><ref id="bbv110-B26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group>
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>
<year>2010</year>;<volume>26</volume>:<fpage>139</fpage>&#8211;<lpage>40</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation></ref><ref id="bbv110-B27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>L-G</given-names></name><name><surname>He</surname><given-names>Q-Y</given-names></name></person-group>
<article-title>ChIPseeker: an R/Bioconductor package for ChIP peak annotation, comparison and visualization</article-title>. <source>Bioinformatics</source>
<year>2015</year>;<volume>31</volume>:<fpage>2382</fpage>&#8211;<lpage>3</lpage>.<pub-id pub-id-type="pmid">25765347</pub-id></mixed-citation></ref><ref id="bbv110-B28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLean</surname><given-names>CY</given-names></name><name><surname>Bristor</surname><given-names>D</given-names></name><name><surname>Hiller</surname><given-names>M</given-names></name><etal/></person-group>
<article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>. <source>Nat Biotechnol</source>
<year>2010</year>;<volume>28</volume>:<fpage>495</fpage>&#8211;<lpage>501</lpage>.<pub-id pub-id-type="pmid">20436461</pub-id></mixed-citation></ref><ref id="bbv110-B29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ram&#237;rez</surname><given-names>F</given-names></name><name><surname>D&#252;ndar</surname><given-names>F</given-names></name><name><surname>Diehl</surname><given-names>S</given-names></name><etal/></person-group>
<article-title>DeepTools: a flexible platform for exploring deep-sequencing data</article-title>. <source>Nucleic Acids Res</source>
<year>2014</year>;<volume>42</volume>.</mixed-citation></ref><ref id="bbv110-B30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonhoure</surname><given-names>N</given-names></name><name><surname>Bounova</surname><given-names>G</given-names></name><name><surname>Bernasconi</surname><given-names>D</given-names></name><etal/></person-group>
<article-title>Quantifying ChIP-seq data: A spiking method providing an internal reference for sample-to-sample normalization</article-title>. <source>Genome Res</source>
<year>2014</year>;<volume>24</volume>:<fpage>1157</fpage>&#8211;<lpage>68</lpage>.<pub-id pub-id-type="pmid">24709819</pub-id></mixed-citation></ref><ref id="bbv110-B31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group>
<article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>
<year>2010</year>;<volume>26</volume>:<fpage>841</fpage>&#8211;<lpage>2</lpage>.<pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation></ref><ref id="bbv110-B32"><label>32</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Pag&#232;s</surname><given-names>H</given-names></name><etal/></person-group>
<article-title>Software for computing and annotating genomic ranges</article-title>. <source>PLoS Comput Biol</source>
<year>2013</year>;<volume>9</volume>:<fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id></mixed-citation></ref><ref id="bbv110-B33"><label>33</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>ZD</given-names></name><name><surname>Rozowsky</surname><given-names>J</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name><etal/></person-group>
<article-title>Modeling ChIP sequencing in silico with applications</article-title>. <source>PLoS Comput Biol</source>
<year>2008</year>;<volume>4</volume>;<fpage>e1000158</fpage>.<pub-id pub-id-type="pmid">18725927</pub-id></mixed-citation></ref><ref id="bbv110-B34"><label>34</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humburg</surname><given-names>P</given-names></name></person-group>
<source>ChIPsim: Simulation of ChIP-seq experiments</source>. <year>2011</year>, <comment>R package version 1.24.0</comment>.</mixed-citation></ref><ref id="bbv110-B35"><label>35</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Ruan</surname><given-names>X</given-names></name><name><surname>Auerbach</surname><given-names>RK</given-names></name><etal/></person-group>
<article-title>Extensive promoter-centered chromatin interactions provide a topological basis for transcription regulation</article-title>. <source>Cell</source>
<year>2012</year>;<volume>148</volume>:<fpage>84</fpage>&#8211;<lpage>98</lpage>.<pub-id pub-id-type="pmid">22265404</pub-id></mixed-citation></ref><ref id="bbv110-B36"><label>36</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname><given-names>JR</given-names></name><name><surname>Selvaraj</surname><given-names>S</given-names></name><name><surname>Yue</surname><given-names>F</given-names></name><etal/></person-group>
<article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>
<year>2012</year>;<volume>485</volume>:<fpage>376</fpage>&#8211;<lpage>80</lpage>.<pub-id pub-id-type="pmid">22495300</pub-id></mixed-citation></ref><ref id="bbv110-B37"><label>37</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Teng</surname><given-names>L</given-names></name><etal/></person-group>
<article-title>Global view of enhancer-promoter interactome in human cells</article-title>. <source>Proc Natl Acad Sci USA</source>
<year>2014</year>;<volume>111</volume>:<fpage>E2191</fpage>&#8211;<lpage>9</lpage>.<pub-id pub-id-type="pmid">24821768</pub-id></mixed-citation></ref><ref id="bbv110-B38"><label>38</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurman</surname><given-names>RE</given-names></name><name><surname>Rynes</surname><given-names>E</given-names></name><name><surname>Humbert</surname><given-names>R</given-names></name><etal/></person-group>
<article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source>
<year>2012</year>;<volume>489</volume>:<fpage>75</fpage>&#8211;<lpage>82</lpage>.<pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation></ref><ref id="bbv110-B39"><label>39</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshimi</surname><given-names>T</given-names></name><name><surname>Nakamura</surname><given-names>N</given-names></name><name><surname>Shimada</surname><given-names>S</given-names></name><etal/></person-group>
<article-title>Homeobox B3, FoxA1 and FoxA2 interactions in epithelial lung cell differentiation of the multipotent M3E3/C3 cell line</article-title>. <source>Eur J Cell Biol</source>
<year>2005</year>;<volume>84</volume>:<fpage>555</fpage>&#8211;<lpage>66</lpage>.<pub-id pub-id-type="pmid">16003909</pub-id></mixed-citation></ref><ref id="bbv110-B40"><label>40</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tompa</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Bailey</surname><given-names>TL</given-names></name><etal/></person-group>
<article-title>Assessing computational tools for the discovery of transcription factor binding sites</article-title>. <source>Nat Biotechnol</source>
<year>2005</year>;<volume>23</volume>:<fpage>137</fpage>&#8211;<lpage>44</lpage>.<pub-id pub-id-type="pmid">15637633</pub-id></mixed-citation></ref><ref id="bbv110-B41"><label>41</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D-Y</given-names></name><name><surname>Bittencourt</surname><given-names>D</given-names></name><name><surname>Stallcup</surname><given-names>MR</given-names></name><etal/></person-group>
<article-title>Identifying differential transcription factor binding in ChIP-seq</article-title>. <source>Front Genet</source>
<year>2015</year>;<volume>6</volume>:<fpage>1</fpage>&#8211;<lpage>11</lpage>.<pub-id pub-id-type="pmid">25674101</pub-id></mixed-citation></ref><ref id="bbv110-B42"><label>42</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonhoure</surname><given-names>N</given-names></name><name><surname>Bounova</surname><given-names>G</given-names></name><name><surname>Bernasconi</surname><given-names>D</given-names></name><etal/></person-group>
<article-title>Quantifying ChIP-seq data: a spiking method providing an internal reference for sample-to-sample normalization</article-title>. <source>Genome Res</source>
<year>2014</year>;<volume>24</volume>:<fpage>1157</fpage>&#8211;<lpage>68</lpage>.<pub-id pub-id-type="pmid">24709819</pub-id></mixed-citation></ref><ref id="bbv110-B43"><label>43</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orlando</surname><given-names>DA</given-names></name><name><surname>Chen</surname><given-names>MW</given-names></name><name><surname>Brown</surname><given-names>VE</given-names></name><etal/></person-group>
<article-title>Quantitative ChIP-Seq normalization reveals global modulation of the epigenome</article-title>. <source>Cell Rep</source>
<year>2014</year>;<volume>9</volume>:<fpage>1163</fpage>&#8211;<lpage>70</lpage>.<pub-id pub-id-type="pmid">25437568</pub-id></mixed-citation></ref><ref id="bbv110-B44"><label>44</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kasowski</surname><given-names>M</given-names></name><name><surname>Kyriazopoulou-Panagiotopoulou</surname><given-names>S</given-names></name><name><surname>Grubert</surname><given-names>F</given-names></name><etal/></person-group>
<article-title>Extensive variation in chromatin states across humans</article-title>. <source>Science</source>
<year>2013</year>;<volume>342</volume>:<fpage>750</fpage>&#8211;<lpage>2</lpage>.<pub-id pub-id-type="pmid">24136358</pub-id></mixed-citation></ref></ref-list></back></article>