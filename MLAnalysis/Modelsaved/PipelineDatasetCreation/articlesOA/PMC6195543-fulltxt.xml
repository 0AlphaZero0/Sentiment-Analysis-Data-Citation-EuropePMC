<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6195543</article-id><article-id pub-id-type="publisher-id">6867</article-id><article-id pub-id-type="doi">10.1038/s41467-018-06867-x</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Mutational interactions define novel cancer subgroups</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Kuipers</surname><given-names>Jack</given-names></name><address><email>jack.kuipers@bsse.ethz.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Thurnherr</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2739-0454</contrib-id><name><surname>Moffa</surname><given-names>Giusi</given-names></name><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Suter</surname><given-names>Polina</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Behr</surname><given-names>Jonas</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Goosen</surname><given-names>Ryan</given-names></name><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Christofori</surname><given-names>Gerhard</given-names></name><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0573-6119</contrib-id><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name><address><email>niko.beerenwinkel@bsse.ethz.ch</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution>Department of Biosystems Science and Engineering, </institution><institution>ETH Zurich, </institution></institution-wrap>4058 Basel, Switzerland </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution>SIB Swiss Institute of Bioinformatics, </institution></institution-wrap>1015 Lausanne, Switzerland </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000121901201</institution-id><institution-id institution-id-type="GRID">grid.83440.3b</institution-id><institution>Division of Psychiatry, </institution><institution>University College London, </institution></institution-wrap>London WC1E 6BT, UK </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.410567.1</institution-id><institution>Institute for Clinical Epidemiology and Biostatistics, </institution><institution>University Hospital Basel, </institution></institution-wrap>4031 Basel, Switzerland </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0642</institution-id><institution-id institution-id-type="GRID">grid.6612.3</institution-id><institution>Department of Biomedicine, </institution><institution>University of Basel, </institution></institution-wrap>4058 Basel, Switzerland </aff></contrib-group><pub-date pub-type="epub"><day>19</day><month>10</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>19</day><month>10</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>9</volume><elocation-id>4353</elocation-id><history><date date-type="received"><day>20</day><month>9</month><year>2017</year></date><date date-type="accepted"><day>1</day><month>10</month><year>2018</year></date></history><permissions><copyright-statement>&#169; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#8217;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#8217;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Large-scale genomic data highlight the complexity and diversity of the molecular changes that drive cancer progression. Statistical analysis of cancer data from different tissues can guide drug repositioning as well as the design of targeted treatments. Here, we develop an improved Bayesian network model for tumour mutational profiles and apply it to 8198 patient samples across 22 cancer types from TCGA. For each cancer type, we identify the interactions between mutated genes, capturing signatures beyond mere mutational frequencies. When comparing mutation networks, we find genes which interact both within and across cancer types. To detach cancer classification from the tissue type we perform de novo clustering of the pancancer mutational profiles based on the Bayesian network models. We find 22 novel clusters which significantly improve survival prediction beyond clinical information. The models highlight key gene interactions for each cluster potentially allowing genomic stratification for clinical trials and identifying drug targets.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Tumour heterogeneity hinders translation of large-scale genomic data into the clinic. Here the authors develop a method for the stratification of cancer patients based on the molecular gene status, including genetic interactions, rather than clinico-histological data, and apply it to TCGA data for over 8000 cases across 22 cancer types.</p></abstract><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000781</institution-id><institution>EC | European Research Council (ERC)</institution></institution-wrap></funding-source><award-id>609883</award-id><principal-award-recipient><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100007601</institution-id><institution>EC | Horizon 2020 (European Union Framework Programme for Research and Innovation)</institution></institution-wrap></funding-source><award-id>633974</award-id><principal-award-recipient><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#169; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">The past years have seen great progress towards a deeper understanding of the molecular changes underpinning cancer progression. Identification and characterisation of molecular subtypes within and across different cancer types has emerged as a promising approach for the development of targeted therapies<sup><xref ref-type="bibr" rid="CR1">1</xref>&#8211;<xref ref-type="bibr" rid="CR3">3</xref></sup>. Nevertheless, cancer treatment is far from optimal. The approval of the limited number of available cancer drugs is often limited to a specific cancer type or subtype, preventing widespread use of targeted therapies. Moreover, cancers may develop resistance against these therapies, rendering them ineffective<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>.</p><p id="Par4">Pancancer analyses enabled by large datasets such as The Cancer Genome Atlas (TCGA)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> or the International Cancer Genome Consortium (ICGC)<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> may aid a better understanding of the disease biology across different tissues, and can, for example, identify mutational hotspots in tumours<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Genes strongly associated with a cancer type or pancancer subgroups provide insights into the molecular mechanisms, which are key for pinpointing novel therapeutic opportunities and improving current treatment strategies. For example, analysis of endometrial carcinoma showed genetic similarities to certain types of breast and ovarian cancer<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> while olaparib, approved for <italic>BRCA</italic>-mutated ovarian cancer, provided a good response in metastatic prostate cancer patients with DNA repair mutations<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Pancancer, or basket, clinical trials<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> could extend targeted treatments beyond their current indication, like testing the <italic>BRAF</italic> inhibitor vemurafenib outside of metastatic melanoma<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, or test novel agents, like Loxo Oncology&#8217;s trial of larotrectinib for patients with a <italic>TRK</italic> gene fusion mutation. Recently, the FDA granted its first approval for a drug (pembrolizumab) based on genetic markers, regardless of the tissue type.</p><p id="Par5">Cancer is known to be a disease characterised by a progression of molecular changes leading to malignant features and activities<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>. Alongside stratifying tumours based on static molecular profiles<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>, investigating their development<sup><xref ref-type="bibr" rid="CR16">16</xref>&#8211;<xref ref-type="bibr" rid="CR22">22</xref></sup> may offer a new perspective on pancancer analyses with the potential to identify key drivers and provide benefits on multiple levels, including (1) prioritisation of mutation-based biomarkers; (2) uncovering previously unknown mutational dependencies; (3) identification of biomarkers of progression; and (4) biological insight into the genetic progression of cancer.</p><p id="Par6">The facets of clustering patient samples, inferring their genetic tumour progression and mutational interactions are highly inter-related (<xref rid="MOESM1" ref-type="media">Supplementary Section A</xref>). Here, we introduce a unified statistical framework to combine them by modelling the mutations as a Bayesian network. The probability of observing each mutation depends on the state of its parents in the network, thereby accounting for mutational interactions such as co-occurrence or mutual exclusivity, as well as more complex relationships. The directions of the connections may be suggestive of causal relationships<sup><xref ref-type="bibr" rid="CR23">23</xref>&#8211;<xref ref-type="bibr" rid="CR25">25</xref></sup>, though they may not be fully resolved from the data.</p><p id="Par7">We develop efficient methods to infer the dependency structure of the mutations and performed fully Bayesian inference (Methods) to capture the uncertainty in the network structure learned from mutational profile data. Characterising mutational data through Bayesian networks provides useful insights through the analysis of the mutational interactions encoded by the network, beyond just analysing mutational frequencies. We employ our Bayesian network modelling to cluster patient samples into groups, with different interactions among mutated genes. The key interactions within and across novel subgroups may uncover common mechanistic insights, potential therapeutic targets, and prognostic and predictive biomarkers.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Analysis overview</title><p id="Par8">We performed two distinct analyses of non-silent mutation data, summarised at the gene level for 201 genes, from 8198 patient samples across 22 cancer types (Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">1</xref>) from TCGA. Initially, in a supervised analysis, we built cancer-specific probabilistic models to explore type-specific mutational interactions and pancancer heterogeneity. Then, in an unsupervised analysis, we proceeded to cluster the samples into novel mutational subgroups (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the analyses. Starting from the mutation data, we perform two types of analysis. Supervised learning of the Bayesian network structure for each known cancer type, allowing us to uncover mutational interactions and visualise pancancer heterogeneity. Unsupervised clustering of the mutation data into components with common interactions to uncover a novel stratification of the patient samples</p></caption><graphic xlink:href="41467_2018_6867_Fig1_HTML" id="d29e430"/></fig></p></sec><sec id="Sec4"><title>Cancer-specific Bayesian networks</title><p id="Par9">Stratifying the TCGA mutation data by tissue of origin, we built Bayesian networks (Methods) separately for each cancer type. We obtained an alternative representation of the mutational landscape that goes beyond mutation frequencies by highlighting the interdependencies between genes. Edges show co-occurrence or mutual exclusivity, or higher order correlations between sets of genes, offering a systematic visualisation of the most important mutational interactions in 22 different cancer types (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>The cancer-specific connections between the genes. For clarity we limit the display to only include connections between the 20 most frequent and connected mutations per cancer type. The Bayesian networks for each cancer type are overlaid on the same union of gene nodes. Edges highlight interactions between the selected mutations and are coloured by the cancer type for which they occur (leukaemia: yellow; glioblastoma: green, etc.). Directed edges point in the inferred direction of dependency, whereas undirected edges indicate cases where the direction cannot be inferred. Solid edges indicate positive correlation (a degree of co-occurrence) while dashed edges indicate negative correlation (a degree of exclusivity) between the genes connected. Genes are coloured according to the colours of their edges. Those with edges in only one specific cancer type are grouped and labelled with the same colour. Genes with edges in different cancer types are arranged in the two circles in the centre. The size of each gene correlates with the total number of edges across all cancer types, including edges that are not shown. Black diamonds mark putatively actionable targets</p></caption><graphic xlink:href="41467_2018_6867_Fig2_HTML" id="d29e447"/></fig></p><p id="Par10">The network parameters estimated from the data capture information both about the mutational frequencies and about their interactions, allowing us to evaluate how well each model explains the mutational status of each patient sample (Methods), including those from other cancer type. Simulations show that our approach performs notably better than alternatives in learning the network structure (<xref rid="MOESM1" ref-type="media">Supplementary Section B</xref>). It also improves on the potential to effectively characterise different cancer types with respect to simple distance-based measures (<xref rid="MOESM1" ref-type="media">Supplementary Section C</xref>). The network structure inference is informed (Methods) by using the STRING protein&#8722;protein interaction network<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> as a prior, but even without this information a comparison (Methods) reveals a significant overlap of the edges (permutation test; <italic>p</italic>&#8201;=&#8201;4.1&#215;10<sup>5</sup>), suggesting the inferred network of mutational interactions is biologically relevant as known functional interactions coincide.</p><p id="Par11">We rediscovered many key genes that have previously been associated with their respective cancer types. For example, genes <italic>ATM</italic>, <italic>PIK3CA</italic> and <italic>PTEN</italic> with a lot of connections in colorectal cancer (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>) have previously been reported as highly mutated<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. In lung adenocarcinomas, we recapitulate the mutual exclusivity between <italic>KRAS</italic> and <italic>EGFR</italic> as well as the importance of <italic>TP53</italic><sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, for which our model suggests that it is frequently co-mutated with both <italic>KRAS</italic> and others like <italic>MLL3</italic>, as well as <italic>KRAS</italic> and <italic>STK11</italic> are frequently co-mutated.</p><p id="Par12"><italic>TP53</italic> is a major hub with the most interactions across multiple cancer types (67 in total) and with multiple dependencies in brain cancer and especially lower-grade glioma. <italic>TP53</italic> mutations in lower-grade glioma have previously been associated with the disease, along with <italic>IDH1</italic>, <italic>FUBP1</italic>, <italic>ATRX</italic>, <italic>CIC</italic>, <italic>NOTCH1</italic>, <italic>EGFR</italic>, and <italic>PIK3CA</italic><sup><xref ref-type="bibr" rid="CR29">29</xref></sup> among which we see some interactions. Similarly in glioblastoma, where in addition to <italic>TP53</italic>, we observe interactions involving <italic>PTEN</italic>, <italic>IDH1</italic> and <italic>ATRX</italic> which were previously reported to be mutated<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>.</p><p id="Par13">Other hubs with high connectivity like <italic>TP53</italic> include <italic>MLL2</italic> (65 interactions), <italic>MLL3</italic> (58), <italic>XYLT2</italic> (56) and <italic>FAT1</italic> (55). Mutations in these genes have previously been associated with cancer<sup><xref ref-type="bibr" rid="CR31">31</xref>&#8211;<xref ref-type="bibr" rid="CR33">33</xref></sup>. <italic>MLL3</italic> and <italic>FAT1</italic> share connections across several cancer types, with both having several interaction in uterine cancer, while <italic>MLL2</italic> exhibits many connections for stomach, and <italic>XYLT2</italic> for oesophageal cancer.</p><p id="Par14">Strong edges can hint at common mechanistic causes or fitness effects. For the example of <italic>FAT1</italic>, our study finds relevant interacting mutations in breast, colorectal, endometrial, kidney, lung, liver, stomach and head and neck cancer, with mutation rates between 2 and 24%. Although <italic>FAT1</italic> was reported to be recurrently mutated in several cancer types<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR35">35</xref></sup>, our results suggest that the gene correlates with a large number of mutations in different cancer types, including <italic>FAT1</italic> in breast cancer, <italic>ATM</italic> in colorectal cancer, and <italic>APC</italic>, <italic>MTOR</italic> and <italic>MLL3</italic> in endometrial cancer. On the pathway level, we found highly connected genes across cancer types to be significantly involved in many signal transduction pathways, as well as cellular processes and DNA damage repair (Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">8</xref>).</p><p id="Par15">Several genes with mutational interactions are putatively actionable, with drugs either approved or currently tested in a clinical study (labelled with black diamonds in Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>). In general, approval of targeted therapies is limited to one or several cancer types or cancer subtypes. Strong dependencies in the Bayesian network potentially indicate effectiveness of targeted therapies against dependent gene mutations, particularly if it is in the same pathway. Moreover, the network potentially expands the group of tumours responsive to a specific targeted therapy, within the same tumour types and between different tumour types. Although the drugs are only targeting the mutation itself, we see for example several interactions of <italic>KRAS</italic> in lung adenocarcinoma (with <italic>TP53</italic>, <italic>EGRF</italic> and <italic>STK11</italic>) and there are currently several clinical trials investigating the effectiveness and safety of targeted therapies against <italic>KRAS</italic> for this cancer type (NCT02642042, NCT01912625 or NCT02079740).</p><p id="Par16">A two-dimensional visualisation based on multiscale projections (Methods) highlights the differences and similarities of patient samples as measured over the Bayesian networks, within and across cancer types (Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>). Some, like colorectal, thyroid and lower grade glioma, are well separated and hence well defined by the mutation profiles of their patient samples; others are much more similar, for example those within overlapping groups. Even for the better separated cancer types, we observe substantial heterogeneity with some patient samples closer to those from other cancers.<fig id="Fig3"><label>Fig. 3</label><caption><p>Visualisation of pancancer heterogeneity. 2D visualisation of the similarity between patient samples based on their fit to each cancer-specific Bayesian network, highlighting the heterogeneity within and across cancer types. For example, stomach, breast and liver cancer show high inter-tumour heterogeneity with a high spread across the plot, whereas pancreatic cancer shows low inter-tumour heterogeneity and is much more localised. Ovarian and breast cancers as well as bladder cancer and lung adenocarcinomas show similar mutational profiles, while lower grade glioma is rather distinct from other cancer types, as is thyroid cancer. The solid shapes are based on contours that together contain a total of 50% of the respective cancer types. The group of samples on the lower right possess no mutations among the 201 genes while those exhibiting a mutation only in <italic>TP53</italic> are also indicated. Versions highlighting certain cancer types are displayed in Supplementary Fig.&#160;<xref rid="MOESM1" ref-type="media">5</xref></p></caption><graphic xlink:href="41467_2018_6867_Fig3_HTML" id="d29e672"/></fig></p><p id="Par17">As well as being applicable to pancancer cohorts, these methods naturally apply when focussing on individual cancer types and their subtypes (as we discuss for breast cancer in&#160;<xref rid="MOESM1" ref-type="media">Supplementary Section D</xref>).</p></sec><sec id="Sec5"><title>De novo clustering based on Bayesian networks</title><p id="Par18">Given the considerable heterogeneity across cancer types, we asked ourselves whether the mutation profiles themselves can be re-clustered on the basis of Bayesian network models without knowing the cancer types. This model-based de novo clustering of the binary mutation data (Methods and <xref rid="MOESM1" ref-type="media">Supplementary Section F</xref>) identified 22 groups, coincidentally the same number as the original cancer types (which was not imposed), but distinct in their composition. Each cluster is defined by a Bayesian network which constitutes a generative model of its patient data. These models fit the data much better than the partitioning by cancer type&#8212;the average cluster assignment is 91.5% compared to 71.9% for the cancer-specific models.</p><p id="Par19">The composition of the clusters (Fig.&#160;<xref rid="Fig4" ref-type="fig">4</xref>) shows that the more differentiated cancer types, like colorectal, thyroid and lower grade glioma from the 2D projection (Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>) initiate new clusters. Clusters G and I are mostly composed of glioma and colorectal samples respectively. Almost all thyroid cancer samples belong to cluster V, along with samples from other cancer types, and this cluster exhibits a strong enrichment in <italic>BRAF</italic> mutations (17% compared to an overall rate of 7%, Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">9</xref>). Cluster K, where <italic>TP53</italic> plays a strong role, mostly consists of colorectal samples, and cluster L of leukaemia with <italic>IDH</italic> mutations being prominent. The ovarian cancer samples belong almost entirely to cluster U (where all samples exhibit a <italic>TP53</italic> mutation). Samples with no mutations among the 201 genes are assigned to cluster V.<fig id="Fig4"><label>Fig. 4</label><caption><p>De novo clustering. <bold>a</bold> Assignment of the 8198 patient samples to the 22 clusters, labelled A&#8722;V, based on Bayesian network clustering of their mutation profiles. The left-hand side of the bar for each cluster indicates the number of patient samples with a given cancer type, while the right-hand side indicates the breakdown into the known subtypes. <bold>b</bold> Survival probabilities of the 22 clusters</p></caption><graphic xlink:href="41467_2018_6867_Fig4_HTML" id="d29e724"/></fig></p><p id="Par20">The de novo clustering also split patient samples from the same cancer type, like the glioma samples into clusters G and N: cluster N has elevated mutation rates in <italic>TP53</italic> and <italic>ATRX</italic> which are largely absent from cluster G which instead has elevated rates of <italic>CIC</italic> as well as even higher rates of <italic>IDH1</italic> than N (98% compared to 86%). Patient samples from certain cancer types may actually be more similar to tumours in other cancers. Cluster S, for example, groups samples of several different cancer types, including bladder, breast, liver and lung cancers and possesses elevated mutation rates in several genes, like <italic>TP53</italic>, <italic>MLL</italic>, <italic>ARID</italic> and <italic>CTNNB1</italic>.</p><p id="Par21">For cancers with known subtypes, the clustering recovered some of these differences. For example, the microsatellite stable subtype of uterine cancer has a rather different cluster composition than the other uterine patient samples (Supplementary Fig.&#160;<xref rid="MOESM1" ref-type="media">14</xref>), with enrichment moving from clusters M and U to A and F. Similarly, the colorectal subtypes are quite distinct in their cluster composition. For the breast cancer patient samples, the luminal subtypes, especially luminal A, have a strong presence in clusters T and V while the basal and Her2 enriched subtypes are mostly absent from these clusters and appear preferentially in cluster U instead.</p><p id="Par22">The clusters are highly significant in predicting survival (likelihood ratio&#8201;=&#8201;37.0; <italic>p</italic>&#8201;=&#8201;7.6&#215;10<sup>&#8722;8</sup>), also accounting for clinical and histopathological information (age, stage and cancer type; Methods), showing that considering the mutation data and their interactions provides a more complete and informative picture of tumours and their progression. The Bayesian network clustering also performs favourably in survival prediction compared to a range of standard clustering approaches (Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">6</xref>).</p><p id="Par23">The clustering is based solely on the mutation data, so we also compared individual clusters without adjusting for clinical and histopathological information. We observed significant differences (Fig.&#160;<xref rid="Fig4" ref-type="fig">4</xref> and Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">3</xref>) showing that the clustering uncovers strong biological signals. In particular clusters G, M, T and V show good survival (5-year overall survival of 70&#8211;80%), whereas clusters B, P and R show poor survival; cluster B has the poorest outcome with a 5-year overall survival of just over 30%.</p><p id="Par24">Some of the differences between individual clusters can be explained by the mutational profiles correlating with and recapitulating clinical and histopathological variables. When we remove the confounding by age, stage and cancer type, clusters G, J, N and U are still significantly different compared to reference (cluster V, Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">4</xref>). Clusters G and N both contain a large fraction of lower grade glioma patient samples and have good survival. The cancer type is adjusted for in the survival analysis, meaning that the improvement in survival predictions is due to the diverse patient samples that are clustered with them (Fig.&#160;<xref rid="Fig4" ref-type="fig">4</xref>) along with the separation of lower grade glioma into two main groups. Clusters J, with a large group of lung adenocarcinomas, and U have significantly poorer prognosis.</p><p id="Par25">Some cancer types are split by the clustering, with one portion forming the bulk of a cluster, and show differences in survival between the patients assigned to different clusters. For example, leukaemia samples in cluster L show a significantly lower lethal risk compared to samples in cluster V (hazard ratio&#8201;=&#8201;0.51; <italic>p</italic>&#8201;=&#8201;0.012). Lower grade glioma samples in cluster N have a non-significantly higher risk than those in cluster G (hazard ratio&#8201;=&#8201;1.64; <italic>p</italic>&#8201;=&#8201;0.056). Similarly colorectal samples in cluster K show non-significantly higher lethal risk than colorectal samples in cluster I (hazard ratio&#8201;=&#8201;1.67; <italic>p</italic>&#8201;=&#8201;0.063), in line with the fact that cluster K contains a large number of samples from the MSS subtype which has the worst outcome<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>.</p><p id="Par26">The probabilistic model describing each cluster can be utilised to visualise the important mutational interactions characterising the mutation profiles of its samples (Fig.&#160;<xref rid="Fig5" ref-type="fig">5</xref>). The cluster composition is distinct from the grouping by cancer (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>), even for clusters dominated by one cancer type such as cluster B, G, I or J, so that the key interactions mostly differ, especially when focussing on 20 genes per cluster for clarity.<fig id="Fig5"><label>Fig. 5</label><caption><p>The cluster-specific connections between the genes. The connections between the 20 most frequent and connected genes per cluster (rather than per cancer type, as in Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>). Black diamonds near nodes indicate putatively actionable genes. Edges highlight interdependencies between the selected mutations: solid for positive and dashed for negative correlation. Directed edges point in the inferred direction of dependency, whereas undirected edges are where the direction cannot be inferred. Node size reflects the total number of edges, including edges not shown. Nodes are coloured by combining the colours of their edges from the different clusters</p></caption><graphic xlink:href="41467_2018_6867_Fig5_HTML" id="d29e818"/></fig></p><p id="Par27"><italic>TP53</italic>, as the most frequently mutated gene across all cancer types, remains fairly prominent when clustering samples by their mutation profile. Looking at its connections among all genes, these differ substantially across the clusters even when the marginal frequency is similar (Fig.&#160;<xref rid="Fig6" ref-type="fig">6</xref>), suggesting that it plays different roles in different clusters. Our approach emphasises mutational interaction patterns which are specific to a cluster. Along with its interactions, the prevalence of <italic>TP53</italic> in each cluster is also used in assigning patient samples. For example all members of cluster U possess a <italic>TP53</italic> mutations while none of cluster V do.<fig id="Fig6"><label>Fig. 6</label><caption><p>Focus on <italic>TP53</italic>. <bold>a</bold> Cancer types or <bold>b</bold> clusters are characterised by interactions of <italic>TP53</italic> with different genes. For cancer types or clusters where <italic>TP53</italic> shows a similarly high mutation frequency (around 0.5), we display all its interactions (positive correlation is represented by solid arrows, negative correlation by dashed). Groups are annotated by the cancer type or cluster name and the respective mutation frequency of <italic>TP53</italic> across samples (in brackets). Several of these interactions have been studied in cancer. For example, an inverse relationship between <italic>ARID1A</italic> and <italic>TP53</italic> was previously observed in gastro-intestinal cancers<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> while <italic>TP53</italic> mutations co-occur with <italic>RB1</italic> in bladder cancer<sup><xref ref-type="bibr" rid="CR53">53</xref></sup></p></caption><graphic xlink:href="41467_2018_6867_Fig6_HTML" id="d29e879"/></fig></p><p id="Par28">Among the clusters, genes such as <italic>ERBB2</italic> (37 interactions), <italic>MSH3</italic> (36) or <italic>CDKN1B</italic> (33) have more interactions than <italic>TP53</italic> (32) in total. Of the selected interactions (Fig.&#160;<xref rid="Fig5" ref-type="fig">5</xref>), <italic>ERBB2</italic> has connections particularly for clusters T and M, and for cluster M interacts with <italic>CTNNB1</italic>. <italic>PIK3CA</italic> has several interactions, including three for cluster C (with <italic>TP53</italic>, <italic>CTNNB1</italic> and <italic>VHL</italic>), a cluster dominated by colorectal cancer samples.</p><p id="Par29">We found several cancer-associated signalling pathways significantly enriched in highly connected genes across clusters, including HIF-1, Jak-STAT, p53, Toll-like receptor, and TNF signalling (Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">10</xref>). These results suggest that genes involved in signalling pathways are not only highly connected, with a large number of mutational interactions with other genes, but that they also play an important role in characterising the clusters.</p><p id="Par30">Clustering samples by their mutational profile, independent of their cancer type, provides an alternative patient stratification which may inform targeted treatment (putatively actionable genes are marked by black diamonds in Fig.&#160;<xref rid="Fig5" ref-type="fig">5</xref>). For example, <italic>BRAF</italic> inhibitors are being currently tested or have already been approved for multiple cancer types, including lung cancer, ovarian cancer, and thyroid cancer<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Substantial fractions of these cancer types are grouped in the single cluster V (for which <italic>BRAF</italic> exhibits three interactions in Fig.&#160;<xref rid="Fig5" ref-type="fig">5</xref>). The similarity of mutational profiles to other cancer types in cluster V suggests that they may be responsive to the same targeted treatment, such as <italic>BRAF</italic> inhibitors, provided the targeted gene or pathway is mutated.</p></sec></sec><sec id="Sec6" sec-type="discussion"><title>Discussion</title><p id="Par31">We modelled mutational profiles with Bayesian networks, which capture the interactions between mutations, in a pancancer setting across 22 cancer types. Clustering of pancancer data can be highly insightful into the molecular similarities across cancer types<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. In order to concurrently model cancer heterogeneity and mutational interactions we combined the Bayesian network approach with clustering in an integrated framework. The challenge for network clustering of large datasets resides in achieving reliable inference of networks with many nodes. Therefore we also developed methods for fast network learning for large data (Methods), so to extend the analysis to a couple of hundred important genes. Larger networks than those analysed may not lead to any further benefit, since many cancer mutations are quite rare and therefore unlikely to show strong interactions detectable in network modelling.</p><p id="Par32">Mutations can be modelled at different levels, from the finer scale of individual mutation sites or hotspots<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> up to the pathway level. Higher resolution comes at the cost of lower frequencies, but this could be balanced out by combining aberrations by their molecular or pathway functions. A powerful alternative could be to use diffusion algorithms to condense aberrations to their affected subnetworks<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> or mediator genes<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Here we focussed on mutation data summarised at the gene level, which contain a large amount of information. Mutational profiles are one genomic lens through which to identify molecular subtypes which can then complement other views based on, for example, copy number, expression and methylation profiles<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> and there may also be interactions across data modalities. Cancers can be highly heterogeneous, potentially harbouring distinct clones with different mutational profiles and prognostic signatures. Finer modelling of clonal structure and its impact on patient stratification present substantial challenges, as well as opportunities for more precise treatment options.</p><p id="Par33">Furthermore, we account for uncertainty in the network structure through a fully Bayesian approach (Methods). The networks learnt provide the key gene interactions characterising each cancer type (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>) and a significantly extended view over just mutational frequencies. Along with the edges, the networks also utilise the frequency of each mutation to quantify how similar or disparate the mutation patterns of patient samples are within and across cancer types (Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>).</p><p id="Par34">Because the networks we infer are related to a class of clustering methods, we directly employed our models to re-cluster the TCGA data. We discovered and characterised 22 clusters in the data, distinct from the original cancer types but happening to match in number. New patient samples, including mutation profiles from different tumour types, can also be classified into the clusters, for which we provide a web application (Software). The new clusters significantly improve survival prediction, over and above that from the clinical and histopathological status of each patient sample. Integrating this information along with the mutational profiles during the clustering could further improve the survival prediction. Different types of mutations can occur and mutations also have different functional impact, which may affect their potential interactions, and may have different effects in different tissues. Accounting for such interactions could offer further refinements.</p><p id="Par35">The Bayesian network modelling and clustering developed here provides us with insights into the mutation events and specifically their dependencies in cancer types and in novel cancer subgroups. These can be used as biomarkers which may be explored experimentally for therapeutic intervention.</p></sec><sec id="Sec7"><title>Methods</title><sec id="Sec8"><title>Cancer mutation data</title><p id="Par36">Mutation annotation files were obtained through GDAC Firehose<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> for the 22 cancer types with sequenced primary tumour samples from more than 100 patients (see Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">1</xref>), giving a total of 8198 patient samples. The 16 most significantly mutated genes for each cancer type were collated to give a total of 201 genes considered. The different sample sizes and potentially different effect sizes makes comparing the significance of gene mutations challenging across cancer types. We found such comparisons led to gene lists dominated by a small number of cancer types, with correspondingly fewer discriminatory pancancer markers. Instead, a fixed number per cancer type was employed to ensure markers were retained for each cancer type to better characterise inter-tumour heterogeneity. A binary matrix of the non-silent mutations in these genes across all patient samples was generated.</p><p id="Par37">Putatively actionable targets are identified based on approved drugs or drugs currently undergoing clinical studies as collected by MyCancerGenome<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, a manually curated precision cancer medicine knowledge resource. MyCancerGenome was queried through rDGIdb<sup><xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>. Functional annotation of genes was performed using the KEGGREST package<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>.</p></sec><sec id="Sec9"><title>Graph inference</title><p id="Par38">To quantify the extent to which a Bayesian network can explain a set of binary data, we use the BDe score<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> where the state of a node <italic>X</italic> is determined by a different parameter <italic>&#952;</italic><sub><bold><italic>Y</italic></bold></sub> for each configuration of its <italic>m</italic> parents <bold><italic>Y</italic></bold> : <italic>P</italic>(<italic>X</italic>&#8201;=&#8201;1 | <bold><italic>Y</italic></bold>)&#8201;=&#8201;<italic>&#952;</italic><sub><bold><italic>Y</italic></bold></sub> with a beta prior on each <italic>&#952;</italic><sub><bold><italic>Y</italic></bold></sub> with hyperparameters <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \beta = {\textstyle{\chi \over {2^{m + 1}}}}$$\end{document}</tex-math><mml:math id="M2"><mml:mi>&#945;</mml:mi><mml:mo>=</mml:mo><mml:mi>&#946;</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#967;</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq1.gif"/></alternatives></inline-formula> defined in terms of a single parameter <italic>&#967;</italic> which represents the number of pseudocounts added.</p><p id="Par39">To make inference of the Bayesian network structure, which is a directed acyclic graph (DAG), we adopt a modified version of order MCMC<sup><xref ref-type="bibr" rid="CR45">45</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup>. For large networks we search over a reduced skeleton, initially found via the PC algorithm<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> and then expanded by MCMC search using the software package <bold>BiDAG</bold><sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. From the final skeleton, a sample from the posterior is obtained using partition MCMC<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> optimised for such a skeleton<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>.</p></sec><sec id="Sec10"><title>Prior edge knowledge</title><p id="Par40">We obtained all human functional interactions from STRING<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, selecting those between the 201 genes included in this study (&#8776;7000 interactions). Edges that were not in this STRING network were penalised by a factor 2 for the graph inference.</p></sec><sec id="Sec11"><title>Additional edge penalisation</title><p id="Par41">When examining the networks learned from binary data, as in Figs.&#160;<xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig5" ref-type="fig">5</xref> we additionally penalise all edges. Edge penalisation (by a factor of 2) has previously been examined with the marginal uniform prior<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> and shown to improve network reconstruction. Based on simulation studies (<xref rid="MOESM1" ref-type="media">Supplementary Section B</xref>) we find stronger regularisation further improves the accuracy for data mimicking the TCGA and employ a factor of 16 to regularise the network. We sample 100 DAGs from the posterior. Edges are only displayed if they appear in at least half of the posterior sample.</p><p id="Par42">To select genes to display per cancer type or per cluster in Figs.&#160;<xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, for each gene we multiply its number of connections by its frequency, and choose the 20 genes with the largest product.</p></sec><sec id="Sec12"><title>Scoring samples against DAGs</title><p id="Par43">For a given DAG the posterior distribution of each node <italic>X</italic> given its parent state <bold><italic>Y</italic></bold> is again a beta distribution with updated parameters <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha + \tilde \alpha$$\end{document}</tex-math><mml:math id="M4"><mml:mi>&#945;</mml:mi><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq2.gif"/></alternatives></inline-formula><sub><bold><italic>Y</italic></bold></sub> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta + \tilde \beta$$\end{document}</tex-math><mml:math id="M6"><mml:mi>&#946;</mml:mi><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq3.gif"/></alternatives></inline-formula><sub><bold><italic>Y</italic></bold></sub>, where <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde \alpha$$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq4.gif"/></alternatives></inline-formula><sub><bold><italic>Y</italic></bold></sub> is the number of times <italic>X</italic> takes the value 1 when the parents are <bold><italic>Y</italic></bold> and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde \beta$$\end{document}</tex-math><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq5.gif"/></alternatives></inline-formula><sub><bold><italic>Y</italic></bold></sub> is the number of times it takes the value 0 in the data. Hence the likelihood<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(X = 1|G,Y) = \hat \theta _Y = \frac{{\alpha + \tilde \alpha _Y}}{{\alpha + \tilde \alpha _Y + \beta + \tilde \beta _Y}}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8739;</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#945;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>&#945;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#946;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>can be evaluated for each node of an arbitrary observed binary vector <bold><italic>X</italic></bold>, providing a measure of fit of the observed vector to the DAG.</p><p id="Par44">Given a sample of <italic>M</italic> DAGs from the posterior distribution <italic>P</italic>(<italic>G</italic> | <italic>k</italic>) of different cancer types (indexed by <italic>k</italic>), we can score each patient sample <italic>D</italic><sub><italic>i</italic></sub> against each DAG <italic>G</italic><sub><italic>j</italic></sub> (dropping the index for the cluster <italic>k</italic>). From the sample we can build the Monte Carlo approximation to the likelihood of the data for a given cluster <italic>k</italic><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {D_i|k} \right) \approx \frac{1}{M}\mathop {\sum}\limits_{j = 1}^M {\kern 1pt} P\left( {D_i|G_j} \right)$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#8776;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>using the likelihoods in Eq. (<xref rid="Equ1" ref-type="">1</xref>). Under a uniform prior over cancer types, the likelihoods in Eq. (<xref rid="Equ2" ref-type="">2</xref>) are normalised to probability vectors over the collection of cancer types according to <italic>P</italic>(<italic>k</italic>|<italic>D</italic><sub><italic>i</italic></sub>)&#8201;&#8733;&#8201;<italic>P</italic>(<italic>D</italic><sub><italic>i</italic></sub>|<italic>k</italic>)<italic>P</italic>(<italic>k</italic>). Similarities between the probability vectors of different patient samples are computed as their Jensen&#8722;Shannon divergence. Calculating this divergence between all pairs of patient samples provides a distance matrix between patient samples which we project into 2D with multidimensional scaling using the <bold>cmdscale</bold> command in <bold>R</bold>, as in Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>.</p></sec><sec id="Sec13"><title>Clustering with frequency information</title><p id="Par45">We cluster the data with a mixture model. Given <italic>K</italic> graphs and parameter sets (<italic>G</italic><sub><italic>k</italic></sub>, <italic>&#952;</italic><sub><italic>k</italic></sub>), we assume that each patient sample <italic>D</italic><sub><italic>i</italic></sub> is generated from one of <italic>K</italic> models depending on the value of a latent variable <italic>Z</italic><sub><italic>i</italic></sub><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_i|(Z_i = k)\sim (G_k,\theta _k)$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>with<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(Z_i = k) = \tau _k$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#964;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par46">To start we allow no edges between the nodes. The different parameters <italic>&#952;</italic><sub><italic>k</italic></sub> we learn for each empty graph <italic>G</italic><sub><italic>k</italic></sub> only depend on the mutation frequencies in each group and do not account for any correlations between them. A Dirichlet prior is assumed on the cluster probabilities <italic>&#964;</italic> with all the parameters set to the value <italic>&#967;</italic>.</p><p id="Par47">We find the maximum a posteriori (MAP) estimates of the mixture model parameters and the cluster membership probabilities of patient samples using the EM approach. This model-based clustering can also be seen as a latent class analysis<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> where we include prior information. Without the prior (or taking the limit <italic>&#967;</italic>&#8201;&#8594;&#8201;0), and without edges in the graph and hence independence between mutations, this clustering reduces to a Bernoulli mixture model.</p></sec><sec id="Sec14"><title>EM MAP algorithm</title><p id="Par48">To find the MAP estimates for the mixture model we repeat the following steps: (1) given the membership probabilities, update the posterior parameters, and (2) given the updated parameters, update the probabilities. This is repeated until the probabilities and parameters no longer change.</p><p id="Par49">At each step <italic>t</italic> of the algorithm we start with the current membership probabilities <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{ik}^{(t)}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq6.gif"/></alternatives></inline-formula> of each patient sample <italic>i</italic> being in cluster <italic>k</italic>. From the membership probabilities we can derive the cluster probabilities (as relative cluster sizes)<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _k^{(t)} = \frac{{\chi + \mathop {\sum}\nolimits_{i = 1}^N {\kern 1pt} T_{ik}^{(t)}}}{{\chi K + N}},$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:msubsup><mml:mrow><mml:mi>&#964;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#967;</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo> &#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>&#967;</mml:mi><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is the number of patient samples. A weighted version of Eq. (<xref rid="Equ1" ref-type="">1</xref>) gives the posterior means for each node <italic>j</italic> in the empty graph of each cluster:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jk}^{(t)} = \frac{{\frac{\chi }{2} + \mathop {\sum}\nolimits_{i = 1}^N {\kern 1pt} D_{ij}T_{ik}^{(t)}}}{{\chi + \mathop {\sum}\nolimits_{i = 1}^N {\kern 1pt} T_{ik}^{(t)}}},$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:msubsup><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mi>&#967;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo> &#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>&#967;</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo> &#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic><sub><italic>ij</italic></sub> is 1 if patient <italic>i</italic> exhibits mutation <italic>j</italic> and 0 otherwise so that it acts as an indicator function in the sum. From this we can directly evaluate <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {D_i|G_k,\hat \theta _k} \right)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq7.gif"/></alternatives></inline-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{ln}}\left[ {P\left( {D_i|G_k,\hat \theta _k} \right)^{(t)}} \right] = \mathop {\sum}\limits_{j = 1}^n {\kern 1pt} D_{ij}{\kern 1pt} {\mathrm{ln}}\left[ {\theta _{jk}^{(t)}} \right] + \left( {1 - D_{ij}} \right){\mathrm{ln}}\left[ {1 - \theta _{jk}^{(t)}} \right]$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi mathvariant="normal">ln</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>P</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> &#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">ln</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">ln</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>again using <italic>D</italic><sub><italic>ij</italic></sub> as an indicator function.</p><p id="Par50">Then we update the membership probabilities to start the next iteration<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{ik}^{(t + 1)} = \frac{{\tau _k^{(t)}P\left( {D_i|G_k,\hat \theta _k} \right)^{(t)}}}{{\mathop {\sum}\nolimits_{k\prime = 1}^K {\kern 1pt} \tau _{k\prime }^{(t)}P\left( {D_i|G_{k\prime },\hat \theta _{k\prime }} \right)^{(t)}}}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#964;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#8242;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>&#964;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#8242;</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#8739;</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#952;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_6867_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>and repeat the iterations until the they no longer change.</p><p id="Par51">The case where each patient sample has their membership probability equally spread across the clusters constitutes an unstable equilibrium for the mixture. To initialise the algorithm we therefore add a small random perturbation to this equilibrium to start with almost uniform probabilities <inline-formula id="IEq8"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{ik}^{(0)} \approx {\textstyle{1 \over K}}$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&#8776;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2018_6867_Article_IEq8.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec15"><title>Cluster discovery</title><p id="Par52">The global parameter <italic>&#967;</italic> quantifies the tradeoff between the within cluster variability and the number of clusters. Larger values of <italic>&#967;</italic> place less importance on each data point and lead to fewer larger clusters. Decreasing <italic>&#967;</italic>, the clusters break up leading to progressively more clusters. Since each clustering is stochastic, we run the clustering 240 times with different initial perturbations and retain the best. To find the optimal value of <italic>&#967;</italic> and number of clusters <italic>K</italic> we vary both and calculate a modified version of the AIC (<xref rid="MOESM1" ref-type="media">Supplementary Section E</xref>). For each value of <italic>&#967;</italic> we choose the number of clusters with the lowest AIC and scan through a range of <italic>&#967;</italic> values. To select <italic>&#967;</italic> we chose the value whose clustering has the highest overlap (measured with the normalised mutual information) with clustering results for the range of <italic>&#967;</italic>.</p></sec><sec id="Sec16"><title>Clustering with structure learning</title><p id="Par53">Allowing edges between the mutations in the DAG models refines the clustering. For each cluster we repeatedly learn the MAP DAG and reassign samples accordingly until convergence. In particular, we repeat the following steps: (1) given the current membership probabilities, learn the MAP graph structure, and (2) given the graph structure, repeat till convergence: (2i) given the membership probabilities, update the graph parameters, and (2ii) given the updated graph parameters, update the probabilities. We separate out learning the graph structure from updating its parameters since the latter is much less computationally demanding than the former. For given graph structures, the parameters and membership probabilities are continuous so the inner loop will converge. However since the graph space is discrete, periodic solutions for the outer loop are possible which can be alleviated by replacing the single graph in each cluster by a collection.</p><p id="Par54">Once the clustering has converged and the final membership probabilities have been learnt, we sample 100 DAGs from the posterior of each cluster and visualise their connectivity and clustering features.</p></sec><sec id="Sec17"><title>Survival analysis</title><p id="Par55">For each of the patient samples, we obtained the most recent clinical information<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. Patients with missing clinical data were removed, leaving 8085 subjects. To evaluate the prognostic&#160;power of the clusters derived from the mutational data for survival prediction, we employed the Cox proportional hazards model, with and without adjustment for age, stage and tissue type which are all significant predictors. The model fit with and without the cluster indicator was evaluated by the likelihood ratio test, based on the asymptotic <italic>&#967;</italic><sup>2</sup> distribution.</p><p id="Par56">The possible values for stage were I, II, III, IV, along with unclassified values of &#8216;[Not Applicable]&#8217;, &#8216;[Not Available]&#8217;, &#8216;[Discrepancy]&#8217;, &#8216;[Unknown]&#8217;, and &#8216;Stage X&#8217;. The &#8216;[Not Applicable]&#8217; category is entirely determined by the tissue type and hence does not affect the regression when adjusting for tissue type. The remaining categories other than &#8216;[Not Available]&#8217; consisted of only 56 patient samples. Performing a Cox regression with adjustment for age and tissue type indicated that keeping those categories separate did not lead to significantly better predictions (likelihood ratio&#8201;=&#8201;1.2; <italic>p</italic>&#8201;=&#8201;0.13) due to their small sizes. All the unclassified values were hence combined into a single stage X. Keeping stage I and stage II separate led to significantly better survival prediction compared to their combination into a single category, and similarly for stage III and IV, and hence all stages were kept separate. Therefore five levels (whose size is summarised in Supplementary Table&#160;<xref rid="MOESM1" ref-type="media">5</xref>) were retained for the stage covariate in the Cox regression.</p><p id="Par57">Modelling survival on the basis of the clinical data available from TCGA is challenging, due to intrinsic limitations in the data<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>, including, for example, relatively short follow-up times as well as heterogeneity in data collection and cohort selection across the different cancer types. Therefore, although we adjust for cancer type in our Cox regressions and use the same survival model to compare different clustering methods, there may be other effects like cancer-type-specific confounding not accounted for.</p></sec><sec id="Sec18"><title>Overlap with functional network</title><p id="Par58">To compare the STRING<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> network to the Bayesian networks inferred in this study we re-ran the analysis without using the functional STRING network as a prior. We then created the union of all edges in the Bayesian networks over all cancer types. We performed a permutation test on the overlap between these two networks by generating one million random permutations of the gene labels in the functional network. For each permuted network, we computed the mean overlap to derive the empirical <italic>p</italic> value.</p><p id="Par60">A web interface to classify new patient samples is at <ext-link ext-link-type="uri" xlink:href="https://cbg.bsse.ethz.ch/pancancer/">https://cbg.bsse.ethz.ch/pancancer/</ext-link>.The package <bold>BiDAG</bold> for Bayesian network inference is at <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=BiDAG">https://CRAN.R-project.org/package=BiDAG</ext-link>. R code for the Bayesian network clustering and survival analysis is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cbgethz/pancancer-clustering">https://github.com/cbgethz/pancancer-clustering</ext-link>.</p></sec><sec id="Sec19"><title>Code availability</title><p id="Par59">The network inference code is available at <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=BiDAG">https://CRAN.R-project.org/package=BiDAG</ext-link>. The clustering and survival analysis code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cbg-ethz/pancancer-clustering">https://github.com/cbg-ethz/pancancer-clustering</ext-link>.</p></sec></sec><sec sec-type="supplementary-material"><title>Electronic supplementary material</title><sec id="Sec21"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2018_6867_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2018_6867_MOESM2_ESM.pdf"><caption><p>Reporting summary</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Electronic supplementary material</title><p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-018-06867-x.</p></sec><ack><title>Acknowledgements</title><p>J.K. was supported by ERC Synergy Grant 609883 (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/">http://erc.europa.eu/</ext-link>). T.T. was supported by EU Horizon 2020 PHC Grant 633974 (SOUND).</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>J.K., G.M., J.B., and N.B. designed the study. J.K., G.M., and P.S. developed the methodology. T.T. collated the data. J.K., T.T., and R.G. performed the analyses. J.K., T.T., G.M., and R.G. drafted the article. G.C. and N.B. critically reviewed the manuscript. All authors approved the final version.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>The mutational profiles and clinical information of the patient samples used in the study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cbg-ethz/pancancer-clustering">https://github.com/cbg-ethz/pancancer-clustering</ext-link>, along with their cluster assignments.</p></notes><notes notes-type="COI-statement"><sec id="FPar1"><title>Competing interests</title><p>The authors declare no competing interests.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>S</given-names></name><name><surname>Schiller</surname><given-names>JH</given-names></name><name><surname>Spinola</surname><given-names>M</given-names></name><name><surname>Minna</surname><given-names>JD</given-names></name></person-group><article-title>New molecularly targeted therapies for lung cancer</article-title><source>J. Clin. Investig.</source><year>2007</year><volume>117</volume><fpage>2740</fpage><lpage>2750</lpage><pub-id pub-id-type="doi">10.1172/JCI31809</pub-id><pub-id pub-id-type="pmid">17909619</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Higgins</surname><given-names>MJ</given-names></name><name><surname>Baselga</surname><given-names>J</given-names></name></person-group><article-title>Targeted therapies for breast cancer</article-title><source>J. Clin. Investig.</source><year>2011</year><volume>121</volume><fpage>3797</fpage><lpage>3803</lpage><pub-id pub-id-type="doi">10.1172/JCI57152</pub-id><pub-id pub-id-type="pmid">21965336</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roock</surname><given-names>WD</given-names></name><name><surname>Vriendt</surname><given-names>VD</given-names></name><name><surname>Normanno</surname><given-names>N</given-names></name><name><surname>Ciardiello</surname><given-names>F</given-names></name><name><surname>Tejpar</surname><given-names>S</given-names></name></person-group><article-title>KRAS, BRAF, PIK3CA, and PTEN mutations: implications for targeted therapies in metastatic colorectal cancer</article-title><source>Lancet Oncol.</source><year>2011</year><volume>12</volume><fpage>594</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1016/S1470-2045(10)70209-6</pub-id><pub-id pub-id-type="pmid">21163703</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Groenendijk</surname><given-names>FH</given-names></name><name><surname>Bernards</surname><given-names>R</given-names></name></person-group><article-title>Drug resistance to targeted therapies: d&#233;j&#224; vu all over again</article-title><source>Mol. Oncol.</source><year>2014</year><volume>8</volume><fpage>1067</fpage><lpage>1083</lpage><pub-id pub-id-type="doi">10.1016/j.molonc.2014.05.004</pub-id><pub-id pub-id-type="pmid">24910388</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLendon</surname><given-names>R</given-names></name><etal/></person-group><article-title>Comprehensive genomic characterization defines human glioblastoma genes and core pathways</article-title><source>Nature</source><year>2008</year><volume>455</volume><fpage>1061</fpage><lpage>1068</lpage><pub-id pub-id-type="doi">10.1038/nature07385</pub-id><pub-id pub-id-type="pmid">18772890</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>TJ</given-names></name><etal/></person-group><article-title>International network of cancer genome projects</article-title><source>Nature</source><year>2010</year><volume>464</volume><fpage>993</fpage><lpage>998</lpage><pub-id pub-id-type="doi">10.1038/nature08987</pub-id><pub-id pub-id-type="pmid">20393554</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>MT</given-names></name><etal/></person-group><article-title>Identifying recurrent mutations in cancer reveals widespread lineage diversity and mutational specificity</article-title><source>Nat. Biotechnol.</source><year>2016</year><volume>34</volume><fpage>155</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1038/nbt.3391</pub-id><pub-id pub-id-type="pmid">26619011</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>TCGA Research Network.</collab></person-group><article-title>Integrated genomic characterization of endometrial carcinoma</article-title><source>Nature</source><year>2013</year><volume>497</volume><fpage>67</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1038/nature12113</pub-id><pub-id pub-id-type="pmid">23636398</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mateo</surname><given-names>J</given-names></name><etal/></person-group><article-title>DNA-repair defects and olaparib in metastatic prostate cancer</article-title><source>N. Engl. J. Med.</source><year>2015</year><volume>2015</volume><fpage>1697</fpage><lpage>1708</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1506859</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunanan</surname><given-names>KM</given-names></name><etal/></person-group><article-title>Basket trials in oncology: a trade-off between complexity and efficiency</article-title><source>J. Clin. Oncol.</source><year>2017</year><volume>35</volume><fpage>271</fpage><lpage>273</lpage><pub-id pub-id-type="doi">10.1200/JCO.2016.69.9751</pub-id><pub-id pub-id-type="pmid">27893325</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyman</surname><given-names>DM</given-names></name><etal/></person-group><article-title>Vemurafenib in multiple nonmelanoma cancers with BRAF V600 mutations</article-title><source>N. Engl. J. Med.</source><year>2015</year><volume>373</volume><fpage>726</fpage><lpage>736</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1502309</pub-id><pub-id pub-id-type="pmid">26287849</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowell</surname><given-names>PC</given-names></name></person-group><article-title>The clonal evolution of tumor cell populations</article-title><source>Science</source><year>1976</year><volume>194</volume><fpage>23</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1126/science.959840</pub-id><pub-id pub-id-type="pmid">959840</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogelstein</surname><given-names>B</given-names></name><etal/></person-group><article-title>Genetic alterations during colorectal tumor development</article-title><source>N. Engl. J. Med.</source><year>1988</year><volume>319</volume><fpage>525</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1056/NEJM198809013190901</pub-id><pub-id pub-id-type="pmid">2841597</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ciriello</surname><given-names>G</given-names></name><etal/></person-group><article-title>Emerging landscape of oncogenic signatures across human cancers</article-title><source>Nat. Genet.</source><year>2013</year><volume>45</volume><fpage>1127</fpage><lpage>1133</lpage><pub-id pub-id-type="doi">10.1038/ng.2762</pub-id><pub-id pub-id-type="pmid">24071851</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoadley</surname><given-names>KA</given-names></name><etal/></person-group><article-title>Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues-of-origin</article-title><source>Cell</source><year>2014</year><volume>158</volume><fpage>929</fpage><lpage>944</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.06.049</pub-id><pub-id pub-id-type="pmid">25109877</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstung</surname><given-names>M</given-names></name><name><surname>Baudis</surname><given-names>M</given-names></name><name><surname>Moch</surname><given-names>H</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group><article-title>Quantifying cancer progression with conjunctive Bayesian networks</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2809</fpage><lpage>2815</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp505</pub-id><pub-id pub-id-type="pmid">19692554</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Attolini</surname><given-names>CSO</given-names></name><etal/></person-group><article-title>A mathematical framework to determine the temporal sequence of somatic genetic events in cancer</article-title><source>Proc. Natl. Acad. Sci. USA</source><year>2010</year><volume>107</volume><fpage>17604</fpage><lpage>17609</lpage><pub-id pub-id-type="doi">10.1073/pnas.1009117107</pub-id><pub-id pub-id-type="pmid">20864632</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstung</surname><given-names>M</given-names></name><name><surname>Eriksson</surname><given-names>N</given-names></name><name><surname>Lin</surname><given-names>J</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group><article-title>The temporal order of genetic and pathway alterations in tumorigenesis</article-title><source>PLoS ONE</source><year>2011</year><volume>6</volume><fpage>e27136</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0027136</pub-id><pub-id pub-id-type="pmid">22069497</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farahani</surname><given-names>HS</given-names></name><name><surname>Lagergren</surname><given-names>J</given-names></name></person-group><article-title>Learning oncogenetic networks by reducing to mixed integer linear programming</article-title><source>PLoS ONE</source><year>2013</year><volume>8</volume><fpage>e65773</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0065773</pub-id><pub-id pub-id-type="pmid">23799047</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misra</surname><given-names>N</given-names></name><name><surname>Szczurek</surname><given-names>E</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name></person-group><article-title>Inferring the paths of somatic evolution in cancer</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>2456</fpage><lpage>2463</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu319</pub-id><pub-id pub-id-type="pmid">24812340</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramazzotti</surname><given-names>D</given-names></name><etal/></person-group><article-title>CAPRI: efficient inference of cancer progression models from cross-sectional data</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>3016</fpage><lpage>3026</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv296</pub-id><pub-id pub-id-type="pmid">25971740</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cristea</surname><given-names>S</given-names></name><name><surname>Kuipers</surname><given-names>J</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group><article-title>pathTiMEx: joint inference of mutually exclusive cancer pathways and their progression dynamics</article-title><source>J. Comput. Biol.</source><year>2017</year><volume>24</volume><fpage>603</fpage><lpage>615</lpage><pub-id pub-id-type="doi">10.1089/cmb.2016.0171</pub-id><pub-id pub-id-type="pmid">27936934</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Pearl, J. &amp; Verma, T. S. A theory of inferred causation. (eds. Allen, J. F., Fikes, R. &amp; Sandewall, E.) In <italic>Second International Conference on Principles of Knowledge Representation and Reasoning</italic> 441&#8211;452, (Morgan Kaufmann Publishers, San Francisco, CA, USA, 1991).</mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="other">Pearl, J. <italic>Causality: Models, Reasoning and Inference</italic> (MIT Press, Cambridge, MA, 2000).</mixed-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dawid</surname><given-names>AP</given-names></name></person-group><article-title>Beware of the DAG!</article-title><source>J. Mach. Learn. Res. Workshop Conf. Proc.</source><year>2010</year><volume>6</volume><fpage>59</fpage><lpage>86</lpage></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szklarczyk</surname><given-names>D</given-names></name><etal/></person-group><article-title>STRING v10: protein&#8722;protein interaction networks, integrated over the tree of life</article-title><source>Nucleic Acids Res.</source><year>2014</year><volume>43</volume><fpage>D447</fpage><lpage>D452</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1003</pub-id><pub-id pub-id-type="pmid">25352553</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>TCGA Network.</collab></person-group><article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title><source>Nature</source><year>2012</year><volume>487</volume><fpage>330</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1038/nature11252</pub-id><pub-id pub-id-type="pmid">22810696</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>TCGA Research Network.</collab></person-group><article-title>Comprehensive molecular profiling of lung adenocarcinoma</article-title><source>Nature</source><year>2014</year><volume>511</volume><fpage>543</fpage><lpage>550</lpage><pub-id pub-id-type="doi">10.1038/nature13385</pub-id><pub-id pub-id-type="pmid">25079552</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>TCGA Research Network.</collab></person-group><article-title>Comprehensive, integrative genomic analysis of diffuse lower-grade gliomas</article-title><source>N. Engl. J. Med.</source><year>2015</year><volume>372</volume><fpage>2481</fpage><lpage>2498</lpage><pub-id pub-id-type="doi">10.1056/NEJMoa1402121</pub-id><pub-id pub-id-type="pmid">26061751</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennan</surname><given-names>CW</given-names></name><etal/></person-group><article-title>The somatic genomic landscape of glioblastoma</article-title><source>Cell</source><year>2013</year><volume>155</volume><fpage>462</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2013.09.034</pub-id><pub-id pub-id-type="pmid">24120142</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olivier</surname><given-names>M</given-names></name><name><surname>Hollstein</surname><given-names>M</given-names></name><name><surname>Hainaut</surname><given-names>P</given-names></name></person-group><article-title>TP53 mutations in human cancers: origins, consequences, and clinical use</article-title><source>Cold Spring Harb. Perspect. Biol.</source><year>2009</year><volume>2</volume><fpage>a001008</fpage></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>LG</given-names></name><etal/></person-group><article-title>Recurrent somatic mutation of FAT1 in multiple human cancers leads to aberrant wnt activation</article-title><source>Nat. Genet.</source><year>2013</year><volume>45</volume><fpage>253</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/ng.2538</pub-id><pub-id pub-id-type="pmid">23354438</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kantidakis</surname><given-names>T</given-names></name><etal/></person-group><article-title>Mutation of cancer driver MLL2 results in transcription stress and genome instability</article-title><source>Genes Dev.</source><year>2016</year><volume>30</volume><fpage>408</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1101/gad.275453.115</pub-id><pub-id pub-id-type="pmid">26883360</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>M</given-names></name></person-group><article-title>Function and cancer genomics of FAT family genes (review)</article-title><source>Int. J. Oncol.</source><year>2012</year><volume>41</volume><fpage>1913</fpage><lpage>1918</lpage><pub-id pub-id-type="doi">10.3892/ijo.2012.1669</pub-id><pub-id pub-id-type="pmid">23076869</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garg</surname><given-names>M</given-names></name><etal/></person-group><article-title>Profiling of somatic mutations in acute myeloid leukemia with FLT3-ITD at diagnosis and relapse</article-title><source>Blood</source><year>2015</year><volume>126</volume><fpage>2491</fpage><lpage>2501</lpage><pub-id pub-id-type="doi">10.1182/blood-2015-05-646240</pub-id><pub-id pub-id-type="pmid">26438511</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phipps</surname><given-names>AI</given-names></name><etal/></person-group><article-title>Association between molecular subtypes of colorectal cancer and patient survival</article-title><source>Gastroenterology</source><year>2015</year><volume>148</volume><fpage>77</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1053/j.gastro.2014.09.038</pub-id><pub-id pub-id-type="pmid">25280443</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>AD</given-names></name><name><surname>Micheel</surname><given-names>CM</given-names></name><name><surname>Anderson</surname><given-names>IA</given-names></name><name><surname>Levy</surname><given-names>MA</given-names></name><name><surname>Lovly</surname><given-names>CM</given-names></name></person-group><article-title>The path(way) less traveled: a pathway-oriented approach to providing information about precision cancer medicine on my cancer genome</article-title><source>Transl. Oncol.</source><year>2016</year><volume>9</volume><fpage>163</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/j.tranon.2016.03.001</pub-id><pub-id pub-id-type="pmid">27084433</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leiserson</surname><given-names>MD</given-names></name><etal/></person-group><article-title>Pan-cancer network analysis identifies combinations of rare somatic mutations across pathways and protein complexes</article-title><source>Nat. Genet.</source><year>2015</year><volume>47</volume><fpage>106</fpage><pub-id pub-id-type="doi">10.1038/ng.3168</pub-id><pub-id pub-id-type="pmid">25501392</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dimitrakopoulos</surname><given-names>C</given-names></name><etal/></person-group><article-title>Network-based integration of multi-omics data for prioritizing cancer genes</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>2441</fpage><lpage>2448</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty148</pub-id><pub-id pub-id-type="pmid">29547932</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="other">Broad Institute TCGA Genome Data Analysis Center. Analysis-ready standardized TCGA data from Broad GDAC Firehose stddata__2015_08_21 run (2016).</mixed-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>AH</given-names></name><etal/></person-group><article-title>DGIdb 2.0: mining clinically relevant drug&#8722;gene interactions</article-title><source>Nucleic Acids Res.</source><year>2015</year><volume>44</volume><fpage>D1036</fpage><lpage>D1044</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1165</pub-id><pub-id pub-id-type="pmid">26531824</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurnherr</surname><given-names>T</given-names></name><name><surname>Singer</surname><given-names>F</given-names></name><name><surname>Stekhoven</surname><given-names>DJ</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group><article-title>Genomic variant annotation workflow for clinical applications</article-title><source>F1000Res.</source><year>2016</year><volume>5</volume><fpage>1963</fpage><pub-id pub-id-type="doi">10.12688/f1000research.9357.2</pub-id><pub-id pub-id-type="pmid">27990260</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other">Tenenbaum, D. <italic>KEGGREST: Client-Side REST Access to KEGG</italic>. R package version 1.14.0 (2016).</mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">Heckerman, D. &amp; Geiger, D. Learning Bayesian networks: a unification for discrete and Gaussian domains. (eds. Besnard, P. &amp; Hanks, S.) In <italic>Eleventh Conference on Uncertainty in Artificial Intelligence</italic> 274&#8211;284 (Morgan Kaufmann Publishers, San Francisco, CA, USA, 1995).</mixed-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>N</given-names></name><name><surname>Koller</surname><given-names>D</given-names></name></person-group><article-title>Being Bayesian about network structure. A Bayesian approach to structure discovery in Bayesian networks</article-title><source>Mach. Learn.</source><year>2003</year><volume>50</volume><fpage>95</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1023/A:1020249912095</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuipers</surname><given-names>J</given-names></name><name><surname>Moffa</surname><given-names>G</given-names></name></person-group><article-title>Partition MCMC for inference on acyclic digraphs</article-title><source>J. Am. Stat. Assoc.</source><year>2017</year><volume>112</volume><fpage>282</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1080/01621459.2015.1133426</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">Spirtes, P., Glymour, C. N. &amp; Scheines, R. <italic>Causation, Prediction, and Search</italic> (MIT Press, Cambridge, MA, 2000).</mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="other">Suter, P. &amp; Kuipers, J. BiDAG: Software for the efficient inference and sampling of Bayesian networks. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=BiDAG">https://CRAN.R-project.org/package=BiDAG</ext-link> (2017).</mixed-citation></ref><ref id="CR49"><label>49.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scutari</surname><given-names>M</given-names></name></person-group><article-title>An empirical-Bayes score for discrete Bayesian networks</article-title><source>J. Mach. Learn. Res.</source><year>2016</year><volume>52</volume><fpage>438</fpage><lpage>448</lpage></element-citation></ref><ref id="CR50"><label>50.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dean</surname><given-names>N</given-names></name><name><surname>Raftery</surname><given-names>AE</given-names></name></person-group><article-title>Latent class analysis variable selection</article-title><source>Ann. Inst. Stat. Math.</source><year>2010</year><volume>62</volume><fpage>11</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1007/s10463-009-0258-9</pub-id><pub-id pub-id-type="pmid">20827439</pub-id></element-citation></ref><ref id="CR51"><label>51.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><etal/></person-group><article-title>An integrated TCGA pan-cancer clinical data resource to drive high-quality survival outcome analytics</article-title><source>Cell</source><year>2018</year><volume>173</volume><fpage>400</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.052</pub-id><pub-id pub-id-type="pmid">29625055</pub-id></element-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>RC</given-names></name><name><surname>Wang</surname><given-names>TL</given-names></name><name><surname>Shih</surname><given-names>IM</given-names></name></person-group><article-title>The emerging roles of ARID1a in tumor suppression</article-title><source>Cancer Biol. Ther.</source><year>2014</year><volume>15</volume><fpage>655</fpage><lpage>664</lpage><pub-id pub-id-type="doi">10.4161/cbt.28411</pub-id><pub-id pub-id-type="pmid">24618703</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Longo</surname><given-names>T</given-names></name><etal/></person-group><article-title>Targeted exome sequencing of the cancer genome in patients with very high-risk bladder cancer</article-title><source>Eur. Urol.</source><year>2016</year><volume>70</volume><fpage>714</fpage><lpage>717</lpage><pub-id pub-id-type="doi">10.1016/j.eururo.2016.07.049</pub-id><pub-id pub-id-type="pmid">27520487</pub-id></element-citation></ref></ref-list></back></article>