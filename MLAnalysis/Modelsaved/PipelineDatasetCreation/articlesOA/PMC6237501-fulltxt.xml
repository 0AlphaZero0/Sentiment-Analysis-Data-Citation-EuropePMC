<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Proc Math Phys Eng Sci</journal-id><journal-id journal-id-type="iso-abbrev">Proc. Math. Phys. Eng. Sci</journal-id><journal-id journal-id-type="publisher-id">RSPA</journal-id><journal-id journal-id-type="hwp">royprsa</journal-id><journal-title-group><journal-title>Proceedings. Mathematical, Physical, and Engineering Sciences</journal-title></journal-title-group><issn pub-type="ppub">1364-5021</issn><issn pub-type="epub">1471-2946</issn><publisher><publisher-name>The Royal Society Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6237501</article-id><article-id pub-id-type="doi">10.1098/rspa.2018.0412</article-id><article-id pub-id-type="publisher-id">rspa20180412</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>1005</subject><subject>81</subject><subject>1008</subject><subject>6</subject><subject>1009</subject><subject>73</subject></subj-group><subj-group subj-group-type="heading"><subject>Research Articles</subject></subj-group></article-categories><title-group><article-title>Determination of the instantaneous geostrophic flow within the three-dimensional magnetostrophic regime</article-title><alt-title alt-title-type="short">Geostrophic flow in the Earth's core</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hardy</surname><given-names>Colin M.</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="corresp" rid="cor1"/></contrib><contrib contrib-type="author"><name><surname>Livermore</surname><given-names>Philip W.</given-names></name><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><name><surname>Niesen</surname><given-names>Jitse</given-names></name><xref ref-type="aff" rid="af3">3</xref></contrib><contrib contrib-type="author"><name><surname>Luo</surname><given-names>Jiawen</given-names></name><xref ref-type="aff" rid="af4">4</xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Kuan</given-names></name><xref ref-type="aff" rid="af4">4</xref></contrib></contrib-group><aff id="af1"><label>1</label><addr-line>EPSRC Centre for Doctoral Training in Fluid Dynamics</addr-line>, <institution>University of Leeds</institution>, <addr-line>Leeds LS2 9JT</addr-line>, <country>UK</country></aff><aff id="af2"><label>2</label><addr-line>School of Earth and Environment</addr-line>, <institution>University of Leeds</institution>, <addr-line>Leeds LS2 9JT</addr-line>, <country>UK</country></aff><aff id="af3"><label>3</label><addr-line>School of Mathematics</addr-line>, <institution>University of Leeds</institution>, <addr-line>Leeds LS2 9JT</addr-line>, <country>UK</country></aff><aff id="af4"><label>4</label><institution>Institut f&#252;r Geophysik</institution>, <addr-line>ETH Zurich</addr-line>, <addr-line>Sonneggstrasse 5</addr-line>, <addr-line>8092 Z&#252;rich</addr-line>, <country>Switzerland</country></aff><author-notes><corresp id="cor1">e-mail: <email>sccmh@leeds.ac.uk</email></corresp><fn fn-type="other"><p>Electronic supplementary material is available online at <uri xlink:href="http://dx.doi.org/10.6084/m9.figshare.c.4238159">http://dx.doi.org/10.6084/m9.figshare.c.4238159</uri>.</p></fn></author-notes><pub-date pub-type="ppub"><month>10</month><year>2018</year></pub-date><pub-date pub-type="epub"><day>3</day><month>10</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>3</day><month>10</month><year>2018</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>474</volume><issue>2218</issue><elocation-id>20180412</elocation-id><history><date date-type="received"><day>19</day><month>6</month><year>2018</year></date><date date-type="accepted"><day>31</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>&#169; 2018 The Authors.</copyright-statement><copyright-year>2018</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>Published by the Royal Society under the terms of the Creative Commons Attribution License <uri xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>, which permits unrestricted use, provided the original author and source are credited.</license-p></license><?release-delay 0|0?></permissions><self-uri content-type="pdf" xlink:href="rspa20180412.pdf"/><self-uri content-type="reviewer_comments" xlink:href="rspa20180412_review_history.pdf"/><abstract><p>In his seminal work, Taylor (1963 <italic>Proc. R. Soc. Lond. A</italic>
<bold>274</bold>, 274&#8211;283. (<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspa.1963.0130">doi:10.1098/rspa.1963.0130</ext-link>).) argued that the geophysically relevant limit for dynamo action within the outer core is one of negligibly small inertia and viscosity in the magnetohydrodynamic equations. Within this limit, he showed the existence of a necessary condition, now well known as Taylor's constraint, which requires that the cylindrically averaged Lorentz torque must everywhere vanish; magnetic fields that satisfy this condition are termed Taylor states. Taylor further showed that the requirement of this constraint being continuously satisfied through time prescribes the evolution of the geostrophic flow, the cylindrically averaged azimuthal flow. We show that Taylor's original prescription for the geostrophic flow, as satisfying a given second-order ordinary differential equation, is only valid for a small subset of Taylor states. An incomplete treatment of the boundary conditions renders his equation generally incorrect. Here, by taking proper account of the boundaries, we describe a generalization of Taylor's method that enables correct evaluation of the instantaneous geostrophic flow for any three-dimensional Taylor state. We present the first full-sphere examples of geostrophic flows driven by non-axisymmetric Taylor states. Although in axisymmetry the geostrophic flow admits a mild logarithmic singularity on the rotation axis, in the fully three-dimensional case we show that this is absent and indeed the geostrophic flow appears to be everywhere regular.</p></abstract><kwd-group><kwd>Taylor's constraint</kwd><kwd>dynamos</kwd><kwd>Earth's core</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>Engineering and Physical Sciences Research Council (EPSRC)</institution></institution-wrap></funding-source></award-group><award-group><funding-source><institution-wrap><institution>University of Leeds</institution><institution-id>http://dx.doi.org/10.13039/501100000777</institution-id></institution-wrap></funding-source><award-id>EP/L01615X/1</award-id></award-group><award-group><funding-source><institution-wrap><institution>NERC</institution></institution-wrap></funding-source><award-id>NE/G014043/1</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>October, 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><label>1.</label><title>Introduction</title><p>Earth's magnetic field is generated by a self-excited dynamo process through the flow of electrically conducting fluid in the outer core. Although the set of equations that govern this process are known, their numerical solution is challenging because of the extreme dynamical conditions [<xref rid="RSPA20180412C1" ref-type="bibr">1</xref>]. Of particular note is the extreme smallness of the core's estimated viscosity, and the large disparity between the daily timescale associated with Earth's rotation and the thousand-year timescale that governs the long-term geomagnetic evolution. Represented in terms of non-dimensional numbers, this means that the Rossby number (also known as the magnetic Ekman number, <italic>E</italic><sub><italic>&#951;</italic></sub>, measuring the ratio of rotational to magnetic timescales) is <italic>R</italic><sub><italic>o</italic></sub>&#8764;10<sup>&#8722;9</sup> and the Ekman number (measuring the ratio of rotational to viscous effects) is <italic>E</italic>&#8764;10<sup>&#8722;15</sup>. The smallness of these parameters means that rapid (sub-year) timescales associated with inertial effects (e.g. torsional waves) and extremely thin boundary layers (of depth about 1&#8201;m) must be resolved in any Earth-like numerical model, even though neither likely plays an important role in the long-term evolution of the geodynamo.</p><p>Over the past decades, modellers of the long-term geomagnetic field have followed one of two largely independent strategies in order to circumvent these problems. First, beginning with the work of [<xref rid="RSPA20180412C2" ref-type="bibr">2</xref>,<xref rid="RSPA20180412C3" ref-type="bibr">3</xref>], it was noted that by artificially increasing these two parameters by many orders of magnitude to now typical values of <italic>R</italic><sub><italic>o</italic></sub>&#8201;=&#8201;10<sup>&#8722;3</sup>, <italic>E</italic>&#8201;=&#8201;10<sup>&#8722;7</sup> [<xref rid="RSPA20180412C4" ref-type="bibr">4</xref>], the numerically difficult rapid timescales and short length scales are smoothed, allowing larger time steps, and therefore ultimately permitting a longer time period to be studied for a given finite computer resource. Although such (now mainstream) models can reproduce many characteristics of Earth's geomagnetic field, several studies have cast doubt as to whether they obey the correct force balance within the core [<xref rid="RSPA20180412C1" ref-type="bibr">1</xref>,<xref rid="RSPA20180412C5" ref-type="bibr">5</xref>,<xref rid="RSPA20180412C6" ref-type="bibr">6</xref>], although some evidence points to models being on the cusp of faithfully representing Earth's core [<xref rid="RSPA20180412C7" ref-type="bibr">7</xref>,<xref rid="RSPA20180412C8" ref-type="bibr">8</xref>].</p><p>In the second strategy, which we consider here in this paper, the values of <italic>R</italic><sub><italic>o</italic></sub> and <italic>E</italic> are both set to zero [<xref rid="RSPA20180412C9" ref-type="bibr">9</xref>]. By entirely neglecting inertia and viscosity, the challenging aspects of rapid timescales and very short viscous lengthscales are removed and this approximation will likely lead to a computationally less demanding set of equations to solve. The resulting dimensionless magnetostrophic regime then involves an exact balance between the Coriolis force, pressure, buoyancy and the Lorentz force associated with the magnetic field <bold>B</bold> itself:
<disp-formula id="RSPA20180412M1x1"><label>1.1</label><mml:math id="DM1"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mi mathvariant="normal">&#8711;</mml:mi></mml:mrow><mml:mo>&#8201;</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#215;</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>F</italic><sub>B</sub> is a buoyancy term that acts in the unit radial direction <inline-formula><mml:math id="IM1"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="IM2"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the unit vector parallel to the rotation axis [<xref rid="RSPA20180412C10" ref-type="bibr">10</xref>]. In a full sphere (neglecting the solid inner core), a complete description of the geodynamo requires a solution of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x1">1.1</xref>) alongside equations describing the evolution of <bold>B</bold> and <italic>F</italic><sub>B</sub> within the core, whose boundary conditions derive from the surrounding electrically insulating impenetrable overlying mantle. Denoting (<italic>s</italic>,&#8201;<italic>&#981;</italic>,&#8201;<italic>z</italic>) as cylindrical coordinates, Taylor [<xref rid="RSPA20180412C9" ref-type="bibr">9</xref>] showed that, as a consequence of this magnetostrophic balance, the magnetic field must obey at all times <italic>t</italic> the well-known condition
<disp-formula id="RSPA20180412M1x2"><label>1.2</label><mml:math id="DM2"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8801;</mml:mo><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula>for any geostrophic cylinder <italic>C</italic>(<italic>s</italic>) of radius <italic>s</italic> coaxial with the rotation axis.</p><p>Taylor also showed that it is expedient to partition the magnetostrophic flow of (<xref ref-type="disp-formula" rid="RSPA20180412M1x1">1.1</xref>), using a cylindrical average, into geostrophic and ageostrophic parts:
<disp-formula id="RSPA20180412UM1"><mml:math id="DM3"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>in which the ageostrophic flow <bold>u</bold><sub><italic>a</italic></sub> has an azimuthal component with zero cylindrical average. Provided equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) is satisfied, equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x1">1.1</xref>) can be used to find <bold>u</bold><sub><italic>a</italic></sub> directly (for example, by using Taylor's constructive method or the integral method of [<xref rid="RSPA20180412C1" ref-type="bibr">1</xref>]), although the geostrophic flow remains formally unspecified by&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x1">1.1</xref>). As Taylor further showed however, the geostrophic flow can be constrained by insisting that equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) is not just satisfied instantaneously but for all time. The task of <italic>u</italic><sub><italic>g</italic></sub> is then to keep the magnetic field on the manifold of Taylor states [<xref rid="RSPA20180412C11" ref-type="bibr">11</xref>]. It is noteworthy that, in such a model, at all times the flow is enslaved to <bold>B</bold> and <italic>F</italic><sub>B</sub>.</p><p>In his 1963 paper, Taylor showed that (for a fully three-dimensional system) the geostrophic flow was at every instant the solution of a certain second-order differential equation (ODE) whose coefficients depend on <bold>B</bold> and <italic>F</italic><sub>B</sub>. His elegant and succinct analysis has been reproduced many times in the literature. It may then come at some surprise that in the intervening five decades there have been no published implementations of his method (that the authors are aware of). Very likely, this is due to a subtle issue concerning the treatment of the magnetic boundary conditions. As we shall show, rather than being applicable to a general (Taylor state) <bold>B</bold>, Taylor's method is only valid for a small subset of Taylor states. Of crucial importance is that this subset does not include those states likely to be realized in any analytical example or in any practical numerical scheme to solve the magnetostrophic equations. The main goal of this paper is to describe why this happens, and to modify Taylor's method in order that it can apply more generally.</p><p>Despite the lack of headway using a direct application of Taylor's ODE, some alternative methods to evolve the magnetostrophic equation have shown success. By treating a version of the Taylor integral&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) that is specific to axisymmetry [<xref rid="RSPA20180412C12" ref-type="bibr">12</xref>,<xref rid="RSPA20180412C13" ref-type="bibr">13</xref>], Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>] demonstrated that they could evolve the magnetostrophic system by solving a first-order differential equation for the geostrophic flow, rendering the Taylor integral zero to first order, and went on to apply it to a variety of examples. In an independent line of investigation [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] showed that, by using control theory, it is possible to find <italic>u</italic><sub><italic>g</italic></sub> implicitly such that the Taylor integral is zero at the end of any finite timestep. As we show later explicitly by example, their method is fundamentally three dimensional, although in their paper they only applied it to the axisymmetric case. The generalized version of Taylor's method that we present in this paper is also fully three dimensional and provides an alternative means to that of Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] of calculating the geostrophic flow. Either of these methods may provide a route to create a fully three-dimensional magnetostrophic alternative to the mainstream numerical models with weak viscosity and inertia. We note however, that the methods we describe within this paper are restricted to the full sphere, and we do not attempt to incorporate the inner core or any of its dynamical effects.</p><p>An alternative route to finding a magnetostrophic dynamo is to reinstate viscosity and inertia and investigate the limit as both <italic>E</italic> and <italic>R</italic><sub><italic>o</italic></sub> become small [<xref rid="RSPA20180412C13" ref-type="bibr">13</xref>]. In such models, it is important that the Lehnert number, <italic>&#955;</italic> (estimated to be 10<sup>&#8722;4</sup> in Earth's core) is small in order that inertial modes separate from magneto-Coriolis waves and can be filtered out [<xref rid="RSPA20180412C16" ref-type="bibr">16</xref>]. It is also worth noting that since a significant part of the Coriolis term may be balanced by the pressure gradient (e.g. [<xref rid="RSPA20180412C17" ref-type="bibr">17</xref>]), the simple estimates of the Rossby number reported above may be too small. A different estimate of importance of inertia is the Alfv&#233;n number (measuring the square root of the ratio of kinetic to magnetic energies), whose small value of <italic>A</italic>&#8764;10<sup>&#8722;2</sup> still supports neglecting the inertial term although with weaker justification [<xref rid="RSPA20180412C8" ref-type="bibr">8</xref>]. Arguably retaining inertia and viscosity would result in models closer to geophysical reality than those that are purely magnetostrophic as this is precisely the regime of the Earth's core. A variety of studies reported evidence of behaviour independent of <italic>E</italic> in the inviscid Taylor-state limit, either from a direct solution [<xref rid="RSPA20180412C18" ref-type="bibr">18</xref>], or from solving the equations assuming asymptotically small <italic>E</italic> [<xref rid="RSPA20180412C19" ref-type="bibr">19</xref>,<xref rid="RSPA20180412C20" ref-type="bibr">20</xref>]. To date, all models of this type have been axisymmetric and there have been no attempts at a general three-dimensional implementation of these ideas. One difficulty with treating asymptotically small <italic>E</italic> is that the resulting equation for <italic>u</italic><sub><italic>g</italic></sub> is an extremely delicate ratio of two small terms, whose form is dependent on the specific choice of mechanical boundary conditions [<xref rid="RSPA20180412C21" ref-type="bibr">21</xref>]. The convergence of magnetostrophic and asymptotically low-<italic>E</italic> models remains an outstanding question.</p><p>The remainder of this paper is structured as follows. Before we can explain why Taylor's method of determining the geostrophic flow fails in general, we need to set out some general background and review other alternative schemes: this is accomplished in &#167;&#167;<xref ref-type="sec" rid="s2">2</xref>&#8211;<xref ref-type="sec" rid="s5">5</xref>. In &#167;<xref ref-type="sec" rid="s6">6</xref>, we discuss the importance of a key boundary term and why it restricts the validity of Taylor's method; we then show explicitly in a simple case that Taylor's method fails. In &#167;&#167;<xref ref-type="sec" rid="s7">7</xref>&#8211;<xref ref-type="sec" rid="s9">9</xref>, we generalize Taylor's method and give some examples, discussing the existence of weak singularities in &#167;<xref ref-type="sec" rid="s10">10</xref> we end with a discussion in &#167;<xref ref-type="sec" rid="s11">11</xref>.</p></sec><sec id="s2"><label>2.</label><title>General considerations</title><sec id="s2a"><label>(a)</label><title>Non-dimensionalization</title><p>In the non-dimensionalization considered in this paper, length is scaled by <italic>L</italic>, the outer core radius 3.5&#8201;&#215;&#8201;10<sup>6</sup>&#8201;m, time by the Ohmic diffusion time <italic>&#964;</italic> (250&#8211;540&#8201;kyr) [<xref rid="RSPA20180412C22" ref-type="bibr">22</xref>] and speed by <inline-formula><mml:math id="IM3"><mml:mrow><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>&#964;</mml:mi><mml:mrow><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&#8776;</mml:mo><mml:mn>5</mml:mn><mml:mo>&#215;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#8722;</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>&#8201;m&#8201;s<sup>&#8722;1</sup>. The scale used for the magnetic field is <inline-formula><mml:math id="IM4"><mml:mrow><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>&#956;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>&#961;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>&#951;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> [<xref rid="RSPA20180412C10" ref-type="bibr">10</xref>], where for Earth the physical parameters take the following values: angular velocity <italic>&#937;</italic><sub>0</sub>&#8201;=&#8201;7.272&#8201;&#215;&#8201;10<sup>&#8722;5</sup>&#8201;s<sup>&#8722;1</sup>, permeability <italic>&#956;</italic><sub>0</sub>&#8201;=&#8201;4<italic>&#960;</italic>&#8201;&#215;&#8201;10<sup>&#8722;7</sup>&#8201;NA<sup>&#8722;2</sup>, density <italic>&#961;</italic><sub>0</sub>&#8201;=&#8201;10<sup>4</sup>&#8201;kg&#8201;m<sup>&#8722;3</sup> and magnetic diffusivity <italic>&#951;</italic>&#8201;=&#8201;0.6&#8211;1.6&#8201;m<sup>2</sup>&#8201;s<sup>&#8722;1</sup>. These parameters lead to the non-dimensional parameters <italic>R</italic><sub><italic>o</italic></sub>&#8201;=&#8201;<italic>&#951;</italic>/(2<italic>&#937;L</italic><sup>2</sup>)&#8201;&#8776;&#8201;10<sup>&#8722;9</sup> and <italic>E</italic>&#8201;=&#8201;<italic>&#957;</italic>/(2<italic>&#937;L</italic><sup>2</sup>)&#8201;&#8776;&#8201;10<sup>&#8722;15</sup>, whose small values motivate neglecting the terms they multiply.</p><p>The value of <inline-formula><mml:math id="IM5"><mml:mrow><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow></mml:mrow><mml:mo>&#8776;</mml:mo><mml:mn>1.7</mml:mn><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">mT</mml:mi></mml:mrow></mml:math></inline-formula> is close to the estimate of the geomagnetic field strength of Gillet <italic>et al.</italic> [<xref rid="RSPA20180412C23" ref-type="bibr">23</xref>], and so we use dimensionless magnetic fields with toroidal or poloidal components of RMS (root mean squared) strength of unity. This corresponds to a dimensional RMS magnitude of 1.7&#8201;mT for purely toroidal or purely poloidal fields and <inline-formula><mml:math id="IM6"><mml:mn>1.7</mml:mn><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mo>&#8776;</mml:mo><mml:mn>2.4</mml:mn><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">mT</mml:mi></mml:mrow></mml:math></inline-formula> for mixed states. Using <inline-formula><mml:math id="IM7"><mml:mrow><mml:mi mathvariant="script">U</mml:mi></mml:mrow></mml:math></inline-formula>, this choice enables the immediate interpretation of the dimensional scale of any flow that we show.</p></sec><sec id="s2b"><label>(b)</label><title>Magnetic field representation and the initial state</title><p>In our full sphere of unit radius, the position <bold><italic>r</italic></bold> is naturally described in spherical coordinates (<italic>r</italic>,&#8201;<italic>&#952;</italic>,&#8201;<italic>&#981;</italic>), although the importance of the rotation axis also leads us to use cylindrical coordinates (<italic>s</italic>,&#8201;<italic>&#981;</italic>,&#8201;<italic>z</italic>). The magnetic field <bold>B</bold> can be written using a toroidal (T)-poloidal (S) framework
<disp-formula id="RSPA20180412UM2"><mml:math id="DM4"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>with <italic>S</italic> and <italic>T</italic> expanded as
<disp-formula id="RSPA20180412UM3"><mml:math id="DM5"><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>Y</italic><sup><italic>m</italic></sup><sub><italic>l</italic></sub> is a spherical harmonic of degree <italic>l</italic> and order <italic>m</italic>. The functions <inline-formula><mml:math id="IM8"><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="IM9"><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> must be chosen to satisfy both Taylor's condition&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>), along with the electrically insulating boundary conditions at <italic>r</italic>&#8201;=&#8201;1 that can be written
<disp-formula id="RSPA20180412M2x1"><label>2.1</label><mml:math id="DM6"><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula>The fluid is assumed to be incompressible and hence the flow <bold>u</bold> can also be written in a comparable form, and due to the absence of viscosity only satisfies an impenetrability condition: <italic>u</italic><sub><italic>r</italic></sub>&#8201;=&#8201;0 on <italic>r</italic>&#8201;=&#8201;1. We cannot impose no-slip or stress-free conditions, there being no boundary layer to accommodate any adjustment from the free-stream inviscid structure.</p><p>All time-dependent magnetostrophic models, axisymmetric or three dimensional, require an initial state from which the system evolves. Because the flow is defined completely by the magnetic field and <italic>F</italic><sub>B</sub>, only the initial structure of the magnetic field <bold>B</bold>(0) and <italic>F</italic><sub>B</sub>(0) are needed: there is no need to specify the initial flow. A general scheme for finding an exact initial Taylor state using a poloidal&#8211;toroidal representation was described by Livermore <italic>et al.</italic> [<xref rid="RSPA20180412C24" ref-type="bibr">24</xref>]; in general, it requires a highly specialized magnetic field to render its integrated azimuthal Lorentz force zero over all geostrophic cylinders. However, in a full sphere such cancellation can be achieved in a simple way by exploiting reflectional symmetry in the equator [<xref rid="RSPA20180412C25" ref-type="bibr">25</xref>]. Using the Galerkin basis of single-spherical-harmonic modes that satisfy the boundary conditions (see appendix&#160;Aa), suitable simple modal expansions are automatically Taylor states.</p></sec><sec id="s2c"><label>(c)</label><title>Overview of time evolution</title><p>Because of the absence of inertia, at each instant the magnetostrophic flow is entirely determined by <bold>B</bold> and <italic>F</italic><sub>B</sub> from equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x1">1.1</xref>): therefore the system, as a whole, only evolves through time-evolution of the quantities <italic>F</italic><sub>B</sub> and <bold>B</bold>. The evolution of <italic>F</italic><sub>B</sub> is assumed to be tractable and lies outside the scope of this study: for simplicity we shall henceforth assume that <italic>F</italic><sub>B</sub>&#8201;=&#8201;0, although we note that all the methods nevertheless apply in the case of non-zero <italic>F</italic><sub>B</sub>. The evolution of the magnetic field is described by the induction equation:
<disp-formula id="RSPA20180412M2x2"><label>2.2</label><mml:math id="DM7"><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8801;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>&#951;</mml:mi><mml:msup><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>where <italic>&#951;</italic>&#8800;0 is the magnetic diffusivity (assumed constant) and &#8706;<sub><italic>t</italic></sub>&#8201;=&#8201;&#8706;/&#8706;<italic>t</italic>. Assuming that we can evolve <bold>B</bold> and <italic>F</italic><sub>B</sub> (using standard methods), the major outstanding task is then to determine the flow at any instant given <bold>B</bold> and <italic>F</italic><sub>B</sub>.</p><p>The ageostrophic component of the flow, containing all the (possibly complex) axially asymmetric structure turns out to be straight-forward to calculate, as it can be determined either through the integral method of Roberts &amp; King [<xref rid="RSPA20180412C1" ref-type="bibr">1</xref>], the constructive method of Taylor [<xref rid="RSPA20180412C9" ref-type="bibr">9</xref>] or the spectral method as described in appendix&#160;Ac. By contrast, the more elementary geostrophic flow, depending only on <italic>s</italic>, is surprisingly difficult to compute, owing to its key role of maintaining Taylor's constraint.</p><p>There are two ways in which the geostrophic flow may be found, which differ in philosophy. In the first, we may undertake an instantaneous analysis to find the geostrophic flow that gives zero rate of change of Taylor's constraint: &#8706;<sub><italic>t</italic></sub><italic>T</italic>(<italic>s</italic>,&#8201;<italic>t</italic>)&#8201;=&#8201;0 [<xref rid="RSPA20180412C9" ref-type="bibr">9</xref>]. Because of the resulting closed-form analytic description, such methods can be useful in computing snapshot solutions that elucidate the mathematical structure of the geostrophic flow, for example, the presence of any singularities. However, as a practical time-evolution tool, their utility is not so obvious. For example, the simple explicit time-evolution scheme, defined by assuming an instantaneous solution is constant over a finite time interval, would lead to a rapid divergence from the Taylor manifold (see [<xref rid="RSPA20180412C11" ref-type="bibr">11</xref>] for an example).</p><p>In the second type of method, we may consider taking a time step (of size <italic>h</italic>), determining the geostrophic flow implicitly by the condition that the magnetic field <bold>B</bold>(<italic>t</italic>&#8201;+&#8201;<italic>h</italic>) satisfies Taylor's constraint [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>,<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>]. In general, implicit and instantaneous methods will only produce the same geostrophic flow in a steady state, or for a time-dependent state for infinitesimally small <italic>h</italic>.</p><p>All methods to determine the geostrophic flow do so up to an arbitrary solid body rotation: <italic>u</italic><sub><italic>g</italic></sub>&#8201;=&#8201;<italic>as</italic>. The constant <italic>a</italic> can be found through requiring zero global angular momentum
<disp-formula id="RSPA20180412M2x3"><label>2.3</label><mml:math id="DM8"><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#960;</mml:mi></mml:mrow></mml:msubsup><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&#8901;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mi>s</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM10"><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:math></inline-formula> is the half-height of <italic>C</italic>(<italic>s</italic>). We also assume the geostrophic flow is everywhere finite (although we permit singularities in the higher-order derivatives), which is implemented by additional conditions where necessary.</p></sec></sec><sec id="s3"><label>3.</label><title>Braginsky's formulation</title><p>Before discussing the determination of the geostrophic flow in more detail, we briefly review a crucial alternative formulation of Taylor's constraint due to [<xref rid="RSPA20180412C12" ref-type="bibr">12</xref>], which laid the foundations of many subsequent works on the subject (e.g. [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>,<xref rid="RSPA20180412C26" ref-type="bibr">26</xref>&#8211;<xref rid="RSPA20180412C29" ref-type="bibr">29</xref>]). As an identity the Taylor integral&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) can be equivalently written as
<disp-formula id="RSPA20180412M3x1"><label>3.1</label><mml:math id="DM9"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>N</italic> and <italic>S</italic> are the northern and southern end caps, respectively, of the cylinder <italic>C</italic>(<italic>s</italic>) at the intersection with the spherical boundary at <italic>r</italic>&#8201;=&#8201;1.</p><p>It is also useful to consider the net magnetic torque on all fluid enclosed within <italic>C</italic>(<italic>s</italic>), <italic>&#915;</italic><sub><italic>z</italic></sub>, defined&#160;by
<disp-formula id="RSPA20180412UM4"><mml:math id="DM10"><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">or</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>In our full-sphere geometry, it is clear that <italic>&#915;</italic><sub><italic>z</italic></sub>(<italic>s</italic>,&#8201;<italic>t</italic>) is zero if and only if <italic>T</italic>(<italic>s</italic>,&#8201;<italic>t</italic>) is zero, although in a spherical shell it is possible that a piecewise (non-zero) solution exists for <italic>&#915;</italic><sub><italic>z</italic></sub>. The condition <italic>&#915;</italic><sub><italic>z</italic></sub>&#8201;=&#8201;0 defines what we refer to as the Braginsky constraint:
<disp-formula id="RSPA20180412M3x2"><label>3.2</label><mml:math id="DM11"><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>&#8801;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>which is equivalent to Taylor's constraint, and simplifies for specific classes of magnetic fields that cause the boundary term to vanish. There are two such classes of magnetic fields which have no sources in the exterior of <italic>r</italic>&#8201;=&#8201;1: fields with no radial component on <italic>r</italic>&#8201;=&#8201;1 (e.g. toroidal fields) and fields that have a vanishing azimuthal component on <italic>r</italic>&#8201;=&#8201;1 (e.g. axisymmetric fields).</p><p>It is important to note the significant difference in the mathematical structure between the constraints of Braginsky&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>) and Taylor&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>). In&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>), there is a clear partition between the two surface integral terms on the right-hand side: the first term is an integral defined over <italic>C</italic>(<italic>s</italic>) that is independent of the magnetic field values on the end caps (these being a set of measure zero); the second end-cap term depends only on the boundary values of the magnetic field. By contrast, although ostensibly Taylor's integral (<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) is an integral over the surface <italic>C</italic>(<italic>s</italic>), the integrand involves a spatial derivative (the curl of <bold>B</bold>) leading to a dependence on the boundary values of the magnetic field. As we will see later, this hidden dependence on the boundary conditions has a deep consequence on Taylor's method for determining the geostrophic flow.</p></sec><sec id="s4"><label>4.</label><title>Existing methods to determine the geostrophic flow</title><p>Our modification of Taylor's method described in &#167;<xref ref-type="sec" rid="s7">7</xref> determines the instantaneous geostrophic flow in a fully three-dimensional geometry. In this section, we briefly review other methods available to calculate the geostrophic flow whose working assumptions are different: either they are axisymmetric or designed to take a finite time step and are not instantaneous. Where there is overlap in applicability, we will use these methods to numerically confirm our solutions.</p><sec id="s4a"><label>(a)</label><title>An axisymmetric first-order implicit method</title><p>As noted above, under axisymmetry Braginsky's condition collapses to
<disp-formula id="RSPA20180412M4x1"><label>4.1</label><mml:math id="DM12"><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>&#960;</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula>This simple form was exploited by Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>] who considered taking a single timestep of duration <italic>h</italic>, after which they required
<disp-formula id="RSPA20180412M4x2"><label>4.2</label><mml:math id="DM13"><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula></p><p>The left-hand side here approximates <italic>&#915;</italic><sub><italic>z</italic></sub>(<italic>s</italic>,&#8201;<italic>t</italic>&#8201;+&#8201;<italic>h</italic>), so this ensures that&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x1">4.1</xref>) is satisfied to first order. To find an equation for the geostrophic flow they differentiated equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x1">4.1</xref>) with respect to time and used the fact that the geostrophic term in the induction equation reduces to
<disp-formula id="RSPA20180412M4x3"><label>4.3</label><mml:math id="DM14"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>They obtained the following first-order ordinary differential equation describing the geostrophic&#160;flow
<disp-formula id="RSPA20180412M4x4"><label>4.4</label><mml:math id="DM15"><mml:mi>s</mml:mi><mml:msub><mml:mi>&#945;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>h</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where
<disp-formula id="RSPA20180412UM5"><mml:math id="DM16"><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>&#960;</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>&#945;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>&#960;</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>B</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi></mml:math></disp-formula>and
<disp-formula id="RSPA20180412M4x5"><label>4.5</label><mml:math id="DM17"><mml:msup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>&#951;</mml:mi><mml:msup><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>The subscripts of zero denote a restriction to axisymmetry of (more general) three-dimensional quantities that are defined subsequently. Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>] implemented this method by solving equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x4">4.4</xref>) using a finite difference scheme. It is worth remarking that this scheme allows small numerical deviations from a Taylor state (since&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x2">4.2</xref>) is only approximate). Because the method depends upon (<xref ref-type="disp-formula" rid="RSPA20180412M4x1">4.1</xref>) which is tied to axisymmetry, their method is not extendable to three dimensions.</p></sec><sec id="s4b"><label>(b)</label><title>A three-dimensional fully implicit scheme</title><p>An alternative implicit scheme proposed by Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] was to seek a geostrophic flow that ensured Taylor's constraint is satisfied (without error) in a numerical scheme after taking a single timestep <italic>h</italic>. By extending to multiple timesteps, this method is suitable to describe fully three-dimensional time-dependent dynamics. Although the authors only demonstrated its utility on axisymmetric examples, in this paper we will show how the method applies to three dimensions with a single short time-step.</p><p>The key idea is to minimize (hopefully to zero) the target function
<disp-formula id="RSPA20180412M4x6"><label>4.6</label><mml:math id="DM18"><mml:mi mathvariant="normal">&#934;</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>by optimizing over all possible choices of <italic>u</italic><sub><italic>g</italic></sub>, assumed constant throughout the interval 0&#8804;<italic>t</italic>&#8804;<italic>h</italic>. Although [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] set out a sophisticated algorithm to do this in general based on control theory, here we describe a simplification of the method which is suitable for <italic>h</italic>&#8810;1, which we can use to benchmark our instantaneous solutions of the generalized three-dimensional Taylor methodology.</p><p>Like Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] we adopt a modal expansion of <italic>u</italic><sub><italic>g</italic></sub>, of which a general form is
<disp-formula id="RSPA20180412M4x7"><label>4.7</label><mml:math id="DM19"><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Bs</mml:mi><mml:mi>ln</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <sans-serif>T</sans-serif><sub><italic>i</italic></sub>(2<italic>s</italic><sup>2</sup>&#8201;&#8722;&#8201;1) are even Chebyshev polynomials of the first kind, and we allow a weak logarithmic singularity at the origin as required by our analytic results in &#167;<xref ref-type="sec" rid="s6">6</xref>a; see also &#167;<xref ref-type="sec" rid="s10">10</xref>.</p><p>Because we plan to take only a single time step of size <italic>h</italic>&#8810;1, we adopt a very simple first-order explicit Euler time evolution scheme
<disp-formula id="RSPA20180412UM6"><mml:math id="DM20"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>which is then substituted into&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x6">4.6</xref>). For simplicity, we assume that the ageostrophic flow, calculated at <italic>t</italic>&#8201;=&#8201;0, is also constant over the time-step. As a representation of the magnetic field (and its rate of change), we use a Galerkin scheme (see appendix&#160;Aa), which satisfies the boundary conditions&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x1">2.1</xref>) automatically. Practically, this means that we use <inline-formula><mml:math id="IM11"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (see equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x2">2.2</xref>)) in place of &#8706;<sub><italic>t</italic></sub><bold>B</bold>, where the overbar denotes the projection onto the Galerkin basis. The coefficients <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic> are then found through minimizing <italic>&#934;</italic>. We note that since <bold>B</bold>(<italic>t</italic>&#8201;+&#8201;<italic>h</italic>) is formally linear in <italic>u</italic><sub><italic>g</italic></sub>(<italic>s</italic>), <italic>T</italic>(<italic>s</italic>,&#8201;<italic>t</italic>&#8201;+&#8201;<italic>h</italic>) is then quadratic and hence <italic>&#934;</italic> quartic in the coefficients <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic>. Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] found the minimum using an iterative scheme, although we note that, in general (and without a good starting approximation), finding such a minimum may be problematic.</p><p>It is noteworthy, however, that in the axisymmetric case this analysis is greatly simplified. Through equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x3">4.3</xref>) only the azimuthal component of <bold>B</bold>(<italic>t</italic>&#8201;+&#8201;<italic>h</italic>) depends on <italic>u</italic><sub><italic>g</italic></sub>, and equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x1">3.1</xref>) shows that <italic>T</italic>(<italic>s</italic>) is now linear and <italic>&#934;</italic> quadratic in <italic>u</italic><sub><italic>g</italic></sub>, hence finding the minimum of <italic>&#934;</italic> is more straightforward.</p></sec><sec id="s4c"><label>(c)</label><title>An instantaneous axisymmetric method</title><p>Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>] also presented a method for finding an instantaneous solution for the geostrophic flow in axisymmetry. Through differentiating with respect to time equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x1">4.1</xref>) they arrive at the following first-order ODE, here referred to as the BWR<sup><xref ref-type="fn" rid="FN0001">1</xref></sup> (Braginsky&#8211;Wu&#8211;Roberts) equation:
<disp-formula id="RSPA20180412M4x8"><label>4.8</label><mml:math id="DM21"><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">BWR</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&#8801;</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>&#945;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>which is the same as&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x4">4.4</xref>) without the final term. This gives <italic>u</italic><sub><italic>g</italic></sub>(<italic>s</italic>) explicitly as
<disp-formula id="RSPA20180412M4x9"><label>4.9</label><mml:math id="DM22"><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>s</mml:mi><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:msub><mml:mi>&#945;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>In all the cases we consider,&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x9">4.9</xref>) can be solved analytically (with the assistance of computer algebra). A further property of this equation is that, for a purely poloidal axisymmetric magnetic field, the solution <italic>u</italic><sub><italic>g</italic></sub> is independent of the magnetic diffusivity <italic>&#951;</italic>. This is because &#8711;<sup>2</sup><bold>B</bold> is also purely poloidal and a purely poloidal field has no azimuthal component. Thus,
<disp-formula id="RSPA20180412UM7"><mml:math id="DM23"><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula>and the diffusion term (within <italic>S</italic><sub>0</sub>) then never appears in&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>). This differs from the case of a more general magnetic field with both toroidal and poloidal components, where <italic>u</italic><sub><italic>g</italic></sub> depends upon <italic>&#951;</italic>.</p><p>We also observe that for an axisymmetric purely toroidal field, since <italic>B</italic><sub><italic>s</italic></sub>&#8201;=&#8201;0 everywhere equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) is null because <italic>&#945;</italic><sub>0</sub>&#8201;=&#8201;<italic>S</italic><sub>0</sub>&#8201;=&#8201;0 reducing it to the tautology 0&#8201;=&#8201;0 and hence placing no constraint on the geostrophic flow.</p></sec><sec id="s4d"><label>(d)</label><title>Taylor's three-dimensional instantaneous method</title><p>We end this section by discussing the well-known (instantaneous) method of Taylor, who determined the unknown geostrophic flow by differentiating with respect to time (denoted by the over-dot shorthand) the Taylor integral in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) to produce:
<disp-formula id="RSPA20180412M4x10"><label>4.10</label><mml:math id="DM24"><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>.</mml:mo></mml:math></disp-formula>On substituting directly for <inline-formula><mml:math id="IM12"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> from equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x2">2.2</xref>) in addition to its curl (describing <inline-formula><mml:math id="IM13"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), Taylor showed that for fully three-dimensional Taylor states <bold>B</bold> the resulting equation for the geostrophic flow can be written in a remarkably succinct form as the second-order ordinary differential equation
<disp-formula id="RSPA20180412M4x11"><label>4.11</label><mml:math id="DM25"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8801;</mml:mo><mml:mi>&#945;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>&#946;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>In the above, the coefficients are
<disp-formula id="RSPA20180412M4x12"><label>4.12</label><mml:math id="DM26"><mml:mi>&#945;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>B</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mi>&#946;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>B</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#8901;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>s</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>and <italic>G</italic>(<italic>s</italic>) is a function describing the interaction of <bold><italic>u</italic></bold><sub><italic>a</italic></sub> and the magnetic field defined&#160;as
<disp-formula id="RSPA20180412UM8"><mml:math id="DM27"><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>&#981;</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>Note the mistake in Taylor [<xref rid="RSPA20180412C9" ref-type="bibr">9</xref>] where a factor of <italic>s</italic> is omitted within the coefficient <italic>&#946;</italic>. The functions <italic>&#945;</italic><sub>0</sub> and <italic>S</italic><sub>0</sub>, previously defined, are simply axisymmetric variants of <italic>&#945;</italic> given above and <italic>S</italic>(<italic>s</italic>) defined&#160;as
<disp-formula id="RSPA20180412UM9"><mml:math id="DM28"><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>where <bold><italic>C</italic></bold><sup><italic>a</italic></sup> is as defined in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x5">4.5</xref>). The fact that the coefficients <italic>&#945;</italic>(<italic>s</italic>) and <italic>&#946;</italic>(<italic>s</italic>) are spatially dependent means that analytic solutions to&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) are very rare and in general only numerical solutions are possible. Of crucial note is that the boundary conditions played no part in the derivation above.</p></sec></sec><sec id="s5"><label>5.</label><title>Technical aside: higher-order boundary conditions</title><sec id="s5a"><label>(a)</label><title>Higher-order boundary conditions in the heat equation</title><p>Taylor's method is based on the instantaneous evolution (which we can take to be at time <italic>t</italic>&#8201;=&#8201;0) of the magnetostrophic system whose magnetic field is prescribed and must satisfy Taylor's constraint. Here, we discuss higher-order boundary conditions, the importance of which has so far been overlooked. We start by introducing this concept in a simple PDE, then we discuss the relevance for Taylor's equation.</p><p>Suppose we are interested in finding <italic>f</italic>(<italic>x</italic>,&#8201;<italic>t</italic>) on <italic>x</italic>&#8712;[0,&#8201;1], whose evolution is described by the heat equation in the interior of the domain
<disp-formula id="RSPA20180412UM10"><mml:math id="DM29"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>to be solved with the boundary conditions <italic>f</italic>(0,&#8201;<italic>t</italic>)&#8201;=&#8201;<italic>f</italic>(1,&#8201;<italic>t</italic>)&#8201;=&#8201;0. For this simple equation, the general solution can be written in the form
<disp-formula id="RSPA20180412UM11"><mml:math id="DM30"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>&#960;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>&#960;</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>Let us now suppose we have an initial state:
<disp-formula id="RSPA20180412UM12"><mml:math id="DM31"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>which satisfies the boundary conditions. Its future evolution would be given by the projection onto the normal modes as above.</p><p>In Taylor's analysis, part of the integral in&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>) could be converted to a boundary term. Here we consider an analogy which is exactly integrable:
<disp-formula id="RSPA20180412M5x1"><label>5.1</label><mml:math id="DM32"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mo>&#8201;</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula></p><p>using the boundary conditions. In Taylor's derivation, he differentiated under the integral sign and substituted directly for &#8706;<italic>f</italic>/&#8706;<italic>t</italic>, in order to find the equation that <italic>u</italic><sub><italic>g</italic></sub> must satisfy using an instantaneous initial magnetic field. In our example, this produces
<disp-formula id="RSPA20180412M5x2"><label>5.2</label><mml:math id="DM33"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>x</mml:mi><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>&#8201;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>At <italic>t</italic>&#8201;=&#8201;0, we evaluate the above expression as &#8722;6 (note that <italic>f</italic><sub><italic>xxx</italic></sub>(<italic>x</italic>,&#8201;0)&#8201;=&#8201;&#8201;&#8722;&#8201;6) resulting in an apparent contradiction with&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x1">5.1</xref>) and illustrating that this approach is not generally valid.</p><p>The problem arises because the initial state does not satisfy the condition <italic>f</italic><sub><italic>xx</italic></sub>(0,&#8201;<italic>t</italic>)&#8201;=&#8201;<italic>f</italic><sub><italic>xx</italic></sub>(1,&#8201;<italic>t</italic>)&#8201;=&#8201;0, which arises from differentiating <italic>f</italic>(0,&#8201;<italic>t</italic>)&#8201;=&#8201;<italic>f</italic>(1,&#8201;<italic>t</italic>)&#8201;=&#8201;0 with respect to time and substituting&#160;the PDE. The condition <italic>f</italic><sub><italic>xx</italic></sub>(0,&#8201;<italic>t</italic>)&#8201;=&#8201;<italic>f</italic><sub><italic>xx</italic></sub>(1,&#8201;<italic>t</italic>)&#8201;=&#8201;0 is called the first-order boundary condition [<xref rid="RSPA20180412C30" ref-type="bibr">30</xref>]. The&#160;consequence of the initial state not satisfying the first-order boundary condition is that the solution is not smooth at the boundary at <italic>t</italic>&#8201;=&#8201;0. Specifically, the derivatives in&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x2">5.2</xref>) do not exist and thus the above derivation is not valid. As a simple illustration of the issue, note that the general solution implies that <inline-formula><mml:math id="IM14"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>&#960;</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>&#960;</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, which cannot represent the constant function <italic>f</italic><sub><italic>xxx</italic></sub>(<italic>x</italic>,&#8201;0)&#8201;=&#8201;&#8201;&#8722;&#8201;6 associated with the initial state. This lack of smoothness only occurs at the initial time <italic>t</italic>&#8201;=&#8201;0. At any later time (<italic>t</italic>&#8201;&gt;&#8201;0), the solution is infinitely smooth; this is the smoothing property of the heat equation.</p><p>In the very special case that the initial state satisfies the first-order boundary conditions (e.g. <italic>f</italic>(<italic>x</italic>,&#8201;0)&#8201;=&#8201;<italic>x</italic><sup>3</sup>(1&#8201;&#8722;&#8201;<italic>x</italic>)<sup>3</sup>) then there is no contradiction and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x1">5.1</xref>) and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x2">5.2</xref>) are consistent. However, for a general initial condition, the procedure adopted is not valid.</p></sec><sec id="s5b"><label>(b)</label><title>The relevance for Taylor's equation</title><p>We now discuss the relevance of the above discussion of higher-order boundary conditions in the context of the Earth's magnetic field. In the derivation of Taylor's second-order ODE&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>), it is implicitly assumed that <bold>B</bold> and all its time derivatives are (initially) smooth everywhere. Although it is somewhat hidden in Taylor's original derivation, taking the time-derivative of the equivalent form of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x1">3.1</xref>) makes this explicit:
<disp-formula id="RSPA20180412M5x3"><label>5.3</label><mml:math id="DM34"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>&#981;</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula>Taylor substituted everywhere the induction equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x2">2.2</xref>), <inline-formula><mml:math id="IM15"><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, but in view of the above discussion, we need to take care, particularly for the boundary terms.</p><p>We appeal to a reduced version of the magnetostrophic equations in order to probe what can be said about the behaviour of <bold>B</bold>(<italic>t</italic>) on the boundary at <italic>t</italic>&#8201;=&#8201;0. Assuming that <bold>u</bold>(<italic>t</italic>) is given and is independent of <bold>B</bold>, the induction equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x2">2.2</xref>) is of standard parabolic form (like the heat equation), so its solution is smooth for all <italic>t</italic>&#8201;&gt;&#8201;0. If the initial condition <bold>B</bold>(0) is also smooth and satisfies the boundary condition&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x1">2.1</xref>), then the solution is smooth also at <italic>t</italic>&#8201;=&#8201;0, except possibly at <italic>r</italic>&#8201;=&#8201;1. For the solution to be smooth everywhere, including at <italic>r</italic>&#8201;=&#8201;1, and for Taylor's substitution to be valid, we need the initial condition to satisfy not only the usual boundary condition (also termed the zero-order boundary conditions) but also the first-order boundary conditions: that &#8706;<sub><italic>t</italic></sub><bold>B</bold>, given by <inline-formula><mml:math id="IM16"><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x2">2.2</xref>) satisfies the boundary condition&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x1">2.1</xref>). Higher-order variants of the boundary conditions pertain to higher-order time derivatives. Assuming that this analysis extends to the full magnetostrophic equations, it provides strong constraints on the form of the initial condition that produces a solution that is smooth for <italic>t</italic>&#8805;0 and all <italic>r</italic>&#8805;0.</p><p>This issue of lack of smoothness of <bold>B</bold> occurs only instantaneously at <italic>t</italic>&#8201;=&#8201;0. One may ask if it is possible to specify an initial field that satisfies Taylor's constraint and higher-order boundary conditions, making it possible to use equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) directly. Although in principle the answer is yes, it would be practically impossible because an evaluation of the first-order boundary condition requires knowledge of &#8706;<sub><italic>t</italic></sub><bold>B</bold> and therefore <italic>u</italic><sub><italic>g</italic></sub>. The logic is therefore circular: we need to know <italic>u</italic><sub><italic>g</italic></sub> in order to check the method that enables us to find <italic>u</italic><sub><italic>g</italic></sub> in the first place. It would seem that some additional insight or good fortune would be required to find a geostrophic flow that is self-consistently satisfies the boundary conditions. The complication compounds the already difficult task of finding an initial condition that satisfies the necessary condition of being a Taylor state.</p><p>It is worth noting, however, that once the system has evolved past the initial condition many of these problems vanish. For <italic>t</italic>&#8201;&gt;&#8201;0, solutions to parabolic systems are smooth and so automatically satisfy all higher-order boundary conditions. It follows that equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) is valid for <italic>t</italic>&#8201;&gt;&#8201;0, although this does not help find the geostrophic flow at <italic>t</italic>&#8201;=&#8201;0.</p></sec><sec id="s5c"><label>(c)</label><title>Schemes in which the boundary information is included</title><p>These concerns described above regarding boundary conditions do not carry over to the axisymmetric case, the plane layer situation nor the three-dimensional implicit schemes described. In the axisymmetric and Cartesian cases (e.g. [<xref rid="RSPA20180412C31" ref-type="bibr">31</xref>]), the boundary conditions are evaluated to zero and the boundary value of the magnetic field or any of its time derivatives never enter any subsequent calculations. In the three-dimensional implicit scheme, because of the representation of all quantities (including <bold>B</bold> and any of its time derivatives) in terms of a Galerkin basis, boundary conditions to all orders are satisfied.</p><p>Thus in the axisymmetric and Cartesian cases, equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) and equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x4">4.4</xref>) are correct irrespective of the initial choice of Taylor state, as is the fully implicit method of &#167;<xref ref-type="sec" rid="s4">4</xref>b for the three-dimensional case. This is to be contrasted with&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) that is valid only for the subset of Taylor states satisfying zero- and first-order boundary conditions.</p></sec></sec><sec id="s6"><label>6.</label><title>An appraisal of Taylor's method</title><sec id="s6a"><label>(a)</label><title>An illustration of when Taylor's method fails</title><p>We are now in a position to provide a first explicit demonstration that Taylor's ODE equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) fails when using an initial Taylor state that does not satisfy first-order boundary conditions. We show this in two parts. Firstly, within axisymmetry, we demonstrate that Taylor's equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) is formally inconsistent with the BWR equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>); secondly, we plot an explicit solution of Taylor's equation and show that it does not agree with those derived from other methods known to be correct. In &#167;&#167;<xref ref-type="sec" rid="s8">8</xref>&#8211;<xref ref-type="sec" rid="s10">10</xref>, we will show that our generalized version of Taylor's method shows agreement among all methods.</p><p>We consider the simple case of the dipolar, single spherical harmonic <italic>l</italic>&#8201;=&#8201;1 axisymmetric poloidal magnetic field
<disp-formula id="RSPA20180412UM13"><mml:math id="DM35"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>30</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>57</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM17"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>231</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>20584</mml:mn></mml:msqrt></mml:math></inline-formula> is a scaling constant (see &#167;<xref ref-type="sec" rid="s2">2</xref>a). We note that <bold>B</bold> satisfies the electrically insulating boundary conditions&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x1">2.1</xref>), and is an exact Taylor state owing to its simple symmetry.</p><p>The ageostrophic flow (determined for example by the method described in appendix&#160;Ac) has only an azimuthal component given by
<disp-formula id="RSPA20180412M6x1"><label>6.1</label><mml:math id="DM36"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mi>&#981;</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:mn>9120</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>7</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>50400</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>26184</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>5</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>50400</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>95760</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>23888</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>16800</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>6</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>47880</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>42000</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>6824</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>For this choice of B, equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) then provides an exact expression for the first derivative of <italic>u</italic><sub><italic>g</italic></sub>. Substituting this into Taylor's second-order equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) renders it unbalanced. Thus none of the solutions of the first-order ODE&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>), satisfy the second-order ODE&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>). Full details of this are given in the electronic supplementary material.</p><p>This specific case (which is illustrative of the general case) shows that equations&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) are inconsistent: in particular, the first-order equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) is not simply the first integral of the second-order equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>). The reason why they are not consistent is that although the ODEs are derived from the equivalent forms&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>) and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M1x2">1.2</xref>), the boundary terms are used to derive&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) but not&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>). Thus, the two equations embody different information. In this example, Taylor's method is equivalent to the erroneous replacement of &#8706;<sub><italic>t</italic></sub><italic>B</italic><sub><italic>&#981;</italic></sub> (which is zero) in the boundary term of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>), by <inline-formula><mml:math id="IM18"><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo>&#8800;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. This can be seen in the expression for the coefficient <italic>&#946;</italic> given in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x10">6.10</xref>), where the boundary term is such that it does not vanish in the axisymmetric case. While the initial magnetic field has been chosen such that it satisfies the boundary condition&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x1">2.1</xref>), through computing &#8706;<sub><italic>t</italic></sub><bold>B</bold> we can show that, based on Taylor's solution, the initial rate of change of the magnetic field violates this boundary condition.</p><p>To confirm that Taylor's method is not generally valid, we now directly compare solutions from various methods. Integrating equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) analytically gives the solution
<disp-formula id="RSPA20180412M6x2"><label>6.2</label><mml:math id="DM37"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>s</mml:mi></mml:mrow><mml:mn>918060</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mn>9926860800</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>32213813760</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>37855940880</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>11143964160</mml:mn><mml:mi>ln</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mn>30664844</mml:mn><mml:msqrt><mml:mn>21</mml:mn></mml:msqrt><mml:mi>arctan</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>80</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>73</mml:mn></mml:mrow><mml:msqrt><mml:mn>21</mml:mn></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>101695629</mml:mn><mml:mi>ln</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>640</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1168</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>535</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>We note that the solution is a sum of odd polynomials, an <italic>s</italic>&#8201;ln(<italic>s</italic>) term and additional (and non-singular) ln and arctan terms. The constant <italic>C</italic> is determined through enforcing zero solid body rotation (equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x3">2.3</xref>)). The solution for <italic>u</italic><sub><italic>g</italic></sub> is everywhere continuous and finite, only at <italic>s</italic>&#8201;=&#8201;0 is there a weak singularity: &#8706;<sub><italic>s</italic></sub>(<italic>u</italic><sub><italic>g</italic></sub>/<italic>s</italic>)&#8764;1/<italic>s</italic>. We also observe that there is no singularity at <italic>s</italic>&#8201;=&#8201;1. A comparable analytic solution but for a quadrupolar axisymmetric magnetic field was given in Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>], which is also regular everywhere except for a weak <italic>s</italic>ln(<italic>s</italic>) singularity at <italic>s</italic>&#8201;=&#8201;0. That the analytic expression&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x2">6.2</xref>) is indeed the true solution is confirmed by <xref ref-type="fig" rid="RSPA20180412F1">figure 1</xref><italic>a</italic> which compares it to the geostrophic flow given by the independent three-dimensional implicit scheme of &#167;<xref ref-type="sec" rid="s4">4</xref>b; the two solutions over-plot. A contour plot of the total azimuthal flow is shown in &#167;<xref ref-type="sec" rid="s9">9</xref> (<xref ref-type="fig" rid="RSPA20180412F6">figure 6</xref><italic>a</italic>).
<fig id="RSPA20180412F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>A comparison of the cases where Taylor's method fails and where it succeeds. (<italic>a</italic>) Compares the solutions for the geostrophic flow for an axisymmetric dipolar poloidal initial field. Red is the analytic solution of the first-order BWR equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>), dotted line is a numerical solution of Taylor's second-order ODE (see text) and dashed line is the solution using the implicit time step method with <italic>h</italic>&#8201;=&#8201;10<sup>&#8722;9</sup>. (<italic>b</italic>) Shows the geostrophic flow corresponding to a non-axisymmetric <italic>l</italic>&#8201;=&#8201;1, <italic>m</italic>&#8201;=&#8201;1 purely toroidal Taylor state, on which all methods agree. (Online version in colour.)&#160;</p></caption><graphic xlink:href="rspa20180412-g1"/></fig>
</p><p>We now directly compare this solution with that obtained by solving Taylor's equation (<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>), shown as the dotted line of <xref ref-type="fig" rid="RSPA20180412F1">figure 1</xref><italic>a</italic>. This solution is found by adopting the expansion&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>) and minimizing the integrated squared residual
<disp-formula id="RSPA20180412M6x3"><label>6.3</label><mml:math id="DM38"><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>with respect to the spectral coefficients, whose truncation is increased until the solution converges.</p><p>Although all solutions agree at small <italic>s</italic>, Taylor's solution shows significant differences from the others for <italic>s</italic>&#8201;&gt;&#8201;0.8.</p><p>It is also of interest to assess numerical convergence to solutions of equations&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>). Although we have an analytic solution to&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>), we use the same numerical method as given above but now applied to&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) by minimizing
<disp-formula id="RSPA20180412M6x4"><label>6.4</label><mml:math id="DM39"><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">BWR</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:math></disp-formula><xref ref-type="fig" rid="RSPA20180412F2">Figure 2</xref> demonstrates that convergence of the solution is faster for the correct, first-order equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) than for Taylor's equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>). Therefore, aside from Taylor's equation being generally inapplicable, it seems that converged solutions are also relatively more difficult to find.
<fig id="RSPA20180412F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>A comparison of the absolute value of the polynomial spectral coefficients <italic>A</italic><sub><italic>i</italic></sub>, defined in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>), against degree for numerical solutions using the BWR and Taylor formulations. (Online version in colour.)</p></caption><graphic xlink:href="rspa20180412-g2"/></fig></p></sec><sec id="s6b"><label>(b)</label><title>Specific cases when Taylor's method succeeds</title><p>For arbitrary purely toroidal Taylor states bounded by an electrical insulator, <bold>B</bold> vanishes on <italic>r</italic>&#8201;=&#8201;1 and in this special case Taylor's methodology is correct. This is because the boundary term involving <italic>B</italic><sub><italic>&#981;</italic></sub><italic>B</italic><sub><italic>r</italic></sub> (see equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>)) has a &#8216;double zero&#8217; and so, when considering its time derivative, erroneous substitution for &#8706;<sub><italic>t</italic></sub><bold>B</bold> leaves it invariant as zero.</p><p>Taking the time derivative of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>), noting that the boundary term is zero, we obtain
<disp-formula id="RSPA20180412M6x5"><label>6.5</label><mml:math id="DM40"><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula>Using the three-dimensional extension of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x3">4.3</xref>)
<disp-formula id="RSPA20180412M6x6"><label>6.6</label><mml:math id="DM41"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>&#981;</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where &#8706;<sub>1</sub>/&#8706;<italic>&#981;</italic> is a derivative with respect to <italic>&#981;</italic> that leaves invariant the unit vectors (e.g. [<xref rid="RSPA20180412C29" ref-type="bibr">29</xref>]), the term involving <italic>u</italic><sub><italic>g</italic></sub> in&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x5">6.5</xref>) becomes
<disp-formula id="RSPA20180412UM14"><mml:math id="DM42"><mml:mi>s</mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msubsup><mml:mi>B</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:mfrac><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>&#981;</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>.</mml:mo></mml:math></disp-formula>Noting that the last integral is zero, we obtain an equation (that holds in three dimensions) that is of the same form as the axisymmetric BWR equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>)
<disp-formula id="RSPA20180412M6x7"><label>6.7</label><mml:math id="DM43"><mml:mi>s</mml:mi><mml:mi>&#945;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>As an illustration, we consider the non-axisymmetric <italic>l</italic>&#8201;=&#8201;1, <italic>m</italic>&#8201;=&#8201;1 toroidal magnetic field
<disp-formula id="RSPA20180412UM15"><mml:math id="DM44"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>A</italic> is a scaling constant which takes the value <inline-formula><mml:math id="IM19"><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msqrt><mml:mn>105</mml:mn></mml:msqrt></mml:math></inline-formula>. The ageostrophic flow is
<disp-formula id="RSPA20180412M6x8"><label>6.8</label><mml:math id="DM45"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>3</mml:mn></mml:mfrac><mml:mi>s</mml:mi><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>6</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>10</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>15</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>cos</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>105</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>5</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>30</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>130</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>15</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>30</mml:mn><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>25</mml:mn><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>&#8722;</mml:mo><mml:mn>56</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>5</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>72</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>16</mml:mn><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>and, solving&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x7">6.7</xref>), the geostrophic flow is
<disp-formula id="RSPA20180412M6x9"><label>6.9</label><mml:math id="DM46"><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="false"><mml:mfrac><mml:mn>97</mml:mn><mml:mn>30</mml:mn></mml:mfrac></mml:mstyle><mml:msup><mml:mi>s</mml:mi><mml:mn>5</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mstyle displaystyle="false"><mml:mfrac><mml:mn>77</mml:mn><mml:mn>15</mml:mn></mml:mfrac></mml:mstyle><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>C</italic><sub>1</sub> is determined through considerations of angular momentum. Note the absence of singularities in this solution.</p><p>This geostrophic flow is shown in <xref ref-type="fig" rid="RSPA20180412F1">figure 1</xref><italic>b</italic>, and we note that the three-dimensional implicit method and Taylor's method give the same solution (not shown).</p><p>It is in fact simple for us to show analytically that for any purely toroidal field, Taylor's equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) and equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x7">6.7</xref>) are equivalent, up to the requirement of a further boundary condition for the second-order differential equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>).</p><p>We note that via integration by parts,&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x12">4.12</xref>) can be written in the following way, which allows identification of the boundary term present within Taylor's method, as the second term in the following expression for the coefficient <italic>&#946;</italic>:
<disp-formula id="RSPA20180412M6x10"><label>6.10</label><mml:math id="DM47"><mml:mi>&#946;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mi>&#945;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mo>&#8750;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></disp-formula>We observe that since <italic>B</italic><sub><italic>r</italic></sub>&#8201;=&#8201;0 for a purely toroidal field, then the boundary term within equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x10">6.10</xref>) will always vanish in this case, reducing Taylor's equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) to the BWR equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x7">6.7</xref>).</p></sec></sec><sec id="s7"><label>7.</label><title>A generalization of Taylor's analysis</title><p>To modify the method of Taylor so that it applies to a magnetic field that does not satisfy the first-order boundary conditions, we use&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>) to impose stationarity of the Taylor constraint. Equally, we could impose stationarity of the equivalent equation (<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>) but it is simpler to avoid the additional integral in <italic>s</italic>. Bearing in mind our discussion in &#167;<xref ref-type="sec" rid="s5">5</xref>, we take particular care to ensure correct handling of the boundary term.</p><p>The magnetic field matches continuously (since <italic>&#951;</italic>&#8800;0) with an external potential field within the mantle <italic>r</italic>&#8805;1. Note that our assumption of a globally continuous solution differs from the case when <italic>&#951;</italic>&#8201;=&#8201;0, for which horizontal components of <bold>B</bold> may be discontinuous on <italic>r</italic>&#8201;=&#8201;1 [<xref rid="RSPA20180412C32" ref-type="bibr">32</xref>]. In our setting where <italic>&#951;</italic>&#8800;0, the field matches continuously but not necessarily smoothly across <italic>r</italic>&#8201;=&#8201;1. We note however that owing to &#8711;&#8201;&#183;&#8201;<bold>B</bold>&#8201;=&#8201;0, the radial component of <bold>B</bold> (and all its time derivatives) are always smooth at <italic>r</italic>&#8201;=&#8201;1 (e.g. [<xref rid="RSPA20180412C33" ref-type="bibr">33</xref>]): thus only the horizontal components <italic>B</italic><sub><italic>&#952;</italic></sub> and <italic>B</italic><sub><italic>&#981;</italic></sub> are not in general smooth.</p><p>Thus, in the first term of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>), we may substitute at <italic>t</italic>&#8201;=&#8201;0
<disp-formula id="RSPA20180412M7x1"><label>7.1</label><mml:math id="DM48"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing=".5em" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mn>0</mml:mn><mml:mo>&#8804;</mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="2em"/><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mn>0</mml:mn><mml:mo>&#8804;</mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1.</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>For the second (boundary) term, we may substitute <inline-formula><mml:math id="IM20"><mml:msub><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> but the initial value of &#8706;<sub><italic>t</italic></sub><italic>B</italic><sub><italic>&#981;</italic></sub> at <italic>r</italic>&#8201;=&#8201;1 is not specified by <inline-formula><mml:math id="IM21"><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula> alone, as assumed in Taylor's derivation.</p><p>The key remaining issue is then to find the initial boundary value of <inline-formula><mml:math id="IM22"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula>, for which we present three methods below. Having done this, all terms are defined and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>) provides an implicit determination of <italic>u</italic><sub><italic>g</italic></sub> up to the usual considerations of solid body rotation and regularity.</p><p>We observe that the form of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>) differs markedly from equations&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x11">4.11</xref>) and&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>): in addition to the spatial derivatives of <italic>u</italic><sub><italic>g</italic></sub> (in the leftmost term), there is an explicit boundary term. For the general case, this boundary term must be retained, although it may be neglected under certain circumstances: e.g. those of &#167;&#167;<xref ref-type="sec" rid="s6">6</xref>b and <xref ref-type="sec" rid="s9">9</xref>.</p><p>We remark that the above instantaneous method can be amended to a first-order implicit scheme (akin to equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x4">4.4</xref>)) by considering
<disp-formula id="RSPA20180412M7x2"><label>7.2</label><mml:math id="DM49"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>&#981;</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#915;</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo></mml:math></disp-formula>As before, this equation is applicable even when <italic>&#915;</italic><sub><italic>z</italic></sub>&#8800;0, that is, if the solution is close but not exactly on the Taylor manifold.</p><sec id="s7a"><label>(a)</label><title>A potential-based spherical transform method</title><p>One way to find <inline-formula><mml:math id="IM23"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula> on <italic>r</italic>&#8201;=&#8201;1 is to note that it is the azimuthal component of the potential field in <italic>r</italic>&#8805;1
<disp-formula id="RSPA20180412UM16"><mml:math id="DM50"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>V</mml:mi><mml:mspace width="0.167em"/></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mspace width="-0.167em"/></mml:mrow><mml:mrow><mml:mo>&#8201;</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>V</mml:mi><mml:mspace width="0.167em"/></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mspace width="-0.167em"/></mml:mrow><mml:mrow><mml:mo>&#8201;</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula>The potential <inline-formula><mml:math id="IM24"><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is itself determined through continuity of the radial component <inline-formula><mml:math id="IM25"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> at <italic>r</italic>&#8201;=&#8201;1 and thus depends upon <italic>u</italic><sub><italic>g</italic></sub>. This method of determining <inline-formula><mml:math id="IM26"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>&#981;</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> has been introduced in the study of torsional waves by Jault [<xref rid="RSPA20180412C29" ref-type="bibr">29</xref>], but is implemented here for the evaluation of the geostrophic flow.</p><p>The time derivative of the potential <inline-formula><mml:math id="IM27"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>V</mml:mi><mml:mspace width="0.167em"/></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mspace width="-0.167em"/></mml:mrow><mml:mrow><mml:mo>&#8201;</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be written in terms of orthonormal spherical harmonics <italic>Y</italic><sub><italic>lm</italic></sub> with unknown coefficients <italic>a</italic><sub><italic>lm</italic></sub> as
<disp-formula id="RSPA20180412UM17"><mml:math id="DM51"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>V</mml:mi><mml:mspace width="0.167em"/></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mspace width="-0.167em"/></mml:mrow><mml:mrow><mml:mo>&#8201;</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>&#8722;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>where 0&#8804;<italic>l</italic>&#8804;<italic>L</italic><sub>max</sub> and &#8722;<italic>l</italic>&#8804;<italic>m</italic>&#8804;<italic>l</italic> and
<disp-formula id="RSPA20180412UM18"><mml:math id="DM52"><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>&#937;</italic> is an element of solid angle. It follows then that on <italic>r</italic>&#8201;=&#8201;1
<disp-formula id="RSPA20180412UM19"><mml:math id="DM53"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover><mml:mi>a</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>&#981;</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula>Key to the implementation of this method here is a spectral expansion of <italic>u</italic><sub><italic>g</italic></sub>, for example&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>), because it allows <inline-formula><mml:math id="IM28"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> (which depends on the <italic>I</italic>&#8201;+&#8201;2 spectral coefficients of <italic>u</italic><sub><italic>g</italic></sub>) to be evaluated everywhere on the boundary, as required in the above spherical transform. This is to be contrasted, for example, with a finite difference representation of <italic>u</italic><sub><italic>g</italic></sub> where no such evaluation is possible.</p><p>To find <italic>u</italic><sub><italic>g</italic></sub>, we note that all time-derivative terms in the left-hand side of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>), including those evaluated on the boundary, are linear in the unknown coefficients (<italic>A</italic><sub>0</sub>,&#8201;<italic>A</italic><sub>1</sub>,&#8201;&#8230;,&#8201;<italic>A</italic><sub><italic>I</italic></sub>,&#8201;<italic>B</italic>), and hence the residual is of the form
<disp-formula id="RSPA20180412UM20"><mml:math id="DM54"><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>for some functions <italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic> and <italic>c</italic> that depend on <bold>B</bold> and <bold>u</bold><sub><italic>a</italic></sub>. We formulate a single equation for the coefficients defining <italic>u</italic><sub><italic>g</italic></sub> by minimizing the quantity <inline-formula><mml:math id="IM29"><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:math></inline-formula> (which is quadratic in the coefficients that we seek). Note that the solution is approximate and depends on two parameters <italic>I</italic> and <inline-formula><mml:math id="IM30"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, which represent the truncation of the expansion used and care must be taken to ensure we achieve convergence in each.</p></sec><sec id="s7b"><label>(b)</label><title>A potential-based Green's function method</title><p>An alternative method for determining the potential <inline-formula><mml:math id="IM31"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>V</mml:mi><mml:mspace width="0.167em"/></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mspace width="-0.167em"/></mml:mrow><mml:mrow><mml:mo>&#8201;</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at the core mantle boundary is through the use of a Green's function convolved with <inline-formula><mml:math id="IM32"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> on <italic>r</italic>&#8201;=&#8201;1. Following [<xref rid="RSPA20180412C34" ref-type="bibr">34</xref>,<xref rid="RSPA20180412C35" ref-type="bibr">35</xref>], the relevant Green's function associated with the Laplace equation in the exterior of a sphere with Neumann boundary conditions is
<disp-formula id="RSPA20180412UM21"><mml:math id="DM55"><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>&#956;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>&#960;</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>&#8722;</mml:mo><mml:mi>&#956;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:mi>&#956;</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>x</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>x</italic>&#8201;=&#8201;1/<italic>r</italic>, <italic>f</italic>&#8201;=&#8201;(1&#8201;&#8722;&#8201;2<italic>x&#956;</italic>&#8201;+&#8201;<italic>x</italic><sup>2</sup>)<sup>1/2</sup>, <italic>&#956;</italic>&#8201;=&#8201;cos<italic>&#952;</italic>cos<italic>&#952;</italic>&#8242;&#8201;+&#8201;sin<italic>&#952;</italic>sin<italic>&#952;</italic>&#8242;cos(<italic>&#981;</italic>&#8201;&#8722;&#8201;<italic>&#981;</italic>&#8242;). This can be expressed as <italic>N</italic>(<italic>x</italic>,&#8201;<italic>&#956;</italic>)&#8201;=&#8201;<italic>N</italic>(1/<italic>r</italic>,&#8201;<italic>&#952;</italic>,&#8201;<italic>&#952;</italic>&#8242;,&#8201;<italic>&#981;</italic>&#8201;&#8722;&#8201;<italic>&#981;</italic>&#8242;), which is the potential at location (<italic>r</italic>,&#8201;<italic>&#952;</italic>,&#8201;<italic>&#981;</italic>) in <italic>r</italic>&#8805;1 due to a singularity of unit strength in the radial field at (<italic>&#952;</italic>&#8242;,&#8201;<italic>&#981;</italic>&#8242;) on the core&#8211;mantle boundary. Making use of the periodicity of <italic>&#981;</italic>, the magnetic potential in the region <italic>r</italic>&#8805;1 can then be written as
<disp-formula id="RSPA20180412UM22"><mml:math id="DM56"><mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#960;</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>&#960;</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>&#981;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>&#981;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>and so
<disp-formula id="RSPA20180412UM23"><mml:math id="DM57"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#960;</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>&#960;</mml:mi></mml:msubsup><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>&#981;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>&#981;</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>&#981;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>&#952;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>&#981;</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>Like the previous method, this procedure of evaluating <inline-formula><mml:math id="IM33"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula> on <italic>r</italic>&#8201;=&#8201;1 requires an integral over all solid angle. Using again our spectral expansion&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>), this results in <inline-formula><mml:math id="IM34"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula> being a linear function of the unknown spectral coefficients; thus using equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>) the geostrophic flow can then be determined as in &#167;<xref ref-type="sec" rid="s7">7</xref>a.</p></sec><sec id="s7c"><label>(c)</label><title>A modal projection</title><p>A further alternative method to find <inline-formula><mml:math id="IM35"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula> on <italic>r</italic>&#8201;=&#8201;1, which does not rely on a magnetic potential, is to employ a modal basis set for the magnetic field that is complete and satisfies the required boundary conditions. Here, we adopt a numerically expedient Galerkin basis set (see appendix&#160;Aa for details), whose orthonormal poloidal and toroidal modes are written, respectively, as <inline-formula><mml:math id="IM36"><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and&#160;<inline-formula><mml:math id="IM37"><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>.</p><p>By using such a representation, boundary conditions to all orders are automatically satisfied and therefore a direct substitution of the projected representation of <inline-formula><mml:math id="IM38"><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>,
<disp-formula id="RSPA20180412M7x3"><label>7.3</label><mml:math id="DM58"><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula>for &#8706;<sub><italic>t</italic></sub><bold>B</bold> in all three components for the whole sphere <italic>r</italic>&#8804;1 is justified. In the above, <italic>l</italic> is bounded by <inline-formula><mml:math id="IM39"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="IM40"><mml:mn>0</mml:mn><mml:mo>&#8804;</mml:mo><mml:mi>n</mml:mi><mml:mo>&#8804;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM41"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> indicates the modal projection of <bold>x</bold> (see appendix&#160;Ab).</p><p>As before, key to the method here is the spectral representation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>) for <italic>u</italic><sub><italic>g</italic></sub>; the coefficients <italic>c</italic><sub><italic>l</italic>,<italic>m</italic>,<italic>n</italic></sub> and <italic>d</italic><sub><italic>l</italic>,<italic>m</italic>,<italic>n</italic></sub>, found by integration (see appendix&#160;Ab), then depend linearly on the unknown coefficients <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic>.</p><p>Equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>) can be then written as the following, in which <italic>u</italic><sub><italic>g</italic></sub> appears explicitly
<disp-formula id="RSPA20180412M7x4"><label>7.4</label><mml:math id="DM59"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd/><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mi>s</mml:mi><mml:mi>&#945;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo accent="false">&#175;</mml:mo></mml:mover><mml:mo>}</mml:mo></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:mphantom></mml:mpadded></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mover><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo accent="false">&#175;</mml:mo></mml:mover><mml:mo>}</mml:mo></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>and
<disp-formula id="RSPA20180412M7x5"><label>7.5</label><mml:math id="DM60"><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mover><mml:mi>G</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:mfrac><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>&#8747;</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:msqrt><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac><mml:msub><mml:mo>&#8750;</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>&#981;</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mover><mml:msup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo accent="false">&#175;</mml:mo></mml:mover><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>&#981;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where the modal projection onto the Galerkin basis is required for an accurate representation of <inline-formula><mml:math id="IM42"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>&#981;</mml:mi></mml:msub></mml:math></inline-formula> within the boundary term. Note that it is not necessary to project the term representing <inline-formula><mml:math id="IM43"><mml:msub><mml:mrow><mml:mover><mml:mi>B</mml:mi><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, due to the fact that the radial component of a divergence-free field must be smooth at the boundary.</p><p>This approach may be considered as the most direct generalization of the BWR equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>) to three dimensions. We note that under the assumption of axisymmetry, equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M7x4">7.4</xref>) can be directly integrated to obtain the BWR equation (<xref ref-type="disp-formula" rid="RSPA20180412M4x8">4.8</xref>).</p><p>Although on one level, a simpler method than those previously presented because we do not need to calculate <inline-formula><mml:math id="IM44"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>V</mml:mi><mml:mspace width="0.167em"/></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow><mml:mspace width="-0.167em"/></mml:mrow><mml:mrow><mml:mo>&#8201;</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in fact the method is more computationally expensive for two reasons. First, we need to check convergence in three parameters: <inline-formula><mml:math id="IM45"><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, rather than just the first two; second, because the orthonormality requires an integration over radius, in addition to the integration over solid angle required by both methods.</p></sec></sec><sec id="s8"><label>8.</label><title>Examples of the geostrophic flow in three dimensions</title><p>We now give some examples to illustrate our generalized methodology for computing the instantaneous geostrophic flow associated with three-dimensional Taylor states, using our spherical-transform method. These will be compared with the solution obtained using the fully implicit three-dimensional method with a very small timestep of <italic>h</italic>&#8201;=&#8201;10<sup>&#8722;9</sup>; in all cases, the solutions overplot. In none of the cases is an analytic solution available for comparison. For further comparison, we plot also the solution of Taylor's ODE (see equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x3">6.3</xref>)).</p><p>We consider firstly an example of a non-axisymmetric <italic>l</italic>&#8201;=&#8201;2, <italic>m</italic>&#8201;=&#8201;2 poloidal magnetic field
<disp-formula id="RSPA20180412M8x1"><label>8.1</label><mml:math id="DM61"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi>A</mml:mi><mml:mfrac><mml:mrow><mml:mn>45</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>7</mml:mn><mml:mo>&#8722;</mml:mo><mml:mn>5</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>sin</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mn>2</mml:mn><mml:mi>&#981;</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM46"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>6</mml:mn><mml:msqrt><mml:mn>390</mml:mn></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. <xref ref-type="fig" rid="RSPA20180412F3">Figure 3</xref> shows that the implicit and instantaneous solutions agree, whereas similar to the axisymmetric case of <xref ref-type="fig" rid="RSPA20180412F1">figure 1</xref><italic>a</italic> we can see that Taylor's solution differs significantly particularly near <italic>s</italic>&#8201;=&#8201;1.
<fig id="RSPA20180412F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>The geostrophic flow for the non-axisymmetric <italic>l</italic>&#8201;=&#8201;2, <italic>m</italic>&#8201;=&#8201;2 poloidal Taylor state of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M8x1">8.1</xref>). Solutions using the spherical transform method, the implicit timestep method with <italic>h</italic>&#8201;=&#8201;10<sup>&#8722;9</sup> and Taylor's ODE are compared. (Online version in colour.)</p></caption><graphic xlink:href="rspa20180412-g3"/></fig></p><p>For all our three-dimensional solutions, the expansion for <italic>u</italic><sub><italic>g</italic></sub> differs from that in axisymmetry given in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>). We now do not include a logarithmic term. As discussed in &#167;<xref ref-type="sec" rid="s10">10</xref>a, the logarithmic behaviour is not expected outside of axisymmetry and would violate the assumed regularity of the magnetic field.</p><p>The approximate polynomial solution, with coefficients rounded to five significant figures, is
<disp-formula id="RSPA20180412UM24"><mml:math id="DM62"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mn>94.079</mml:mn><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>550.14</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>2196.4</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>5</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>3292.7</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>7</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>2178.4</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>9</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>11996</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>&#8722;</mml:mo><mml:mn>35435</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>42961</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>15</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>24113</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>17</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>5248.3</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>19</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where the expansion has been truncated at <italic>s</italic><sup>19</sup> and convergence achieved with parameters <inline-formula><mml:math id="IM47"><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math></inline-formula>.</p><p>We secondly consider a more complex example of a non-axisymmetric magnetic field, which contains both <italic>l</italic>&#8201;=&#8201;2, <italic>m</italic>&#8201;=&#8201;1 toroidal and poloidal components
<disp-formula id="RSPA20180412M8x2"><label>8.2</label><mml:math id="DM63"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mn>45</mml:mn><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>7</mml:mn><mml:mo>&#8722;</mml:mo><mml:mn>5</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>sin</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#981;</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula><mml:math id="IM48"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>5</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msqrt><mml:mn>21</mml:mn></mml:msqrt></mml:math></inline-formula> and <inline-formula><mml:math id="IM49"><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mn>7</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>262440</mml:mn></mml:msqrt></mml:math></inline-formula>. <xref ref-type="fig" rid="RSPA20180412F4">Figure 4</xref> shows that again the solution using the instantaneous method is validated by the implicit method, whereas Taylor's solution deviates as <italic>s</italic>&#8201;&#8594;&#8201;1. The figure also shows the geostrophic flow generated separately by either the purely toroidal or purely poloidal magnetic field component, each individually a Taylor state. As anticipated by the structure of the equation for <italic>u</italic><sub><italic>g</italic></sub> (nonlinear in <bold>B</bold>), the geostrophic flow driven by the total field does not equal the sum of the individually driven geostrophic flows.
<fig id="RSPA20180412F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>The geostrophic flow for the <italic>l</italic>&#8201;=&#8201;2, <italic>m</italic>&#8201;=&#8201;1 non-axisymmetric mixed Taylor state of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M8x2">8.2</xref>). Solutions using the spherical transform method, the implicit timestep method with <italic>h</italic>&#8201;=&#8201;10<sup>&#8722;9</sup> and Taylor's ODE are compared. Solutions for solely either the poloidal and toroidal components of the Taylor state using the spherical transform method are also shown. (Online version in colour.)</p></caption><graphic xlink:href="rspa20180412-g4"/></fig></p></sec><sec id="s9"><label>9.</label><title>Analytic approximation for an Earth-like field</title><p>Based on the present structure of the geomagnetic field, various studies show that it is reasonable to neglect the boundary term in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M3x2">3.2</xref>) in an Earth-like context [<xref rid="RSPA20180412C1" ref-type="bibr">1</xref>,<xref rid="RSPA20180412C36" ref-type="bibr">36</xref>]. This is because not only is the magnetic field likely much stronger inside the core than on <italic>r</italic>&#8201;=&#8201;1, but also because only the non-axisymmetric field contributes to the boundary term and it is relatively weak. The estimated strength of the magnetic inside the core is 5&#8201;mT, and that of the non-axisymmetric field on <italic>r</italic>&#8201;=&#8201;1 is 0.5&#8201;mT; therefore, the relative magnitude of the boundary to the interior terms is about 1/10<sup>2</sup> or 1%. The negligible effect of the boundary term has been verified in the case of related studies of torsional waves [<xref rid="RSPA20180412C26" ref-type="bibr">26</xref>,<xref rid="RSPA20180412C37" ref-type="bibr">37</xref>].</p><p>Should we neglect the boundary term entirely, then the geostrophic flow is described by the same equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x7">6.7</xref>) that pertains to a purely toroidal field, whose solution is
<disp-formula id="RSPA20180412M9x1"><label>9.1</label><mml:math id="DM64"><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>s</mml:mi><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mi>&#945;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula>If <italic>&#945;</italic>(<italic>s</italic>)&#8201;&gt;&#8201;0, then this equation is integrable. A continuous solution for <italic>u</italic><sub><italic>g</italic></sub> does not exist, however, if <italic>B</italic><sup>2</sup><sub><italic>s</italic></sub> is everywhere zero on a geostrophic cylinder <italic>C</italic>(<italic>s</italic>*) (rendering <italic>&#945;</italic>(<italic>s</italic>*)&#8201;=&#8201;0). Physically, this would mean that the magnetic field fails to couple cylinders on either side of <italic>s</italic>&#8201;=&#8201;<italic>s</italic>*, leading to a discontinuity in the geostrophic flow.</p><p>In the Taylor states we use, <bold>B</bold> is of polynomial form and it then follows that <italic>S</italic> and <italic>&#945;</italic> are also polynomial (up to a square root factor arising from the geometry) and therefore <italic>u</italic><sub><italic>g</italic></sub> can (in general) be found in closed form. We note that, in general, <italic>S</italic>/<italic>&#945;</italic> is <italic>O</italic>(1) and so <italic>u</italic><sub><italic>g</italic></sub> behaves as <italic>s</italic>ln(<italic>s</italic>) as <italic>s</italic>&#8201;&#8594;&#8201;0.</p><p>As an example of this approach, here we construct an Earth-like Taylor state comprising an axisymmetric poloidal mode and a non-axisymmetric toroidal mode, scaled such that the magnitude of the asymmetric part is 20% of the magnitude of the axisymmetric part, but that the total RMS field strength is unity:
<disp-formula id="RSPA20180412M9x2"><label>9.2</label><mml:math id="DM65"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>sin</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mn>2</mml:mn><mml:mi>&#981;</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfrac><mml:mn>21</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>&#8722;</mml:mo><mml:mn>3</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mo>&#8289;</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM50"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mn>28875</mml:mn></mml:msqrt><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM51"><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mn>966</mml:mn></mml:msqrt></mml:math></inline-formula>. The analytic solution of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M9x1">9.1</xref>) is
<disp-formula id="RSPA20180412UM25"><mml:math id="DM66"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:mn>1185586336</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mo>&#8722;</mml:mo><mml:mn>3645348420</mml:mn><mml:msqrt><mml:mn>10626</mml:mn></mml:msqrt><mml:mi>arctan</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>5</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>5</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mn>10626</mml:mn></mml:msqrt></mml:mrow><mml:mn>42</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>9801464537150</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mo>&#8722;</mml:mo><mml:mn>12073529601375</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>633064443000</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>25808428800</mml:mn><mml:mi>ln</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>5</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>5</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mn>10626</mml:mn></mml:msqrt></mml:mrow><mml:mn>42</mml:mn></mml:mfrac></mml:mphantom></mml:mpadded></mml:mrow><mml:mo>+</mml:mo><mml:mn>25531026444</mml:mn><mml:mo>&#8201;</mml:mo><mml:mi>ln</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>6325</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>12650</mml:mn><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>6367</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1185586336</mml:mn><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>which is shown in <xref ref-type="fig" rid="RSPA20180412F5">figure 5</xref> and compared to our solution by the method in &#167;<xref ref-type="sec" rid="s7">7</xref>a in which full account is taken of the boundary terms. As anticipated, the two solutions are very similar and diverge only close to <italic>s</italic>&#8201;=&#8201;1 (where the boundary term has most effect), with an RMS difference of about 1%, all of which occurs very close to the outer boundary. This validates the neglect of the boundary term for this example, and indicates the significance of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M9x1">9.1</xref>) which can be used with confidence to analytically approximate the geostrophic flow generated by an Earth-like field. However, we note the presence of a logarithmic singularity that (in view of an earlier comment) that we do not expect in a non-axisymmetric case; this is discussed in the following section.
<fig id="RSPA20180412F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>The geostrophic flow for a non-axisymmetric Earth-like Taylor state. Numerical solution using the spherical transform method (red) is compared to the analytic solution neglecting the boundary term (blue). (Online version in colour.)</p></caption><graphic xlink:href="rspa20180412-g5"/></fig></p><p>Finally, <xref ref-type="fig" rid="RSPA20180412F6">figure 6</xref><italic>b</italic> shows contours of the total azimuthal component of the flow. Of note is the much higher amplitude of flow associated with the increased complexity of the magnetic field compared with the single-mode magnetic field example of <xref ref-type="fig" rid="RSPA20180412F6">figure 6</xref><italic>a</italic>. The scale of this flow is as would be expected geophysically: maximum dimensionless velocities are of order 100, corresponding to dimensional velocities of order 10<sup>&#8722;4</sup>&#8201;ms<sup>&#8722;1</sup> consistent with large-scale core flows inferred by secular variation [<xref rid="RSPA20180412C38" ref-type="bibr">38</xref>].
<fig id="RSPA20180412F6" orientation="portrait" position="float"><label>Figure 6.</label><caption><p>Contour plots of (<italic>a</italic>) the total azimuthal flow <italic>u</italic><sub><italic>&#981;</italic></sub> driven by the axisymmetric poloidal field in &#167;6a, (<italic>b</italic>) the axisymmetric part of the total azimuthal flow driven by the Earth-like field of&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M9x2">9.2</xref>).</p></caption><graphic xlink:href="rspa20180412-g6"/></fig></p></sec><sec id="s10"><label>10.</label><title>Singularities of <italic>u</italic><sub><italic>g</italic></sub></title><p>A key benefit of having an instantaneous description of the geostrophic flow is to make explicit its analytic structure, which then motivates spectral expansions such as&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x7">4.7</xref>) for use with other methods. Assuming <italic>&#945;</italic>(<italic>s</italic>)&#8201;&gt;&#8201;0, because the equation describing <italic>u</italic><sub><italic>g</italic></sub> is smooth and regular, <italic>u</italic><sub><italic>g</italic></sub> is expected to be an odd [<xref rid="RSPA20180412C39" ref-type="bibr">39</xref>] finite function on 0&#8201;&lt;&#8201;<italic>s</italic>&#8201;&lt;&#8201;1. There are three places however where the solution may be singular: (i)&#160;<italic>s</italic>&#8201;=&#8201;0; (ii) <italic>s</italic>&#8201;=&#8201;1 and (iii)&#160;in the complex plane <italic>s</italic>&#8201;=&#8201;<italic>x</italic>&#8201;+&#8201;i<italic>y</italic>, away from the real axis (<italic>y</italic>&#8800;0). We discuss each in turn.</p><sec id="s10a"><label>(a)</label><title>Singularities at <italic>s</italic>&#8201;=&#8201;0</title><p>Firstly, we consider the presence of a singularity at <italic>s</italic>&#8201;=&#8201;0. In axisymmetry, it is well established that <italic>u</italic><sub><italic>g</italic></sub>&#8764;<italic>s</italic>ln(<italic>s</italic>) as <italic>s</italic>&#8201;&#8594;&#8201;0, resulting in a <italic>s</italic><sup>&#8722;1</sup> singularity in &#8706;<sub><italic>s</italic></sub>(<italic>u</italic><sub><italic>g</italic></sub>/<italic>s</italic>) [<xref rid="RSPA20180412C13" ref-type="bibr">13</xref>,<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>,<xref rid="RSPA20180412C40" ref-type="bibr">40</xref>], reproduced in our example (<xref ref-type="disp-formula" rid="RSPA20180412M6x2">6.2</xref>). However, it has not been quite clear whether the logarithmic singularity pertains to a general asymmetric Taylor state: in particular, in axisymmetry <italic>s</italic>&#8201;=&#8201;0 is a singular line of the coordinate system, whereas in three-dimensional spherical coordinates the only singular point is the origin <italic>r</italic>&#8201;=&#8201;0. Roberts &amp; Wu [<xref rid="RSPA20180412C36" ref-type="bibr">36</xref>] showed that either by neglecting the boundary term (their (25a)) or considering Taylor's ODE directly, which we have shown to be of limited validity, (see their appendix&#160;B) leads to a general logarithmic behaviour.</p><p>At first inspection, it appears that the boundary term is negligible as <italic>s</italic>&#8201;&#8594;&#8201;0. For a general three-dimensional field, both <bold>B</bold> and <inline-formula><mml:math id="IM52"><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#729;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are <inline-formula><mml:math id="IM53"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> on <italic>s</italic>&#8201;=&#8201;0, suggesting that the interior term in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M5x3">5.3</xref>) is <inline-formula><mml:math id="IM54"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, whereas the boundary term is <inline-formula><mml:math id="IM55"><mml:mrow><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> as <inline-formula><mml:math id="IM56"><mml:mi>s</mml:mi><mml:mo stretchy="false">&#8594;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. Motivated by the example in &#167;<xref ref-type="sec" rid="s9">9</xref>, this suggests that a full treatment (including the boundary term) retains the singularity in three dimensions&#8212;however, we do not find this to be the case. Significant cancellation in the interior term occurs and while the integrand is <italic>O</italic>(1), the integral itself is <italic>O</italic>(<italic>s</italic>), as expected since we know that the interior term and boundary term must sum to zero for all <italic>s</italic>. Therefore, there is no evidence that the three-dimensional case has a logarithmic singularity at <italic>s</italic>&#8201;=&#8201;0, and indeed all our numerical solutions and analytic solutions are regular there. In the purely toroidal field explored in &#167;<xref ref-type="sec" rid="s6">6</xref>b, the analytic solution given in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x9">6.9</xref>) is purely polynomial, with no singular behaviour at the origin.</p><statement><title>Theorem</title><p>This assertion can be strengthened into a theorem. The assumption of a magnetic field that is regular initially and remains so for all time places a restriction on the permitted behaviour of the geostrophic flow. In axisymmetry, the space of solutions allows a weak singularity in the geostrophic flow at <italic>s</italic>&#8201;=&#8201;0. However, in three dimensions it is required that the geostrophic flow is regular at the origin in order to maintain regularity of the magnetic field.</p></statement><statement><title>Proof.</title><p>This result directly follows from the form of the geostrophic term in the induction equation. In axisymmetry this is given by equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M4x3">4.3</xref>), from which it is clear that it is permissible for <italic>u</italic><sub><italic>g</italic></sub> to contain a weak logarithmic singularity while maintaining a regular <bold>B</bold>. In three dimensions, the geostrophic term in the induction equation is given by equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x6">6.6</xref>). In the presence of a non-axisymmetric magnetic field, any logarithmic singularity in <italic>u</italic><sub><italic>g</italic></sub> would render &#8706;<sub><italic>t</italic></sub><bold>B</bold> non-regular. Hence the assumption of regular <bold>B</bold>(<italic>t</italic>) is incompatible with such a singular solution.&#8195;&#9642;</p></statement><p>While the analytic approximation in &#167;<xref ref-type="sec" rid="s9">9</xref> is shown to produce accurate geostrophic flows for Earth-like magnetic fields, it should be used with caution, since the analytic structure of the solution will contain an <italic>s</italic>ln<italic>s</italic> dependence, that does not persist when the full balance including the boundary term is considered. For axisymmetric magnetic fields, this weak logarithmic singularity is not a significant concern since the geostrophic flow only enters the induction equation through &#8706;<sub><italic>s</italic></sub>(<italic>u</italic><sub><italic>g</italic></sub>/<italic>s</italic>) and so the magnetic field remains regular everywhere. By contrast, in three dimensions the structure of the geostrophic term in the induction equation (given in equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x6">6.6</xref>)) means that the logarithmic singularity is imparted to the magnetic field itself, causing the magnetic field to diverge at the rotation axis and violating the standard assumption of a regular field. Thus, in a practical implementation, such singular behaviour must be filtered out of <italic>u</italic><sub><italic>g</italic></sub>.</p></sec><sec id="s10b"><label>(b)</label><title>Singularities at <italic>s</italic>&#8201;=&#8201;1</title><p>We also address the possible existence of a singularity at <italic>s</italic>&#8201;=&#8201;1. For the specific case of an axisymmetric dipolar magnetic field, Roberts &amp; Wu [<xref rid="RSPA20180412C36" ref-type="bibr">36</xref>] presented an argument that &#8706;<sub><italic>s</italic></sub><italic>u</italic><sub><italic>g</italic></sub>&#8764;(1&#8201;&#8722;&#8201;<italic>s</italic><sup>2</sup>)<sup>&#8722;1/2</sup>, although they conceded that this was not supported by their numerical examples. The same form of singular behaviour for <italic>u</italic><sub><italic>g</italic></sub> has been predicted for torsional waves [<xref rid="RSPA20180412C41" ref-type="bibr">41</xref>,<xref rid="RSPA20180412C42" ref-type="bibr">42</xref>], perturbations to Taylor states, whose eventual steady state at <italic>t</italic>&#8201;=&#8201;&#8734; would be exactly magnetostrophic (if indeed steady Taylor states exist). However, there is no reason why the analytic structure of the oscillations should mirror that of the underlying background state, particularly as the manner of how the limit <italic>t</italic>&#8201;&#8594;&#8201;&#8734; is reached at the end points where the wave speed may vanish is unclear [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>,<xref rid="RSPA20180412C43" ref-type="bibr">43</xref>].</p><p>Although we are not in a position to prove one way or the other the existence of singular behaviour at <italic>s</italic>&#8201;=&#8201;1, we demonstrate by example that it is not generally present.</p><p>We find no singularity at <italic>s</italic>&#8201;=&#8201;1 in the non-axisymmetric example of &#167;<xref ref-type="sec" rid="s8">8</xref>. A similar regular behaviour is shown in <xref ref-type="fig" rid="RSPA20180412F7">figure 7</xref> (solid curve) for an axisymmetric example. Interestingly, for this latter case, the application of Taylor's ODE (which is invalid for this example) gives a solution that does show a singularity at <italic>s</italic>&#8201;=&#8201;1 (dotted curve). In this instance, singular behaviour is simply an artefact of applying Taylor's ODE when it is not valid, and we have found no cases where a solution to our more general analysis behaves singularly at <italic>s</italic>&#8201;=&#8201;1.
<fig id="RSPA20180412F7" orientation="portrait" position="float"><label>Figure 7.</label><caption><p>A plot of &#8706;<sub><italic>s</italic></sub>(<italic>u</italic><sub><italic>g</italic></sub>/<italic>s</italic>) for solutions to a mixed axisymmetric Taylor state consisting of the poloidal field of the example of &#167;6a with a <italic>l</italic>&#8201;=&#8201;1, <italic>m</italic>&#8201;=&#8201;0, <italic>n</italic>&#8201;=&#8201;1 toroidal Galerkin mode, using the BWR and Taylor equations. (<italic>a</italic>) Shows the whole domain, a singularity of the form <italic>s</italic><sup>&#8722;1</sup> is visible for both solutions at <italic>s</italic>&#8201;=&#8201;0 and for Taylor's solution only, a weaker singularity also occurs at <italic>s</italic>&#8201;=&#8201;1. (<italic>b</italic>) Zoomed-in plot of the <italic>s</italic>&#8201;=&#8201;1 singularity to show clearly that it only occurs when solving Taylor's equation; it has the form (1&#8201;&#8722;&#8201;<italic>s</italic><sup>2</sup>)<sup>&#8722;1/2</sup>. (Online version in colour.)</p></caption><graphic xlink:href="rspa20180412-g7"/></fig></p><p>This observation may help explain why the prediction of a singularity at <italic>s</italic>&#8201;=&#8201;1 [<xref rid="RSPA20180412C36" ref-type="bibr">36</xref>] is not borne out in any numerical examples. They themselves discussed this discrepancy and hypothesized that a key issue is the lack of boundary information contained within Taylor's equation. We speculate that should their magnetic field satisfy not only Taylor's constraint and the boundary conditions but also crucially the first-order boundary conditions, that this singular behaviour will vanish and the geostrophic flow will remain regular at <italic>s</italic>&#8201;=&#8201;1. We note however that certain magnetic forcing terms can render the geostrophic flow singular at <italic>s</italic>&#8201;=&#8201;1: for example, that of a non-polynomial mean-field <italic>&#945;</italic>-effect described in appendix F of Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>].</p><p>Finally, we remark that for a dipolar axisymmetric Taylor state, both Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] and Roberts &amp; Wu [<xref rid="RSPA20180412C43" ref-type="bibr">43</xref>] showed evidence of non-singular but abrupt boundary-layer like behaviour close to <italic>s</italic>&#8201;=&#8201;1, possibly because the equation describing the geostrophic flow is null at the equator (i.e. <italic>&#945;</italic>&#8201;=&#8201;<italic>S</italic>&#8201;=&#8201;0). A similar result was also found by Fearn &amp; Proctor [<xref rid="RSPA20180412C40" ref-type="bibr">40</xref>] who abandoned constraining their geostrophic flows near <italic>s</italic>&#8201;=&#8201;1 due to anomalous behaviour. We note, however, in our analytical solutions, we find no evidence of such behaviour: for example, <xref ref-type="fig" rid="RSPA20180412F1">figure 1</xref><italic>a</italic> shows a smooth solution at <italic>s</italic>&#8201;=&#8201;1.</p></sec><sec id="s10c"><label>(c)</label><title>Singularities off the <italic>s</italic>-axis</title><p>Finally, inspecting an example solution&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M6x2">6.2</xref>) shows that there can be either branch cuts or logarithmic singularities away from the real line. These do not affect the solution itself (defined on the real interval 0&#8804;<italic>s</italic>&#8804;1) but can influence convergence of the numerical method used to find <italic>u</italic><sub><italic>g</italic></sub> [<xref rid="RSPA20180412C44" ref-type="bibr">44</xref>]. The closer the singularities lie to the real interval [0,&#8201;1] the slower the convergence. In general, we speculate that such singularities can lie arbitrarily close to the real line, possibly being associated with the breakdown of the magnetostrophic balance, for example, torsional waves.</p></sec></sec><sec id="s11"><label>11.</label><title>Discussion</title><p>In this paper, we have discussed in some detail how the geostrophic flow, a fundamental part of any magnetostrophic dynamo, might be determined. Of particular note is that we have shown why the method introduced by Taylor [<xref rid="RSPA20180412C9" ref-type="bibr">9</xref>] fails in most cases, because of its intrinsic (and, to date, unrecognized) assumption that the initial magnetic field structure must satisfy a higher-order boundary condition (that is, both the magnetic field and its time derivative must satisfy matching conditions pertaining to an exterior electrical insulator). We presented a generalized version of Taylor's method valid for an arbitrary initial magnetic Taylor state that is not subject to higher-order boundary conditions. In many of our examples, the magnetic fields of dimensional scale 1.7&#8201;mT drive flows of magnitude about 10<sup>&#8722;4</sup>&#8201;ms<sup>&#8722;1</sup>, comparable to large-scale flows inferred for the core [<xref rid="RSPA20180412C38" ref-type="bibr">38</xref>]. Thus, in concert with weakly viscous models, inviscid models also produce Earth-like solutions.</p><p>A broader point of note is the extent to which the restriction on the validity of Taylor's approach impacts the related derivation of the equation describing torsional waves [<xref rid="RSPA20180412C26" ref-type="bibr">26</xref>]. A general treatment of torsional waves includes boundary terms, whose proper evaluation would require a method such as described in Jault [<xref rid="RSPA20180412C29" ref-type="bibr">29</xref>]. However, the troublesome boundary terms are usually neglected, either because of axisymmetry or because of arguments based on the relative size of the asymmetric magnetic field [<xref rid="RSPA20180412C1" ref-type="bibr">1</xref>]. Either way, these approaches remain unconstrained by any consideration of higher-order boundary conditions on the magnetic field and the theoretical description remains correct. However, in &#167;10a we describe the danger of neglecting the boundary term, this leading to a logarithmic singularity not present in solutions of the full equation. This has potential implications for analysis of torsional waves, for which the avoidance of a logarithmic singularity may require the full boundary term.</p><p>It is worth noting that the weak logarithmic singularity <italic>u</italic><sub><italic>g</italic></sub>&#8764;<italic>s</italic>ln(<italic>s</italic>) as <italic>s</italic>&#8201;&#8594;&#8201;0 in axisymmetric magnetostrophic models stands in contrast with weakly viscous models which are anticipated to be regular everywhere. For example, the asymptotic structure is <italic>u</italic><sub><italic>g</italic></sub>&#8201;=&#8201;<italic>O</italic>(<italic>s</italic>) in axisymmetry for both no-slip and stress-free boundary conditions (using the formulae summarized in eqns 8 and 9 of Livermore <italic>et al.</italic> [<xref rid="RSPA20180412C21" ref-type="bibr">21</xref>] and the fact that <italic>B</italic><sub><italic>s</italic></sub>,&#8201;<italic>B</italic><sub><italic>&#981;</italic></sub>&#8764;<italic>s</italic> as <italic>s</italic>&#8201;&#8594;&#8201;0) and <italic>u</italic><sub><italic>g</italic></sub>&#8201;=&#8201;<italic>O</italic>(1) in non-axisymmetry (using the formulae in eqn (33) of Hollerbach [<xref rid="RSPA20180412C45" ref-type="bibr">45</xref>] and the fact that ([<bold>&#8711;</bold>&#8201;&#215;&#8201;<bold>B</bold>]&#8201;&#215;&#8201;<bold>B</bold>)<sub><italic>&#981;</italic></sub>&#8764;<italic>s</italic> through the properties of general vectors described by Lewis &amp; Bellan [<xref rid="RSPA20180412C39" ref-type="bibr">39</xref>]). The presence of a weak logarithmic singularity is therefore a feature unique to the axisymmetric inviscid case, and serves to distinguish the exact magnetostrophic balance (with zero viscosity) from models with arbitrarily small but non-zero viscosity. However, in three dimensions, there is no such distinction between the structure of <italic>u</italic><sub><italic>g</italic></sub> between <italic>E</italic>&#8201;=&#8201;0 and <italic>E</italic>&#8810;1: in both cases <italic>u</italic><sub><italic>g</italic></sub> is regular.</p><p>Given that the geometry of the outer core of the Earth is a spherical shell rather than a full sphere, a natural question to ask is how we would calculate the flow within this domain. The method for determining the ageostrophic flow would remain comparable although it could be discontinuous or singular across the tangent cylinder <inline-formula><mml:math id="IM57"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula>, the geostrophic cylinder tangent to the solid inner core [<xref rid="RSPA20180412C46" ref-type="bibr">46</xref>]. As for the geostrophic flow, in the absence of viscosity, there is no reason why it must be continuous across <inline-formula><mml:math id="IM58"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula>; there are no known matching conditions that it must satisfy and such an analysis lies far beyond the scope of this work.</p><p>Although supplying an analytic structure of the evolving magnetostrophic flow, an instantaneous determination of the geostrophic component is not itself of practical use within a numerical method using finite timesteps of size <italic>h</italic>, as the solution will immediately diverge from the solution manifold [<xref rid="RSPA20180412C11" ref-type="bibr">11</xref>]. However, as for the axisymmetric-specific method of Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>], our three-dimensional instantaneous methods generalize simply to schemes that are accurate to first order in <italic>h</italic>, thus presenting a viable method for numerically evolving a three-dimensional magnetostrophic dynamo. A direct comparison of this method with the fully implicit (three-dimensional) method of Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] would be an interesting study. Indeed, our three-dimensional first-order-accurate solutions could be used as a starting guess for their nonlinear iterative scheme, enabling much larger timesteps to be taken for which the geostrophic flow does not need to be close to its structure at the previous step.</p><p>Lastly, there is mounting evidence that rapid dynamics within the core is governed by quasi-geostrophic (QG) dynamics, in which the flow is quasi-invariant along the axis of rotation [<xref rid="RSPA20180412C47" ref-type="bibr">47</xref>,<xref rid="RSPA20180412C48" ref-type="bibr">48</xref>]. We briefly comment on whether the slowly evolving background magnetostrophic state is also likely to show such a structure. Both Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>] and Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>] show axisymmetric magnetostrophic solutions that have largely <italic>z</italic>-invariant zonal flows. Here, in our three-dimensional cases, we also find that the geostrophic flow is comparable in magnitude to the ageostrophic zonal flow. In our Earth-like example, comparing <xref ref-type="fig" rid="RSPA20180412F5">figures 5</xref> and <xref ref-type="fig" rid="RSPA20180412F6">6</xref><italic>b</italic>, the maximum value of the geostrophic flow is about one-quarter of that of the total zonal flow. Furthermore, our (large-scale) magnetostrophic solutions contain a significant <italic>z</italic>-invariant component, a finding that is consistent with [<xref rid="RSPA20180412C49" ref-type="bibr">49</xref>] who have recently suggested the existence of a threshold lengthscale, below which the geodynamo is magnetostrophic and above which the dynamics are QG.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><caption><title>ESM1 - 4</title></caption><media mimetype="application" mime-subtype="zip" xlink:href="rspa20180412supp1.zip" orientation="portrait" id="d35e11431" position="anchor"/></supplementary-material></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD2"><caption><title>ESM5 - ESM8 are PDF versions of the maple worksheets ESM1 - ESM4 respectively.</title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rspa20180412supp2.pdf" orientation="portrait" id="d35e11439" position="anchor"/></supplementary-material></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD3"><caption><title>ESM5 - ESM8 are PDF versions of the maple worksheets ESM1 - ESM4 respectively.</title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rspa20180412supp3.pdf" orientation="portrait" id="d35e11447" position="anchor"/></supplementary-material></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD4"><caption><title>ESM5 - ESM8 are PDF versions of the maple worksheets ESM1 - ESM4 respectively.</title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rspa20180412supp4.pdf" orientation="portrait" id="d35e11455" position="anchor"/></supplementary-material></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD5"><caption><title>ESM5 - ESM8 are PDF versions of the maple worksheets ESM1 - ESM4 respectively.</title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rspa20180412supp5.pdf" orientation="portrait" id="d35e11463" position="anchor"/></supplementary-material></sec></body><back><ack><title>Acknowledgments</title><p>The authors thank Andrew Jackson and Dominique Jault for helpful discussions, as well as Chris Jones, Rainer Hollerbach and David Gubbins for useful comments. We also thank Dominique Jault and an anonymous reviewer for constructive criticism that helped us to improve the paper.</p></ack><fn-group><title>Note</title><fn id="FN0001"><label>1</label><p>The name here is in recognition of two important contributions: that of the functional form of the Taylor integral due to Braginsky [<xref rid="RSPA20180412C12" ref-type="bibr">12</xref>], and the subsequent application to the discovery of the geostrophic flow due to Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>]. We note that magnetic diffusion (included in equation (4.8)) was neglected in Braginsky's 1970 study on torsional waves, but was reinstated by Wu &amp; Roberts [<xref rid="RSPA20180412C14" ref-type="bibr">14</xref>].</p></fn></fn-group><sec id="s12"><title>Data accessibility</title><p>Maple worksheets that reproduce our examples are included as electronic supplementary material.</p></sec><sec id="s13"><title>Author's contributions</title><p>P.L. is responsible for the original ideas behind the work with input from K.L. C.H. wrote the Maple worksheets with input from J.N. and calculated the example solutions, which were validated by J.L. using Mathematica. C.H. and P.L. wrote the majority of the paper with input from J.N. and J.L. All authors read and commented on the manuscript.</p></sec><sec id="s14" sec-type="COI-statement"><title>Competing interests</title><p>We declare we have no competing interests.</p></sec><sec id="s15"><title>Funding</title><p>This work was supported by the Engineering and Physical Sciences Research Council (EPSRC) Centre for Doctoral Training in Fluid Dynamics at the University of Leeds under grant no. EP/L01615X/1. P.W.L. was partially supported by NERC grant no.
NE/G014043/1.</p></sec><app-group><app><title>Appendix A. Further details of numerical methods</title><p><bold>(a) A Galerkin representation</bold></p><p>A simple way of constructing magnetic states is to take combinations of single-mode toroidal or poloidal vectors, whose scalars are each defined in terms of a single spherical harmonic:
<disp-formula id="RSPA20180412UM26"><mml:math id="DM67"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM59"><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#967;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM60"><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#968;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and the harmonics are fully normalized over solid angle:
<disp-formula id="RSPA20180412UM27"><mml:math id="DM68"><mml:mo>&#8750;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mo>=</mml:mo><mml:mn>1.</mml:mn></mml:math></disp-formula>We choose the scalar functions <italic>&#967;</italic><sub><italic>l</italic>,<italic>n</italic></sub> and <italic>&#968;</italic><sub><italic>l</italic>,<italic>n</italic></sub>, <italic>n</italic>&#8805;1, to be of polynomial form [<xref rid="RSPA20180412C50" ref-type="bibr">50</xref>,<xref rid="RSPA20180412C51" ref-type="bibr">51</xref>], and defined in terms of Jacobi polynomials <italic>P</italic><sup>(<italic>&#945;</italic>,<italic>&#946;</italic>)</sup><sub><italic>n</italic></sub>(<italic>x</italic>), by
<disp-formula id="RSPA20180412MA1"><label>A 1</label><mml:math id="DM69"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing=".5em" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi>&#967;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="2em"/><mml:msub><mml:mi>&#968;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where
<disp-formula id="RSPA20180412MA2"><label>A 2</label><mml:math id="DM70"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing=".5em" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mo>&#8201;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>Suitably normalized, the vector modes then satisfy (A) the boundary conditions of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412M2x1">2.1</xref>); (B) regularity at the origin and (C) <italic>L</italic><sub>2</sub> orthonormality of the form
<disp-formula id="RSPA20180412MA3"><label>A 3</label><mml:math id="DM71"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing=".5em" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mo>&#8747;</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>&#8901;</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>&#8747;</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>&#8901;</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>&#948;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>&#948;</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>&#948;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:msub><mml:mo>&#8747;</mml:mo><mml:mi>V</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>&#8901;</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where all integrals are over the spherical volume <italic>V</italic> . These conditions reduce to the equations (when <italic>l</italic>&#8201;=&#8201;<italic>l</italic>&#8242;, <italic>m</italic>&#8201;=&#8201;<italic>m</italic>&#8242;)
<disp-formula id="RSPA20180412UM28"><mml:math id="DM72"><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msub><mml:mi>&#968;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>&#968;</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msub><mml:mi>&#968;</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msub><mml:mi>&#968;</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>&#948;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msub><mml:mi>&#967;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>&#967;</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>&#948;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>&#8242;</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula>For the velocity field, the ageostrophic flow satisfies only the impenetrable condition <italic>u</italic><sub><italic>r</italic></sub>&#8201;=&#8201;0 on <italic>r</italic>&#8201;=&#8201;1, which constrains only the poloidal representation. A modal set that satisfies this boundary condition, regularity at the origin and <italic>L</italic><sub>2</sub> orthonormality is given by Li <italic>et al.</italic> [<xref rid="RSPA20180412C15" ref-type="bibr">15</xref>]
<disp-formula id="RSPA20180412UM29"><mml:math id="DM73"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM61"><mml:msubsup><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM62"><mml:msubsup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>&#958;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. The radial functions are given by
<disp-formula id="RSPA20180412MA4"><label>A 4</label><mml:math id="DM74"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing=".5em" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>&#958;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width="2em"/><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>for <italic>n</italic>&#8805;1.</p><p><bold>(b) Projection</bold></p><p>In &#167;<xref ref-type="sec" rid="s7">7</xref>c, we need to project a divergence-free magnetic field <bold>B</bold> onto the magnetic Galerkin basis up to a truncation <inline-formula><mml:math id="IM63"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> in spherical harmonic degree and <inline-formula><mml:math id="IM64"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> in radial index:
<disp-formula id="RSPA20180412UM30"><mml:math id="DM75"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">&#175;</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">T</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-script">S</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:math></disp-formula>Determination of the coefficients <italic>a</italic><sup><italic>m</italic></sup><sub><italic>l</italic>,<italic>n</italic></sub> and <italic>b</italic><sup><italic>m</italic></sup><sub><italic>l</italic>,<italic>n</italic></sub> can either be accomplished through use of the three-dimensional integral&#160;(<xref ref-type="disp-formula" rid="RSPA20180412MA3">A 3</xref>) directly, or equivalently by first taking the transform in solid angle to find the toroidal and poloidal parts of <bold>B</bold>
<disp-formula id="RSPA20180412MA5"><label>A 5</label><mml:math id="DM76"><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#8750;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#8750;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#981;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where d<italic>&#937;</italic>&#8201;=&#8201;sin<italic>&#952;</italic>&#8201;d<italic>&#952;</italic>&#8201;d<italic>&#981;</italic>, and secondly integrating in radius to give
<disp-formula id="RSPA20180412UM31"><mml:math id="DM77"><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>&#967;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#8747;</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>&#968;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mstyle><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:msub><mml:mi>&#968;</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8706;</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo></mml:math></disp-formula></p><p><bold>(c) Computation of the ageostrophic flow</bold></p><p>For a magnetic field <bold><italic>B</italic></bold> which is an exact Taylor state, we can solve the magnetostrophic equation
<disp-formula id="RSPA20180412MA6"><label>A 6</label><mml:math id="DM78"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mi mathvariant="bold">&#8711;</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#215;</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula></p><p>to determine the ageostrophic part of the fluid velocity <bold><italic>u</italic></bold><sub><italic>a</italic></sub>. We note that the geostrophic flow is unconstrained by this equation as
<disp-formula id="RSPA20180412UM32"><mml:math id="DM79"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>&#215;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">&#981;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">&#8711;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#8747;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#8201;</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>and so, as it can be written as a gradient, it can be absorbed into the pressure term.</p><p>The procedure then consists of taking the curl of equation&#160;(<xref ref-type="disp-formula" rid="RSPA20180412MA6">A 6</xref>) to remove the pressure dependence and then proposing a trial form of the fluid velocity <bold>u</bold> in terms of modes with unknown coefficients. Because <inline-formula><mml:math id="IM65"><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a constant vector and <bold>B</bold> is based on Galerkin modes of polynomial form of known maximum degree, the modal representation for the flow then also has a known maximum degree. The unknown coefficients are found by equating powers of <italic>r</italic> and solving the resulting system analytically with the assistance of computer algebra (e.g. Maple).</p><p>It is worth noting that the solution <bold>u</bold> above is determined only up to an arbitrary geostrophic flow. We remove the cylindrically averaged azimuthal component of <bold>u</bold>, which results in the ageostrophic flow <bold><italic>u</italic></bold><sub><italic>a</italic></sub> with no geostrophic component. This also means that the geostrophic flow, determined through the methods described in the main text, is uniquely defined.
</p></app></app-group><ref-list><title>References</title><ref id="RSPA20180412C1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name>, <name name-style="western"><surname>King</surname><given-names>EM</given-names></name></person-group>
<year>2013</year>
<article-title>On the genesis of the Earth's magnetism</article-title>. <source>Rep. Prog. Phys.</source>
<volume>76</volume>, <elocation-id content-type="artnum">096801</elocation-id> (<pub-id pub-id-type="doi">10.1088/0034-4885/76/9/096801</pub-id>)<pub-id pub-id-type="pmid">24004491</pub-id></mixed-citation></ref><ref id="RSPA20180412C2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Glatzmaier</surname><given-names>GA</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name></person-group>
<year>1995</year>
<article-title>A three-dimensional self-consistent computer simulation of a geomagnetic field reversal</article-title>. <source>Nature</source>
<volume>377</volume>, <fpage>203</fpage>&#8211;<lpage>209</lpage>. (<pub-id pub-id-type="doi">10.1038/377203a0</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kageyama</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sato</surname><given-names>T</given-names></name></person-group>
<year>1995</year>
<article-title>Computer simulation of a magnetohydrodynamic dynamo. II</article-title>. <source>Phys. Plasmas</source>
<volume>2</volume>, <fpage>1421</fpage>&#8211;<lpage>1431</lpage>. (<pub-id pub-id-type="doi">10.1063/1.871485</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C4"><label>4</label><mixed-citation publication-type="misc"><person-group person-group-type="author"><name name-style="western"><surname>Christensen</surname><given-names>UR</given-names></name>, <name name-style="western"><surname>Wicht</surname><given-names>J</given-names></name></person-group>
<year>2015</year>
<comment>Numerical dynamo simulations. In <italic>Treatise on geophysics</italic> (ed. G Schubert), vol.&#160;8, pp.&#160;245&#8211;277. Amsterdam, The Netherlands: Elsevier</comment>.</mixed-citation></ref><ref id="RSPA20180412C5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soderlund</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>King</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Aurnou</surname><given-names>JM</given-names></name></person-group>
<year>2012</year>
<article-title>The influence of magnetic fields in planetary dynamo models</article-title>. <source>Earth Planet. Sci. Lett.</source>
<volume>333</volume>, <fpage>9</fpage>&#8211;<lpage>20</lpage>. (<pub-id pub-id-type="doi">10.1016/j.epsl.2012.03.038</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>King</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Buffett</surname><given-names>BA</given-names></name></person-group>
<year>2013</year>
<article-title>Flow speeds and length scales in geodynamo models: the role of viscosity</article-title>. <source>Earth Planet. Sci. Lett.</source>
<volume>371</volume>, <fpage>156</fpage>&#8211;<lpage>162</lpage>. (<pub-id pub-id-type="doi">10.1016/j.epsl.2013.04.001</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yadav</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Gastine</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Christensen</surname><given-names>UR</given-names></name>, <name name-style="western"><surname>Wolk</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Poppenhaeger</surname><given-names>K</given-names></name></person-group>
<year>2016</year>
<article-title>Approaching a realistic force balance in geodynamo simulations</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>113</volume>, <fpage>12&#8201;065</fpage>&#8211;<lpage>12&#8201;070</lpage>. (<pub-id pub-id-type="doi">10.1073/pnas.1608998113</pub-id>)<pub-id pub-id-type="pmid">26699496</pub-id></mixed-citation></ref><ref id="RSPA20180412C8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schaeffer</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jault</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Nataf</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Fournier</surname><given-names>A</given-names></name></person-group>
<year>2017</year>
<article-title>Turbulent geodynamo simulations: a leap towards Earth's core</article-title>. <source>Geophys. J. Int.</source>
<volume>211</volume>, <fpage>1</fpage>&#8211;<lpage>29</lpage>. (<pub-id pub-id-type="doi">10.1093/gji/ggx265</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Taylor</surname><given-names>JB</given-names></name></person-group>
<year>1963</year>
<article-title>The magneto-hydrodynamics of a rotating fluid and the Earth's dynamo problem</article-title>. <source>Proc. R. Soc. Lond. A</source>
<volume>274</volume>, <fpage>274</fpage>&#8211;<lpage>283</lpage>. (<pub-id pub-id-type="doi">10.1098/rspa.1963.0130</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fearn</surname><given-names>DR</given-names></name></person-group>
<year>1998</year>
<article-title>Hydromagnetic flow in planetary cores</article-title>. <source>Rep. Prog. Phys.</source>
<volume>61</volume>, <fpage>175</fpage>&#8211;<lpage>235</lpage>. (<pub-id pub-id-type="doi">10.1088/0034-4885/61/3/001</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Ierley</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name></person-group>
<year>2011</year>
<article-title>The evolution of a magnetic field subject to Taylor's constraint: a projection operator applied to free decay</article-title>. <source>Geophys. J. Int.</source>
<volume>187</volume>, <fpage>690</fpage>&#8211;<lpage>704</lpage>. (<pub-id pub-id-type="doi">10.1111/j.1365-246X.2011.05187.x</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Braginsky</surname><given-names>SI</given-names></name></person-group>
<year>1970</year>
<article-title>Torsional magnetohydrodynamic vibrations in the Earth's core and variations in the length of day</article-title>. <source>Geomagn. Aeron.</source>
<volume>10</volume>, <fpage>1</fpage>&#8211;<lpage>10</lpage>.</mixed-citation></ref><ref id="RSPA20180412C13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jault</surname><given-names>D</given-names></name></person-group>
<year>1995</year>
<article-title>Model Z by computation and Taylor's condition</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>79</volume>, <fpage>99</fpage>&#8211;<lpage>124</lpage>. (<pub-id pub-id-type="doi">10.1080/03091929508228993</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name></person-group>
<year>2015</year>
<article-title>On magnetostrophic mean-field solutions of the geodynamo equations</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>109</volume>, <fpage>84</fpage>&#8211;<lpage>110</lpage>. (<pub-id pub-id-type="doi">10.1080/03091929.2014.988711</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name></person-group>
<year>2018</year>
<article-title>Taylor state dynamos found by optimal control: axisymmetric examples</article-title>. <source>J. Fluid. Mech.</source>
<volume>853</volume>, <fpage>647</fpage>&#8211;<lpage>697</lpage>. (<pub-id pub-id-type="doi">10.1017/jfm.2018.569</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jault</surname><given-names>D</given-names></name></person-group>
<year>2008</year>
<article-title>Axial invariance of rapidly varying diffusionless motions in the earth's core interior</article-title>. <source>Phys. Earth Planet. Interiors</source>
<volume>166</volume>, <fpage>67</fpage>&#8211;<lpage>76</lpage>. (<pub-id pub-id-type="doi">10.1016/j.pepi.2007.11.001</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aubert</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Gastine</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Fournier</surname><given-names>A</given-names></name></person-group>
<year>2017</year>
<article-title>Spherical convective dynamos in the rapidly rotating asymptotic regime</article-title>. <source>J. Fluid. Mech.</source>
<volume>813</volume>, <fpage>558</fpage>&#8211;<lpage>593</lpage>. (<pub-id pub-id-type="doi">10.1017/jfm.2016.789</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fearn</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Rahman</surname><given-names>MM</given-names></name></person-group>
<year>2004</year>
<article-title>Evolution of non-linear <italic>&#945;</italic><sup>2</sup>-dynamos and Taylor's constraint</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>98</volume>, <fpage>385</fpage>&#8211;<lpage>406</lpage>. (<pub-id pub-id-type="doi">10.1080/03091920410001724124</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hollerbach</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ierley</surname><given-names>G</given-names></name></person-group>
<year>1991</year>
<article-title>A modal <italic>&#945;</italic><sup>2</sup>-dynamo in the limit of asymptotically small viscosity</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>56</volume>, <fpage>133</fpage>&#8211;<lpage>158</lpage>. (<pub-id pub-id-type="doi">10.1080/03091929108219515</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soward</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>CA</given-names></name></person-group>
<year>1983</year>
<article-title><italic>&#945;</italic><sup>2</sup>-dynamos and Taylor's constraint</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>27</volume>, <fpage>87</fpage>&#8211;<lpage>122</lpage>. (<pub-id pub-id-type="doi">10.1080/03091928308210122</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Hollerbach</surname><given-names>R</given-names></name></person-group>
<year>2016</year>
<article-title>A comparison of no-slip, stress-free and inviscid models of rapidly rotating fluid in a spherical shell</article-title>. <source>Sci. Rep.</source>
<volume>6</volume>, <fpage>1</fpage>&#8211;<lpage>11</lpage>. (<pub-id pub-id-type="doi">10.1038/s41598-016-0001-8</pub-id>)<pub-id pub-id-type="pmid">28442746</pub-id></mixed-citation></ref><ref id="RSPA20180412C22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Davies</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pozzo</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gubbins</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Alf&#232;</surname><given-names>D</given-names></name></person-group>
<year>2015</year>
<article-title>Constraints from material properties on the dynamics and evolution of Earth's core</article-title>. <source>Nat. Geosci.</source>
<volume>8</volume>, <fpage>678</fpage>&#8211;<lpage>685</lpage>. (<pub-id pub-id-type="doi">10.1038/ngeo2492</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gillet</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jault</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Canet</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Fournier</surname><given-names>A</given-names></name></person-group>
<year>2010</year>
<article-title>Fast torsional waves and strong magnetic field within the Earth's core</article-title>. <source>Nature</source>
<volume>465</volume>, <fpage>74</fpage>&#8211;<lpage>77</lpage>. (<pub-id pub-id-type="doi">10.1038/nature09010</pub-id>)<pub-id pub-id-type="pmid">20445627</pub-id></mixed-citation></ref><ref id="RSPA20180412C24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Ierley</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name></person-group>
<year>2008</year>
<article-title>The structure of Taylor's constraint in three dimensions</article-title>. <source>Proc. R. Soc. A</source>
<volume>464</volume>, <fpage>3149</fpage>&#8211;<lpage>3174</lpage>. (<pub-id pub-id-type="doi">10.1098/rspa.2008.0091</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Ierley</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name></person-group>
<year>2009</year>
<article-title>The construction of exact Taylor states I: the full sphere</article-title>. <source>Geophys. J. Int.</source>
<volume>177</volume>, <fpage>367</fpage>&#8211;<lpage>382</lpage>. (<pub-id pub-id-type="doi">10.1111/j.1365-246X.2008.04008.x</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name>, <name name-style="western"><surname>Aurnou</surname><given-names>JM</given-names></name></person-group>
<year>2011</year>
<article-title>On the theory of core-mantle coupling</article-title>. <source>Geophys. Astrophys. Fl. Dyn.</source>
<volume>106</volume>, <fpage>157</fpage>&#8211;<lpage>230</lpage>. (<pub-id pub-id-type="doi">10.1080/03091929.2011.589028</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Braginsky</surname><given-names>SI</given-names></name></person-group>
<year>1975</year>
<article-title>Nearly axially symmetric model of the hydrodynamic dynamo of the Earth. I</article-title>. <source>Geomagn. Aeron.</source>
<volume>15</volume>, <fpage>122</fpage>&#8211;<lpage>128</lpage>.</mixed-citation></ref><ref id="RSPA20180412C28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fearn</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Proctor</surname><given-names>MRE</given-names></name></person-group>
<year>1992</year>
<article-title>Magnetostrophic balance in non-axisymmetric, non-standard dynamo models</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>67</volume>, <fpage>117</fpage>&#8211;<lpage>128</lpage>. (<pub-id pub-id-type="doi">10.1080/03091929208201840</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C29"><label>29</label><mixed-citation publication-type="misc"><person-group person-group-type="author"><name name-style="western"><surname>Jault</surname><given-names>D</given-names></name></person-group>
<year>2003</year>
<comment>Electromagnetic and topographic coupling. In <italic>Earth's core and lower mantle</italic> (eds CA Jones, MA Soward, K Zhang). London, UK: Taylor and Francis</comment>.</mixed-citation></ref><ref id="RSPA20180412C30"><label>30</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Evans</surname><given-names>LC</given-names></name></person-group>
<year>2010</year>
<source>Partial differential equations</source>. <publisher-loc>Providence, RI</publisher-loc>: <publisher-name>American Mathematical Society</publisher-name>.</mixed-citation></ref><ref id="RSPA20180412C31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Abdel-Aziz</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>CA</given-names></name></person-group>
<year>1988</year>
<article-title><italic>&#945;&#969;</italic>-dynamos and Taylor's constraint</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>44</volume>, <fpage>117</fpage>&#8211;<lpage>139</lpage>. (<pub-id pub-id-type="doi">10.1080/03091928808208881</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C32"><label>32</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Backus</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Parker</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Constable</surname><given-names>C</given-names></name></person-group>
<year>1996</year>
<source>Foundations of ceomagnetism</source>. <publisher-loc>Cambridge, UK</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref><ref id="RSPA20180412C33"><label>33</label><mixed-citation publication-type="misc"><person-group person-group-type="author"><name name-style="western"><surname>Gubbins</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name></person-group>
<year>1987</year>
<comment>Magnetohydrodynamics of the Earth's core. In <italic>Geomagnetism</italic> (ed. JA Jacobs), vol.&#160;2, pp.&#160;1&#8211;183. London, UK: Academic Press</comment>.</mixed-citation></ref><ref id="RSPA20180412C34"><label>34</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gubbins</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Roberts</surname><given-names>N</given-names></name></person-group>
<year>1983</year>
<article-title>Use of the frozen flux approximation in the interpretation of archaeomagnetic and palaeomagnetic data</article-title>. <source>Geophys. J. Int.</source>
<volume>73</volume>, <fpage>675</fpage>&#8211;<lpage>687</lpage>. (<pub-id pub-id-type="doi">10.1111/j.1365-246X.1983.tb03339.x</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C35"><label>35</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Constable</surname><given-names>CG</given-names></name></person-group>
<year>1997</year>
<article-title>The time-averaged geomagnetic field: global and regional biases for 0&#8211;5&#8201;Ma</article-title>. <source>Geophys. J. Int.</source>
<volume>131</volume>, <fpage>643</fpage>&#8211;<lpage>666</lpage>. (<pub-id pub-id-type="doi">10.1111/j.1365-246X.1997.tb06604.x</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C36"><label>36</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>CC</given-names></name></person-group>
<year>2014</year>
<article-title>On the modified Taylor constraint</article-title>. <source>Geophys. Astrophys. Fluid Dyn.</source>
<volume>108</volume>, <fpage>696</fpage>&#8211;<lpage>715</lpage>. (<pub-id pub-id-type="doi">10.1080/03091929.2014.942955</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C37"><label>37</label><mixed-citation publication-type="misc"><person-group person-group-type="author"><name name-style="western"><surname>Jault</surname><given-names>D</given-names></name>, <name name-style="western"><surname>L&#233;gaut</surname><given-names>G</given-names></name></person-group>
<year>2005</year>
<comment>Alfv&#233;n waves within the Earth's core. In <italic>Fluid dynamics and dynamos in astrophysics and geophysics</italic> (eds AH Soward, CA Jones, DW Hughes, NO Weiss), pp.&#160;277&#8211;293. Boca Raton, FL: CRC Press</comment>.</mixed-citation></ref><ref id="RSPA20180412C38"><label>38</label><mixed-citation publication-type="misc"><person-group person-group-type="author"><name name-style="western"><surname>Holme</surname><given-names>R</given-names></name></person-group>
<year>2015</year>
<comment>Large-scale flow in the core. In <italic>Treatise on geophysics</italic> (ed. G Schubert), vol.&#160;8, pp.&#160;91&#8211;113. Amsterdam, The Netherlands: Elsevier</comment>.</mixed-citation></ref><ref id="RSPA20180412C39"><label>39</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lewis</surname><given-names>HR</given-names></name>, <name name-style="western"><surname>Bellan</surname><given-names>PM</given-names></name></person-group>
<year>1990</year>
<article-title>Physical constraints on the coefficients of Fourier expansions in cylindrical coordinates</article-title>. <source>J. Math. Phys.</source>
<volume>31</volume>, <fpage>2592</fpage>&#8211;<lpage>2596</lpage>. (<pub-id pub-id-type="doi">10.1063/1.529009</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C40"><label>40</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fearn</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Proctor</surname><given-names>MRE</given-names></name></person-group>
<year>1987</year>
<article-title>Dynamically consistent magnetic fields produced by differential rotation</article-title>. <source>J. Fluid Mech.</source>
<volume>178</volume>, <fpage>521</fpage>&#8211;<lpage>534</lpage>. (<pub-id pub-id-type="doi">10.1017/S0022112087001356</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C41"><label>41</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schaeffer</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jault</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Cardin</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Drouard</surname><given-names>M</given-names></name></person-group>
<year>2012</year>
<article-title>On the reflection of Alfv&#233;n waves and its implication for Earth's core modelling</article-title>. <source>Geophys. J. Int.</source>
<volume>191</volume>, <fpage>508</fpage>&#8211;<lpage>516</lpage>. (<pub-id pub-id-type="doi">10.1111/j.1365-246x.2012.05611.x</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C42"><label>42</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maffei</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name></person-group>
<year>2016</year>
<article-title>Propagation and reflection of diffusionless torsional waves in a sphere</article-title>. <source>Geophys. J. Int.</source>
<volume>204</volume>, <fpage>1477</fpage>&#8211;<lpage>1489</lpage>. (<pub-id pub-id-type="doi">10.1093/gji/ggv518</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C43"><label>43</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>PH</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>CC</given-names></name></person-group>
<year>2018</year>
<article-title>On magnetostrophic mean-field solutions of the geodynamo equations. Part 2</article-title>. <source>J. Plasma Phys.</source>
<volume>84</volume>, <elocation-id content-type="artnum">735840402</elocation-id> (<pub-id pub-id-type="doi">10.1017/s0022377818000545</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C44"><label>44</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Boyd</surname><given-names>JP</given-names></name></person-group>
<year>2001</year>
<source>Chebyshev and Fourier spectral methods</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Dover</publisher-name>.</mixed-citation></ref><ref id="RSPA20180412C45"><label>45</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hollerbach</surname><given-names>R</given-names></name></person-group>
<year>1996</year>
<article-title>On the theory of the geodynamo</article-title>. <source>Phys. Earth Planet. Int.</source>
<volume>98</volume>, <fpage>163</fpage>&#8211;<lpage>185</lpage>. (<pub-id pub-id-type="doi">10.1016/S0031-9201(96)03185-8</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C46"><label>46</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Hollerbach</surname><given-names>R</given-names></name></person-group>
<year>2012</year>
<article-title>Successive elimination of shear layers by a hierarchy of constraints in inviscid spherical-shell flows</article-title>. <source>J. Math. Phys.</source>
<volume>53</volume>, <elocation-id content-type="artnum">073104</elocation-id> (<pub-id pub-id-type="doi">10.1063/1.4736990</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C47"><label>47</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pais</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Jault</surname><given-names>D</given-names></name></person-group>
<year>2008</year>
<article-title>Quasi-geostrophic flows responsible for the secular variation of the Earth's magnetic field</article-title>. <source>Geophys. J. Int.</source>
<volume>173</volume>, <fpage>421</fpage>&#8211;<lpage>443</lpage>. (<pub-id pub-id-type="doi">10.1111/j.1365-246x.2008.03741.x</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C48"><label>48</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gillet</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Schaeffer</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jault</surname><given-names>D</given-names></name></person-group>
<year>2011</year>
<article-title>Rationale and geophysical evidence for quasi-geostrophic rapid dynamics within the Earth's outer core</article-title>. <source>Phys. Earth Planet. Int.</source>
<volume>187</volume>, <fpage>380</fpage>&#8211;<lpage>390</lpage>. (<pub-id pub-id-type="doi">10.1016/j.pepi.2011.01.005</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C49"><label>49</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aurnou</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>King</surname><given-names>EM</given-names></name></person-group>
<year>2017</year>
<article-title>The cross-over to magnetostrophic convection in planetary dynamo systems</article-title>. <source>Proc. R. Soc. A</source>
<volume>473</volume>, <elocation-id content-type="artnum">20160731</elocation-id> (<pub-id pub-id-type="doi">10.1098/rspa.2016.0731</pub-id>)<pub-id pub-id-type="pmid">28413338</pub-id></mixed-citation></ref><ref id="RSPA20180412C50"><label>50</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name></person-group>
<year>2010</year>
<article-title>An optimal Galerkin scheme to solve the kinematic dynamo eigenvalue problem in a full sphere</article-title>. <source>J. Comput. Phys.</source>
<volume>229</volume>, <fpage>8666</fpage>&#8211;<lpage>8683</lpage>. (<pub-id pub-id-type="doi">10.1016/j.jcp.2010.07.039</pub-id>)</mixed-citation></ref><ref id="RSPA20180412C51"><label>51</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Livermore</surname><given-names>PW</given-names></name></person-group>
<year>2011</year>
<article-title>Variational data assimilation for the initial value dynamo problem</article-title>. <source>Phys. Rev. E</source>
<volume>84</volume>, <elocation-id content-type="artnum">056321</elocation-id> (<pub-id pub-id-type="doi">10.1103/physreve.84.056321</pub-id>)</mixed-citation></ref></ref-list></back></article>