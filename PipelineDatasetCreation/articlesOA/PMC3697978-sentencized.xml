<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genetics</journal-id><journal-id journal-id-type="iso-abbrev">Genetics</journal-id><journal-id journal-id-type="hwp">genetics</journal-id><journal-id journal-id-type="pmc">genetics</journal-id><journal-id journal-id-type="publisher-id">genetics</journal-id><journal-title-group><journal-title>Genetics</journal-title></journal-title-group><issn pub-type="ppub">0016-6731</issn><issn pub-type="epub">1943-2631</issn><publisher><publisher-name>Genetics Society of America</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3697978</article-id><article-id pub-id-type="pmid">23636737</article-id><article-id pub-id-type="publisher-id">151217</article-id><article-id pub-id-type="doi">10.1534/genetics.113.151217</article-id><article-categories><subj-group subj-group-type="heading"><subject>Investigations</subject><subj-group><subject>Genetics of Complex Traits</subject></subj-group></subj-group></article-categories><title-group><article-title><SecTag type="TITLE"><text><SENT sid="0" pm="."><plain>Dissecting High-Dimensional Phenotypes with Bayesian Sparse Factor Analysis of Genetic Covariance Matrices </plain></SENT>
</text></SecTag></article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Runcie</surname><given-names>Daniel E.</given-names></name><xref ref-type="aff" rid="aff1">*</xref><xref ref-type="corresp" rid="cor1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Mukherjee</surname><given-names>Sayan</given-names></name><xref ref-type="aff" rid="aff2"><sup>†</sup></xref></contrib><aff id="aff1"><label>*</label>Department of Biology, Duke University, Durham, North Carolina 27708</aff><aff id="aff2"><label>†</label>Departments of Statistical Science, Computer Science, and Mathematics, Institute for Genome Sciences &amp; Policy, Duke University, Durham, North Carolina 27708</aff></contrib-group><author-notes><fn id="afn1"><p><text><SENT sid="1" pm="."><plain><?release-delay 0|0?>Supporting information is available online at <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1">http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1</ext-link>. </plain></SENT>
</text></p></fn><corresp id="cor1"><label>1</label>Corresponding author: Department of Evolution and Ecology, University of California Davis, 1 Shields Ave., Davis, CA 95616. E-mail: <email>daniel.e.runcie@gmail.com</email></corresp></author-notes><pub-date pub-type="epub-ppub"><month>7</month><year>2013</year></pub-date><pub-date pub-type="ppub"><month>7</month><year>2013</year></pub-date><pub-date pub-type="pmc-release"><month>7</month><year>2013</year></pub-date><volume>194</volume><issue>3</issue><fpage>753</fpage><lpage>767</lpage><history><date date-type="received"><day>12</day><month>3</month><year>2013</year></date><date date-type="accepted"><day>17</day><month>4</month><year>2013</year></date></history><permissions><copyright-statement>Copyright © 2013 by the Genetics Society of America</copyright-statement><copyright-year>2013</copyright-year><license license-type="open-access"><license-p>Available freely online through the author-supported open access option.</license-p></license></permissions><self-uri xlink:title="pdf" xlink:type="simple" xlink:href="753.pdf"/><abstract><p><SecTag type="ABS"><text><SENT sid="2" pm="."><plain>Quantitative genetic studies that model complex, multivariate phenotypes are important for both evolutionary prediction and artificial selection. </plain></SENT>
<SENT sid="3" pm="."><plain>For example, changes in gene expression can provide insight into developmental and physiological mechanisms that link genotype and phenotype. </plain></SENT>
<SENT sid="4" pm="."><plain>However, classical analytical techniques are poorly suited to quantitative genetic studies of gene expression where the number of traits assayed per individual can reach many thousand. </plain></SENT>
<SENT sid="5" pm="."><plain>Here, we derive a Bayesian genetic sparse factor model for estimating the genetic covariance matrix (G-matrix) of high-dimensional traits, such as gene expression, in a mixed-effects model. </plain></SENT>
<SENT sid="6" pm="."><plain>The key idea of our model is that we need consider only G-matrices that are biologically plausible. </plain></SENT>
<SENT sid="7" pm="."><plain>An organism’s entire phenotype is the result of processes that are modular and have limited complexity. </plain></SENT>
<SENT sid="8" pm="."><plain>This implies that the G-matrix will be highly structured. </plain></SENT>
<SENT sid="9" pm="."><plain>In particular, we assume that a limited number of intermediate traits (or factors, e.g., variations in development or physiology) control the variation in the high-dimensional phenotype, and that each of these intermediate traits is sparse – affecting only a few observed traits. </plain></SENT>
<SENT sid="10" pm="."><plain>The advantages of this approach are twofold. </plain></SENT>
<SENT sid="11" pm="."><plain>First, sparse factors are interpretable and provide biological insight into mechanisms underlying the genetic architecture. </plain></SENT>
<SENT sid="12" pm="."><plain>Second, enforcing sparsity helps prevent sampling errors from swamping out the true signal in high-dimensional data. </plain></SENT>
<SENT sid="13" pm="."><plain>We demonstrate the advantages of our model on simulated data and in an analysis of a published Drosophila melanogaster gene expression data set. </plain></SENT>
</text></SecTag></p></abstract><SecTag type="KEYWORD"><kwd-group><kwd>G matrix</kwd><kwd>factor model</kwd><kwd>sparsity</kwd><kwd>Bayesian inference</kwd><kwd>animal model</kwd></kwd-group></SecTag><counts><page-count count="15"/></counts><custom-meta-group><custom-meta><meta-name> DJS Export </meta-name><meta-value>v1</meta-value></custom-meta></custom-meta-group></article-meta></front><body><p><text><SENT sid="14" pm="."><plain>QUANTITATIVE studies of evolution or artificial selection often focus on a single or a handful of traits, such as size, survival, or crop yield. </plain></SENT>
<SENT sid="15" pm="."><plain>Recently, there has been an effort to collect more comprehensive phenotypic information on traits such as morphology, behavior, physiology, or gene expression (Houle 2010). </plain></SENT>
<SENT sid="16" pm="."><plain>For example, the expression of thousands of genes can be measured simultaneously (Gibson and Weir 2005; Ayroles et al. 2009; McGraw et al. 2011), together capturing complex patterns of gene regulation that reflect molecular networks, cellular stresses, and disease states (de la Cruz et al. 2010; Xiong et al. 2012). </plain></SENT>
<SENT sid="17" pm="."><plain>Studying the quantitative genetics of multiple correlated traits requires a joint modeling approach (Walsh and Blows 2009). </plain></SENT>
<SENT sid="18" pm="."><plain>However, applying the tools of quantitative genetics to high-dimensional, highly correlated data sets presents considerable analytical and computational challenges (Meyer and Kirkpatrick 2010). </plain></SENT>
<SENT sid="19" pm="."><plain>In this article we formulate a modeling framework to address these challenges for a common quantitative genetic analysis: estimating the matrix of additive genetic variances and covariances, or G-matrix (Lynch and Walsh 1998). </plain></SENT>
<SENT sid="20" pm="."><plain>The G-matrix encodes information about responses to selection (Lande 1979), evolutionary constraints (Kirkpatrick 2009), and modularity (Cheverud 1996) and is important for predicting evolutionary change (Schluter 1996). </plain></SENT>
</text></p><p><text><SENT sid="21" pm="."><plain>The challenge in scaling classic methods to hundreds or thousands of traits is that the number of modeling parameters grows rapidly. </plain></SENT>
<SENT sid="22" pm="."><plain>An unconstrained G-matrix for p traits requires p(p + 1)/2 parameters, and modeling environmental variation and measurement error (Kirkpatrick and Meyer 2004) requires at least as many additional parameters. </plain></SENT>
<SENT sid="23" pm="."><plain>Such large numbers of parameters can lead to instability in parameter estimates—analyses that are highly sensitive to outliers and have high variance. </plain></SENT>
<SENT sid="24" pm="."><plain>Previous methods for overcoming this instability include (1) “bending” or smoothing unconstrained estimates of G-matrices, such as from pairwise estimates of genetic covariation (Ayroles et al. 2009; Stone and Ayroles 2009) or moments estimators (Hayes and Hill 1981), and (2) estimating a constrained G-matrix that is low rank and is thus specified with fewer parameters (e.g., Kirkpatrick and Meyer 2004). </plain></SENT>
<SENT sid="25" pm="."><plain>Constraining the G-matrix has computational and analytical advantages: fewer parameters results in more robust estimates and lower computational requirements (Kirkpatrick and Meyer 2004). </plain></SENT>
<SENT sid="26" pm="."><plain>Constrained estimators of G-matrices include methods based on moments estimators (Hine and Blows 2006; McGraw et al. 2011) and mixed-effects models [e.g., the “animal model” and other related models (Henderson 1984; Kruuk 2004; Kirkpatrick and Meyer 2004; de los Campos and Gianola 2007)]. </plain></SENT>
<SENT sid="27" pm="."><plain>Mixed-effects models are particularly powerful for studies in large breeding programs and wild populations. </plain></SENT>
<SENT sid="28" pm="."><plain>These methods perform well on moderate-dimensional data. </plain></SENT>
<SENT sid="29" pm="."><plain>However, they are computationally costly and not sufficiently robust to analyze high-dimensional traits. </plain></SENT>
</text></p><p><text><SENT sid="30" pm="."><plain>Our objective in this article is to develop a model for estimating G-matrices that is scalable to large numbers of traits and is applicable to a variety of experimental designs, including both experimental crosses and pedigreed populations. </plain></SENT>
<SENT sid="31" pm="."><plain>We build on the Bayesian mixed-effects model of de los Campos and Gianola (2007) and model the G-matrix with a factor model. </plain></SENT>
<SENT sid="32" pm="."><plain>But, we add additional constraints by using a highly informative, biologically motivated, prior distribution on the G-matrix. </plain></SENT>
<SENT sid="33" pm="."><plain>The key idea that allows us to scale to large numbers of traits is that we believe the vast majority of the space of covariance matrices does not contain matrices that are biologically plausible as a G-matrix. </plain></SENT>
<SENT sid="34" pm="."><plain>In particular, we expect the G-matrix to be sparse, by which we mean that we favor G-matrices that are modular and low rank. </plain></SENT>
<SENT sid="35" pm="."><plain>Sparsity in statistics refers to models in which many parameters are expected to be zero (Lucas et al. 2006). </plain></SENT>
<SENT sid="36" pm="."><plain>By modular, we mean that small groups of traits will covary together. </plain></SENT>
<SENT sid="37" pm="."><plain>By low rank, we mean that there will be few (important) modules. </plain></SENT>
<SENT sid="38" pm="."><plain>We call a G-matrix with these properties sparse because there exists a low-rank factorization (most of the possible dimensions are zero) of the matrix with many of its values equal to (or close to) zero. </plain></SENT>
<SENT sid="39" pm="."><plain>This constrains the class of covariance matrices that we search over, a necessary procedure for inference of covariance matrices from high-dimensional data (Bickel and Levina 2008a,b; Carvalho et al. 2008; El Karoui 2008; Meyer and Kirkpatrick 2010; Hahn et al. 2013). </plain></SENT>
<SENT sid="40" pm="."><plain>Under these assumptions, we can also interpret the modules underlying our factorization without imposing additional constraints such as orthogonality (Engelhardt and Stephens 2010), something not possible with earlier mixed-effect factor models (Meyer 2009). </plain></SENT>
</text></p><p><text><SENT sid="41" pm="."><plain>The biological argument behind our assumption of a sparse G-matrix is that the traits we measure on an organism arise from developmental processes of limited complexity, and developmental processes tend to be modular (Cheverud 1996; Wagner and Altenberg 1996; Davidson and Levine 2008). </plain></SENT>
<SENT sid="42" pm="."><plain>For gene expression, regulatory networks control gene expression, and variation in gene expression can often be linked to variation in pathways (Xiong et al. 2012; de la Cruz et al. 2010). </plain></SENT>
<SENT sid="43" pm="."><plain>For a given data set, we make two assumptions about the modules (pathways): (1) a limited number of modules contribute to trait variation and (2) each module affects a limited number of traits. </plain></SENT>
<SENT sid="44" pm="."><plain>There is support and evidence for these modeling assumptions in the quantitative genetics literature as G-matrices tend to be highly structured (Walsh and Blows 2009) and the majority of genetic variation is contained in a few dimensions regardless of the number of traits studied (Ayroles et al. 2009; Mcgraw et al. 2011). </plain></SENT>
<SENT sid="45" pm="."><plain>Note that while we focus on developmental mechanisms underlying trait covariation, ecological or physiological processes can also lead to modularity in observed traits and our prior may be applied to these situations as well. </plain></SENT>
</text></p><p><text><SENT sid="46" pm="."><plain>Based on these assumptions, we present a Bayesian sparse factor model for inferring G-matrices for hundreds or thousands of traits which we call Bayesian sparse factor analysis of genetic covariance matrices or BSFG. </plain></SENT>
<SENT sid="47" pm="."><plain>We demonstrate the advantages of the model on simulated data and reanalyze gene expression data from a published study on Drosophila melanogaster (Ayroles et al. 2009). </plain></SENT>
<SENT sid="48" pm="."><plain>Although high-dimensional sparse models have been widely used in genetic association studies (Cantor et al. 2010; Engelhardt and Stephens 2010; Stegle et al. 2010; Parts et al. 2011; Zhou and Stephens 2012) to our knowledge, sparsity has not yet been applied to estimating a G-matrix. </plain></SENT>
</text></p><SecTag type="METHODS"><sec sec-type="methods" id="s1"><title><text><SENT sid="49" pm="."><plain>Methods </plain></SENT>
</text></title><p><text><SENT sid="50" pm="."><plain>In this section, we derive the BSFG model, by extending the classic multivariate animal model to the high-dimensional setting, where hundreds or thousands of traits are simultaneously examined. </plain></SENT>
<SENT sid="51" pm="."><plain>A factor model posits that a set of unobserved (latent) traits called factors underly the variation in the observed (measured) traits. </plain></SENT>
<SENT sid="52" pm="."><plain>For example, variation in gene expression might be the downstream output of variation in the activity of a gene regulatory network. </plain></SENT>
<SENT sid="53" pm="."><plain>Here, the activity of this gene network is a latent trait, and gene expression is a very high-dimensional set of observed traits. </plain></SENT>
<SENT sid="54" pm="."><plain>We use the animal model framework to partition variation in the observed traits and the latent factor traits into additive genetic variation and residuals. </plain></SENT>
<SENT sid="55" pm="."><plain>We encode our two main biological assumptions on the G-matrix as priors on the factors: sparsity in the number of factors that are important, and sparsity in the number of observed traits related to each factor. </plain></SENT>
<SENT sid="56" pm="."><plain>These priors constrain our estimation to realistic G-matrices and thus prevent sampling errors from swamping out the true signal in high-dimensional data. </plain></SENT>
</text></p><sec id="s2"><title><text><SENT sid="57" pm="."><plain>Model </plain></SENT>
</text></title><p><text><SENT sid="58" pm="."><plain>For a single trait the following linear mixed-effects model is commonly used to explain phenotypic variation (Henderson 1984),yi=Xbi+Zui+ei,(1)where yi is the vector of observations of the trait on n individuals; bi is the vector of coefficients for fixed effects and environmental covariates such as sex or age with design matrix X; ui∼N(0,σGi2A) is the random vector of additive genetic effects with incidence matrix Z, and ei∼N(0,σRi2In) is the residual error caused by nonadditive genetic variation, random environmental effects, and measurement error. </plain></SENT>
<SENT sid="59" pm="."><plain>The residuals are assumed to be independent of the additive genetic effects. </plain></SENT>
<SENT sid="60" pm="."><plain>Here, A is the known r × r additive relationship matrix among the individuals; r generally equals n, but will not if there are unmeasured parents, or if several individuals are clones and share the same genetic background (e.g., see the Drosophila gene expression data below). </plain></SENT>
</text></p><p><text><SENT sid="61" pm="."><plain>In going from one trait to p traits we can align the vectors for each trait in (1) to form the following multivariate model,Y=XB+ZU+E,(2)where Y = [y1 … yp], B = [b1 … bp], U = [u1 … up] and E = [e1 … ep]. U and E are therefore random variables drawn from matrix normal distributions (Dawid 1981),U∼MNr,p(0;A,G), E∼MNn,p(0;In,R),(3)where the subscripts r, p and n, p specify the dimensions of the matrices, 0 is a matrix of zeros, A and In specify the covariances of each trait among individuals, and G and R specify the additive genetic and residual covariances among traits. </plain></SENT>
</text></p><p><text><SENT sid="62" pm="."><plain>We estimate the covariance matrices G and R. To do so, we assume that any covariance among the observed traits is caused by a number of latent factors. </plain></SENT>
<SENT sid="64" pm="."><plain>Specifically, we model k latent traits that each linearly relate to one or more of the observed traits. </plain></SENT>
<SENT sid="65" pm="."><plain>We specify U and E via the following hierarchical factor model,U=FaΛT+Ea, E=FrΛT+ErFa∼MNr,k(0;A,Σa), Fr∼MNn,k(0;In,Σr)Ea∼MNr,p(0;A,Ψa), Er∼MNn,p(0;In,Ψr)Λ∼π(θ),(4)where Λ is a p × k matrix called the “factor loadings” matrix. </plain></SENT>
<SENT sid="66" pm="."><plain>Each column specifies the relationship between one latent trait and all observed traits. </plain></SENT>
<SENT sid="67" pm="."><plain>Just as U and E partition the among-individual variation in the observed traits into additive genetic effects and residuals in (2), the matrices Fa and Fr partition the among-individual variation in the latent traits into additive genetic effects and residuals. Σa and Σr model the among-factor (within-individual) covariances of Fa and Fr, which we assume to be diagonal (Σa=Diag(σaj2),Σr=Diag(σrj2)). Ψa and Ψr are the idiosyncratic (trait-specific) variances of the factor model and are assumed to be diagonal. </plain></SENT>
</text></p><p><text><SENT sid="68" pm="."><plain>In model (4), as in any factor model (e.g., West 2003), Λ is not identifiable without adding extra constraints. </plain></SENT>
<SENT sid="69" pm="."><plain>In general, the factors in Λ can be rotated arbitrarily. </plain></SENT>
<SENT sid="70" pm="."><plain>This is not an issue for estimating G itself, but prevents biological interpretations of Λ and makes assessing MCMC convergence difficult. </plain></SENT>
<SENT sid="71" pm="."><plain>To solve this problem, we introduce constraints on the orientation of Λ through our prior distribution π(θ) specified below. </plain></SENT>
<SENT sid="72" pm="."><plain>However, even after fixing a rotation, the relative scaling of corresponding columns of Fa, Fr, and Λ are still not well defined. </plain></SENT>
<SENT sid="73" pm="."><plain>For example, if the jth column of Fa and Fr are both multiplied by a constant c, the same model is recovered if the jth column of Λ is multiplied by 1/c. </plain></SENT>
<SENT sid="74" pm="."><plain>To fix c, we require the column variances (σaj2 and σrj2) to sum to one, i.e., Σa+Σr = Ik. </plain></SENT>
<SENT sid="75" pm="."><plain>Therefore, the single matrix Σh2=Σa=Ik−Σr is sufficient to specify both variances. </plain></SENT>
<SENT sid="76" pm="."><plain>The diagonal elements of this matrix specify the narrow-sense heritability (hj2=σaj2/(σaj2+σrj2)=σaj2) of latent trait j. </plain></SENT>
</text></p><p><text><SENT sid="77" pm="."><plain>Given the properties of the matrix normal distribution (Dawid 1981) and models (3) and (4) we can recover G and R asG=ΛΣh2ΛT+Ψa,R=Λ(Ik−Σh2)ΛT+Ψr.(5)Therefore, our model for the total phenotypic covariance P = G + R isP=ΛΛT+Ψa+Ψr.(6)Our specification of the BSFG model in (4) differs from earlier methods such as the Bayesian genetic factor model of de los Campos and Gianola (2007) in two key respects. </plain></SENT>
<SENT sid="78" pm="."><plain>First, in classic factor models, the total number of latent traits is assumed to be small (k ≪ p). </plain></SENT>
<SENT sid="79" pm="."><plain>Therefore, Equation 5 would model G with only pk + k + p parameters instead of p(p + 1)/2. </plain></SENT>
<SENT sid="80" pm="."><plain>However, choosing k is a very difficult, unsolved problem, and inappropriate choices can result in biased and unstable estimates of G and R (e.g., Meyer and Kirkpatrick 2008). </plain></SENT>
<SENT sid="81" pm="."><plain>In our model we allow many latent traits but assume that the majority of them are relatively unimportant. </plain></SENT>
<SENT sid="82" pm="."><plain>This subtle difference is important because it removes the need to accurately choose k, instead emphasizing the estimation of the magnitude of each latent trait. </plain></SENT>
<SENT sid="83" pm="."><plain>This model is based on the work by Bhattacharya and Dunson (2011), which they term an “infinite” factor model. </plain></SENT>
<SENT sid="84" pm="."><plain>In our prior distribution on the factor loadings matrix Λ (see section Priors), we order the latent traits (columns of Λ) in terms of decreasing influence on the total phenotypic variation and assume that the variation explained by these latent traits decreases rapidly. </plain></SENT>
<SENT sid="85" pm="."><plain>Therefore, rather than attempt to identify the correct k we model the decline in the influence of successive latent traits. </plain></SENT>
<SENT sid="86" pm="."><plain>As in other factor models, to save computational effort we can truncate Λ to include only its first k* &lt; k columns because we require the variance explained by each later column to approach zero. </plain></SENT>
<SENT sid="87" pm="."><plain>The truncation point k* can be estimated jointly while fitting the model and is flexible (we suggest truncating any columns of Λ defining modules that explain &lt;1% of the phenotypic variation in any observed trait). </plain></SENT>
<SENT sid="88" pm="."><plain>Note that k* conveys little biological information and does not have the same interpretation as k in classic factor models. </plain></SENT>
<SENT sid="89" pm="."><plain>Since additional factors are expected to explain negligible phenotypic variation, including a few extra columns to Λk* to check for more factors is permissible (e.g., Meyer and Kirkpatrick 2008). </plain></SENT>
</text></p><p><text><SENT sid="90" pm="."><plain>Second, we assume that the residual covariance R has a factor structure and that the same latent traits underly both G and R. Assuming a constrained space for R is uncommon in multivariate genetic estimation. </plain></SENT>
<SENT sid="92" pm="."><plain>For example, de los Campos and Gianola (2007) fit an unconstrained R, although they used an informative inverse Wishart prior (Gelman 2006) and only consider five traits. </plain></SENT>
<SENT sid="93" pm="."><plain>The risk of assuming a constrained R is that poorly modeled phenotypic covariance (P = G + R) can lead to biased estimates of genetic covariance in some circumstances (Jaffrezic et al. 2002; Meyer and Kirkpatrick 2008). </plain></SENT>
</text></p><p><text><SENT sid="94" pm="."><plain>However, constraining R is necessary in high-dimensional settings to prevent the number of modeling parameters from increasing exponentially, and we argue that modeling R as we have done is biologically justified. </plain></SENT>
<SENT sid="95" pm="."><plain>Factor models fitting low numbers of latent factors are used in many fields because they accurately model phenotypic covariances. </plain></SENT>
<SENT sid="96" pm="."><plain>Reasonable constraints on R have been applied successfully in previous genetic models. </plain></SENT>
<SENT sid="97" pm="."><plain>One example is in the direct estimation of genetic principle components model of Kirkpatrick and Meyer (2004). </plain></SENT>
<SENT sid="98" pm="."><plain>These authors model only the first mE eigenvectors of the residual covariance matrix. </plain></SENT>
<SENT sid="99" pm="."><plain>Our model for R is closely related to models used in random regression analysis of function-valued traits (e.g., Kirkpatrick and Heckman 1989; Pletcher and Geyer 1999; Jaffrezic et al. 2002; Meyer 2005). </plain></SENT>
<SENT sid="100" pm="."><plain>In those models, R is modeled as a permanent environmental effect function plus independent error. </plain></SENT>
<SENT sid="101" pm="."><plain>The permanent environmental effect function is given a functional form similar to (or more complex than) the genetic function. </plain></SENT>
<SENT sid="102" pm="."><plain>In Equation 4, Fr is analogous to this permanent environmental effect (but across different traits rather than the same trait observed through time), with its functional form described by Λ, and Er is independent error. </plain></SENT>
<SENT sid="103" pm="."><plain>Since both Fa and Fr relate to the observed phenotypes through Λ, the functional form of the model for the residuals (ei) is at least as complex as the genetic functional form (and more complex whenever hj2=0 for some factors). </plain></SENT>
</text></p><p><text><SENT sid="104" pm="."><plain>The biological justification of our approach is that the factors represent latent traits, and just like any other trait their value can partially be determined by genetic variation. </plain></SENT>
<SENT sid="105" pm="."><plain>For example, the activity of developmental pathways is determined by the internal and external environment but can also have a genetic basis. </plain></SENT>
<SENT sid="106" pm="."><plain>The latent traits determine the phenotypic covariance of the observed traits, and their heritability determines the genetic covariance. </plain></SENT>
<SENT sid="107" pm="."><plain>In genetic experiments, some of these latent traits (e.g., measurement biases) might be variable, but not have a genetic component. </plain></SENT>
<SENT sid="108" pm="."><plain>We expect that some factors will contribute to R but not G, so R will be modeled with more factors than G (Meyer and Kirkpatrick 2008). </plain></SENT>
</text></p><p><text><SENT sid="109" pm="."><plain>We examine the impact of our prior on R through simulations below, including cases when the true R is not low rank. </plain></SENT>
<SENT sid="110" pm="."><plain>When our assumptions regarding R do not hold, the prior may lead to biased estimates. </plain></SENT>
<SENT sid="111" pm="."><plain>For example, measurement biases might be low dimensional but not sparse, and some studies have estimated the phenotypic covariance P to be full rank (e.g., McGuigan and Blows 2007). </plain></SENT>
<SENT sid="112" pm="."><plain>However, we expect that for many general high-dimensional biological data sets this model will be useful and can provide novel insights. </plain></SENT>
<SENT sid="113" pm="."><plain>In particular, by directly modeling the heritability of the latent traits, we can predict their evolution. </plain></SENT>
</text></p></sec><sec id="s3"><title><text><SENT sid="114" pm="."><plain>Priors </plain></SENT>
</text></title><p><text><SENT sid="115" pm="."><plain>Modeling high-dimensional data requires some prior specification or penalty/regularization for accurate and stable parameter estimation (Hastie et al. 2003; West 2003; Poggio and Smale 2003). </plain></SENT>
<SENT sid="116" pm="."><plain>For our model this means that constraints on G and R are required. </plain></SENT>
<SENT sid="117" pm="."><plain>We impose constraints through a highly informative prior on Λ. Our prior is motivated by the biological assumption that variation in underlying developmental processes such as gene networks or metabolic pathways gives rise to genetic and residual covariances. </plain></SENT>
<SENT sid="119" pm="."><plain>This implies:The biological system has limited complexity: a small number of latent traits are relevant for trait variation. </plain></SENT>
<SENT sid="120" pm="."><plain>This means that the number of important factors is low (k* ≪ p).Each underlying latent trait affects a limited number of the observed traits. </plain></SENT>
<SENT sid="121" pm="."><plain>This means the factor loadings (columns of Λ) are sparse (mostly near zero).We formalize the above assumptions by a prior on Λ that imposes sparsity (formally, shrinkage toward zero) and low effective rank (Bhattacharya and Dunson 2011). </plain></SENT>
<SENT sid="122" pm="."><plain>This prior is specified as a hierarchical distribution on each element λij of Λ:λij|φij,τj∼N(0,φij−1τj−1), i=1…p, j=1…kφij∼Ga(ν/2,ν/2),τj=∏l=1mδl δ1∼Ga(a1,b1), δl∼Ga(a2,b2)forl=2…k.(7)The hierarchical prior is composed of three levels:We model each λij (specifying how observed trait i is related to latent trait j) with a normal distribution.Based on assumption 2, we expect most λij ≈ 0. </plain></SENT>
<SENT sid="123" pm="."><plain>A normal distribution with a fixed variance parameter is not sufficient to impose this constraint. </plain></SENT>
<SENT sid="124" pm="."><plain>We model the the precision (inverse of the variance) of each loading element λij with the parameter φij drawn from a gamma distribution. </plain></SENT>
<SENT sid="125" pm="."><plain>This normal–gamma mixture distribution (conditional on τj) is commonly used to impose sparsity (Neal 1996; Tipping 2001) as the marginal distribution on λij takes the form of Student’s t-distribution with v degrees of freedom and is heavy tailed. </plain></SENT>
<SENT sid="126" pm="."><plain>This forces the λij’s to be concentrated near zero, but permits occasional large magnitude values. </plain></SENT>
<SENT sid="127" pm="."><plain>This prior specification is conceptually similar to the widely used Bayesian Lasso (Park and Casella 2008).The parameter τj controls the overall variance explained by factor j by shrinking the variance toward zero as m → ∞. The decay in the variance is enforced by increasing the precision of λij as j increases so that |λij| → 0. </plain></SENT>
<SENT sid="129" pm="."><plain>The sequence {τj, j = 1 … k} is formed from the cumulative product of the sequence {δj, j = 1 … k}, where each element is modeled with a gamma distribution, and will be stochastically increasing as long as a2 &gt; b2. </plain></SENT>
<SENT sid="130" pm="."><plain>This means that the variance of λij will stochastically decrease and higher-indexed columns of Λ will be less likely to have any large magnitude elements. </plain></SENT>
<SENT sid="131" pm="."><plain>This decay ensures that it will be safe to truncate Λ at some sufficiently large k* because columns k &gt; k* will (necessarily) explain less variance. </plain></SENT>
</text></p><p><text><SENT sid="132" pm="."><plain>The prior distribution on τj (and therefore the sequence {δ1, …, δj}) is a key modeling decision as τj controls how much of the total phenotypic variance we expect each successive factor to explain. </plain></SENT>
<SENT sid="133" pm="."><plain>Based on assumption 1, we expect that few factors will be sufficient to explain total phenotypic variation, and thus {τj} will increase rapidly. </plain></SENT>
<SENT sid="134" pm="."><plain>However, relatively flat priors on δm, m = 2 … k (e.g., a2 = 3, b2 = 1), which allow some consecutive factors to be of nearly equal magnitude, appear to work well in simulations. </plain></SENT>
</text></p><p><text><SENT sid="135" pm="."><plain>The prior on the heritability of each of latent factor trait is a discrete set of values in the unit interval. </plain></SENT>
<SENT sid="136" pm="."><plain>This specification was selected for computational efficiency and to give hj2=0 positive weight in the prior. </plain></SENT>
<SENT sid="137" pm="."><plain>We find the following discrete distribution works well,πhj2(0)=0.5, πhj2(l/nh)=12(nh−1),forl=1…(nh−1), (8)where nh is the number of points to evaluate hj2. </plain></SENT>
<SENT sid="138" pm="."><plain>In analyses reported here, we set nh = 100. </plain></SENT>
<SENT sid="139" pm="."><plain>This prior gives equal weight to hj2=0 and hj2&gt;0 because we expect several factors (in particular, those reflecting measurement error) to have no genetic variance. </plain></SENT>
<SENT sid="140" pm="."><plain>In principle, we could place a continuous prior on the interval [0, 1], but no such prior would be conjugate, and developing a MCMC sampler would be more difficult. </plain></SENT>
</text></p><p><text><SENT sid="141" pm="."><plain>We place inverse gamma priors with parameters aa, ba and ar, br on each diagonal element of Ψa and Ψr, respectively. </plain></SENT>
<SENT sid="142" pm="."><plain>Priors on each element of B are normal distributions with very large (&gt;106) variances. </plain></SENT>
</text></p></sec><sec id="s4"><title><text><SENT sid="143" pm="."><plain>Implementation </plain></SENT>
</text></title><p><text><SENT sid="144" pm="."><plain>Inference in the BSFG model uses an adaptive Gibbs sampler for which we provide detailed steps in the appendix. </plain></SENT>
<SENT sid="145" pm="."><plain>The code has been implemented in Matlab and can be found at the website (<ext-link ext-link-type="uri" xlink:href="http://www.stat.duke.edu/∼sayan/bfgr/index.shtml">http://www.stat.duke.edu/∼sayan/bfgr/index.shtml</ext-link>) together with code to replicate the simulations and gene expression analyses reported here. </plain></SENT>
</text></p></sec><sec id="s5"><title><text><SENT sid="146" pm="."><plain>Simulations </plain></SENT>
</text></title><p><text><SENT sid="147" pm="."><plain>We present a simulation study of high-dimensional traits observed in the offspring of a balanced paternal half-sib breeding design. </plain></SENT>
<SENT sid="148" pm="."><plain>We examined 10 scenarios (Table 1), each corresponding to different parameters for the matrices G and R to evaluate the impact of the modeling assumptions specified by our prior. </plain></SENT>
<SENT sid="149" pm="."><plain>For each scenario we simulated trait values of individuals from Equation (2) with Z = In, B = 0p, and X a single column of ones representing the trait means. </plain></SENT>
</text></p><SecTag type="TABLE"><table-wrap id="t1" position="float"><label>Table 1</label><caption><title><text><SENT sid="150" pm="."><plain>Simulation parameters </plain></SENT>
</text></title></caption><table frame="above" rules="groups"><col width="15.71%" span="1"/><col width="9.54%" span="1"/><col width="8.21%" span="1"/><col width="8.21%" span="1"/><col width="7.69%" span="1"/><col width="9.62%" span="1"/><col width="7.83%" span="1"/><col width="10.72%" span="1"/><col width="12.58%" span="1"/><col width="4.94%" span="1"/><col width="4.95%" span="1"/><thead><tr><th valign="top" align="left" scope="col" rowspan="1" colspan="1"/><td valign="top" align="center" scope="col" colspan="3" rowspan="1"><text><SENT sid="151" pm="."><plain>No. factors </plain></SENT>
</text></td><th valign="top" align="center" scope="col" colspan="2" rowspan="1"><text><SENT sid="152" pm="."><plain>R type </plain></SENT>
</text></th><th valign="top" align="center" scope="col" colspan="2" rowspan="1"><text><SENT sid="153" pm="."><plain>No. traits </plain></SENT>
</text></th><th valign="top" align="center" scope="col" colspan="3" rowspan="1"><text><SENT sid="154" pm="."><plain>Sample size </plain></SENT>
</text></th></tr><tr><th valign="top" align="left" scope="col" rowspan="1" colspan="1"/><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="155" pm="."><plain>a </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="156" pm="."><plain>b </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="157" pm="."><plain>c </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="158" pm="."><plain>d </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="159" pm="."><plain>e </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="160" pm="."><plain>f </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="161" pm="."><plain>g </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="162" pm="."><plain>h </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="163" pm="."><plain>i </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="164" pm="."><plain>j </plain></SENT>
</text></th></tr></thead><tbody><tr><td valign="top" align="left" scope="col" rowspan="1" colspan="1"><text><SENT sid="165" pm="."><plain>G and R </plain></SENT>
</text></td><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"><text><SENT sid="166" pm="."><plain> No. traits </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="167" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="168" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="169" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="170" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="171" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="172" pm="."><plain>20 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="173" pm="."><plain>1000 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="174" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="175" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="176" pm="."><plain>100 </plain></SENT>
</text></td></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"><text><SENT sid="177" pm="."><plain> Residual type </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="178" pm="."><plain>SFa </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="179" pm="."><plain>SF </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="180" pm="."><plain>SF </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="181" pm="."><plain>Fb </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="182" pm="."><plain>Wishartc </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="183" pm="."><plain>SF </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="184" pm="."><plain>SF </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="185" pm="."><plain>SF </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="186" pm="."><plain>SF </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="187" pm="."><plain>SF </plain></SENT>
</text></td></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"><text><SENT sid="188" pm="."><plain> No. factors </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="189" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="190" pm="."><plain>25 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="191" pm="."><plain>50 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="192" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="193" pm="."><plain>5 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="194" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="195" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="196" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="197" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="198" pm="."><plain>10 </plain></SENT>
</text></td></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"><text><SENT sid="199" pm="."><plain> h2 of factorsd </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="200" pm="."><plain>0.5 (5) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="201" pm="."><plain>0.5 (15) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="202" pm="."><plain>0.5 (30) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="203" pm="."><plain>0.5 (5) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="204" pm="."><plain>1.0 (5) </plain></SENT>
</text></td><td colspan="2" valign="top" align="center" rowspan="1"><text><SENT sid="205" pm="."><plain>0.5 (5) </plain></SENT>
</text></td><td colspan="3" valign="top" align="center" rowspan="1"><text><SENT sid="206" pm="."><plain>0.9–0.1 (5) </plain></SENT>
</text></td></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"/><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="207" pm="."><plain>0.0 (5) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="208" pm="."><plain>0.0 (10) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="209" pm="."><plain>0.0 (20) </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="210" pm="."><plain>0.0 (5) </plain></SENT>
</text></td><td valign="top" align="left" rowspan="1" colspan="1"/><td colspan="2" valign="top" align="center" rowspan="1"><text><SENT sid="211" pm="."><plain>0.0 (5) </plain></SENT>
</text></td><td colspan="3" valign="top" align="center" rowspan="1"><text><SENT sid="212" pm="."><plain>0.0 (5) </plain></SENT>
</text></td></tr><tr><td valign="top" align="left" scope="col" rowspan="1" colspan="1"><text><SENT sid="213" pm="."><plain>Sample size </plain></SENT>
</text></td><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1"/></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"><text><SENT sid="214" pm="."><plain> No. sires </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="215" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="216" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="217" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="218" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="219" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="220" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="221" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="222" pm="."><plain>50 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="223" pm="."><plain>100 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="224" pm="."><plain>500 </plain></SENT>
</text></td></tr><tr><td valign="top" align="left" scope="row" rowspan="1" colspan="1"><text><SENT sid="225" pm="."><plain> No. offspring/sire </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="226" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="227" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="228" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="229" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="230" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="231" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="232" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="233" pm="."><plain>5 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="234" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="235" pm="."><plain>10 </plain></SENT>
</text></td></tr></tbody></table><table-wrap-foot><fn><p><text><SENT sid="236" pm="."><plain>Eight simulations were designed to demonstrate the capabilities of BSFG. </plain></SENT>
<SENT sid="237" pm="."><plain>Scenarios a–c test genetic and residual covariance matrices composed of different numbers of factors. </plain></SENT>
<SENT sid="238" pm="."><plain>Scenarios d–e test residual covariance matrices that are not sparse. </plain></SENT>
<SENT sid="239" pm="."><plain>Scenarios f–g test different numbers of traits. </plain></SENT>
<SENT sid="240" pm="."><plain>Scenarios h–j test different sample sizes. </plain></SENT>
<SENT sid="241" pm="."><plain>All simulations followed a paternal half-sib breeding design. </plain></SENT>
<SENT sid="242" pm="."><plain>Each simulation was run 10 times. </plain></SENT>
</text></p></fn><fn id="t1n1"><label>a</label><p><text><SENT sid="243" pm="."><plain>Sparse factor model for R. Each simulated factor loading (λij) had a 75–97% chance of equaling zero. </plain></SENT>
</text></p></fn><fn id="t1n2"><label>b</label><p><text><SENT sid="245" pm="."><plain>Factor model for R. Residual factors (those with hj2=0) were not sparse (λij ≠ 0). </plain></SENT>
</text></p></fn><fn id="t1n3"><label>c</label><p><text><SENT sid="247" pm="."><plain>R was simulated from a Wishart distribution with p + 1 degrees of freedom and inverse scale matrix 1pIp. </plain></SENT>
<SENT sid="248" pm="."><plain>Five additional factors were each assigned a heritability of 1.0. </plain></SENT>
</text></p></fn><fn id="t1n4"><label>d</label><p><text><SENT sid="249" pm="."><plain>In each column, factors are divided between those h2 &gt; 0 and those with h2 = 0. </plain></SENT>
<SENT sid="250" pm="."><plain>The number in parentheses provides the number of factors with the given heritability. </plain></SENT>
</text></p></fn></table-wrap-foot></table-wrap></SecTag><p><text><SENT sid="251" pm="."><plain>Scenarios a–c tested the accuracy of the model given increasing numbers of latent traits. G and P were simulated based on 10, 25, or 50 important factors, respectively, for 100 traits. </plain></SENT>
<SENT sid="252" pm="."><plain>Heritabilities (hj2) of latent factors j = 1 … 5, 1 … 15, or 1 … 30, respectively, were set to 0.5 and contributed to both G and R. Heritabilities of the remaining factors (j = 6 … 10, 16 … 25, or 31 … 50, respectively) were set to 0.0 and contributed only to R. For each latent factor, loadings λij were drawn from independent standard normal distributions. </plain></SENT>
<SENT sid="255" pm="."><plain>To make the covariance matrices biologically reasonable, we forced each factor to be sparse: 75–97% of the λij were set to zero. </plain></SENT>
<SENT sid="256" pm="."><plain>The idiosyncratic variances Ψa and Ψe were set to 0.2 × Ip. </plain></SENT>
<SENT sid="257" pm="."><plain>Therefore, trait-specific heritabilties ranged from 0.0 to 0.5, with the majority toward the upper limit. </plain></SENT>
<SENT sid="258" pm="."><plain>Each simulation included 10 offspring from 100 unrelated sires. </plain></SENT>
</text></p><p><text><SENT sid="259" pm="."><plain>Scenarios d–e tested the accuracy of the model when the true R was neither sparse nor low rank, since inappropriately modeled residual variances can lead to biased estimates of G (e.g., Jaffrezic et al. 2002; Meyer and Kirkpatrick 2007). </plain></SENT>
<SENT sid="260" pm="."><plain>Scenarios were identical to a except the R matrix did not have a sparse factor form. </plain></SENT>
<SENT sid="261" pm="."><plain>In scenario d, R was constructed with a factor structure with 10 factors, but 5 of these factors (j = 6 … 10, i.e., those with hj2=0.0) were not sparse (i.e., all factor loadings were nonzero). </plain></SENT>
<SENT sid="262" pm="."><plain>This might occur, for example, if the nongenetic factors were caused by measurement error. </plain></SENT>
<SENT sid="263" pm="."><plain>In scenario e, R was drawn from a central Wishart distribution with p + 1 degrees of freedom and therefore was full rank and did not follow a factor structure at all. </plain></SENT>
</text></p><p><text><SENT sid="264" pm="."><plain>Scenarios f–g tested the accuracy of the model given increasing numbers of observed traits. </plain></SENT>
<SENT sid="265" pm="."><plain>Both scenarios were identical to scenario a except scenario f had 20 observed traits and scenario g had 1000. </plain></SENT>
</text></p><p><text><SENT sid="266" pm="."><plain>Scenarios h–j tested the accuracy of the model given experiments of different size and given different latent trait heritabilities. </plain></SENT>
<SENT sid="267" pm="."><plain>Simulations were identical to scenario a except that the five genetic factors in each simulation were assigned hj2=0.9,0.7,0.5,0.3, and 0.1 for j = 2, 4, 6, 8, 10, the number of sires was set to 50, 100, or 500, and the number of offspring per sire was set to 5 (for simulation h only). </plain></SENT>
</text></p><p><text><SENT sid="268" pm="."><plain>To fit the simulated data, we set the hyperparameters in the prior to: ν = 3, a1 = 2, b1 = 1/20, a2 = 3, b2 = 1. </plain></SENT>
<SENT sid="269" pm="."><plain>We ran our Gibbs sampler for 12,000 iterations, discarded the first 10,000 samples as burn-in, and collected 1000 posterior samples with a thinning rate of two. </plain></SENT>
</text></p><p><text><SENT sid="270" pm="."><plain>We calculated a number of statistics from each simulation to quantify the estimation error of the BSFG model. </plain></SENT>
<SENT sid="271" pm="."><plain>For each statistic, we compared the posterior mean of a model parameter to the true value specified in the simulation. </plain></SENT>
</text></p><p><text><SENT sid="272" pm="."><plain>First, as a sanity check, we compared the accuracy of our method to a methods of moments estimate of G calculated as Gm = 4(B − W)/n, where B and W are the between- and within-sire matrices of mean squares and cross products and n is the number of offspring per sire. </plain></SENT>
<SENT sid="273" pm="."><plain>We compared the accuracy of the moments estimator Gm to the posterior mean G^ from our model by calculating the Frobenius norm of the errors: |Gm − G|F and |G^−G|F. </plain></SENT>
</text></p><p><text><SENT sid="274" pm="."><plain>The Frobenius norm measure above quantifies the total sum of square error in each pairwise covariance estimate. </plain></SENT>
<SENT sid="275" pm="."><plain>However, the geometry of G is more important for predicting evolution (Walsh and Blows 2009). </plain></SENT>
<SENT sid="276" pm="."><plain>We evaluated the accuracy of each estimated G matrix by comparing the k-dimensional subspace of ℝp with the majority of the variation in G to the corresponding subspace for the posterior mean estimate G^. </plain></SENT>
<SENT sid="277" pm="."><plain>We used the Krzanowski subspace comparison statistic (Krzanowski 1979; Blows et al. 2004), which is the sum of the eigenvalues of the matrix S=Gk^TGkGkTGk^, where Gk^ is the subspace spanned by the eigenvectors with the k largest eigenvalues of the posterior mean of G, and Gk is the corresponding subspace of the true (simulated) matrix. </plain></SENT>
<SENT sid="278" pm="."><plain>This statistic will be zero for orthogonal (nonoverlapping) subspaces and will equal k for identical subspaces. </plain></SENT>
<SENT sid="279" pm="."><plain>The accuracy of the estimated P was calculated similarly. </plain></SENT>
<SENT sid="280" pm="."><plain>For each comparison, k was chosen as the number of factors used in the construction of the simulated matrix (Table 1), except in scenario e with the Wishart-distributed R matrix. </plain></SENT>
<SENT sid="281" pm="."><plain>Here, we set the k for P at 19, which was sufficient to capture &gt;99% of the variation in most simulated P matrices. </plain></SENT>
</text></p><p><text><SENT sid="282" pm="."><plain>We evaluated the accuracy of latent factor estimates in two ways. </plain></SENT>
<SENT sid="283" pm="."><plain>First, we calculated the magnitude of each factor as |λj|2 where |⋅| is the L2-norm. </plain></SENT>
<SENT sid="284" pm="."><plain>This quantifies the phenotypic variance across all traits explained by each factor. </plain></SENT>
<SENT sid="285" pm="."><plain>We then counted the number of factors that explained &gt;0.1% of total phenotypic variance. </plain></SENT>
<SENT sid="286" pm="."><plain>Such factors were termed “large factors.” Second, for each simulated factor j, we calculated the error in estimated factor identity by finding the estimated factor j* with trait loadings vector λj* that had the smallest vector angle with the true factor trait loadings vector λj. </plain></SENT>
<SENT sid="287" pm="."><plain>Smaller angles correspond to more accurately identified factors. </plain></SENT>
<SENT sid="288" pm="."><plain>For scenarios d and e, error angles could be calculated only for the genetically variable factors (factors 1–5) because the residual factors for these scenarios were not well defined. </plain></SENT>
<SENT sid="289" pm="."><plain>In scenario d, factors 6–10 were not sparse and thus were identifiable only up to an arbitrary rotation by any matrix H such that HHT = I (Meyer 2009). </plain></SENT>
<SENT sid="290" pm="."><plain>In scenario e, the residual matrix did not have a factor form. </plain></SENT>
</text></p></sec><sec id="s6"><title><text><SENT sid="291" pm="."><plain>Gene expression analysis </plain></SENT>
</text></title><p><text><SENT sid="292" pm="."><plain>We downloaded gene expression profiles and measures of competitive fitness of 40 wild-derived lines of Drosophila melanogaster from ArrayExpress (accession E-MEXP-1594) and the Drosophila Genetic Reference Panel (DGRP) website (<ext-link ext-link-type="uri" xlink:href="http://dgrp.gnets.ncsu.edu/">http://dgrp.gnets.ncsu.edu/</ext-link>) (Ayroles et al. 2009). </plain></SENT>
<SENT sid="293" pm="."><plain>A line’s competitive fitness (Knight and Robertson 1957; Hartl and Jungen 1979) measures the percentage of offspring bearing the assay line’s genotype recovered from vials seeded with a known proportion of adults from a reference line. </plain></SENT>
<SENT sid="294" pm="."><plain>We used the BSFG model to infer a set of latent factor traits underlying the among-line gene expression covariance matrix for a subset of the genes and the among-line covariance between each gene and competitive fitness. </plain></SENT>
<SENT sid="295" pm="."><plain>These latent factors are useful because they provide insight into what genes and developmental or molecular pathways underlie variation in competitive fitness. </plain></SENT>
</text></p><p><text><SENT sid="296" pm="."><plain>We first normalized the processed gene expression data to correspond to the analyses of Ayroles et al. (2009) and then selected the 414 genes identified in that article as having a plausible among-line covariance with competitive fitness. </plain></SENT>
<SENT sid="297" pm="."><plain>In this data set, two biological replicates of male and female fly collections from each line were analyzed for whole-animal RNA expression. </plain></SENT>
<SENT sid="298" pm="."><plain>The competitive fitness measurements were the means of 20 competitive trials performed with sets of flies from these same lines, but not the same flies used in the gene expression analysis. </plain></SENT>
<SENT sid="299" pm="."><plain>Gene expression values for the samples measured for competitive fitness and competitive fitness values for the samples measured for gene expression were treated as missing data (see Appendix). </plain></SENT>
<SENT sid="300" pm="."><plain>We used our model to estimate the covariance of line effects. </plain></SENT>
<SENT sid="301" pm="."><plain>Following the analyses of Ayroles et al. (2009), we included a fixed effect of sex and independent random effects of the sex:line interaction for each gene. </plain></SENT>
<SENT sid="302" pm="."><plain>No sex or sex:line effects were fit for competitive fitness itself as this value was measured at the level of the line, not on individual flies. </plain></SENT>
</text></p><p><text><SENT sid="303" pm="."><plain>We set the prior hyperparameters as above and ran our Gibbs sampler for 40,000 iterations, discarded the first 20,000 samples as a burn-in period, and collected 1000 posterior samples of all parameters with a thinning rate of 20. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="RESULTS"><sec sec-type="results" id="s7"><title><text><SENT sid="304" pm="."><plain>Results </plain></SENT>
</text></title><sec id="s8"><title><text><SENT sid="305" pm="."><plain>Simulation example </plain></SENT>
</text></title><p><text><SENT sid="306" pm="."><plain>The BSFG model’s estimates of genetic covariances were considerably more accurate than estimates based on unbiased methods of moments estimators. </plain></SENT>
<SENT sid="307" pm="."><plain>In scenario a, for example, the mean Frobenius norm was 13.9 for the moments estimator and 6.3 for the Bayesian genetic sparse factor model’s posterior mean, a 54% improvement. </plain></SENT>
</text></p><p><text><SENT sid="308" pm="."><plain>The BSFG model accurately estimated subspaces containing the majority of variation in both G and P. Figure 1 shows the distribution of Krzanowski’s subspace similarity statistics (∑λsi) for G in each scenario (subspace statistics for P are shown in supporting information, <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1/genetics.113.151217-3.pdf">Figure S1</ext-link>). </plain></SENT>
<SENT sid="309" pm="."><plain>Krzanowski’s statistic corresponds approximately to the number of eigenvectors of the true subspace recovered in the estimated subspace and in our simulations rarely differed even one unit from the true value of k for either G and P. The exceptions for G were mostly in scenarios h–j, where the fifth genetic factor (factor 10) was assigned a heritability of 0.1 and the subspace spanned by the first five eigenvectors of estimated G matrices often did not include this vector. </plain></SENT>
<SENT sid="311" pm="."><plain>This effect was exacerbated at low sample sizes. </plain></SENT>
<SENT sid="312" pm="."><plain>The Krzanowski error for G (relative to k) also increased slightly for larger numbers of factors (Figure 1A), if R was full rank (Figure 1B), if few traits were observed (Figure 1C), or if the sample size was small (Figure 1D). </plain></SENT>
<SENT sid="313" pm="."><plain>Some simulations with nonsparse latent factors of R also caused slight subspace errors (scenario d, Figure 1B). </plain></SENT>
<SENT sid="314" pm="."><plain>Krzanowski’s statistics for P followed a similar pattern to those for G (<ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1/genetics.113.151217-3.pdf">Figure S1</ext-link>), except that the errors for full-rank R or for different numbers of traits were more pronounced (<ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1/genetics.113.151217-3.pdf">Figure S1</ext-link>B). </plain></SENT>
</text></p><SecTag type="FIG"><fig id="fig1" fig-type="figure" position="float"><label>Figure 1</label><caption><p><text><SENT sid="315" pm="."><plain>BSFG recovers the dominant subspace of high-dimensional G-matrices. </plain></SENT>
<SENT sid="316" pm="."><plain>Each subplot shows the distribution of Krzanowski’s statistics (∑λsi, Krzanowski 1979; Blows et al. 2004) calculated for posterior mean estimates of G across a related set of scenarios. </plain></SENT>
<SENT sid="317" pm="."><plain>Plotted values are k−∑λsi so that statistics are comparable across scenarios with different subspace dimensions. </plain></SENT>
<SENT sid="318" pm="."><plain>On this scale, identical subspaces have a value of zero and values increase as the subspaces diverge. </plain></SENT>
<SENT sid="319" pm="."><plain>The value of k used in each scenario is listed inside each box plot. </plain></SENT>
<SENT sid="320" pm="."><plain>The difference from zero roughly corresponds to the number of eigenvectors of the true subspace missing from the estimated subspace. </plain></SENT>
<SENT sid="321" pm="."><plain>Different parameters were varied in each set of simulations as listed below each box. </plain></SENT>
<SENT sid="322" pm="."><plain>(A) Increasing numbers of simulated factors. </plain></SENT>
<SENT sid="323" pm="."><plain>(B) Different types of R matrices. </plain></SENT>
<SENT sid="324" pm="."><plain>SF, a sparse-factor form for R. F, a (nonsparse) factor form for R. Wishart, R was sampled from a Wishart distribution. </plain></SENT>
<SENT sid="327" pm="."><plain>(C) Different numbers of traits. </plain></SENT>
<SENT sid="328" pm="."><plain>(D) Different numbers of sampled individuals. </plain></SENT>
<SENT sid="329" pm="."><plain>Note that in scenarios h–j, factor h2’s ranged from 0.0 to 0.9. </plain></SENT>
<SENT sid="330" pm="."><plain>Complete parameter sets describing each simulation are described in Table 1. </plain></SENT>
</text></p></caption><graphic xlink:href="753fig1"/></fig></SecTag><p><text><SENT sid="331" pm="."><plain>Even though the number of latent factors is not an explicit parameter in the BSFG model, the number of “large factors” fit in each scenario was always close to the true number of simulated factors (Table 2, except in scenario e where R was full rank). </plain></SENT>
<SENT sid="332" pm="."><plain>Factor identity estimates were also accurate. Figure 2 shows the distribution of error angles between the true factors and their estimates for each scenario. </plain></SENT>
<SENT sid="333" pm="."><plain>Median error angles were generally around 3°, but occasionally as large 5°–10° when there were more true latent factors (Figure 2A), if R was full rank (scenario e, Figure 2B), or if the sample size was small (small numbers of individuals or small numbers of traits, scenarios f and h; Figure 2, C and D). </plain></SENT>
</text></p><SecTag type="TABLE"><table-wrap id="t2" position="float"><label>Table 2</label><caption><title><text><SENT sid="334" pm="."><plain>Number of large factors recovered in each scenario </plain></SENT>
</text></title></caption><table frame="above" rules="groups"><col width="27.89%" span="1"/><col width="9.08%" span="1"/><col width="23.16%" span="1"/><col width="20.23%" span="1"/><col width="19.64%" span="1"/><thead><tr><th colspan="1" valign="top" align="left" scope="colgroup" rowspan="1"><text><SENT sid="335" pm="."><plain>Scenario </plain></SENT>
</text></th><th colspan="2" valign="top" align="center" scope="col" rowspan="1"><text><SENT sid="336" pm="."><plain>Expected </plain></SENT>
</text></th><th valign="top" align="center" scope="col" rowspan="1" colspan="1"><text><SENT sid="337" pm="."><plain>Median </plain></SENT>
</text></th><th valign="top" align="left" scope="col" rowspan="1" colspan="1"><text><SENT sid="338" pm="."><plain>Range </plain></SENT>
</text></th></tr></thead><tbody><tr><td rowspan="3" valign="top" align="left" scope="row" colspan="1"><text><SENT sid="339" pm="."><plain>No. factors </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="340" pm="."><plain>a </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="341" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="342" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="343" pm="."><plain>(10,10) </plain></SENT>
</text></td></tr><tr><td valign="top" colspan="1" align="center" scope="row" rowspan="1"><text><SENT sid="344" pm="."><plain>b </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="345" pm="."><plain>25 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="346" pm="."><plain>25 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="347" pm="."><plain>(23,25) </plain></SENT>
</text></td></tr><tr><td valign="top" colspan="1" align="center" scope="row" rowspan="1"><text><SENT sid="348" pm="."><plain>c </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="349" pm="."><plain>50 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="350" pm="."><plain>49 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="351" pm="."><plain>(48,50) </plain></SENT>
</text></td></tr><tr><td rowspan="2" valign="top" align="left" scope="row" colspan="1"><text><SENT sid="352" pm="."><plain>R type </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="353" pm="."><plain>d </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="354" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="355" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="356" pm="."><plain>(10,10) </plain></SENT>
</text></td></tr><tr><td valign="top" colspan="1" align="center" scope="row" rowspan="1"><text><SENT sid="357" pm="."><plain>e </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="358" pm="."><plain>NAa </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="359" pm="."><plain>56 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="360" pm="."><plain>(44,66) </plain></SENT>
</text></td></tr><tr><td rowspan="2" valign="top" align="left" scope="row" colspan="1"><text><SENT sid="361" pm="."><plain>No. traits </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="362" pm="."><plain>f </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="363" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="364" pm="."><plain>9 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="365" pm="."><plain>(8,11) </plain></SENT>
</text></td></tr><tr><td valign="top" colspan="1" align="center" scope="row" rowspan="1"><text><SENT sid="366" pm="."><plain>g </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="367" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="368" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="369" pm="."><plain>(10,10) </plain></SENT>
</text></td></tr><tr><td rowspan="3" valign="top" align="left" scope="row" colspan="1"><text><SENT sid="370" pm="."><plain>Sample size </plain></SENT>
</text></td><td valign="top" align="center" rowspan="1" colspan="1"><text><SENT sid="371" pm="."><plain>h </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="372" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="373" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="374" pm="."><plain>(10,10) </plain></SENT>
</text></td></tr><tr><td valign="top" colspan="1" align="center" scope="row" rowspan="1"><text><SENT sid="375" pm="."><plain>i </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="376" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="377" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="378" pm="."><plain>(10,10) </plain></SENT>
</text></td></tr><tr><td valign="top" colspan="1" align="center" scope="row" rowspan="1"><text><SENT sid="379" pm="."><plain>j </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="380" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="." rowspan="1" colspan="1"><text><SENT sid="381" pm="."><plain>10 </plain></SENT>
</text></td><td valign="top" align="char" char="(" rowspan="1" colspan="1"><text><SENT sid="382" pm="."><plain>(10,10) </plain></SENT>
</text></td></tr></tbody></table><table-wrap-foot><fn><p><text><SENT sid="383" pm="."><plain>Each scenario was simulated 10 times. </plain></SENT>
<SENT sid="384" pm="."><plain>Factor magnitude was calculated as the L2-norm of the factor loadings, divided by the total phenotypic variance across all traits. </plain></SENT>
<SENT sid="385" pm="."><plain>Factors explaining &gt;0.1% of total phenotypic variance were considered large. </plain></SENT>
</text></p></fn><fn id="t2n1"><label>a</label><p><text><SENT sid="386" pm="."><plain>In scenario e, the residual matrix did not have a factor form. </plain></SENT>
</text></p></fn></table-wrap-foot></table-wrap></SecTag><SecTag type="FIG"><fig id="fig2" fig-type="figure" position="float"><label>Figure 2</label><caption><p><text><SENT sid="387" pm="."><plain>BSFG successfully fits trait loadings on latent factors. </plain></SENT>
<SENT sid="388" pm="."><plain>The estimated factors were matched to the true latent traits in each simulation by calculating the vector angle between the trait loadings of each true factor and the most similar estimated factor (column of Λ). </plain></SENT>
<SENT sid="389" pm="."><plain>The median error angle across factors was calculated for each simulation. </plain></SENT>
<SENT sid="390" pm="."><plain>Box plots show the distribution of median error angles by scenario. </plain></SENT>
<SENT sid="391" pm="."><plain>Two identical vectors have an angle of zero. </plain></SENT>
<SENT sid="392" pm="."><plain>Completely orthogonal vectors have an angle of 90°. </plain></SENT>
<SENT sid="393" pm="."><plain>(A) Increasing numbers of simulated factors. </plain></SENT>
<SENT sid="394" pm="."><plain>(B) Different types of R matrices. </plain></SENT>
<SENT sid="395" pm="."><plain>Angles are shown only for the genetically variable factors in scenarios d and e (factors 1–5, see Methods). </plain></SENT>
<SENT sid="396" pm="."><plain>(C) Different numbers of traits. </plain></SENT>
<SENT sid="397" pm="."><plain>(D) Different numbers of sampled individuals. </plain></SENT>
</text></p></caption><graphic xlink:href="753fig2"/></fig></SecTag><p><text><SENT sid="398" pm="."><plain>Finally, the genetic architectures of the unobserved latent traits (factors) and the observed traits were accurately estimated. </plain></SENT>
<SENT sid="399" pm="."><plain>As expected, latent factor heritability estimates were more accurate for scenarios with larger sample sizes (Figure 3), but there was little difference in h2 estimates for factors with nonzero heritability across scenarios with different numbers of factors, different residual properties, or different numbers of traits (<ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1/genetics.113.151217-2.pdf">Figure S2</ext-link>). </plain></SENT>
<SENT sid="400" pm="."><plain>With small sample sizes (scenario h), larger numbers of factors (scenarios b–c), or fewer traits (scenario f), there was increasing error in h2 for factors with true h2 = 0 (Figures 3 and <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/lookup/suppl/doi:10.1534/genetics.113.151217/-/DC1/genetics.113.151217-2.pdf">Figure S2</ext-link>). </plain></SENT>
<SENT sid="401" pm="."><plain>Similarly, sample size had the greatest effect on the quality of h2 estimates for the 20–1000 traits in each scenario (Figure 4). </plain></SENT>
<SENT sid="402" pm="."><plain>Surprisingly, the most accurate trait heritability estimates were recovered when R had a factor structure but was not sparse (scenario d, Figure 4B), probably because the true range of h2 values was greater. </plain></SENT>
<SENT sid="403" pm="."><plain>Heritability estimates were also more accurate with increasing complexity of G and R (Figure 4A), but were not strongly affected by the number of traits studied (Figure 4C), or by full-rank R (Figure 4B). </plain></SENT>
</text></p><SecTag type="FIG"><fig id="fig3" fig-type="figure" position="float"><label>Figure 3</label><caption><p><text><SENT sid="404" pm="."><plain>BSFG accurately estimates the heritability of latent traits. </plain></SENT>
<SENT sid="405" pm="."><plain>Distributions of factor h2 estimates for scenarios h–j. </plain></SENT>
<SENT sid="406" pm="."><plain>These scenarios differed in the number of individuals sampled. </plain></SENT>
<SENT sid="407" pm="."><plain>Ten latent traits with h2’s between 0.0 and 0.9 were generated in each simulation. </plain></SENT>
<SENT sid="408" pm="."><plain>After fitting our factor model to each simulated data set, the estimated factors were matched to the true latent traits based on the trait-loading vector angles. </plain></SENT>
<SENT sid="409" pm="."><plain>Each box plot shows the distribution of h2 estimates for each simulated factor across 10 simulations. </plain></SENT>
<SENT sid="410" pm="."><plain>Note that the trait loadings for each factor differed in each simulation; only the h2 values remained the same. </plain></SENT>
<SENT sid="411" pm="."><plain>Thin horizontal lines in each column show the simulated h2 values. </plain></SENT>
<SENT sid="412" pm="."><plain>Colors correspond to the scenario, and solid boxes/circles are used for factors with h2 &gt; 0.0. </plain></SENT>
</text></p></caption><graphic xlink:href="753fig3"/></fig></SecTag><SecTag type="FIG"><fig id="fig4" fig-type="figure" position="float"><label>Figure 4</label><caption><p><text><SENT sid="413" pm="."><plain>BSFG estimates of individual trait heritability are accurate. </plain></SENT>
<SENT sid="414" pm="."><plain>The heritability of each individual trait was calculated as hi2=Gii/Pii. RSME=(1/p)∑i=1p(h^i2−hi2)2 was calculated for each simulation. </plain></SENT>
<SENT sid="415" pm="."><plain>Box plots show the distribution of RMSE values for each scenario. </plain></SENT>
<SENT sid="416" pm="."><plain>(A) Increasing numbers of simulated factors. </plain></SENT>
<SENT sid="417" pm="."><plain>(B) Different types of R matrices. </plain></SENT>
<SENT sid="418" pm="."><plain>(C) Different numbers of traits. </plain></SENT>
<SENT sid="419" pm="."><plain>(D) Different numbers of sampled individuals. </plain></SENT>
</text></p></caption><graphic xlink:href="753fig4"/></fig></SecTag></sec><sec id="s9"><title><text><SENT sid="420" pm="."><plain>Gene expression example </plain></SENT>
</text></title><p><text><SENT sid="421" pm="."><plain>Our estimate of the G-matrix from the Drosophila gene expression data was qualitatively similar to the original estimate (Figure 5B, and compare to Figure 7a in Ayroles et al. 2009). </plain></SENT>
<SENT sid="422" pm="."><plain>Estimates of the broad-sense heritability of each gene were also similar (r = 0.74). </plain></SENT>
<SENT sid="423" pm="."><plain>While a direct comparison of the dominant G-matrix subspace recovered by our model and the estimate by Ayroles et al. (2009) was not possible because individual covariances were not reported, we could compare the two estimates of the underlying structure. </plain></SENT>
<SENT sid="424" pm="."><plain>Using the modulated modularity clustering (MMC) algorithm (Stone and Ayroles 2009), Ayroles et al. (2009) identified 20 modules of genetically correlated transcripts post hoc. </plain></SENT>
<SENT sid="425" pm="."><plain>Our model identified 27 latent factors (Figure 5, D–F), of which 13 were large factors (explaining &gt;1% variation in 2+ genes). </plain></SENT>
<SENT sid="426" pm="."><plain>The large factors were consistent (r &gt; 0.95) across three parallel chains of the Gibbs sampler. </plain></SENT>
<SENT sid="427" pm="."><plain>Many factors were similar to the modules identified by MMC (Figure 5E). </plain></SENT>
<SENT sid="428" pm="."><plain>Some of the factors were nearly one-to-one matches to modules (e.g., factor 10 with module 8, and factor 14 with module 12). </plain></SENT>
<SENT sid="429" pm="."><plain>However, others merged together two or more modules (e.g., factor 1 with modules 7 and 9, and factor 2 with modules 4, 13, 16–20). </plain></SENT>
<SENT sid="430" pm="."><plain>And some entire modules were part of two or more factors (e.g., module 17 was included in factors 2 and 4, and module 18 was included in factors 2 and 16). </plain></SENT>
</text></p><SecTag type="FIG"><fig id="fig5" fig-type="figure" position="float"><label>Figure 5</label><caption><p><text><SENT sid="431" pm="."><plain>Among-line covariance of gene expression and competitive fitness in Drosophila is modular. </plain></SENT>
<SENT sid="432" pm="."><plain>(A–C) Genetic (among-line) architecture of 414 gene expression traits measured in adult flies of 40 wild-caught lines (Ayroles et al. 2009). </plain></SENT>
<SENT sid="433" pm="."><plain>(A) Posterior mean broad-sense heritabilities (H2) of the 414 genes. </plain></SENT>
<SENT sid="434" pm="."><plain>(B) Heat map of posterior mean genetic correlations among these genes. </plain></SENT>
<SENT sid="435" pm="."><plain>(C) Posterior mean estimates and 95% highest posterior density (HPD) intervals for genetic correlations between each gene and competitive fitness. </plain></SENT>
<SENT sid="436" pm="."><plain>For comparison, see Ayroles et al. (2009, Figure 7a). </plain></SENT>
<SENT sid="437" pm="."><plain>(D–F) Latent trait structure underlying gene expression covariances. </plain></SENT>
<SENT sid="438" pm="."><plain>(D) Posterior mean H2 for each estimated latent trait. </plain></SENT>
<SENT sid="439" pm="."><plain>(E) Heat map of posterior mean Λ matrix showing gene loadings on each latent trait. </plain></SENT>
<SENT sid="440" pm="."><plain>(F) Posterior mean estimates and 95% HPD intervals for genetic correlations between each latent trait and competitive fitness. </plain></SENT>
<SENT sid="441" pm="."><plain>The right axis of E groups genes into modules inferred using modulated modularity clustering (Ayroles et al. 2009; Stone and Ayroles 2009). </plain></SENT>
</text></p></caption><graphic xlink:href="753fig5"/></fig></SecTag><p><text><SENT sid="442" pm="."><plain>Each factor represents a sparse set (or “module”) of genes that may be coregulated by a common developmental process. </plain></SENT>
<SENT sid="443" pm="."><plain>Using the Database for Annotation, Visualization and Integrated Discovery (DAVID) v. 6.7 (Huang et al. 2009a,b), we identified several factors that were individually enriched (within this set of 414 genes) for defense and immunity, nervous system function, odorant binding, and transcription and cuticle formation. </plain></SENT>
<SENT sid="445" pm="."><plain>Similar molecular functions were identified among the modules identified by Ayroles et al. (2009). </plain></SENT>
<SENT sid="446" pm="."><plain>By inferring factors at the level of phenotypic variation, rather than the among-line covariances, we could directly estimate the broad-sense heritability (H2) of these latent traits themselves. Figure 5D shows these H2 estimates for each latent trait. </plain></SENT>
<SENT sid="447" pm="."><plain>Several of the factors have very low (&lt;0.2) or very high (&gt;0.75) H2 values. </plain></SENT>
<SENT sid="448" pm="."><plain>Selection on the later latent traits would likely be considerably more efficient than the former. </plain></SENT>
</text></p><p><text><SENT sid="449" pm="."><plain>Finally, we estimated the among-line correlation between the expression of each gene and competitive fitness (Figure 5C). </plain></SENT>
<SENT sid="450" pm="."><plain>Roughly 15% (60/414) of the 95% highest posterior density (HPD) interval estimates of the among-line correlations did not included zero. </plain></SENT>
<SENT sid="451" pm="."><plain>We also estimated the genetic correlation between competitive fitness and each of the latent traits defined by the 27 factors (Figure 5F). </plain></SENT>
<SENT sid="452" pm="."><plain>Most factors were not genetically correlated with competitive fitness. </plain></SENT>
<SENT sid="453" pm="."><plain>However, the genetic correlations between competitive fitness and factors 2 and 16 were large and highly significant, suggesting intriguing genetic relationships between these two latent traits and fitness. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="DISCUSS"><sec sec-type="discussion" id="s10"><title><text><SENT sid="454" pm="."><plain>Discussion </plain></SENT>
</text></title><p><text><SENT sid="455" pm="."><plain>The BSFG model performs well on both simulated and real data and opens the possibility of incorporating high-dimensional traits into evolutionary genetic studies and breeding programs. </plain></SENT>
<SENT sid="456" pm="."><plain>Technologies for high-dimensional phenotyping are becoming widely available in evolutionary biology and ecology so methods for modeling such traits are needed. </plain></SENT>
<SENT sid="457" pm="."><plain>Gene expression traits in particular provide a way to measure underappreciated molecular and developmental traits that may be important for evolution, and technologies exist to measure these traits on very large scales. </plain></SENT>
<SENT sid="458" pm="."><plain>Our model can be applied to other molecular traits (e.g., metabolites or protein concentrations), high-dimensional morphological traits (e.g., outlines of surfaces from geometric morphometrics), or gene–environment interactions (e.g., the same trait observed in multiple environments). </plain></SENT>
</text></p><sec id="s11"><title><text><SENT sid="459" pm="."><plain>Scalability of the method </plain></SENT>
</text></title><p><text><SENT sid="460" pm="."><plain>The key advantage of the BSFG model over existing methods is its ability to provide robust estimates of covariance parameters for data sets with large numbers of traits. </plain></SENT>
<SENT sid="461" pm="."><plain>In this study, we demonstrated high performance of the model for 100–1000 simulated traits and robust results on real data with 415. </plain></SENT>
<SENT sid="462" pm="."><plain>Similar factor models (without the genetic component) have been applied to gene expression data sets with thousands of traits (Bhattacharya and Dunson 2011), and we expect the genetic model to perform similarly. </plain></SENT>
<SENT sid="463" pm="."><plain>The main limitation will be computational time, which scales roughly linearly with the number of traits analyzed (assuming the number of important factors grows more slowly). </plain></SENT>
<SENT sid="464" pm="."><plain>As an example, analyses of simulations from scenario g with 1000 traits and 1000 individuals took about 4 hr to generate 12,000 posterior samples on a laptop computer with a 4-core 2.4-GHz Intel Core i7, while analyses of scenario a with 100 traits took ∼45 min. </plain></SENT>
<SENT sid="465" pm="."><plain>Parallel computing techniques may speed up analyses in cases of very large (e.g., 10,000+) numbers of traits. </plain></SENT>
</text></p><p><text><SENT sid="466" pm="."><plain>The main reason that our model scales well in this way is that under our prior, each factor is sparse. </plain></SENT>
<SENT sid="467" pm="."><plain>Experience with factor models in fields such as gene expression analysis, economics, finance, and social sciences (Fan et al. 2011), as well as with genetic association studies (e.g., Engelhardt and Stephens 2010; Stegle et al. 2010; Parts et al. 2011) demonstrates that sparsity (or shrinkage) is necessary to perform robust inference on high-dimensional data (Bickel and Levina 2008a,b; El Karoui 2008; Meyer and Kirkpatrick 2010). </plain></SENT>
<SENT sid="468" pm="."><plain>Otherwise, sampling variability can overwhelm any true signals, leading to unstable estimates. </plain></SENT>
<SENT sid="469" pm="."><plain>Here, we used the t-distribution as a shrinkage prior, following Bhattacharya and Dunson (2011), but many other choices are possible (Armagan et al. 2011). </plain></SENT>
</text></p></sec><sec id="s12"><title><text><SENT sid="470" pm="."><plain>Applications to evolutionary quantitive genetics </plain></SENT>
</text></title><p><text><SENT sid="471" pm="."><plain>The G-matrix features prominently in the theory of evolutionary quantitative genetics, and its estimation has been a central goal of many experimental and observational studies (Walsh and Blows 2009). </plain></SENT>
<SENT sid="472" pm="."><plain>Since the BSFG model is built on the standard “animal model” framework, it is flexible and can be applied to many experimental designs. </plain></SENT>
<SENT sid="473" pm="."><plain>And since the BSFG model is Bayesian and naturally produces estimates within the parameter space, posterior samples provide convenient credible intervals for the G-matrix itself and for many evolutionarily important parameters, such as trait-specific eritabilities or individual breeding values (Sorensen and Gianola 2010). </plain></SENT>
</text></p><p><text><SENT sid="474" pm="."><plain>An important use of the G-matrix is to predict the response of a set of traits to selection (Lande 1979). </plain></SENT>
<SENT sid="475" pm="."><plain>Applying Robertson’s second theorem of natural selection, the response in y¯ will equal the additive genetic covariance between the vector of traits and fitness (Δy¯=σA(y,w¯)) (Rausher 1992; Walsh and Blows 2009). </plain></SENT>
<SENT sid="476" pm="."><plain>This quantity can be estimated directly from our model if fitness is included as the p* = (p + 1)th trait,Δy¯=Λ/p*Λp*T,where Λ/p* contains all rows of Λ except the row for fitness, and Λp* contains only the row of Λ corresponding to fitness. </plain></SENT>
<SENT sid="477" pm="."><plain>Similarly, the quantity 1−ψap*/Gp*,p* equals the percentage of genetic variation in fitness accounted for by variation in the observed traits (Walsh and Blows 2009), which is useful for identifying other traits that might be relevant for fitness. </plain></SENT>
</text></p><p><text><SENT sid="478" pm="."><plain>On the other hand, our model is not well suited to estimating the dimensionality of the G-matrix. </plain></SENT>
<SENT sid="479" pm="."><plain>A low-rank G-matrix means that there are absolute genetic constraints on evolution (Lande 1979). </plain></SENT>
<SENT sid="480" pm="."><plain>Several methods provide statistical tests for the rank of the G-matrix (e.g., Kirkpatrick and Meyer 2004; Mezey and Houle 2005; Hine and Blows 2006). </plain></SENT>
<SENT sid="481" pm="."><plain>We use a prior that shrinks the magnitudes of higher index factors to provide robust estimates of the largest factors. </plain></SENT>
<SENT sid="482" pm="."><plain>This will likely have a side effect of underestimating the total number of factors, although this effect was not observed in our simulations. </plain></SENT>
<SENT sid="483" pm="."><plain>However, absolute constraints appear rare (Houle 2010), and the dimensions of the G-matrix with the most variation are likely those with the greatest effect on evolution in natural populations (Schluter 1996; Kirkpatrick 2009). </plain></SENT>
<SENT sid="484" pm="."><plain>Our model should estimate these dimensions well. </plain></SENT>
<SENT sid="485" pm="."><plain>From a practical standpoint, preselecting the number of factors has plagued other reduced-rank estimators of the G-matrix (e.g., Kirkpatrick and Meyer 2004; Hine and Blows 2006; Meyer 2009). </plain></SENT>
<SENT sid="486" pm="."><plain>Our prior is based on an infinite factor model (Bhattacharya and Dunson 2011), and so no a priori decision on k is needed. </plain></SENT>
<SENT sid="487" pm="."><plain>Instead, the parameters of the prior distribution on {τj} become important modeling decisions. </plain></SENT>
<SENT sid="488" pm="."><plain>In our experience, a relatively diffuse prior on δl with a2 = 3, b2 = 1 tends to work well. </plain></SENT>
</text></p></sec><sec id="s13"><title><text><SENT sid="489" pm="."><plain>Biological interpretation of factors </plain></SENT>
</text></title><p><text><SENT sid="490" pm="."><plain>Genetic modules are sets of traits likely to evolve together. </plain></SENT>
<SENT sid="491" pm="."><plain>We assume that the developmental process is modular and model a set of latent traits that each affect a limited number of observed traits. </plain></SENT>
<SENT sid="492" pm="."><plain>A unique feature of the BSFG model is that the genetic and environmental factors are estimated jointly, instead of separately as in classic multilevel factor models (e.g., Goldstein 2010). </plain></SENT>
<SENT sid="493" pm="."><plain>If each factor represents a true latent trait (e.g., variation in a developmental process), it is reasonable to decompose variation in this trait into genetic and environmental components. </plain></SENT>
<SENT sid="494" pm="."><plain>We directly estimate the heritability of the latent traits and, therefore, can use our model to predict their evolution. </plain></SENT>
</text></p><p><text><SENT sid="495" pm="."><plain>Other techniques for identifying genetic modules have several limitations. </plain></SENT>
<SENT sid="496" pm="."><plain>The MMC algorithm (Stone and Ayroles 2009; Ayroles et al. 2009) does not infer modules in an explicit quantitative genetic framework and constrains each observed trait to belong to only one module. </plain></SENT>
<SENT sid="497" pm="."><plain>A common strategy (e.g., McGraw et al. 2011) is to treat each major eigenvector of G or P itself as a module. </plain></SENT>
<SENT sid="498" pm="."><plain>These eigenvectors can be modeled directly (e.g., Kirkpatrick and Meyer 2004), but their biological interpretation is unclear because of the mathematical constraint that the eigenvectors be orthogonal (Hansen and Houle 2008). </plain></SENT>
<SENT sid="499" pm="."><plain>Classic factor models (such as proposed by Meyer 2009 or de los Campos and Gianola 2007) assume a form of modularity, but since the latent factors are not identifiable (Meyer 2009), the identity of the underlying modules is unclear. </plain></SENT>
<SENT sid="500" pm="."><plain>In contrast, under our sparsity prior, the modules we identify are identifiable (up to a sign-flip: the loadings on each factor can be multiplied by −1 without affecting its probability under the model, but this does not change which traits are associated with each factor). </plain></SENT>
<SENT sid="501" pm="."><plain>In simulations and with the Drosophila gene expression data, independent MCMC chains consistently identify the same dominant factors. </plain></SENT>
<SENT sid="502" pm="."><plain>Therefore the observed traits associated with each factor can be used to characterize a developmental module. </plain></SENT>
</text></p></sec><sec id="s14"><title><text><SENT sid="503" pm="."><plain>Extensions </plain></SENT>
</text></title><p><text><SENT sid="504" pm="."><plain>Our model is built on the classic mixed effect model in quantitative genetics (Henderson 1984). </plain></SENT>
<SENT sid="505" pm="."><plain>It is straightforward to extend to models with additional fixed or random effects (e.g., dominance or epistatic effects) for each trait. </plain></SENT>
<SENT sid="506" pm="."><plain>The update equation for hj2 in the Gibbs sampler described in the Appendix does not allow additional random effects in the model for the latent factors themselves, although other formulations are possible. </plain></SENT>
<SENT sid="507" pm="."><plain>A second extension relates to the case in which the relationship matrix among individuals (A) is unknown. </plain></SENT>
<SENT sid="508" pm="."><plain>Here, relationship estimates from genotype data can be easily incorporated. </plain></SENT>
<SENT sid="509" pm="."><plain>As such, our model is related to a recently proposed sparse factor model for genetic associations with intermediate phenotypes (Parts et al. 2011). </plain></SENT>
<SENT sid="510" pm="."><plain>These authors introduced prior information on genetic modules from gene function and pathway databases, which could be incorporated in our model in a similar way. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="CONCL"><sec sec-type="conclusions" id="s15"><title><text><SENT sid="511" pm="."><plain>Conclusions </plain></SENT>
</text></title><p><text><SENT sid="512" pm="."><plain>The BSFG model we propose provides a novel approach to genetic estimation with high-dimensional traits. </plain></SENT>
<SENT sid="513" pm="."><plain>We anticipate that incorporating many diverse phenotypes into genetic studies will provide powerful insights into evolutionary processes. </plain></SENT>
<SENT sid="514" pm="."><plain>The use of highly informative but biologically grounded priors is necessary for making inferences on high-dimensional data and can help identify developmental mechanisms underlying phenotypic variation in populations. </plain></SENT>
</text></p></sec></SecTag>
<SecTag type="SUPPL"><sec sec-type="supplementary-material">
<title><text><SENT sid="515" pm="."><plain>Supplementary Material </plain></SENT>
</text></title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title><text><SENT sid="516" pm="."><plain>Supporting Information </plain></SENT>
</text></title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_194_3_753__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="89db1ab4633f5fdf3aa3ca7ff231b205_genetics.113.151217-1.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="b5ca384230c85ce7e65b241d21cf93bd_genetics.113.151217-3.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="8c29f96183680be3991f7d35b76baee6_genetics.113.151217-2.pdf"/>
</supplementary-material>
</sec></SecTag>
</body><back><SecTag type="ACK_FUND"><ack><title>Acknowledgments</title><p><text4fund><text><SENT sid="517" pm="."><plain>We thank Barbara Engelhardt, Iulian Pruteanu-Malinici, Jenny Tung, and two anonymous reviewers for comments and advice on this method. </plain></SENT>
<SENT sid="518" pm="."><plain>S.M. and D.E.R. are pleased to acknowledge the support of National Institutes of Health (Systems Biology) 5P50-GM081883, and S.M. is pleased to acknowledge the support of Air Force Office of Scientific Research, FA9550-10-1-0436, National Science Foundation (NSF) CCF-1049290, and NSF DMS-1209155. </plain></SENT>
</text></text4fund></p></ack></SecTag><fn-group><fn id="fn1"><p><text><SENT sid="519" pm="."><plain>Communicating editor: I. Hoeschele </plain></SENT>
</text></p></fn></fn-group><SecTag type="APPENDIX"><app-group><app><title>Appendix: Posterior sampling</title><p>We estimate the posterior distribution of the BSFG model with an adaptive partially collapsed Gibbs sampler (<xref rid="bib58" ref-type="bibr">van Dyk and Park 2011</xref>) based on the procedure proposed by <xref rid="bib3" ref-type="bibr">Bhattacharya and Dunson (2011)</xref>. The value <italic>k</italic>* at which columns in <bold>Λ</bold> are truncated is set using an adaptive procedure (<xref rid="bib3" ref-type="bibr">Bhattacharya and Dunson 2011</xref>). Given a truncation point, the following conditional posterior distributions are sampled in order:<list list-type="order" id="L3"><list-item><p>The full conditional posterior distribution of the truncated factor loading matrix <inline-formula><mml:math id="me45"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is dependent on the parameters <bold>B</bold>, <bold>E</bold><sub>a</sub>, <bold>F</bold> = <bold>F</bold><sub>a</sub> + <bold>F</bold><sub>r</sub>, and <inline-formula><mml:math id="me46"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ψ</mml:mi></mml:mstyle><mml:mtext>r</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The full density factors into independent multivariate normal densities (MVNs) for each row of <inline-formula><mml:math id="me47"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>:<disp-formula><mml:math id="me48"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <disp-formula><mml:math id="me49"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>.</disp-formula></p><p>To speed up the MCMC mixing, we partially collapse this Gibbs update step by marginalizing over <bold>E</bold><sub>a</sub> ∼ N(<bold>0</bold>, <bold>A</bold>, <bold>Ψ</bold><sub>a</sub>). Let <inline-formula><mml:math id="me50"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ψ</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,<disp-formula><mml:math id="me51"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>*</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi><mml:mi>A</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>*</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="me52"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi><mml:mi>A</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The matrix sum <inline-formula><mml:math id="me53"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi><mml:mi>A</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math></inline-formula> can be efficiently inverted each MCMC iteration by precalculating a unitary matrix <bold>U</bold> and a diagonal matrix <bold>S</bold> such that <bold>ZAZ</bold><sup>T</sup> = <bold>USU</bold><sup>T</sup>. Thus, <inline-formula><mml:math id="me54"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi><mml:mi>A</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mo> </mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math></inline-formula>, which does not require a full matrix inversion.</p></list-item><list-item><p>The full conditional posterior distribution of the joint matrix <inline-formula><mml:math id="me55"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:mo> </mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext><mml:mtext>T</mml:mtext></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math></inline-formula> is dependent on the parameters <bold>F</bold>, <bold>Λ</bold>, Ψ<sub>a</sub>, and Ψ<sub>r</sub>. The full density factors into independent MVNs for each column of the matrix,<disp-formula><mml:math id="me56"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:msubsup><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi><mml:mtext>T</mml:mtext></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<bold>W</bold> and <bold>C</bold> are defined as<disp-formula><mml:math id="me57"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi mathvariant="bold">W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">0</mml:mi></mml:mtd><mml:mtd><mml:mi mathvariant="bold">0</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold">0</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>The precision matrix <bold>C</bold> can be efficiently inverted each MCMC iteration by precalculating the unitary matrix <bold>U</bold> and diagonal matrices <bold>S</bold><sub>1</sub> and <bold>S</bold><sub>2</sub> as the generalized singular value decomposition of the Cholesky decomposition of the two components of <bold>C</bold> such that <inline-formula><mml:math id="me58"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mo> </mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math></inline-formula>, which does not require a full matrix inversion.</p></list-item><list-item><p>The full conditional posterior distribution of the latent factor heritabilities, <inline-formula><mml:math id="me59"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>Diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is dependent on <bold>F</bold> and <bold>F</bold><sub>a</sub>. The density factors into independent distributions for each <inline-formula><mml:math id="me60"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, each of which has the form of a multinomial distribution since the prior on this parameter is discrete. This update step can be partially collapsed by marginalizing over <inline-formula><mml:math id="me61"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The partially collapsed density is normalized by summing over all possibilities of <inline-formula><mml:math id="me62"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>,<disp-formula><mml:math id="me63"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi><mml:mi>A</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi><mml:mi>A</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>E</mml:mtext></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where N(<bold>x</bold>|<italic>μ</italic>, Σ) is the MVN with mean <italic>μ</italic> and variance Σ, evaluated at <bold>x</bold>, <inline-formula><mml:math id="me64"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="me65"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the prior probability that <inline-formula><mml:math id="me66"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Given this conditional posterior, <inline-formula><mml:math id="me67"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is sampled from a multinomial distribution. The MVN densities can be calculated efficiently with the diagonalization matrices given in step 1.</p></list-item><list-item><p>The full conditional posterior distribution of the genetic effects on the factors, <bold>F</bold><sub>a</sub>, depends on <bold>F</bold> and <bold>Σ</bold><sub>a</sub>. This distribution factors into independent MVNs for each column <inline-formula><mml:math id="me68"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo> </mml:mo><mml:mtext>st</mml:mtext><mml:mo> </mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>,<disp-formula><mml:math id="me69"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>,</disp-formula></p><p>where <inline-formula><mml:math id="me70"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mtext>T</mml:mtext></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>The precision matrix <bold>C</bold> can be efficiently inverted each MCMC iteration in the same manner as in step 2.</p></list-item><list-item><p>The residuals of the genetic effects on the factor scores, <bold>F</bold><sub>r</sub>, can be calculated as <bold>F</bold> − <bold>F</bold><sub>a</sub>. The full conditional posterior distribution of <bold>F</bold> is a matrix variate normal distribution that depends on <inline-formula><mml:math id="me71"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and Ψ<sub>r</sub>:<disp-formula><mml:math id="me72"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>|</mml:mo></mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ψ</mml:mi></mml:mstyle><mml:mtext>r</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mtext>MN</mml:mtext></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi><mml:mi>B</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ψ</mml:mi></mml:mstyle><mml:mtext>r</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mtext>a</mml:mtext></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula><mml:math id="me73"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ψ</mml:mi></mml:mstyle><mml:mtext>r</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math>.</disp-formula></p></list-item><list-item><p>The conditional posterior of the factor loading precision parameter <italic>φ<sub>ij</sub></italic> for trait <italic>i</italic> on factor <italic>j</italic> is<disp-formula id="eq___10"><mml:math id="me84"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>ν</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>ν</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p>The conditional posterior of <italic>δ<sub>m</sub></italic>, <italic>m</italic> = 1 … <italic>k</italic>* is as follows. For <italic>δ</italic><sub>1</sub>,<disp-formula><mml:math id="me75"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>and for <disp-formula><mml:math id="me77"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>h</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="me76"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <disp-formula><mml:math id="me85"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>≠</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math>.</disp-formula></p><p>The sequence {<italic>τ<sub>j</sub></italic>} is calculated as the cumulative product: <inline-formula><mml:math id="me78"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>The conditional posterior of the precision of the residual genetic effects of trait <italic>j</italic> is<disp-formula id="eq___15"><mml:math id="me79"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>a</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mtext>T</mml:mtext></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p>The conditional posterior of the residual precision of model residuals for trait <italic>j</italic> is<disp-formula id="eq___16"><mml:math id="me80"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Ga</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>r</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mover><mml:mrow><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder></mml:mrow><mml:mi>n</mml:mi></mml:mover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>x</mml:mi></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msubsup><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>z</mml:mi></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p>If missing observations are present, values are drawn independently from univariate normal distributions parameterized by the current values of all other parameters,<disp-formula id="eq___17"><mml:math id="me81"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>x</mml:mi></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>f</mml:mi></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msubsup><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi><mml:mtext>T</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>z</mml:mi></mml:mstyle><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <italic>y<sub>ij</sub></italic> is the imputed phenotype value for the <italic>j</italic>th trait in individual <italic>i</italic>. The three components of the mean are: <bold>x</bold><sup>(</sup><italic><sup>i</sup></italic><sup>)</sup>, the row vector of fixed effect covariates for individual <italic>i</italic> times <bold>b</bold><italic><sub>j</sub></italic>, the <italic>j</italic>th column of the fixed effect coefficient matrix; <bold>f</bold><sup>(</sup><italic><sup>i</sup></italic><sup>)</sup>, the row vector of factor scores on the <italic>k</italic>* factors for individual <italic>i</italic> times <inline-formula><mml:math id="me82"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>j</mml:mi><mml:mtext>T</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>, the row of the factor loading matrix for trait <italic>j</italic>; and <bold>z</bold><sup>(</sup><italic><sup>i</sup></italic><sup>)</sup>, the row vector of the random (genetic) effect incidence matrix for individual <italic>i</italic> times <inline-formula><mml:math id="me83"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mtext>a</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the vector of residual genetic effects for trait <italic>j</italic> not accounted for by the <italic>k</italic>* factors. Finally, <italic>ψ<sub>j</sub></italic> is the residual variance of trait <italic>j</italic>. All missing data are drawn in a single block update.</p><p>Other random effects, such as the line × sex effects modeled in the gene expression example of this article can be incorporated into this sampling scheme in much the same way that the residual genetic effects, <bold>E</bold><sub>a</sub>, are included here.</p></list-item></list></p></app></app-group></SecTag><SecTag type="REF"><ref-list><title>Literature Cited</title><ref id="bib1"><text><SENT sid="521" pm="."><plain>ArmaganA.DunsonD.ClydeM., 2011 Generalized beta mixtures of Gaussians, pp. 523–531 in Advances in Neural Information Processing Systems 24, edited by Shawe-TaylorJ.Zemel R.BartlettP.PereiraF.WeinbergerK. Available at: <ext-link ext-link-type="uri" xlink:href="http://books.nips.cc/nips24.html">http://books.nips.cc/nips24.html</ext-link> </plain></SENT>
</text></ref><ref id="bib2"><text><SENT sid="522" pm="."><plain>AyrolesJ. </plain></SENT>
<SENT sid="523" pm="."><plain>F.CarboneM. </plain></SENT>
<SENT sid="524" pm="."><plain>A.StoneE. </plain></SENT>
<SENT sid="525" pm="."><plain>A.JordanK. </plain></SENT>
<SENT sid="526" pm="."><plain>W.LymanR. </plain></SENT>
<SENT sid="527" pm="."><plain>F., 2009 Systems genetics of complex traits in Drosophila melanogaster. Nat. </plain></SENT>
<SENT sid="528" pm="."><plain>Genet. 41(3): 299–30719234471 </plain></SENT>
</text></ref><ref id="bib3"><text><SENT sid="529" pm="."><plain>BhattacharyaA.DunsonD. </plain></SENT>
<SENT sid="530" pm="."><plain>B., 2011 Sparse Bayesian infinite factor models. Biometrika 98(2): 291–30623049129 </plain></SENT>
</text></ref><ref id="bib4"><text><SENT sid="531" pm="."><plain>BickelP. </plain></SENT>
<SENT sid="532" pm="."><plain>J.LevinaE., 2008a Covariance regularization by thresholding. Ann. </plain></SENT>
<SENT sid="533" pm="."><plain>Stat. 36: 2577–2604 </plain></SENT>
</text></ref><ref id="bib5"><text><SENT sid="534" pm="."><plain>BickelP. </plain></SENT>
<SENT sid="535" pm="."><plain>J.LevinaE., 2008b Regularized estimation of large covariance matrices. Ann. </plain></SENT>
<SENT sid="536" pm="."><plain>Stat. 36: 199–227 </plain></SENT>
</text></ref><ref id="bib6"><text><SENT sid="537" pm="."><plain>BlowsM. </plain></SENT>
<SENT sid="538" pm="."><plain>W.ChenowethS. </plain></SENT>
<SENT sid="539" pm="."><plain>F.HineE., 2004 Orientation of the genetic variance–covariance matrix and the fitness surface for multiple male sexually selected traits. Am. </plain></SENT>
<SENT sid="540" pm="."><plain>Nat. 163(3): 329–34015026971 </plain></SENT>
</text></ref><ref id="bib7"><text><SENT sid="541" pm="."><plain>CantorR. </plain></SENT>
<SENT sid="542" pm="."><plain>M.LangeK.SinsheimerJ. </plain></SENT>
<SENT sid="543" pm="."><plain>S., 2010 Prioritizing GWAS results: a review of statistical methods and recommendations for their application. Am. </plain></SENT>
<SENT sid="544" pm="."><plain>J. </plain></SENT>
<SENT sid="545" pm="."><plain>Hum. </plain></SENT>
<SENT sid="546" pm="."><plain>Genet. 86(1): 6–2220074509 </plain></SENT>
</text></ref><ref id="bib8"><text><SENT sid="547" pm="."><plain>CarvalhoC. </plain></SENT>
<SENT sid="548" pm="."><plain>M.ChangJ.LucasJ. </plain></SENT>
<SENT sid="549" pm="."><plain>E.NevinsJ. </plain></SENT>
<SENT sid="550" pm="."><plain>R.WangQ., 2008 High-dimensional sparse factor modeling: applications in gene expression genomics. J. Am. </plain></SENT>
<SENT sid="552" pm="."><plain>Stat. </plain></SENT>
<SENT sid="553" pm="."><plain>Assoc. 103(484): 1438–145621218139 </plain></SENT>
</text></ref><ref id="bib9"><text><SENT sid="554" pm="."><plain>CheverudJ. </plain></SENT>
<SENT sid="555" pm="."><plain>M., 1996 Developmental integration and the evolution of pleiotropy. Integr. </plain></SENT>
<SENT sid="556" pm="."><plain>Comp. </plain></SENT>
<SENT sid="557" pm="."><plain>Biol. 36(1): 44–50 </plain></SENT>
</text></ref><ref id="bib10"><text><SENT sid="558" pm="."><plain>DavidsonE.LevineM., 2008 Properties of developmental gene regulatory networks. Proc. </plain></SENT>
<SENT sid="559" pm="."><plain>Natl. </plain></SENT>
<SENT sid="560" pm="."><plain>Acad. </plain></SENT>
<SENT sid="561" pm="."><plain>Sci. </plain></SENT>
<SENT sid="562" pm="."><plain>USA 105(51): 20063–2006619104053 </plain></SENT>
</text></ref><ref id="bib11"><text><SENT sid="563" pm="."><plain>DawidA. </plain></SENT>
<SENT sid="564" pm="."><plain>P., 1981 Some matrix-variate distribution theory: notational considerations and a Bayesian application. Biometrika 68(1): 265–274 </plain></SENT>
</text></ref><ref id="bib12"><text><SENT sid="565" pm="."><plain>de la CruzO.WenX.KeB.SongM.NicolaeD. </plain></SENT>
<SENT sid="566" pm="."><plain>L., 2010 Gene, region and pathway level analyses in whole-genome studies. Genet. </plain></SENT>
<SENT sid="567" pm="."><plain>Epidemiol. 34: 222–23120013942 </plain></SENT>
</text></ref><ref id="bib13"><text><SENT sid="568" pm="."><plain>de Los CamposG.GianolaD., 2007 Factor analysis models for structuring covariance matrices of additive genetic effects: a Bayesian implementation. Genet. </plain></SENT>
<SENT sid="569" pm="."><plain>Sel. </plain></SENT>
<SENT sid="570" pm="."><plain>Evol. 39(5): 481–49417897592 </plain></SENT>
</text></ref><ref id="bib14"><text><SENT sid="571" pm="."><plain>el KarouiN., 2008 Operator norm consistent estimation of large dimensional sparse covariance matrices. Ann. </plain></SENT>
<SENT sid="572" pm="."><plain>Stat. 36: 2717–2756 </plain></SENT>
</text></ref><ref id="bib15"><text><SENT sid="573" pm="."><plain>EngelhardtB. </plain></SENT>
<SENT sid="574" pm="."><plain>E.StephensM., 2010 Analysis of population structure: a unifying framework and novel methods based on sparse factor analysis. PLoS Genet. 6(9): e100111720862358 </plain></SENT>
</text></ref><ref id="bib16"><text><SENT sid="575" pm="."><plain>FanJ.LvJ.QiL., 2011 Sparse high dimensional models in economics. Annu. </plain></SENT>
<SENT sid="576" pm="."><plain>Rev. </plain></SENT>
<SENT sid="577" pm="."><plain>Econom. 3: 291–31722022635 </plain></SENT>
</text></ref><ref id="bib17"><text><SENT sid="578" pm="."><plain>GelmanA., 2006 Prior distributions for variance parameters in hierarchical models. Bayesian Anal. 1(3): 515–533 </plain></SENT>
</text></ref><ref id="bib18"><text><SENT sid="579" pm="."><plain>GibsonG.WeirB., 2005 The quantitative genetics of transcription. Trends Genet. 21(11): 616–62316154229 </plain></SENT>
</text></ref><ref id="bib19"><text><SENT sid="580" pm="."><plain>GoldsteinH., 2010 Multilevel Factor Analysis, Structural Equation and Mixture Models, pp. 189–200. Wiley, New York. </plain></SENT>
</text></ref><ref id="bib20"><text><SENT sid="581" pm="."><plain>Hahn, P. R., C. M. </plain></SENT>
<SENT sid="584" pm="."><plain>Carvalho, and S. Mukherjee, 2013 Partial factor modeling: predictor-dependent shrinkage for linear regression. </plain></SENT>
<SENT sid="586" pm="."><plain>J. </plain></SENT>
<SENT sid="587" pm="."><plain>Am. </plain></SENT>
<SENT sid="588" pm="."><plain>Stat. </plain></SENT>
<SENT sid="589" pm="."><plain>Assoc. </plain></SENT>
<SENT sid="590" pm="."><plain>(in press). </plain></SENT>
</text></ref><ref id="bib21"><text><SENT sid="591" pm="."><plain>HansenT. </plain></SENT>
<SENT sid="592" pm="."><plain>F.HouleD., 2008 Measuring and comparing evolvability and constraint in multivariate characters. J. Evol. </plain></SENT>
<SENT sid="594" pm="."><plain>Biol. 21(5): 1201–121918662244 </plain></SENT>
</text></ref><ref id="bib22"><text><SENT sid="595" pm="."><plain>HartlD. </plain></SENT>
<SENT sid="596" pm="."><plain>L.JungenH., 1979 Estimation of average fitness of populations of Drosophila melanogaster and the evolution of fitness in experimental populations. Evolution 33(1): 371–380 </plain></SENT>
</text></ref><ref id="bib23"><text><SENT sid="597" pm="."><plain>HastieT.TibshiraniR.FriedmanJ. </plain></SENT>
<SENT sid="598" pm="."><plain>H., 2003 The Elements of Statistical Learning. Springer, New York </plain></SENT>
</text></ref><ref id="bib24"><text><SENT sid="599" pm="."><plain>HayesJ. </plain></SENT>
<SENT sid="600" pm="."><plain>F.HillW. </plain></SENT>
<SENT sid="601" pm="."><plain>G., 1981 Modification of estimates of parameters in the construction of genetic selection indices (’bending’). Biometrics 37(3): 483–493 </plain></SENT>
</text></ref><ref id="bib25"><text><SENT sid="602" pm="."><plain>Henderson, C. R., 1984 Applications of Linear Models in Animal Breeding University of Guelph, Guelph, Ontario, Canada. </plain></SENT>
</text></ref><ref id="bib26"><text><SENT sid="604" pm="."><plain>HineE.BlowsM. </plain></SENT>
<SENT sid="605" pm="."><plain>W., 2006 Determining the effective dimensionality of the genetic variance-covariance matrix. Genetics 173: 1135–114416547106 </plain></SENT>
</text></ref><ref id="bib27"><text><SENT sid="606" pm="."><plain>HouleD., 2010 Colloquium papers: numbering the hairs on our heads: the shared challenge and promise of phenomics. Proc. </plain></SENT>
<SENT sid="607" pm="."><plain>Natl. </plain></SENT>
<SENT sid="608" pm="."><plain>Acad. </plain></SENT>
<SENT sid="609" pm="."><plain>Sci. </plain></SENT>
<SENT sid="610" pm="."><plain>USA 107(Suppl. </plain></SENT>
<SENT sid="611" pm="."><plain>1): 1793–179919858477 </plain></SENT>
</text></ref><ref id="bib28"><text><SENT sid="612" pm="."><plain>HuangD. </plain></SENT>
<SENT sid="613" pm="."><plain>W.ShermanB. </plain></SENT>
<SENT sid="614" pm="."><plain>T.LempickiR. </plain></SENT>
<SENT sid="615" pm="."><plain>A., 2009a Bioinformatics enrichment tools: paths toward the comprehensive functional analysis of large gene lists. Nucleic Acids Res. 37(1): 1–1319033363 </plain></SENT>
</text></ref><ref id="bib29"><text><SENT sid="616" pm="."><plain>HuangD. </plain></SENT>
<SENT sid="617" pm="."><plain>W.ShermanB. </plain></SENT>
<SENT sid="618" pm="."><plain>T.LempickiR. </plain></SENT>
<SENT sid="619" pm="."><plain>A., 2009b Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources. Nat. </plain></SENT>
<SENT sid="620" pm="."><plain>Protoc. 4(1): 44–5719131956 </plain></SENT>
</text></ref><ref id="bib30"><text><SENT sid="621" pm="."><plain>JaffrezicF.WhiteM. </plain></SENT>
<SENT sid="622" pm="."><plain>S.ThompsonR.VisscherP. </plain></SENT>
<SENT sid="623" pm="."><plain>M., 2002 Contrasting models for lactation curve analysis. J. Dairy Sci. 85: 968–97512018443 </plain></SENT>
</text></ref><ref id="bib31"><text><SENT sid="625" pm="."><plain>KirkpatrickM., 2009 Patterns of quantitative genetic variation in multiple dimensions. Genetica 136(2): 271–28418695991 </plain></SENT>
</text></ref><ref id="bib32"><text><SENT sid="626" pm="."><plain>KirkpatrickM.HeckmanN., 1989 A quantitative genetic model for growth, shape, reaction norms, and other infinite-dimensional characters. J. Math. </plain></SENT>
<SENT sid="628" pm="."><plain>Biol. 27(4): 429–4502769086 </plain></SENT>
</text></ref><ref id="bib33"><text><SENT sid="629" pm="."><plain>KirkpatrickM.MeyerK., 2004 Direct estimation of genetic principal components: simplified analysis of complex phenotypes. Genetics 168: 2295–230615611193 </plain></SENT>
</text></ref><ref id="bib34"><text><SENT sid="630" pm="."><plain>Knight, G. R., and A. Robertson 1957 Fitness as a measurable character in Drosophila. </plain></SENT>
<SENT sid="633" pm="."><plain>Genetics 42: 524. </plain></SENT>
</text></ref><ref id="bib35"><text><SENT sid="634" pm="."><plain>KruukL. </plain></SENT>
<SENT sid="635" pm="."><plain>E. </plain></SENT>
<SENT sid="636" pm="."><plain>B., 2004 Estimating genetic parameters in natural populations using the ’animal model’. Philos. </plain></SENT>
<SENT sid="637" pm="."><plain>Trans. </plain></SENT>
<SENT sid="638" pm="."><plain>R. </plain></SENT>
<SENT sid="639" pm="."><plain>Soc. </plain></SENT>
<SENT sid="640" pm="."><plain>B 359(1446): 873–890 </plain></SENT>
</text></ref><ref id="bib36"><text><SENT sid="641" pm="."><plain>KrzanowskiW. </plain></SENT>
<SENT sid="642" pm="."><plain>J., 1979 Between-groups comparison of principal components. J. Am. </plain></SENT>
<SENT sid="644" pm="."><plain>Stat. </plain></SENT>
<SENT sid="645" pm="."><plain>Assoc. 74(367): 703–707 </plain></SENT>
</text></ref><ref id="bib37"><text><SENT sid="646" pm="."><plain>LandeR., 1979 Quantitative genetic-analysis of multivariate evolution, applied to brain–body size allometry. Evolution 33(1): 402–416 </plain></SENT>
</text></ref><ref id="bib38"><text><SENT sid="647" pm="."><plain>LucasJ.CarvalhoC.WangQ.BildA.NevinsJ., 2006 Sparse statistical modelling in gene expression genomics, pp. 155–173 in Bayesian Inference for Gene Expression and Proteomics, edited byDo K.-A.Muller P.VannucciM. Cambridge University Press, Cambridge, UK </plain></SENT>
</text></ref><ref id="bib39"><text><SENT sid="648" pm="."><plain>Lynch, M., and B. Walsh, 1998 Genetics and Analysis of Quantitative Traits, Ed. </plain></SENT>
<SENT sid="650" pm="."><plain>1. </plain></SENT>
<SENT sid="651" pm="."><plain>Sinauer Associates, Sunderland, MA. </plain></SENT>
</text></ref><ref id="bib40"><text><SENT sid="652" pm="."><plain>McGrawE. </plain></SENT>
<SENT sid="653" pm="."><plain>A.YeY. </plain></SENT>
<SENT sid="654" pm="."><plain>H.FoleyB.ChenowethS. </plain></SENT>
<SENT sid="655" pm="."><plain>F.HiggieM., 2011 High-dimensional variance partitioning reveals the modular genetic basis of adaptive divergence in gene expression during reproductive character displacement. Evolution 65(11): 3126–313722023580 </plain></SENT>
</text></ref><ref id="bib41"><text><SENT sid="656" pm="."><plain>McGuiganK.BlowsM. </plain></SENT>
<SENT sid="657" pm="."><plain>W., 2007 The phenotypic and genetic covariance structure of drosphilid wings. Evolution 61(4): 902–91117439620 </plain></SENT>
</text></ref><ref id="bib42"><text><SENT sid="658" pm="."><plain>MeyerK., 2005 Advances in methodology for random regression analyses. Aust. </plain></SENT>
<SENT sid="659" pm="."><plain>J. </plain></SENT>
<SENT sid="660" pm="."><plain>Exp. </plain></SENT>
<SENT sid="661" pm="."><plain>Agric. 45: 847–858 </plain></SENT>
</text></ref><ref id="bib43"><text><SENT sid="662" pm="."><plain>MeyerK., 2009 Factor-analytic models for genotype × environment type problems and structured covariance matrices. Genet. </plain></SENT>
<SENT sid="663" pm="."><plain>Sel. </plain></SENT>
<SENT sid="664" pm="."><plain>Evol. 41: 2119284520 </plain></SENT>
</text></ref><ref id="bib44"><text><SENT sid="665" pm="."><plain>MeyerK.KirkpatrickM., 2007 A note on bias in reduced rank estimates of covariance matrices. Proc. </plain></SENT>
<SENT sid="666" pm="."><plain>Assoc. </plain></SENT>
<SENT sid="667" pm="."><plain>Adv. </plain></SENT>
<SENT sid="668" pm="."><plain>Anim. </plain></SENT>
<SENT sid="669" pm="."><plain>Breed. </plain></SENT>
<SENT sid="670" pm="."><plain>Genet 17: 154–157 </plain></SENT>
</text></ref><ref id="bib45"><text><SENT sid="671" pm="."><plain>MeyerK.KirkpatrickM., 2008 Perils of parsimony: properties of reduced-rank estimates of genetic covariance matrices. Genetics 180: 1153–116618757923 </plain></SENT>
</text></ref><ref id="bib46"><text><SENT sid="672" pm="."><plain>MeyerK.KirkpatrickM., 2010 Better estimates of genetic covariance matrices by “bending” using penalized maximum likelihood. Genetics 185(3): 1097–111020442220 </plain></SENT>
</text></ref><ref id="bib47"><text><SENT sid="673" pm="."><plain>MezeyJ.HouleD., 2005 The dimensionality of genetic variation for wing shape in Drosophila melanogaster. Evolution 59(5): 1027–103816136802 </plain></SENT>
</text></ref><ref id="bib48"><text><SENT sid="674" pm="."><plain>NealR. </plain></SENT>
<SENT sid="675" pm="."><plain>M., 1996 Bayesian Learning for Neural Networks. Springer-Verlag, New York, Secaucus, NJ </plain></SENT>
</text></ref><ref id="bib49"><text><SENT sid="676" pm="."><plain>PartsL.StegleO.WinnJ.DurbinR., 2011 Joint genetic analysis of gene expression data with inferred cellular phenotypes. PLoS Genet. 7(1): e100127621283789 </plain></SENT>
</text></ref><ref id="bib64"><text><SENT sid="677" pm="."><plain>ParkT.CasellaG., 2008 The Bayesian Lasso. J. Am. </plain></SENT>
<SENT sid="679" pm="."><plain>Stat. </plain></SENT>
<SENT sid="680" pm="."><plain>Assoc. 103: 681–686 </plain></SENT>
</text></ref><ref id="bib50"><text><SENT sid="681" pm="."><plain>PletcherS. </plain></SENT>
<SENT sid="682" pm="."><plain>D.GeyerC. </plain></SENT>
<SENT sid="683" pm="."><plain>J., 1999 The genetic analysis of age-dependent traits: modeling the character process. Genetics 153: 825–83510610347 </plain></SENT>
</text></ref><ref id="bib51"><text><SENT sid="684" pm="."><plain>PoggioT.SmaleS., 2003 The mathematics of learning: dealing with data. Not. </plain></SENT>
<SENT sid="685" pm="."><plain>Am. </plain></SENT>
<SENT sid="686" pm="."><plain>Math. </plain></SENT>
<SENT sid="687" pm="."><plain>Soc. 50: 2003 </plain></SENT>
</text></ref><ref id="bib52"><text><SENT sid="688" pm="."><plain>RausherM. </plain></SENT>
<SENT sid="689" pm="."><plain>D., 1992 The measurement of selection on quantitative traits - biases due to environmental covariances between traits and fitness. Evolution 46(3): 616–626 </plain></SENT>
</text></ref><ref id="bib53"><text><SENT sid="690" pm="."><plain>SchluterD., 1996 Adaptive radiation along genetic lines of least resistance. Evolution 50(5): 1766–1774 </plain></SENT>
</text></ref><ref id="bib54"><text><SENT sid="691" pm="."><plain>Sorensen, D., and D. Gianola, 2010 Likelihood, Bayesian and MCMC Methods in Quantitative Genetics: Statistics for Biology and Health Springer-Verlag, Berlin. </plain></SENT>
</text></ref><ref id="bib55"><text><SENT sid="693" pm="."><plain>StegleO.PartsL.DurbinR.WinnJ., 2010 A Bayesian framework to account for complex non-genetic factors in gene expression levels greatly increases power in eQTL studies. PLOS Comput. </plain></SENT>
<SENT sid="694" pm="."><plain>Biol. 6(5): e100077020463871 </plain></SENT>
</text></ref><ref id="bib56"><text><SENT sid="695" pm="."><plain>StoneE. </plain></SENT>
<SENT sid="696" pm="."><plain>A.AyrolesJ. </plain></SENT>
<SENT sid="697" pm="."><plain>F., 2009 Modulated modularity clustering as an exploratory tool for functional genomic inference. PLoS Genet. 5(5): e100047919424432 </plain></SENT>
</text></ref><ref id="bib57"><text><SENT sid="698" pm="."><plain>TippingM. </plain></SENT>
<SENT sid="699" pm="."><plain>E., 2001 Sparse bayesian learning and the relevance vector machine. J. Mach. </plain></SENT>
<SENT sid="701" pm="."><plain>Learn. </plain></SENT>
<SENT sid="702" pm="."><plain>Res. 1: 211–244 </plain></SENT>
</text></ref><ref id="bib58"><text><SENT sid="703" pm="."><plain>van DykD. </plain></SENT>
<SENT sid="704" pm="."><plain>A.ParkT., 2011 Partially collapsed Gibbs sampling and path-adaptive Metropolis-Hastings in high-energy astrophysics, pp. 383–397 in Handbook of Markov Chain Monte Carlo, edited byBrooks S.Gelman A.JonesG.MengX.-L. Chapman &amp; Hall/CRC Handbooks of Modern Statistical Methods, New York, NY </plain></SENT>
</text></ref><ref id="bib59"><text><SENT sid="705" pm="."><plain>WagnerG.AltenbergL., 1996 Perspective: complex adaptations and the evolution of evolvability. Evolution 50: 967–976 </plain></SENT>
</text></ref><ref id="bib60"><text><SENT sid="706" pm="."><plain>WalshB.BlowsM. </plain></SENT>
<SENT sid="707" pm="."><plain>W., 2009 Abundant genetic variation plus strong selection = multivariate genetic constraints: a geometric view of adaptation. Annu. </plain></SENT>
<SENT sid="708" pm="."><plain>Rev. </plain></SENT>
<SENT sid="709" pm="."><plain>Ecol. </plain></SENT>
<SENT sid="710" pm="."><plain>Evol. </plain></SENT>
<SENT sid="711" pm="."><plain>Syst. 40: 41–59 </plain></SENT>
</text></ref><ref id="bib61"><text><SENT sid="712" pm="."><plain>West, M., 2003 Bayesian factor regression models in the “large p, small n” paradigm, pp. </plain></SENT>
<SENT sid="713" pm="."><plain>723–732 in Bayesian Statistics Oxford University Press, Oxford. </plain></SENT>
</text></ref><ref id="bib62"><text><SENT sid="714" pm="."><plain>XiongQ.AnconaN.HauserE. </plain></SENT>
<SENT sid="715" pm="."><plain>R.MukherjeeS.FureyT. </plain></SENT>
<SENT sid="716" pm="."><plain>S., 2012 Integrating genetic and gene expression evidence into genome-wide association analysis of gene sets. Genome Res. 22: 386–39721940837 </plain></SENT>
</text></ref><ref id="bib63"><text><SENT sid="717" pm="."><plain>ZhouX.StephensM., 2012 Genome-wide efficient mixed-model analysis for association studies. Nat. </plain></SENT>
<SENT sid="718" pm="."><plain>Genet. 44: 821–82422706312 </plain></SENT>
</text></ref></ref-list></SecTag></back></article>
