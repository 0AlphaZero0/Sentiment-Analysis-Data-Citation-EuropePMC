<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">J Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">J Math Biol</journal-id><journal-title-group><journal-title>Journal of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0303-6812</issn><issn pub-type="epub">1432-1416</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5829145</article-id><article-id pub-id-type="publisher-id">1167</article-id><article-id pub-id-type="doi">10.1007/s00285-017-1167-9</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title><SecTag type="TITLE"><text><SENT sid="0" pm="."><plain>The combinatorics of discrete time-trees: theory and open problems </plain></SENT>
</text></SecTag></article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6299-8249</contrib-id><name><surname>Gavryushkin</surname><given-names>Alex</given-names></name><address><email>alex@gavruskin.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9406-730X</contrib-id><name><surname>Whidden</surname><given-names>Chris</given-names></name><address><email>cwhidden@fredhutch.org</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id><name><surname>Matsen</surname><given-names>Frederick A.</given-names><suffix>IV</suffix></name><address><email>matsen@fredhutch.org</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution>Department of Biosystems Science and Engineering, </institution><institution>ETH Zürich, </institution></institution-wrap>4058 Basel, Switzerland </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 1622</institution-id><institution-id institution-id-type="GRID">grid.270240.3</institution-id><institution>Program in Computational Biology, </institution><institution>Fred Hutchinson Cancer Research Center, </institution></institution-wrap>Seattle, WA 98109 USA </aff></contrib-group><pub-date pub-type="epub"><day>29</day><month>7</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>7</month><year>2017</year></pub-date><pub-date pub-type="ppub"><year>2018</year></pub-date><volume>76</volume><issue>5</issue><fpage>1101</fpage><lpage>1121</lpage><history><date date-type="received"><day>29</day><month>12</month><year>2016</year></date><date date-type="rev-recd"><day>14</day><month>7</month><year>2017</year></date></history><permissions><copyright-statement>© The Author(s) 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1"><SecTag type="ABS"><text><SENT sid="1" pm="."><plain>A time-tree is a rooted phylogenetic tree such that all internal nodes are equipped with absolute divergence dates and all leaf nodes are equipped with sampling dates. </plain></SENT>
<SENT sid="2" pm="."><plain>Such time-trees have become a central object of study in phylogenetics but little is known about the parameter space of such objects. </plain></SENT>
<SENT sid="3" pm="."><plain>Here we introduce and study a hierarchy of discrete approximations of the space of time-trees from the graph-theoretic and algorithmic point of view. </plain></SENT>
<SENT sid="4" pm="."><plain>One of the basic and widely used phylogenetic graphs, the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph, is the roughest approximation and bottom level of our hierarchy. </plain></SENT>
<SENT sid="5" pm="."><plain>More refined approximations discretize the relative timing of evolutionary divergence and sampling dates. </plain></SENT>
<SENT sid="6" pm="."><plain>We study basic graph-theoretic questions for these graphs, including the size of neighborhoods, diameter upper and lower bounds, and the problem of finding shortest paths. </plain></SENT>
<SENT sid="7" pm="."><plain>We settle many of these questions by extending the concept of graph grammars introduced by Sleator, Tarjan, and Thurston to our graphs. </plain></SENT>
<SENT sid="8" pm="."><plain>Although time values greatly increase the number of possible trees, we show that 1-neighborhood sizes remain linear, allowing for efficient local exploration and construction of these graphs. </plain></SENT>
<SENT sid="9" pm="."><plain>We also obtain upper bounds on the r-neighborhood sizes of these graphs, including a smaller bound than was previously known for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI. </plain></SENT>
<SENT sid="10" pm="."><plain>Our results open up a number of possible directions for theoretical investigation of graph-theoretic and algorithmic properties of the time-tree graphs. </plain></SENT>
<SENT sid="11" pm="."><plain>We discuss the directions that are most valuable for phylogenetic applications and give a list of prominent open problems for those applications. </plain></SENT>
<SENT sid="12" pm="."><plain>In particular, we conjecture that the split theorem applies to shortest paths in time-tree graphs, a property not shared in the general \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI case. </plain></SENT>
</text></SecTag></p></abstract><SecTag type="KEYWORD"><kwd-group xml:lang="en"><title>Keywords</title><kwd>Phylogenetic inference methods</kwd><kwd>Phylogenetic time-tree</kwd><kwd>Nearest neighbor interchange graph</kwd></kwd-group></SecTag><kwd-group xml:lang="--"><title>Mathematics Subject Classification</title><kwd>92B05</kwd><kwd>68R10</kwd><kwd>68Q25</kwd></kwd-group><funding-group><award-group><funding-source><institution>Marsden Fund of the Royal Society of New Zealand</institution></funding-source><award-id>UOA1324</award-id></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1223057</award-id><award-id>1564137</award-id><principal-award-recipient><name><surname>Matsen</surname><given-names>Frederick A.</given-names><suffix>IV</suffix></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>© Springer-Verlag GmbH Germany, part of Springer Nature 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><SecTag type="INTRO"><sec id="Sec1"><title><text><SENT sid="13" pm="."><plain>Introduction </plain></SENT>
</text></title><p id="Par2"><text><SENT sid="14" pm="."><plain>The last 10 years have seen an explosion of methods using sequence data to infer demographic model parameters by sampling phylogenetic trees (Kuhner et al. 1995, 1998, 2000; Beerli and Felsenstein 2001; Kuhner 2006; Drummond et al. 2002, 2005, 2006; Minin et al. 2008). </plain></SENT>
<SENT sid="15" pm="."><plain>These methods have had an especially significant impact in inferring historical epidemic spreading rates of viruses and other evolutionary parameters of quickly evolving organisms. </plain></SENT>
<SENT sid="16" pm="."><plain>For example, such methods can be used to infer time to a most recent common ancestor of human HIV group M viruses (Worobey et al. 2008; Baele et al. 2013). </plain></SENT>
<SENT sid="17" pm="."><plain>Thus the time-tree—a rooted phylogenetic tree with all internal nodes equipped with absolute divergence dates—has become an important object of investigation. </plain></SENT>
<SENT sid="18" pm="."><plain>This interpretation of continuous parameters for time-trees stands in contrast to that for classical phylogenetic trees, in which branch lengths quantify the amount of molecular substitution along a branch. </plain></SENT>
<SENT sid="19" pm="."><plain>Posterior distributions on both time-trees and classical trees are estimated using Markov chain Monte Carlo (MCMC) (Mau and Newton 1997; Yang and Rannala 1997; Drummond et al. 2002), but with different transition kernels. </plain></SENT>
<SENT sid="20" pm="."><plain>This paper builds a foundation for a mathematical understanding of time-trees, such as understanding convergence properties of MCMC thereupon. </plain></SENT>
</text></p><p id="Par3"><text><SENT sid="21" pm="."><plain>Although Markov chain Monte Carlo (MCMC) is guaranteed to sample from the true posterior given an infinite run time, it is important to understand mixing properties of the chain, which determine sampling properties for a finite time run. </plain></SENT>
<SENT sid="22" pm="."><plain>The mixing properties of phylogenetic MCMC have, in the classical unrooted case, been a major area of research from both the theoretical perspective of mixing time bounds (Mossel and Vigoda 2005, 2006; Štefankovič and Vigoda 2011; Spade et al. 2014) and the practical perspective of performance on real data (Beiko et al. 2006; Ronquist et al. 2006; Lakner et al. 2008; Whidden and Matsen IV 2015). </plain></SENT>
<SENT sid="23" pm="."><plain>This research has focused on mixing over the set of discrete phylogenetic tree graph structures, because mixing over these discrete structures is the primary obstruction to MCMC convergence. </plain></SENT>
</text></p><p id="Par4"><text><SENT sid="24" pm="."><plain>Time-trees use different MCMC transition kernels than do classical phylogenetic trees. </plain></SENT>
<SENT sid="25" pm="."><plain>The discrete component of MCMC moves between classical phylogenetic trees are typically determined by their discretization. </plain></SENT>
<SENT sid="26" pm="."><plain>For example, common moves include subtree prune and regraft (SPR) moves, which cut a subtree off and reattach it at another location, and the subset of SPR moves called nearest-neighbor interchange (\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI) moves. </plain></SENT>
<SENT sid="27" pm="."><plain>Classically, these are applied without reference to branch lengths. </plain></SENT>
<SENT sid="28" pm="."><plain>On the other hand, the discrete component of moves between time-trees are defined also in terms of their timing information. </plain></SENT>
<SENT sid="29" pm="."><plain>For example, Hohna et al. (2008) show that SPR-like moves that reattach subtrees at the same divergence time are more effective than ones that do not. </plain></SENT>
<SENT sid="31" pm="."><plain>This sort of move cannot be expressed using the type of discretization used thus far in which all continuous information is lost, and so the previous work on MCMC mixing cannot be applied. </plain></SENT>
</text></p><p id="Par5"><text><SENT sid="32" pm="."><plain>However, one can discretize time-trees in a way that does preserve some of the information. </plain></SENT>
<SENT sid="33" pm="."><plain>For example, by retaining the order of internal nodes backward in time one obtains a so-called ranked tree (Semple and Steel 2003). </plain></SENT>
<SENT sid="34" pm="."><plain>To make a less rough approximation of a time-tree, one can allow the time periods between nodes of the tree to take only finitely many possible values (Åkerborg et al. 2008). </plain></SENT>
<SENT sid="35" pm="."><plain>This results in an object we call a discrete time-tree. </plain></SENT>
<SENT sid="36" pm="."><plain>The graph built on such trees provides a discretization of the space of time-trees, which we call a discrete time-tree graph. </plain></SENT>
<SENT sid="37" pm="."><plain>By a graph on a set of trees here and throughout the paper we mean a graph consisting of trees as vertices, with edges connecting pairs of trees that are identical after a given tree rearrangement operation (Semple and Steel 2003). </plain></SENT>
<SENT sid="38" pm="."><plain>This graph-theoretic terminology is convenient and has become widespread in recent years (Spade et al. 2014; Whidden and Matsen IV 2015; Gavryushkin and Drummond 2016). </plain></SENT>
<SENT sid="39" pm="."><plain>A sequence of time-trees sampled using MCMC projects to a collection of movements on a graph in which each vertex is a discrete time-tree and each edge is a discrete version of an MCMC move on time-trees. </plain></SENT>
</text></p><p id="Par6"><text><SENT sid="40" pm="."><plain>Although inferential algorithms have applied MCMC on time-trees for over a decade, and graphs corresponding to discretizations of unrooted tree space have been studied for even longer, we are not aware of any work defining graphs from discretization of time-tree spaces or analyzing random walks thereupon. </plain></SENT>
<SENT sid="41" pm="."><plain>Such a theory would provide a foundation for understanding the behavior of MCMC algorithms on time-trees, as has been done previously for graphs associated with unrooted phylogenetic trees. </plain></SENT>
<SENT sid="42" pm="."><plain>Up to now, the only discretization of time-tree space is that of ranked trees (Page 1991; Ford et al. 2009; Lambert and Stadler 2013), and the corresponding graphs have not been studied. </plain></SENT>
</text></p><p id="Par7"><text><SENT sid="43" pm="."><plain>In this paper we initiate the mathematical study of discrete time-tree graphs, obtain basic geometric and graph-theoretic results, and compare these results to those in the classical phylogenetic setting. </plain></SENT>
<SENT sid="44" pm="."><plain>In particular, we focus on ranked trees, discrete time-trees (as defined above), and the ultrametric versions of those types of trees. </plain></SENT>
<SENT sid="45" pm="."><plain>We establish size bounds for neighborhoods and diameters in these tree spaces and show how those bounds can be used to develop efficient tree search algorithms such as MCMC. </plain></SENT>
<SENT sid="46" pm="."><plain>The importance of these basic geometric characteristics in phylogenetics and other areas of evolutionary biology is highlighted in Huber et al. (2011).Fig. 1Time-tree on 6 leaves. </plain></SENT>
<SENT sid="48" pm="."><plain>Time is measured by non-negative real numbers. </plain></SENT>
<SENT sid="49" pm="."><plain>If all times are integers, the tree is a discrete time-tree </plain></SENT>
</text></p></sec></SecTag><SecTag type="INTRO"><sec id="Sec2"><title><text><SENT sid="50" pm="."><plain>Technical introduction </plain></SENT>
</text></title><p id="Par8"><text><SENT sid="51" pm="."><plain>Throughout the paper by a (phylogenetic) tree we mean a rooted binary tree with designated leaves, that is, an undirected acyclic graph with the following properties: (1) all nodes have degree 1, 2, or 3; (2) there exists exactly one node of degree 2, this node is called the root of the tree; (3) all nodes of degree 1 are labeled by distinct identifiers, these nodes are called leaves or taxa (singular taxon). </plain></SENT>
<SENT sid="52" pm="."><plain>The parent of a node x in a tree is the unique node y that is both adjacent to x and closer to the root of the tree than x. Every node of a tree has a parent except for the root, and is called the child of that parent. </plain></SENT>
</text></p><p id="Par9"><text><SENT sid="54" pm="."><plain>We fix the number of leaves of the trees and denote this number by n throughout the paper. </plain></SENT>
<SENT sid="55" pm="."><plain>We also assume that each tree with n leaves uses the same fixed set of n labels to mark the leaves. </plain></SENT>
<SENT sid="56" pm="."><plain>Hence, we say that two trees are isomorphic if they are isomorphic as graphs and the isomorphism maps leaves marked by the same label to each other. </plain></SENT>
<SENT sid="57" pm="."><plain>We do not distinguish between isomorphic trees, i.e. we identify them. </plain></SENT>
</text></p><p id="Par10"><text><SENT sid="58" pm="."><plain>By a time-tree (Fig. 1) we mean a phylogenetic tree with an absolute time associated with every node of the tree so that the time strictly increases along every path from a leaf to the root: for internal nodes the time is interpreted as (typically estimated) divergence time and for leaves it is the (typically known) sampling time. </plain></SENT>
<SENT sid="59" pm="."><plain>By “absolute” we clarify that these are not relative times, but rather actual times that can be put on a calendar. </plain></SENT>
<SENT sid="60" pm="."><plain>We assume that time progresses backward, from the leaves to the root. </plain></SENT>
</text></p><p id="Par11"><text><SENT sid="61" pm="."><plain>A discrete time-tree is a tree such that all its nodes are assigned distinct times from the set of non-negative integers and every node has a smaller time than its parent (Fig. 1). </plain></SENT>
<SENT sid="62" pm="."><plain>Note that this implies that for every pair of nodes x, y if the shortest path from the root to x passes through y then the time of y is greater than the time of x. Each node is associated with a type of event: internal nodes represent divergence events, while leaf nodes represent the sampling of new taxa. </plain></SENT>
<SENT sid="64" pm="."><plain>The rank of a node is the number of nodes in the tree with strictly smaller time. </plain></SENT>
<SENT sid="65" pm="."><plain>We say that a pair of nodes x, y of a discrete time-tree is an event interval if there exists no node z such that the time of z is between the time of x and y. Hence, an event interval is an interval between two divergence events, a taxon and a divergence event, or two taxa. </plain></SENT>
<SENT sid="67" pm="."><plain>Note that taxon events can be younger than divergence nodes, i.e. when the sampling time precedes divergence events on the tree. </plain></SENT>
<SENT sid="68" pm="."><plain>The difference between the times of x and y is called the length of the interval x, y. We identify two discrete time-trees if they are isomorphic as trees and the isomorphism preserves ranks of the nodes as well as event interval lengths. </plain></SENT>
</text></p><p id="Par12"><text><SENT sid="70" pm="."><plain>We are now ready to introduce a hierarchy of discrete time-trees. </plain></SENT>
<SENT sid="71" pm="."><plain>At the bottom level of our hierarchy is the well-known \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph, which does not have timing information. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI is a graph with the vertices being all trees on n leaves. </plain></SENT>
<SENT sid="72" pm="."><plain>Two trees T and R are adjacent in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI if there exists an edge e in T and an edge f in R such that both edges are not adjacent to a leaf and the graph obtained from T by shrinking e to a vertex is isomorphic to the graph obtained from R by shrinking f. We denote this graph by \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_0$$\end{document}DtT0, where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT stands for “discrete time-trees”.Fig. 2All possible moves performed on intervals I and J. Assuming that the length of every event interval is either 1 or 2, the outer trees are all possible neighbors in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT of the tree in the middle obtained by moves performed on intervals I and J. The trees on the right are obtained by moves performed on interval I and those on the left on J  </plain></SENT>
</text></p><p id="Par13"><text><SENT sid="76" pm="."><plain>The following graph \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm forms the level \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$m &gt; 0$$\end{document}m&gt;0 of the hierarchy. </plain></SENT>
<SENT sid="77" pm="."><plain>The set of vertices of the graph is the set of all discrete time-trees on n leaves such that every event interval has its length not greater than m. Two trees T and R are adjacent in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm if R can be obtained from T by one of three operations: a length move performed on interval I, swapping the rank of two nodes x and y on interval I or an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move performed on interval I (Fig. 2). </plain></SENT>
<SENT sid="79" pm="."><plain>A length move changes the length of I by 1. </plain></SENT>
<SENT sid="80" pm="."><plain>Swapping the rank of two nodes swaps the times of the nodes; such a swap is only possible when the nodes bound an event interval I of length 1. R can be obtained from T by an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move if there exist event intervals \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$I_T$$\end{document}IT and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$I_R$$\end{document}IR of length 1 in T and R, respectively, such that the graphs obtained by shrinking \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$I_T$$\end{document}IT and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$I_R$$\end{document}IR to vertices are isomorphic and the isomorphism preserves the lengths of the event intervals. </plain></SENT>
<SENT sid="81" pm="."><plain>In other words, by going from one tree to an adjacent tree in the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm graph we can either change the length of one event interval by one unit, swap the rank of two nodes bounding an event interval of minimal length, or send the length of an event interval of minimal length down to zero and then resolve the multifurcation to either of the two possible trees. </plain></SENT>
<SENT sid="82" pm="."><plain>In the latter case, the new interval is of minimal length. </plain></SENT>
<SENT sid="83" pm="."><plain>See Fig. 3 for an example of the full variety of possible moves.Fig. 3Trees T and R are at \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_2$$\end{document}DtT2 distance 3. </plain></SENT>
<SENT sid="84" pm="."><plain>To move from T to R in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_2$$\end{document}DtT2, one must decrease the length of interval I, swap the ranks of nodes A and C bounding interval J, and perform an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move on interval K, resolving nodes C and D  </plain></SENT>
</text></p><p id="Par14"><text><SENT sid="85" pm="."><plain>Note that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_0$$\end{document}DtT0 can be obtained from \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_1$$\end{document}DtT1 by “forgetting” ranks and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_1$$\end{document}DtT1—from \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm by forgetting lengths. </plain></SENT>
<SENT sid="86" pm="."><plain>In general, the graph structure for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$m &gt; 1$$\end{document}m&gt;1 can be understood by considering all four-tree diagrams as the four trees on the right in Fig. 2 and introducing an extra layer of nodes in every tail adjacent to the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI triangle. </plain></SENT>
</text></p><p id="Par15"><text><SENT sid="87" pm="."><plain>This hierarchy can be seen as a set of discrete refinements of the full space of phylogenetic time-trees, where event intervals can take an arbitrary real value. </plain></SENT>
<SENT sid="88" pm="."><plain>Indeed, if we allow the lengths of event intervals to take every possible non-negative real value and impose the Euclidean metric on trees with the same ranked topology, then we get the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\tau $$\end{document}τ-space introduced by Gavryushkin and Drummond (2016). </plain></SENT>
<SENT sid="89" pm="."><plain>In this case, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_1$$\end{document}DtT1 is the graph with the vertices being the orthants of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\tau $$\end{document}τ-space and the adjacency relation being the relation of “have a shared facet of co-dimension 1.” Similarly \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_0$$\end{document}DtT0 is the adjacency graph on the orthants of BHV space (Billera et al. 2001). </plain></SENT>
</text></p><p id="Par16"><text><SENT sid="90" pm="."><plain>The \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm graph on ultrametric trees, that is the set of trees such that each leaf has the same time, is denoted by \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtTu}_m$$\end{document}DtTum. </plain></SENT>
<SENT sid="91" pm="."><plain>The \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_1$$\end{document}DtT1 graph is denoted by \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI and called the ranked \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph; on ultrametric trees we will denote it \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu. </plain></SENT>
<SENT sid="92" pm="."><plain>The \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm R$$\end{document}R in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI stands for ranked and not for rooted. </plain></SENT>
<SENT sid="93" pm="."><plain>We emphasize that although this is the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves can be applied to trees in any of the spaces considered (under appropriate conditions). </plain></SENT>
<SENT sid="94" pm="."><plain>For simplicity, we use the generic identifier \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT to refer to a \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm with an arbitrary \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$m &gt; 1$$\end{document}m&gt;1. </plain></SENT>
</text></p><p id="Par17"><text><SENT sid="95" pm="."><plain>A graph can also be seen as a metric space where the distance is given by the length of a shortest path, so we will refer to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm and other graphs introduced above as both, in agreement with Semple and Steel (2003). </plain></SENT>
</text></p></sec></SecTag><sec id="Sec3"><title><text><SENT sid="96" pm="."><plain>Geometry and complexity of discrete time-trees </plain></SENT>
</text></title><p id="Par18"><text><SENT sid="97" pm="."><plain>We begin by considering the shortest path distance on the graphs. </plain></SENT>
<SENT sid="98" pm="."><plain>It is well-known that computing distances is NP-hard in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI (Dasgupta et al. 2000). </plain></SENT>
<SENT sid="99" pm="."><plain>Hence the following question is natural. </plain></SENT>
</text></p><sec id="FPar1"><title><text><SENT sid="100" pm="."><plain>Problem 1 </plain></SENT>
</text></title><p id="Par19"><text><SENT sid="101" pm="?"><plain>What is the complexity of computing the distance between two discrete time-trees? </plain></SENT>
</text></p><p><text><SENT sid="102" pm="."><plain>Although this problem remains open, we make progress towards the solution by establishing several geometric and algorithmic properties of these graphs. </plain></SENT>
<SENT sid="103" pm="."><plain>First, we demonstrate in the following example that even for caterpillar trees the complexity cannot be derived from that of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI distance. </plain></SENT>
<SENT sid="104" pm="."><plain>A caterpillar tree (sometimes called a ladder tree) has all leaves connected to a single path from the root. </plain></SENT>
<SENT sid="105" pm="."><plain>A cherry is a pair of taxa adjacent to a common internal node in the tree. </plain></SENT>
</text></p></sec><sec id="FPar2"><title><text><SENT sid="106" pm="."><plain>Example 2 </plain></SENT>
</text></title><p id="Par21"><text><SENT sid="107" pm="."><plain>(see Fig. 4) Let T be the ultrametric caterpillar tree denoted \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$((((((1, 2), 3), 4), 5), 6), 7)$$\end{document}((((((1,2),3),4),5),6),7) in Newick notation (Felsenstein et al. 1990) and R be the ultrametric tree ((((((1, 4), 5), 6), 2), 3), 7). </plain></SENT>
<SENT sid="108" pm="."><plain>Then a shortest \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI path is given by first making a cherry (2, 3), then moving the cherry up to the split \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$1456 \mid 7$$\end{document}1456∣7, and then resolving the cherry back. </plain></SENT>
<SENT sid="109" pm="."><plain>In \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu this path is not shortest, and one shortest path moves the parents of 2 and 3 up independently. </plain></SENT>
</text></p><p><text><SENT sid="110" pm="."><plain>Fig. 4Shortest paths in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI may not be shortest in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI  </plain></SENT>
</text></p><p><text><SENT sid="111" pm="."><plain>A set of trees A is called convex if for every pair of trees from A, there exists a shortest path between them such that every tree on the path belongs to A. Example 2 can be generalized to show that the set of trees of the form \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$(\ldots (1, i_2), \ldots , i_{n-1}), n)$$\end{document}(…(1,i2),…,in-1),n), where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\{i_2, \ldots , i_{n-1}\} = \{2, \ldots , n-1\}$$\end{document}{i2,…,in-1}={2,…,n-1}, is convex in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT and is not convex in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI. </plain></SENT>
<SENT sid="113" pm="."><plain>Indeed, the example shows that if two leaves have to be moved up, they can be moved independently along a shortest path. </plain></SENT>
<SENT sid="114" pm="."><plain>The generalization of this statement to an arbitrary number of leaves implies convexity in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT, while the need to group leaves in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI as in the previous example shows non-convexity in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI space. </plain></SENT>
<SENT sid="115" pm="."><plain>This basic difference in the structure of the two graphs suggests that the complexity of computing the distance is likely to be different. </plain></SENT>
</text></p><p><text><SENT sid="116" pm="."><plain>We proceed by establishing basic geometric properties of discrete time-trees. </plain></SENT>
</text></p></sec><sec id="Sec4"><title><text><SENT sid="117" pm="."><plain>Sizes of neighborhoods </plain></SENT>
</text></title><p id="Par25"><text><SENT sid="118" pm="."><plain>We first bound the number of trees in each graph. </plain></SENT>
<SENT sid="119" pm="."><plain>As expected, times greatly expand the size of the graphs. </plain></SENT>
</text></p><sec id="FPar3"><title><text><SENT sid="120" pm="."><plain>Lemma 3 </plain></SENT>
</text></title><p id="Par26"><text><SENT sid="121" pm="."><plain>(see Semple and Steel (2003)) Let |V| be the number of vertices in the graph, then |V| is equal to </plain></SENT>
</text></p></sec><sec id="FPar4"><title><text><SENT sid="122" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par27"><text><SENT sid="123" pm="."><plain>The proof for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI can be found in Semple and Steel (2003). </plain></SENT>
<SENT sid="124" pm="."><plain>The rest follow using similar arguments. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p><p><text><SENT sid="125" pm="."><plain>We continue by tightly bounding the sizes of 1-neighborhoods of various discretizations of the space of time-trees. </plain></SENT>
<SENT sid="126" pm="."><plain>Each has a 1-neighborhood size that is linear in n allowing for efficient local traversal and enumeration, a property of importance for phylogenetic algorithms, e.g. tree proposals in MCMC. </plain></SENT>
</text></p></sec><sec id="FPar5"><title><text><SENT sid="127" pm="."><plain>Lemma 4 </plain></SENT>
</text></title><p id="Par29"><text><SENT sid="128" pm="."><plain>Let T be a tree on n leaves and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\deg (T)$$\end{document}deg(T) the number of trees adjacent to T. ThenAll bounds are tight. </plain></SENT>
</text></p></sec><sec id="FPar6"><title><text><SENT sid="130" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par30"><text><SENT sid="131" pm="."><plain>We prove the bounds by providing exemplar trees with the specified degrees and explaining why no tree can have a greater (or lesser) degree. </plain></SENT>
<SENT sid="132" pm="."><plain>Recall that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$m &gt; 1$$\end{document}m&gt;1 is the maximal possible length of an event interval in a tree from \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT. </plain></SENT>
<SENT sid="133" pm="."><plain>The lower bound in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT is attained by any tree with all event intervals being of length m. In this case, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\deg (T)$$\end{document}deg(T) is simply the number of event intervals, since every event interval adds 1 to the total degree of the tree. </plain></SENT>
<SENT sid="135" pm="."><plain>Other trees have the same or more possible event interval changes, showing that this is a lower bound. </plain></SENT>
<SENT sid="136" pm="."><plain>The upper bound is attained by a caterpillar tree with all intervals short, every taxon being younger than every divergence event, and both taxa in the cherry being younger than at least one other taxon, that is, a caterpillar tree with internal nodes having ranks \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n, \ldots , 2(n-1)$$\end{document}n,…,2(n-1) and the ranks of the taxa in the cherry \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$&lt;n-1$$\end{document}&lt;n-1. </plain></SENT>
<SENT sid="137" pm="."><plain>In this case, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\deg (T)$$\end{document}deg(T) is bounded by the sum of the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2(n-1)$$\end{document}2(n-1) possible interval length changes, at most \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2(n-2)$$\end{document}2(n-2) \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI neighbors, and at most n rank changes that can occur between the n taxa and the root of the cherry. </plain></SENT>
<SENT sid="138" pm="."><plain>In total, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\deg (T) \le 2(n-1) + 2(n-2) + n = 5n-6$$\end{document}deg(T)≤2(n-1)+2(n-2)+n=5n-6. </plain></SENT>
<SENT sid="139" pm="."><plain>Note that this is an upper bound indeed, as each of the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2(n-2)$$\end{document}2(n-2) intervals excluding the most recent can contribute either a rank change or 2 \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves. </plain></SENT>
<SENT sid="140" pm="."><plain>The caterpillar tree described above maximizes the number of intervals that contribute 2 \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves and enables the rest of intervals to contribute a rank change. </plain></SENT>
</text></p><p id="Par31"><text><SENT sid="141" pm="."><plain>For ultrametric trees, the number of event intervals is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1$$\end{document}n-1, hence they add \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1$$\end{document}n-1 to the degree of the caterpillar tree from interval length changes. </plain></SENT>
<SENT sid="142" pm="."><plain>The number of intervals on which an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move is possible is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-2$$\end{document}n-2 for ultrametric trees, hence they contribute \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2(n-2)$$\end{document}2(n-2) to the degree. </plain></SENT>
<SENT sid="143" pm="."><plain>In total, this gives the upper bound of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$3n-5$$\end{document}3n-5 for ultrametric trees. </plain></SENT>
</text></p><p id="Par32"><text><SENT sid="144" pm="."><plain>Every \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move results in two neighbors, so the equality \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\deg (T) = 2(n-2)$$\end{document}deg(T)=2(n-2) follows for the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph. </plain></SENT>
<SENT sid="145" pm="."><plain>Indeed, no \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move can be performed on an edge adjacent to a taxon, exactly two \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves can be performed on every edge between internal nodes (the number of which is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-2$$\end{document}n-2), and no two trees obtained by an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move performed on different edges are identical. </plain></SENT>
</text></p><p id="Par33"><text><SENT sid="146" pm="."><plain>The lower bound in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI is attained by the caterpillar-tree where taxa get ranks \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$0, 1, 3, 5, \ldots , 2n-3$$\end{document}0,1,3,5,…,2n-3 and internal nodes get ranks \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2, 4, 6, \ldots , 2n-2$$\end{document}2,4,6,…,2n-2. </plain></SENT>
<SENT sid="147" pm="."><plain>In other words, the divergence events alternate with the taxa in the ranked topology of the tree so that if we parse the tree from the present to the past, we meet the nodes in the following order: taxon, taxon, coalescence, taxon, coalescence, taxon, coalescence, and so on. </plain></SENT>
<SENT sid="148" pm="."><plain>In this case, intervals bounded by a taxon from below add nothing to the degree of the tree and intervals bounded from below by an internal node add one each, hence \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1$$\end{document}n-1 in total. </plain></SENT>
<SENT sid="149" pm="."><plain>The upper bound for both \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu is obtained in the same way as for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT. </plain></SENT>
</text></p><p id="Par34"><text><SENT sid="150" pm="."><plain>For the lower bound in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu, we note that the oldest event interval (the one adjacent to the root) necessarily contributes 2 to the degree. </plain></SENT>
<SENT sid="151" pm="."><plain>Hence the lower bound can be reached by a tree such that no other interval contributes more than 1. </plain></SENT>
<SENT sid="152" pm="."><plain>The degree of such a tree is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1$$\end{document}n-1 in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p><p><text><SENT sid="153" pm="."><plain>Lemma 4 gives tight bounds for the number of trees in a 1-neighborhood, while the following theorem gives an upper bound for the number of trees in an r-neighborhood. </plain></SENT>
<SENT sid="154" pm="."><plain>The best known upper bound for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI that we are aware of is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$3^{n-2} 2^{4r}$$\end{document}3n-224r (Li et al. 1996). </plain></SENT>
<SENT sid="155" pm="."><plain>We obtain a smaller bound for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu and, hence, improve the result for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI as well. </plain></SENT>
</text></p></sec><sec id="FPar7"><title><text><SENT sid="156" pm="."><plain>Theorem 5 </plain></SENT>
</text></title><p id="Par36"><text><SENT sid="157" pm="."><plain>The number of trees within distance r from any given tree is at most </plain></SENT>
</text></p></sec><sec id="FPar8"><title><text><SENT sid="158" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par37"><text><SENT sid="159" pm="."><plain>We describe the proof in detail for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu and then explain how to modify the proof for the other three graphs. </plain></SENT>
<SENT sid="160" pm="."><plain>The proof employs the technique by Sleator et al. (1992) for counting paths in a graph using a graph grammar. </plain></SENT>
<SENT sid="162" pm="."><plain>A graph grammar is a method of encoding each possible graph as a finite set of productions (described more formally below). </plain></SENT>
<SENT sid="163" pm="."><plain>Given the grammar, the number of possible productions to the power of the encoding length for a given neighborhood radius gives a simple upper bound on the number of trees in a neighborhood. </plain></SENT>
<SENT sid="164" pm="."><plain>Specifically, Theorem 2.3 from Sleator et al. (1992), adapted to trees, states the following:Let T be a tree with h nodes, including all internal nodes and taxa, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ be a graph grammar, d be the number of vertices in left sides of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ, and k be the maximum number of nodes in any right side of a production of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ. </plain></SENT>
<SENT sid="166" pm="."><plain>Let \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$R(T, \Gamma , r)$$\end{document}R(T,Γ,r) be the set of graphs obtainable from T by derivations in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ of length at most r. Then \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|R(T, \Gamma , r)| \le (d + 1)^{h+k\cdot r}$$\end{document}|R(T,Γ,r)|≤(d+1)h+k·r.We first apply Theorem 2.3 from Sleator et al. (1992) and then improve the bound using specific properties of the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu graph. </plain></SENT>
<SENT sid="169" pm="."><plain>We note that since our trees are ranked trees, they possess additional structure (ranking) on top of the tree graph structure, hence we will be applying the same style of argument as in Sleator et al. (1992) but to a somewhat different structure. </plain></SENT>
</text></p><p id="Par39"><text><SENT sid="171" pm="."><plain>We now introduce the graph grammar for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu. </plain></SENT>
<SENT sid="172" pm="."><plain>Since we will apply the graph grammar to modify trees, we use the graph-theoretic terminology here and recall that a tree is a graph. </plain></SENT>
<SENT sid="173" pm="."><plain>A graph grammar consists of a finite set of productions \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\{L_i \rightarrow _i R_i\}$$\end{document}{Li→iRi}, where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$L_i$$\end{document}Li and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$R_i$$\end{document}Ri are connected undirected edge-end labeled graphs and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow _i$$\end{document}→i is a one-to-one map between half-edges of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$L_i$$\end{document}Li and those of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$R_i$$\end{document}Ri. </plain></SENT>
<SENT sid="174" pm="."><plain>Here, for every edge in the tree we distinguish between its two ends and refer to them as half-edges—this is necessary to be able to substitute one subgraph by another in a unique way by connecting corresponding half-edges—as in Sleator et al. (1992). </plain></SENT>
<SENT sid="176" pm="."><plain>The productions are then applied to the starting tree T to derive all possible trees at \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu distance up to r from T. By a running tree at stage s we mean the tree obtained after s applications of the production rules in the derivation. </plain></SENT>
<SENT sid="178" pm="."><plain>A production is said to be ready at a stage s of the derivation if the running tree at stage s has a subgraph isomorphic to the left side \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$L_i$$\end{document}Li of the production. </plain></SENT>
<SENT sid="179" pm="."><plain>A ready production can be applied to the running tree by destroying all nodes corresponding to the left side of the production under the isomorphism and replacing them with the right side \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$R_i$$\end{document}Ri of the production. </plain></SENT>
<SENT sid="180" pm="."><plain>The map \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow _i$$\end{document}→i of the production then says how to reconnect the right side of the production to the half-edges of the running tree that were created after the destruction. </plain></SENT>
<SENT sid="181" pm="."><plain>The obtained tree is the new running tree for the next stage \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$s+1$$\end{document}s+1 of the derivation. </plain></SENT>
<SENT sid="182" pm="."><plain>See Sleator et al. (1992) for precise definitions and details. </plain></SENT>
</text></p><p id="Par40"><text><SENT sid="184" pm="."><plain>The graph grammar for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu is the grammar \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ shown on Fig. 5. </plain></SENT>
<SENT sid="185" pm="."><plain>Note that the definition of a graph grammar requires the left sides \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$L_i$$\end{document}Li to be connected and we have a disconnected left side in the third production. </plain></SENT>
<SENT sid="186" pm="."><plain>We can adapt our graph grammar to fit this requirement by noting that the nodes on the left side of the production must be of consecutive ranks, so we consider those nodes as being adjacent via a second type of adjacency relation by declaring nodes with consecutive ranks to be adjacent. </plain></SENT>
<SENT sid="187" pm="."><plain>This second type of relation is in addition to the first type of adjacency relation given by the branches of the tree. </plain></SENT>
<SENT sid="188" pm="."><plain>Furthermore, this second type of adjacency allows us to avoid considering two separate moves for the left and right sister nodes. </plain></SENT>
<SENT sid="189" pm="."><plain>Indeed, the half-edge labels order the edges to make the distinction between left and right, however since our nodes are ordered via ranking, this ordering of edges is irrelevant. </plain></SENT>
<SENT sid="190" pm="."><plain>We will further exploit this important property below, where we improve the bound obtained directly from grammar \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ.Fig. 5Graph grammar \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu. </plain></SENT>
<SENT sid="191" pm="."><plain>Maps \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\rightarrow _i$$\end{document}→i are shown by dashed lines. </plain></SENT>
<SENT sid="192" pm="."><plain>In the first two productions, the edge-ends marked by \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\beta $$\end{document}β and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\gamma $$\end{document}γ without dashed lines are mapped to each other: top \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\gamma $$\end{document}γ to top \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\gamma $$\end{document}γ, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\beta $$\end{document}β to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\beta $$\end{document}β, bottom \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\gamma $$\end{document}γ to bottom \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\gamma $$\end{document}γ. </plain></SENT>
<SENT sid="193" pm="."><plain>In the last production, edge-ends marked by the same label are mapped to each other. </plain></SENT>
<SENT sid="194" pm="."><plain>All pairs of nodes on both sides of each production must be of consecutive ranks. </plain></SENT>
<SENT sid="195" pm="."><plain>The first two productions correspond to an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move, while the last production corresponds to rank change </plain></SENT>
</text></p><p id="Par41"><text><SENT sid="196" pm="."><plain>The number of vertices in left sides of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ is 6, the maximum number of vertices in any right side of a production of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ is 2. </plain></SENT>
<SENT sid="197" pm="."><plain>Since the number of internal nodes of a tree on n leaves in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1$$\end{document}n-1, directly applying Theorem 2.3 from Sleator et al. (1992) we get the bound of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$7^{n+2r-1}$$\end{document}7n+2r-1. </plain></SENT>
</text></p><p id="Par42"><text><SENT sid="199" pm="."><plain>This bound can be improved following the techniques described in Sects. 3.2–3.4 of (Sleator et al. 1992, see also Sect. 5) by bounding the number of possible productions available at a given time by a number smaller than their total. </plain></SENT>
<SENT sid="200" pm="."><plain>Every node of a tree in any application of a production of grammar \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ can play either of two roles: top node or bottom node. </plain></SENT>
<SENT sid="201" pm="."><plain>Hence to indicate that a pair of nodes is ready for being destroyed and replaced using a production, we must specify which node is a top node and which is a bottom node. </plain></SENT>
<SENT sid="202" pm="."><plain>We use a total of three node-labels (Sleator et al. 1992 call these “labels of vertices”) to identify these two roles and to distinguish which of the two possible \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves is applied. </plain></SENT>
<SENT sid="203" pm="."><plain>We claim that three node-labels a, b, c is enough to specify which productions can be applied to a given tree. </plain></SENT>
<SENT sid="204" pm="."><plain>We must redefine the notion of readiness to verify this claim. </plain></SENT>
<SENT sid="205" pm="."><plain>We say that a pair of consecutive nodes is ready if the node-label of the bottom node is a and the node-label of the top node is either b or c. If two consecutive nodes are ready and not connected by an edge in the tree, then only the rank move is possible. </plain></SENT>
<SENT sid="207" pm="."><plain>If they are, the type of the move is determined by the node-label of the top node. </plain></SENT>
<SENT sid="208" pm="."><plain>Hence, this notion of readiness uniquely identifies which of the three productions is applied. </plain></SENT>
</text></p><p id="Par43"><text><SENT sid="209" pm="."><plain>Sleator et al. (1992) use a special node-label, called the “zero label”, to mark nodes that should not be destroyed. </plain></SENT>
<SENT sid="211" pm="."><plain>They also explain how to eliminate the zero label in various cases. </plain></SENT>
<SENT sid="212" pm="."><plain>In our case, we can use one of the labels that are already in use, namely node-label a. That is, to indicate that a node v should never be destroyed, we label the node with an a. This labeling will indeed preserve the node v because of the following. </plain></SENT>
<SENT sid="215" pm="."><plain>If w is the node directly succeeding v at some step of the derivation then w can only be marked with an a and hence the pair v, w is not ready. </plain></SENT>
<SENT sid="216" pm="."><plain>If w is the node directly preceding v at some step of the derivation then the pair w, v is never ready. </plain></SENT>
<SENT sid="217" pm="."><plain>Hence v is preserved in either case. </plain></SENT>
</text></p><p id="Par44"><text><SENT sid="218" pm="."><plain>Thus, all possible configurations encoded by the six nodes on the left sides of the productions of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ can be encoded using three node-labels. </plain></SENT>
<SENT sid="219" pm="."><plain>This implies that the derivation can be encoded by a ternary sequence of length \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1+2r$$\end{document}n-1+2r. </plain></SENT>
<SENT sid="220" pm="."><plain>Indeed, the first \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n-1$$\end{document}n-1 entries of the sequence are needed to encode all possible node-labelings of the initial tree, plus two entries are needed for each of the r applications of productions because every production creates two new nodes, each of which has to be node-labeled. </plain></SENT>
<SENT sid="221" pm="."><plain>The number of such strings, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$3^{n-1+2r}$$\end{document}3n-1+2r, gives the desired improved bound. </plain></SENT>
</text></p><p id="Par45"><text><SENT sid="222" pm="."><plain>The proof for the other three spaces follows similarly. </plain></SENT>
</text></p><p id="Par46"><text><SENT sid="223" pm="."><plain>For \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI, we extend the graph grammar \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ by two productions, namely, one for the move when two taxa swap their ranks and one for the move when a taxon and an internal node swap their ranks. </plain></SENT>
<SENT sid="224" pm="."><plain>Since in both of these productions the only possible type of move is the rank move, two node-labels is enough for these productions. </plain></SENT>
<SENT sid="225" pm="."><plain>Since the number of (internal and leaf) nodes in an \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI tree is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2n - 1$$\end{document}2n-1 and the maximum number of nodes on right sides of the productions is still 2, the desired bound is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$3^{2n-1 + 2r}$$\end{document}32n-1+2r. </plain></SENT>
</text></p><p id="Par47"><text><SENT sid="226" pm="."><plain>For \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtTu}$$\end{document}DtTu, we have to extend the grammar \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Gamma $$\end{document}Γ by two productions, namely, one for increasing the length of the branch between two nodes in the production and one for decreasing. </plain></SENT>
<SENT sid="227" pm="."><plain>This increases the number of necessary node-labels by one. </plain></SENT>
<SENT sid="228" pm="."><plain>Indeed, if a production has a long event interval on the left side, three node-labels are enough to indicate whether the event interval length increases or decreases. </plain></SENT>
<SENT sid="229" pm="."><plain>Alternatively, if a production has a short event interval on the left side, three node-labels are needed for the top node to indicate the type of move to apply: a length increase move, one of the two possible \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves, or a rank swap move. </plain></SENT>
<SENT sid="230" pm="."><plain>Together, this requires 4 node-labels and the desired bound is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$4^{n-1 + 2r}$$\end{document}4n-1+2r. </plain></SENT>
</text></p><p id="Par48"><text><SENT sid="231" pm="."><plain>For \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT, we extend the grammar constructed for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtTu}$$\end{document}DtTu by four productions, namely, one for the move when two taxa either swap their ranks or increase the interval length between them, one for the move when two taxa either increase or decrease the interval length between them, one for the move when a taxon and an internal node either swap their ranks or increase the interval length between them, and one for the move when a taxon and an internal node either increase or decrease the interval length between them. </plain></SENT>
<SENT sid="232" pm="."><plain>All these moves require three node-labels, hence the desired bound is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$4^{2n-1 + 2r}$$\end{document}42n-1+2r. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p></sec></sec><sec id="Sec5"><title><text><SENT sid="233" pm="."><plain>Diameter of the graphs </plain></SENT>
</text></title><p id="Par49"><text><SENT sid="234" pm="."><plain>Since Theorem 5 bounds the sizes of r-neighborhoods by functions of the form \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$a^{f(n) + 2r}$$\end{document}af(n)+2r, the following corollary bounds the diameters of the graphs under consideration from below. </plain></SENT>
</text></p><sec id="FPar9"><title><text><SENT sid="235" pm="."><plain>Corollary 6 </plain></SENT>
</text></title><p id="Par50"><text><SENT sid="236" pm="."><plain>Let \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Delta (\mathcal {G}), |\mathcal {G}|$$\end{document}Δ(G),|G|, and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\delta _r(\mathcal {G})$$\end{document}δr(G) be the diameter, the number of vertices, and the number of vertices within distance r from any given vertex in graph \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathcal {G}$$\end{document}G, respectively. </plain></SENT>
<SENT sid="237" pm="."><plain>If \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\delta _r(\mathcal {G}) = a^{f(n) + 2r}$$\end{document}δr(G)=af(n)+2r then\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\begin{aligned} \Delta (\mathcal {G}) \ge \frac{1}{2} \log _a\frac{|\mathcal {G}|}{b}, \end{aligned}$$\end{document}Δ(G)≥12loga|G|b,where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$b = a^{f(n)}$$\end{document}b=af(n). </plain></SENT>
<SENT sid="238" pm="."><plain>In particular, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Delta (\mathrm {RNNIu}) \ge \frac{1}{2} \log _3\frac{(n-1)!\,n!}{6^{n-1}}$$\end{document}Δ(RNNIu)≥12log3(n-1)!n!6n-1. </plain></SENT>
</text></p></sec><sec id="FPar10"><title><text><SENT sid="239" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par51"><text><SENT sid="240" pm="."><plain>We note that every r that satisfies the inequality \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\delta _r(\mathcal {G}) &lt; |\mathcal {G}|$$\end{document}δr(G)&lt;|G| is smaller than the diameter, that is, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Delta (\mathcal {G}) &gt; r$$\end{document}Δ(G)&gt;r for all such r. By taking \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\log _a(\cdot )$$\end{document}loga(·), the former inequality is equivalent to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\log _ab + 2r &lt; \log _a|\mathcal {G}|$$\end{document}logab+2r&lt;loga|G|, that is, to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$r &lt; \frac{1}{2} \log _a\frac{|\mathcal {G}|}{b}$$\end{document}r&lt;12loga|G|b. </plain></SENT>
<SENT sid="242" pm="."><plain>Hence, the desired inequality. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p><p><text><SENT sid="243" pm="."><plain>Now we estimate the diameter of the graphs from above, complementing the above lower bounds. </plain></SENT>
<SENT sid="244" pm="."><plain>Recall that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Delta (\mathcal {G})$$\end{document}Δ(G) is the diameter of graph \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathcal {G}$$\end{document}G. </plain></SENT>
</text></p></sec><sec id="FPar11"><title><text><SENT sid="245" pm="."><plain>Theorem 7 </plain></SENT>
</text></title><p id="Par53"><text><SENT sid="246" pm="."><plain>For \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n \ge 4$$\end{document}n≥4, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\Delta (\mathrm {RNNIu}) \le n^2 - 3n - \displaystyle \frac{5}{8}$$\end{document}Δ(RNNIu)≤n2-3n-58. </plain></SENT>
</text></p></sec><sec id="FPar12"><title><text><SENT sid="247" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par54"><text><SENT sid="248" pm="."><plain>Let T and R be trees in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu. </plain></SENT>
<SENT sid="249" pm="."><plain>We show that there exists a path between them of length \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$n^2 - 3n - \frac{5}{8}$$\end{document}n2-3n-58 or shorter. </plain></SENT>
<SENT sid="250" pm="."><plain>We denote the taxa on one side from the root of T by A and the rest of the taxa by B. Let \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A = A_1 \cup A_2$$\end{document}A=A1∪A2 and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B = B_1 \cup B_2$$\end{document}B=B1∪B2 so that the root of R splits the taxa into \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_1 \cup B_1$$\end{document}A1∪B1 and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2 \cup B_2$$\end{document}A2∪B2. </plain></SENT>
<SENT sid="252" pm="."><plain>Note that all \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_i$$\end{document}Ai’s and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_i$$\end{document}Bi’s have to be disjoint. </plain></SENT>
<SENT sid="253" pm="."><plain>We assume that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|A_1| = |A_2| = |B_1| = |B_2| = \frac{n-1}{4}$$\end{document}|A1|=|A2|=|B1|=|B2|=n-14 and denote this number by s. We will see later in the proof that this assumption does not restrict the generality of our argument. </plain></SENT>
</text></p><p id="Par55"><text><SENT sid="255" pm="."><plain>We construct the path from T to R proceeding in the following steps, which are illustrated on Fig. 6. </plain></SENT>
<SENT sid="256" pm="."><plain>Let f(n) be the desired upper bound. </plain></SENT>
<SENT sid="257" pm="."><plain>For move counts in the remainder of this proof, we will allow the “null move” in which no modification is made.Fig. 6An algorithm to compute a (not necessarily shortest) path between discrete time-trees. </plain></SENT>
<SENT sid="258" pm="."><plain>Although the trees at steps (6) and (7) look identical, the topologies inside the triangles are different: those at step (6) correspond to the restriction of T, at step (7)—of R  Move all the nodes adjacent to taxa in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2 on top of all the other nodes in T, apart from the root. </plain></SENT>
<SENT sid="259" pm="."><plain>The tree restricted to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2 is then a caterpillar tree. </plain></SENT>
<SENT sid="260" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$3s^2$$\end{document}3s2 moves.Move the caterpillar tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2 to the other side of the root. </plain></SENT>
<SENT sid="261" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\frac{1}{2} s^2 + \frac{1}{2} s$$\end{document}12s2+12s moves.Move all the nodes adjacent to taxa in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_1$$\end{document}B1 on top of all nodes apart from those adjacent to taxa in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2 and the root. </plain></SENT>
<SENT sid="262" pm="."><plain>The tree restricted to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_1$$\end{document}B1 is then a caterpillar tree. </plain></SENT>
<SENT sid="263" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2s^2$$\end{document}2s2 moves.Swap the caterpillars on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2 and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_1$$\end{document}B1. </plain></SENT>
<SENT sid="264" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$s^2$$\end{document}s2 moves.Move the caterpillar tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_1$$\end{document}B1 to the other side of the root. </plain></SENT>
<SENT sid="265" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\frac{1}{2} s^2 + \frac{1}{2} s$$\end{document}12s2+12s moves.Translate the tree restricted to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_2$$\end{document}B2 up to place it between the trees on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_1$$\end{document}A1 and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2. </plain></SENT>
<SENT sid="266" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$s^2$$\end{document}s2 moves.Convert the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_1 \cup B_2$$\end{document}A1∪B2 to the corresponding subtree in R in terms of topology and relative ranking of nodes within the subtree. </plain></SENT>
<SENT sid="267" pm="."><plain>This takes 2f(n / 4) moves.Translate the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_2$$\end{document}B2 down so that the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_1 \cup B_2$$\end{document}A1∪B2 matches the corresponding subtree in R in terms of topology and relative ranking of nodes. </plain></SENT>
<SENT sid="268" pm="."><plain>This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$s^2$$\end{document}s2 moves.Merge the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2$$\end{document}A2 with the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_2$$\end{document}B2 so that the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_1 \cup A_2 \cup B_2$$\end{document}A1∪A2∪B2 coincides with that in R. This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$2s^2$$\end{document}2s2 moves.Merge the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$B_1$$\end{document}B1 with the tree on \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_1$$\end{document}A1 so that the tree coincides with R. This takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$3s^2$$\end{document}3s2 moves.In total, we have a recursive equation \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$f(n) = 14s^2 + s + 2 f(n/4)$$\end{document}f(n)=14s2+s+2f(n/4). </plain></SENT>
</text></p><p id="Par66"><text><SENT sid="271" pm="."><plain>Assuming that the solution is a polynomial, we see that the polynomial must be of degree 2. </plain></SENT>
<SENT sid="272" pm="."><plain>It remains to apply the recursive equation to find the coefficients of the polynomial:\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\begin{aligned} f(n) = n^2 - 3n - \frac{5}{8}. \end{aligned}$$\end{document}f(n)=n2-3n-58.It remains to note that the assumption \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|A_1| = |A_2| = |B_1| = |B_2| = \frac{n-1}{4}$$\end{document}|A1|=|A2|=|B1|=|B2|=n-14 does not increase the distance between T and R. Indeed, the sets can be chosen so that at most half of the nodes have to cross the root, that is, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|A_2 \cup B_1| \le \frac{n-1}{2}$$\end{document}|A2∪B1|≤n-12. </plain></SENT>
<SENT sid="274" pm="."><plain>Furthermore, the smaller the size of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$A_2 \cup B_1$$\end{document}A2∪B1 the shorter the path. </plain></SENT>
<SENT sid="275" pm="."><plain>Finally, the total length of the path is maximized when \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|A_2| = |B_1|$$\end{document}|A2|=|B1| and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|A_1| = |B_2|$$\end{document}|A1|=|B2|. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p><p><text><SENT sid="276" pm="."><plain>Although we stated and proved the theorem only for the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu graph, the idea can be adapted to the other graphs considered here. </plain></SENT>
<SENT sid="277" pm="."><plain>However, this adaptation goes beyond the scope of this paper. </plain></SENT>
</text></p><p><text><SENT sid="278" pm="."><plain>We also note that the proof of the theorem provides an efficient algorithm for computing (not necessarily shortest) paths between discrete time-trees. </plain></SENT>
<SENT sid="279" pm="."><plain>This algorithm can be used for efficient exploration of the space, e.g. via MCMC, where approximate paths can be used to improve mixing by making distant proposals. </plain></SENT>
<SENT sid="280" pm="."><plain>The algorithm might also be useful to determine if two trees appear to be separated by a valley (e.g. of posterior probability) or if they are rather located on a plateau. </plain></SENT>
</text></p><p><text><SENT sid="281" pm="."><plain>A non-ranked tree has a symmetry associated with every internal node. </plain></SENT>
<SENT sid="282" pm="."><plain>Those symmetries can be employed to consider only a single representative from equivalent pairs of trees, such as by using tanglegrams (Matsen et al. 2015; Whidden and Matsen 2016), where a tanglegram is a graph formed by identifying the leaves of two phylogenetic trees. </plain></SENT>
<SENT sid="283" pm="."><plain>However, as the following proposition shows, ranked trees are free from all but one of those symmetries, hence the tanglegram approach is not applicable in this case. </plain></SENT>
</text></p></sec><sec id="FPar13"><title><text><SENT sid="284" pm="."><plain>Proposition 8 </plain></SENT>
</text></title><p id="Par70"><text><SENT sid="285" pm="."><plain>Let T be a tree from \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtTu}$$\end{document}DtTu, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI, or \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\sigma $$\end{document}σ a permutation of taxa of T. Let \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_\sigma $$\end{document}Tσ be the tree obtained from T by permuting the taxa using \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\sigma $$\end{document}σ. </plain></SENT>
<SENT sid="287" pm="."><plain>Then \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T = T_\sigma $$\end{document}T=Tσ if and only if \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\sigma $$\end{document}σ is either the identity permutation or a transposition of a pair of taxa that form a cherry in T. </plain></SENT>
</text></p></sec><sec id="FPar14"><title><text><SENT sid="288" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par71"><text><SENT sid="289" pm="."><plain>The sufficiency is obvious. </plain></SENT>
<SENT sid="290" pm="."><plain>For the necessity, assume that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\sigma $$\end{document}σ transpose taxa i, j such that i, j is not a cherry in T. This implies that i and j have different parents. </plain></SENT>
<SENT sid="292" pm="."><plain>Hence \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T \ne T_\sigma $$\end{document}T≠Tσ because the ranks of the parent of i are different in T and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_\sigma $$\end{document}Tσ. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p><p><text><SENT sid="293" pm="."><plain>These observations suggest that the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph is geometrically and algorithmically different from the other four graphs. </plain></SENT>
</text></p></sec></sec><sec id="Sec6"><title><text><SENT sid="294" pm="."><plain>Efficient algorithm for generating \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graphs </plain></SENT>
</text></title><p id="Par73"><text><SENT sid="295" pm="."><plain>We now introduce an algorithm to compute the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph on n leaves by extending an algorithm from Whidden and Matsen (2016). </plain></SENT>
<SENT sid="296" pm="."><plain>The input to our algorithm is a set S of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI trees in the format described by Gavryushkin and Drummond (2016) and implemented in Gavryushkin and Drummond (2015) (see also Semple and Steel 2003). </plain></SENT>
<SENT sid="297" pm="."><plain>The two key requirements of the algorithm are the ability to enumerate the neighbors of a given tree in the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph, and the ability to determine whether a given tree is already a vertex of the graph. </plain></SENT>
<SENT sid="298" pm="."><plain>Both of these requirements follow from an efficient unique representation for ranked trees. </plain></SENT>
</text></p><p id="Par74"><text><SENT sid="299" pm="."><plain>A node of a tree is given by the set of taxa that are all descendants of the node. </plain></SENT>
<SENT sid="300" pm="."><plain>A tree is then given by a sequence of nodes ordered by their ranks. </plain></SENT>
<SENT sid="301" pm="."><plain>Clearly, this obtained representation is unique. </plain></SENT>
<SENT sid="302" pm="."><plain>For example, the representation of the tree on Fig. 1 is \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$(\{A\}, \{C\}, \{D\}, \{B\}, \{E\}, \{A,B\}, \{D,E\}, \{C, D, E\}, \{F\}, \{A,B,F\}, \{A,B,C,D,E,F\})$$\end{document}({A},{C},{D},{B},{E},{A,B},{D,E},{C,D,E},{F},{A,B,F},{A,B,C,D,E,F}), or \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$(\{A,B\}, \{D,E\}, \{C, D, E\}, \{A,B,F\}, \{A,B,C,D,E,F\})$$\end{document}({A,B},{D,E},{C,D,E},{A,B,F},{A,B,C,D,E,F}) if we make the tree ultrametric by placing all taxa below the most recent divergence event. </plain></SENT>
<SENT sid="303" pm="."><plain>Using this representation of trees we construct a map \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\nu : S \rightarrow \omega $$\end{document}ν:S→ω, where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\omega $$\end{document}ω is the set of non-negative integers. </plain></SENT>
<SENT sid="304" pm="."><plain>This map allows us to determine whether or not a tree is already a vertex of the graph. </plain></SENT>
<SENT sid="305" pm="."><plain>This takes linear time if the map is implemented as a trie. </plain></SENT>
<SENT sid="306" pm="."><plain>We can also enumerate the neighbors of a tree in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$O(n^2)$$\end{document}O(n2)-time using Lemma 4. </plain></SENT>
<SENT sid="307" pm="."><plain>The algorithm therefore takes \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$O(|S|*n^2)$$\end{document}O(|S|∗n2)-time. </plain></SENT>
<SENT sid="308" pm="."><plain>The high-level steps of the algorithm are as follows. </plain></SENT>
<SENT sid="309" pm="."><plain>See Whidden and Matsen (2016) for an analogous proof of correctness. </plain></SENT>
</text></p><p id="Par75"><text><SENT sid="310" pm="."><plain>Construct-\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI-Graph(S)Let G be an empty graph.Let \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\nu $$\end{document}ν be an empty mapping from trees to integers.Let \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$i = 0$$\end{document}i=0.For each of the m trees:Add a vertex i to G representing the current tree \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_i$$\end{document}Ti.Add \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_i \rightarrow i$$\end{document}Ti→i to \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\nu $$\end{document}ν.For each neighbor \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_j$$\end{document}Tj of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_i$$\end{document}Ti:(j)If \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$T_j$$\end{document}Tj is in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\text {dom}}(\nu )$$\end{document}dom(ν) then add an edge \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$(i, \nu (T_j))$$\end{document}(i,ν(Tj)) to G.  \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$i = i + 1$$\end{document}i=i+1.  </plain></SENT>
</text></p></sec></sec><sec id="Sec7"><title><text><SENT sid="311" pm="."><plain>Open problems and conjectures </plain></SENT>
</text></title><p id="Par85"><text><SENT sid="312" pm="."><plain>In the previous section we posed Problem 1, which asks about the complexity of computing the distance in discrete time-tree graphs. </plain></SENT>
<SENT sid="313" pm="."><plain>This problem is the primary obstacle for actual biological applications of the introduced graphs. </plain></SENT>
<SENT sid="314" pm="."><plain>The history of research into computational complexity of phylogenetic graphs is very rich and exciting, in particular for the case of the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph, with a number of erroneous results being published over the 25 years it took to settle the complexity. </plain></SENT>
<SENT sid="315" pm="."><plain>See Dasgupta et al. (2000) for a detailed discussion of those publications, some of which claimed that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI distance is NP-hard while others claiming that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI distance is decidable in polynomial time. </plain></SENT>
<SENT sid="317" pm="."><plain>The latter claims were mainly based on the so-called Split Theorem which states the following: If a partition of leaves given by an edge is shared between two trees then there exists a shortest \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI path between the trees such that every tree on the path maintains the partition. </plain></SENT>
<SENT sid="318" pm="."><plain>These claims were finally refuted by Li et al. (1996), who proved that the Split Theorem does not hold in the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph. </plain></SENT>
<SENT sid="320" pm="."><plain>Hence, a natural question that would contribute to understanding Problem 1 is whether or not the Split Theorem holds in the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph and other time-tree graphs. </plain></SENT>
</text></p><sec id="Sec8"><title><text><SENT sid="321" pm="."><plain>Split Theorem </plain></SENT>
</text></title><p id="Par86"><text><SENT sid="322" pm="."><plain>Li et al. (1996) used properties of the diameter of the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph and the sizes of its neighborhoods to provide an example of trees such that every shortest \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI path between the trees fails to maintain a partition of taxa shared by the origin and destination trees. </plain></SENT>
<SENT sid="323" pm="."><plain>Specifically, they showed that sorting two caterpillar trees simultaneously is more efficient than sorting them independently, provided the size of the trees is large enough. </plain></SENT>
<SENT sid="324" pm="."><plain>In the following, we conjecture that the ranked versions of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph maintain splits along shortest paths. </plain></SENT>
<SENT sid="325" pm="."><plain>Our conjecture is based on the fact that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI does not satisfy the diameter bounds necessary for the argument in Li et al. (1996) to go through—see Theorems 5 and 7. </plain></SENT>
<SENT sid="327" pm="."><plain>Indeed, since sorting a caterpillar tree of size k in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI takes fewer moves than merging two such caterpillar trees and then separating them, the counter-example from Li et al. (1996) does not apply in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI. </plain></SENT>
<SENT sid="329" pm="."><plain>This counter-example using two trees encodes the basic way in which \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI shortest paths are non-trivial: that one can economize by first grouping leaves into bundles, moving the bundles, and then breaking the bundles apart. </plain></SENT>
<SENT sid="330" pm="."><plain>Because this basic operation does not provide an advantage in the simplest case of two caterpillar trees in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI, we do not believe that it will hold for more complex collections of moves. </plain></SENT>
</text></p><sec id="FPar15"><title><text><SENT sid="331" pm="."><plain>Conjecture 9 </plain></SENT>
</text></title><p id="Par87"><text><SENT sid="332" pm="."><plain>The following is true in all graphs \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtTu}$$\end{document}DtTu, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI, and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNIu}$$\end{document}RNNIu, but not in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI. </plain></SENT>
<SENT sid="333" pm="."><plain>If a partition of leaves given by an edge is presented in two trees T and R then the partition is presented in every tree on every shortest path between T and R. </plain></SENT>
</text></p></sec></sec><sec id="Sec9"><title><text><SENT sid="334" pm="."><plain>Computing the distance </plain></SENT>
</text></title><p id="Par88"><text><SENT sid="335" pm="."><plain>In this section, we bound the number of neighbors of a tree x in the discrete time-tree graphs that are closer than x to a given tree y, under the assumption that Conjecture 9 holds. </plain></SENT>
<SENT sid="336" pm="."><plain>We denote trees by lowercase letters to stress the fact that we are considering graphs as metric spaces in this section. </plain></SENT>
<SENT sid="337" pm="."><plain>We show that the maximum fraction of neighbors that tend closer to y grows linearly with respect to d(x, y). </plain></SENT>
<SENT sid="338" pm="."><plain>When the graph is seen as a metric space, this property is important for the study of the curvature of the space as well as convergence properties of random walks over the space. </plain></SENT>
<SENT sid="339" pm="."><plain>This will be useful in future studies analogous to Whidden and Matsen (2016). </plain></SENT>
<SENT sid="340" pm="."><plain>Furthermore, the result provides a further insight into possible approaches to Problem 1. </plain></SENT>
</text></p><sec id="FPar16"><title><text><SENT sid="341" pm="."><plain>Theorem 10 </plain></SENT>
</text></title><p id="Par89"><text><SENT sid="342" pm="."><plain>Assume that Conjecture 9 holds. </plain></SENT>
<SENT sid="343" pm="."><plain>Let x and y be two trees and N(x) a one-neighborhood of x. Then the number of trees \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$u \in N(x)$$\end{document}u∈N(x) such that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$d(u, y) \le d(x, y)$$\end{document}d(u,y)≤d(x,y) is at most(i)3d(x, y) in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI,(ii)4d(x, y) in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_2$$\end{document}DtT2,(iii)5d(x, y) in \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_m$$\end{document}DtTm for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$m &gt; 2$$\end{document}m&gt;2. </plain></SENT>
</text></p></sec><sec id="FPar17"><title><text><SENT sid="345" pm="."><plain>Proof </plain></SENT>
</text></title><p id="Par93"><text><SENT sid="346" pm="."><plain>We first prove the statement for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}_2$$\end{document}DtT2. </plain></SENT>
<SENT sid="347" pm="."><plain>Let U be the set of neighbors u of x such that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$d(u,y) \le d(x,y)$$\end{document}d(u,y)≤d(x,y), as stated in the theorem. </plain></SENT>
<SENT sid="348" pm="."><plain>We partition U into three sets of trees—I, R, and L—obtained from x by a single \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI move, rank change, or length change, respectively. </plain></SENT>
<SENT sid="349" pm="."><plain>We then prove the theorem by bounding the size of each partition by 2d(x, y), d(x, y), and d(x, y), respectively. </plain></SENT>
</text></p><p id="Par94"><text><SENT sid="350" pm="."><plain>We first consider some basic properties of minimal length paths between x and y. Observe that at most d(x, y) bipartitions differ between x and y, as each \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI operation replaces one bipartition with another (and rank and length changes do not modify bipartitions). </plain></SENT>
<SENT sid="352" pm="."><plain>Now, Conjecture 9 implies that no minimal length path from x to y will replace a bipartition that is common to x and y. </plain></SENT>
</text></p><p id="Par95"><text><SENT sid="353" pm="."><plain>We are now ready to bound the sizes of each partition I, R, and L. First, consider the subset I of closer neighbors obtained via \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves. </plain></SENT>
<SENT sid="355" pm="."><plain>By our observations above, |I| is bounded by the number of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI operations that modify one of the at most d(x, y) bipartitions of x that are not a bipartition of y. There are two neighbors of x that lack any given bipartition (obtained by moving either the left or right subtree located below the bipartition). </plain></SENT>
<SENT sid="357" pm="."><plain>Therefore, \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|I| \le 2d(x,y)$$\end{document}|I|≤2d(x,y). </plain></SENT>
</text></p><p id="Par96"><text><SENT sid="358" pm="."><plain>Second, consider the subset R of closer neighbors obtained via rank change moves. </plain></SENT>
<SENT sid="359" pm="."><plain>These operate either on one of x’s unique bipartitions or a bipartition common to x and y that differs in rank. </plain></SENT>
<SENT sid="360" pm="."><plain>As observed above, the number of unique bipartitions is bounded by the maximum number of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI moves on any minimal x to y path. </plain></SENT>
<SENT sid="361" pm="."><plain>Any such path must fix the ranks of each common edge. </plain></SENT>
<SENT sid="362" pm="."><plain>In other words, if \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$r_1$$\end{document}r1 is the number of trees in U which are obtained from x by a rank move corresponding to a common edge and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$r_2$$\end{document}r2 is the number of trees in U which are obtained from x by a rank move corresponding to a unique edge of x, then \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$r_1 + r_2 \le d(x,y)$$\end{document}r1+r2≤d(x,y), because the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$r_1$$\end{document}r1 moves have to be done along every shortest path from x to y. Thus, the total size of R is bounded by d(x, y). </plain></SENT>
</text></p><p id="Par97"><text><SENT sid="364" pm="."><plain>The bound of d(x, y) on the number of length changes that can be applied to move x closer to y follows similarly. </plain></SENT>
<SENT sid="365" pm="."><plain>Therefore, there are at most \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$|I| + |R| + |L| \le 2d(x,y) + d(x,y) + d(x,y) = 4d(x,y)$$\end{document}|I|+|R|+|L|≤2d(x,y)+d(x,y)+d(x,y)=4d(x,y) trees \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$u \in N(x)$$\end{document}u∈N(x) such that \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$d(u, y) \le d(x, y)$$\end{document}d(u,y)≤d(x,y). </plain></SENT>
</text></p><p id="Par98"><text><SENT sid="366" pm="."><plain>The statement for the other two graphs follows similarly: for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI we need to count only for trees from I and R, for \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT we will have to add 2d(x, y) instead of d(x, y) for L. \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\square $$\end{document}□ </plain></SENT>
</text></p><p><text><SENT sid="367" pm="."><plain>We conclude by noting that most of the results in this paper can be generalized to the class of sampled ancestor trees (Gavryushkina et al. 2014), where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {DtT}$$\end{document}DtT trees are enriched by an extra event called sampled ancestor—an internal node marked by a taxon with exactly one child. </plain></SENT>
<SENT sid="368" pm="."><plain>However, currently only a few methods of sampling the space of sampled ancestor trees are known (Gavryushkina et al. 2016) and the geometry of the space is poorly understood (Gavryushkin and Drummond 2016), hence we do not include the generalization here. </plain></SENT>
</text></p></sec></sec></sec><SecTag type="DISCUSS"><sec id="Sec10"><title><text><SENT sid="369" pm="."><plain>Discussion </plain></SENT>
</text></title><p id="Par100"><text><SENT sid="370" pm="."><plain>In this paper, we have introduced a hierarchy of discrete time-trees that naturally approximates the full space of phylogenetic time-trees. </plain></SENT>
<SENT sid="371" pm="."><plain>The first two levels of the hierarchy are the well-known classes of rooted phylogenetic trees and ranked phylogenetic trees. </plain></SENT>
<SENT sid="372" pm="."><plain>We extend this previous work by considering a novel graph structure, the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph, on the set of ranked trees. </plain></SENT>
<SENT sid="373" pm="."><plain>In the same way that the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph is the discrete component of the full space of phylogenetic trees, the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph is the simplest discrete component of the full space of time-trees. </plain></SENT>
<SENT sid="374" pm="."><plain>Hence, the introduced hierarchy fits and refines naturally the classical picture of phylogenetic graphs. </plain></SENT>
</text></p><p id="Par101"><text><SENT sid="375" pm="."><plain>Surprisingly, the geometry of \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI and \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graphs differ in many aspects including the diameter, the sizes of neighborhoods, and the convexity of caterpillar trees. </plain></SENT>
<SENT sid="376" pm="."><plain>This suggests that the computational complexity of computing distances in the two graphs is likely to be different, at least at the level of certain subgraphs such as the restriction to caterpillar trees. </plain></SENT>
<SENT sid="377" pm="."><plain>Although the size of discrete ranked graphs are much larger than their \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI graph counterparts, ranks provide an inherent structure that may serve as a useful avenue of attack for future algorithms. </plain></SENT>
</text></p><p id="Par102"><text><SENT sid="378" pm="."><plain>We introduce and make some initial progress on the computational complexity of calculating the distance between two time-trees (Problem 1). </plain></SENT>
<SENT sid="379" pm="."><plain>This is an important step for further progress in theoretical research as well as computational and biological applications of time-trees. </plain></SENT>
<SENT sid="380" pm="."><plain>In particular, a better understanding of this problem would have the following applications. </plain></SENT>
</text></p><sec id="Sec11"><title><text><SENT sid="381" pm="."><plain>Efficient tree search algorithms </plain></SENT>
</text></title><p id="Par103"><text><SENT sid="382" pm="."><plain>Some of the most popular phylogenetic time-tree inference methods utilize the Markov Chain Monte Carlo (MCMC) algorithm to sample a probability distribution over the space of time-trees. </plain></SENT>
<SENT sid="383" pm="."><plain>The most efficient proposals on time-trees will take into account both local and global geometry of the corresponding space. </plain></SENT>
<SENT sid="384" pm="."><plain>Our hierarchy of discrete time-trees offers a natural discrete structure of the space used in such tree proposals. </plain></SENT>
</text></p><p id="Par104"><text><SENT sid="385" pm="."><plain>Thus far, the most widely used modifications of trees are \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {NNI}$$\end{document}NNI, SPR, and their variants. </plain></SENT>
<SENT sid="386" pm="."><plain>The graph distance inherited from these modifications is known to be NP-hard to compute, and although sometimes NP-hard problems can be solved efficiently for practically interesting data sets, this is not the case for these phylogenetic graphs of ranked trees, where the size of tractable problems is an order of magnitude smaller than those that routinely arise in practice. </plain></SENT>
<SENT sid="387" pm="."><plain>Hence, a computationally tractable phylogenetic graph is a highly relevant and desirable object for the field, and we believe that the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\mathrm {RNNI}$$\end{document}RNNI graph should have this property. </plain></SENT>
</text></p></sec><sec id="Sec12"><title><text><SENT sid="388" pm="."><plain>Convergence of phylogenetic algorithms </plain></SENT>
</text></title><p id="Par105"><text><SENT sid="389" pm="."><plain>A tractable phylogenetic distance would greatly assist methods to assess convergence of Bayesian tree inference algorithms based on MCMC and related methods. </plain></SENT>
<SENT sid="390" pm="."><plain>In other areas of statistics, distance methods are widely used to test for convergence, but the computational complexity of phylogenetic distances makes those methods applicable to only very moderate data sizes. </plain></SENT>
<SENT sid="391" pm="."><plain>Phylogenetic distances are especially suitable for such applications because they correspond to the distance inherited from the inference algorithm, being based on the same sorts of tree rearrangements. </plain></SENT>
</text></p><p id="Par106"><text><SENT sid="392" pm="."><plain>Another important property for phylogenetic applications is to compute the number of trees that are “equally good” under certain criterion. </plain></SENT>
<SENT sid="393" pm="."><plain>This intuition is formalized by Sanderson et al. (2011) in the notion of a terrace. </plain></SENT>
<SENT sid="395" pm="."><plain>To compute the terrace, an efficient tree metric is of crucial importance. </plain></SENT>
</text></p></sec></sec></SecTag></body><back><fn-group><SecTag type="ACK_FUND"><fn><p><text4fund><text><SENT sid="396" pm="."><plain>AG was supported by Marsden Fund of the Royal Society of New Zealand, Grant UOA1324, through the Centre for Computational Evolution, the University of Auckland, where this work has been carried out. </plain></SENT>
<SENT sid="397" pm="."><plain>This work was done in part while AG was visiting Fred Hutchinson Cancer Research Center. </plain></SENT>
<SENT sid="398" pm="."><plain>CW and FM were funded by National Science Foundation Awards 1223057 and 1564137. </plain></SENT>
<SENT sid="399" pm="."><plain>CW is a Simons Foundation Fellow of the Life Sciences Research Foundation. </plain></SENT>
<SENT sid="400" pm="."><plain>FM supported in part by a Faculty Scholar grant from the Howard Hughes Medical Institute and the Simons Foundation. </plain></SENT>
</text></text4fund></p></fn></SecTag></fn-group><SecTag type="REF"><ref-list id="Bib1"><title>References</title><ref id="CR1"><text><SENT sid="401" pm="."><plain>ÅkerborgÖSennbladBLagergrenJBirth-death prior on phylogeny and speed datingBMC Evol Biol2008817710.1186/1471-2148-8-7718318893 </plain></SENT>
</text></ref><ref id="CR2"><text><SENT sid="402" pm="."><plain>BaeleGLiWLSDrummondAJSuchardMALemeyPAccurate model selection of relaxed molecular clocks in bayesian phylogeneticsMol Biol Evol201330223924310.1093/molbev/mss24323090976 </plain></SENT>
</text></ref><ref id="CR3"><text><SENT sid="403" pm="."><plain>BeerliPFelsensteinJMaximum likelihood estimation of a migration matrix and effective population sizes in n subpopulations by using a coalescent approachProc Natl Acad Sci USA20019884563456810.1073/pnas.08106809811287657 </plain></SENT>
</text></ref><ref id="CR4"><text><SENT sid="404" pm="."><plain>BeikoRGKeithJMHarlowTJRaganMASearching for convergence in phylogenetic markov chain monte carloSyst Biol200655455356510.1080/1063515060081254416857650 </plain></SENT>
</text></ref><ref id="CR5"><text><SENT sid="405" pm="."><plain>BilleraLJHolmesSPVogtmannKGeometry of the space of phylogenetic treesAdv Appl Math200127473376710.1006/aama.2001.0759 </plain></SENT>
</text></ref><ref id="CR6"><text><SENT sid="406" pm="."><plain>Dasgupta B, He X, Jiang T, Li M, Tromp J, Zhang L (2000) On computing the nearest neighbor interchange distance. </plain></SENT>
<SENT sid="407" pm="."><plain>In: Discrete mathematical problems with medical applications: DIMACS workshop discrete mathematical problems with medical applications, 8–10 Dec 1999, DIMACS Center, vol 55, p 19. </plain></SENT>
<SENT sid="408" pm="."><plain>American Mathematical Society </plain></SENT>
</text></ref><ref id="CR7"><text><SENT sid="409" pm="."><plain>DrummondAJHoSYWPhillipsMJRambautARelaxed phylogenetics and dating with confidencePLOS Biol200645e8810.1371/journal.pbio.004008816683862 </plain></SENT>
</text></ref><ref id="CR8"><text><SENT sid="410" pm="."><plain>DrummondAJNichollsGKRodrigoAGSolomonWEstimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence dataGenetics2002161313072012136032 </plain></SENT>
</text></ref><ref id="CR9"><text><SENT sid="411" pm="."><plain>DrummondAJRambautAShapiroBPybusOGBayesian coalescent inference of past population dynamics from molecular sequencesMol Biol Evol20052251185119210.1093/molbev/msi10315703244 </plain></SENT>
</text></ref><ref id="CR10"><text><SENT sid="412" pm="."><plain>Felsenstein J, Archie J, Day WH, Maddison W, Meacham C, Rohlf FJ, Swofford D (1986) The newick tree format. <ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip/newicktree.html">http://evolution.genetics.washington.edu/phylip/newicktree.html</ext-link> </plain></SENT>
</text></ref><ref id="CR11"><text><SENT sid="413" pm="."><plain>FordDMatsenFAStadlerTA method for investigating relative timing information on phylogenetic treesSyst Biol200958216718310.1093/sysbio/syp01820525576 </plain></SENT>
</text></ref><ref id="CR12"><text><SENT sid="414" pm="."><plain>Gavryushkin A, Drummond AJ (2015) Taugeodesic. doi:10.5281/zenodo.47152 </plain></SENT>
</text></ref><ref id="CR13"><text><SENT sid="415" pm="."><plain>GavryushkinADrummondAJThe space of ultrametric phylogenetic treesJ Theor Biol201640319720810.1016/j.jtbi.2016.05.00127188249 </plain></SENT>
</text></ref><ref id="CR14"><text><SENT sid="416" pm="."><plain>GavryushkinaAHeathTAKsepkaDTStadlerTWelchDDrummondAJBayesian total-evidence dating reveals the recent crown radiation of penguinsSyst Biol2016 </plain></SENT>
</text></ref><ref id="CR15"><text><SENT sid="417" pm="."><plain>GavryushkinaAWelchDStadlerTDrummondAJBayesian inference of sampled ancestor trees for epidemiology and fossil calibrationPLOS Comput Biol20141012e100391910.1371/journal.pcbi.100391925474353 </plain></SENT>
</text></ref><ref id="CR16"><text><SENT sid="418" pm="."><plain>Hohna S, Defoin-Platel M, Drummond AJ (2008) Clock-constrained tree proposal operators in bayesian phylogenetic inference. </plain></SENT>
<SENT sid="419" pm="."><plain>In: 8th IEEE international conference on 8th IEEE international conference on bioinformatics and bioengineering, BIBE 2008, pp 1–7. doi:10.1109/BIBE.2008.4696663 </plain></SENT>
</text></ref><ref id="CR17"><text><SENT sid="420" pm="."><plain>HuberKTSpillnerASucheckiRMoultonVMetrics on multilabeled trees: interrelationships and diameter boundsIEEE/ACM Trans Comput Biol Bioinform2011841029104010.1109/TCBB.2010.12221116046 </plain></SENT>
</text></ref><ref id="CR18"><text><SENT sid="421" pm="."><plain>KuhnerM KLAMARC 2.0: maximum likelihood and bayesian estimation of population parametersBioinformatics200622676877010.1093/bioinformatics/btk05116410317 </plain></SENT>
</text></ref><ref id="CR19"><text><SENT sid="422" pm="."><plain>KuhnerMKBeerliPYamatoJFelsensteinJUsefulness of single nucleotide polymorphism data for estimating population parametersGenetics2000156143944710978306 </plain></SENT>
</text></ref><ref id="CR20"><text><SENT sid="423" pm="."><plain>KuhnerMKYamatoJFelsensteinJEstimating effective population size and mutation rate from sequence data using Metropolis-Hastings samplingGenetics19951404142114307498781 </plain></SENT>
</text></ref><ref id="CR21"><text><SENT sid="424" pm="."><plain>KuhnerMKYamatoJFelsensteinJMaximum likelihood estimation of population growth rates based on the coalescentGenetics199814914294349584114 </plain></SENT>
</text></ref><ref id="CR22"><text><SENT sid="425" pm="."><plain>LaknerCVan Der MarkPHuelsenbeckJPLargetBRonquistFEfficiency of Markov chain Monte Carlo tree proposals in Bayesian phylogeneticsSyst Biol20085718610310.1080/1063515080188615618278678 </plain></SENT>
</text></ref><ref id="CR23"><text><SENT sid="426" pm="."><plain>LambertAStadlerTBirth-death models and coalescent point processes: the shape and probability of reconstructed phylogeniesTheor Popul Biol20139011312810.1016/j.tpb.2013.10.00224157567 </plain></SENT>
</text></ref><ref id="CR24"><text><SENT sid="427" pm="."><plain>LiMTrompJZhangLCaiJ-YWongCSome notes on the nearest neighbour interchange distanceComputing and combinatorics. </plain></SENT>
<SENT sid="428" pm="."><plain>Lecture notes in computer science1996BerlinSpringer343351 </plain></SENT>
</text></ref><ref id="CR25"><text><SENT sid="429" pm="."><plain>Matsen IV FA, Billey S, Kas A, Konvalinka M (2015) Tanglegrams: a reduction tool for mathematical phylogenetics. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1507.04784">arXiv:1507.04784</ext-link> [q-bio.PE] </plain></SENT>
</text></ref><ref id="CR26"><text><SENT sid="430" pm="."><plain>MauBNewtonMAPhylogenetic inference for binary data on dendograms using Markov chain Monte CarloJ Comput Graph Stat199761122131 </plain></SENT>
</text></ref><ref id="CR27"><text><SENT sid="431" pm="."><plain>MininVNBloomquistEWSuchardMASmooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamicsMol Biol Evol20082571459147110.1093/molbev/msn09018408232 </plain></SENT>
</text></ref><ref id="CR28"><text><SENT sid="432" pm="."><plain>MosselEVigodaEPhylogenetic MCMC algorithms are misleading on mixtures of treesScience200530957442207220910.1126/science.111549316195459 </plain></SENT>
</text></ref><ref id="CR29"><text><SENT sid="433" pm="."><plain>MosselEVigodaELimitations of Markov chain Monte Carlo algorithms for Bayesian inference of phylogenyAnn Appl Probab20061642215223410.1214/105051600000000538 </plain></SENT>
</text></ref><ref id="CR30"><text><SENT sid="434" pm="."><plain>PageRDMRandom dendrograms and null hypotheses in cladistic biogeographySyst Zool1991401546210.2307/2992221 </plain></SENT>
</text></ref><ref id="CR31"><text><SENT sid="435" pm="."><plain>RonquistFLargetBHuelsenbeckJ PKadaneJ BSimonDvan der MarkPComment on “Phylogenetic MCMC algorithms are misleading on mixtures of trees”Science2006312577236710.1126/science.112362216627724 </plain></SENT>
</text></ref><ref id="CR32"><text><SENT sid="436" pm="."><plain>SandersonMJMcMahonMMSteelMTerraces in phylogenetic tree spaceScience2011333604144845010.1126/science.120635721680810 </plain></SENT>
</text></ref><ref id="CR33"><text><SENT sid="437" pm="."><plain>SempleCSteelMPhylogenetics2003OxfordOxford University Press </plain></SENT>
</text></ref><ref id="CR34"><text><SENT sid="438" pm="."><plain>SleatorDDTarjanREThurstonWPShort encodings of evolving structuresSIAM J Discrete Math19925342845010.1137/0405034 </plain></SENT>
</text></ref><ref id="CR35"><text><SENT sid="439" pm="."><plain>SpadeDAHerbeiRKubatkoLSA note on the relaxation time of two Markov chains on rooted phylogenetic tree spacesStati Probab Lett20148424725210.1016/j.spl.2013.09.017 </plain></SENT>
</text></ref><ref id="CR36"><text><SENT sid="440" pm="."><plain>ŠtefankovičDVigodaEFast convergence of Markov chain Monte Carlo algorithms for phylogenetic reconstruction with homogeneous data on closely related speciesSIAM J Discrete Math20112531194121110.1137/100790550 </plain></SENT>
</text></ref><ref id="CR37"><text><SENT sid="441" pm="."><plain>WhiddenCMatsenFAIVQuantifying MCMC exploration of phylogenetic tree spaceSyst Biol20151063–51571076836X </plain></SENT>
</text></ref><ref id="CR38"><text><SENT sid="442" pm="."><plain>Whidden C, Matsen IV FA (2016) Ricci-Ollivier curvature of the rooted phylogenetic Subtree-Prune-Regraft graph. </plain></SENT>
<SENT sid="443" pm="."><plain>In: Proceedings of the thirteenth workshop on analytic algorithmics and combinatorics (ANALCO16), pp 106–120. url: <ext-link ext-link-type="uri" xlink:href="http://epubs.siam.org/doi/abs/10.1137/1.9781611974324.6">http://epubs.siam.org/doi/abs/10.1137/1.9781611974324.6</ext-link> </plain></SENT>
</text></ref><ref id="CR39"><text><SENT sid="444" pm="."><plain>WorobeyMGemmelMTeuwenDEHaselkornTKunstmanKBunceMMuyembeJ-JKabongoJ-MMKalengayiRMVan MarckEGilbertMTPWolinskySMDirect evidence of extensive diversity of HIV-1 in kinshasa by 1960Nature2008455721366166410.1038/nature0739018833279 </plain></SENT>
</text></ref><ref id="CR40"><text><SENT sid="445" pm="."><plain>YangZRannalaBBayesian phylogenetic inference using DNA sequences: a Markov chain Monte Carlo methodMol Biol Evol199714771772410.1093/oxfordjournals.molbev.a0258119214744 </plain></SENT>
</text></ref></ref-list></SecTag></back></article>
