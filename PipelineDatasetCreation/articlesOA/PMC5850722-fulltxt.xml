<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id><journal-id journal-id-type="iso-abbrev">Mol. Biol. Evol</journal-id><journal-id journal-id-type="publisher-id">molbev</journal-id><journal-title-group><journal-title>Molecular Biology and Evolution</journal-title></journal-title-group><issn pub-type="ppub">0737-4038</issn><issn pub-type="epub">1537-1719</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5850722</article-id><article-id pub-id-type="pmid">29029342</article-id><article-id pub-id-type="doi">10.1093/molbev/msx259</article-id><article-id pub-id-type="publisher-id">msx259</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methods</subject></subj-group></article-categories><title-group><article-title>STRIDE: Species Tree Root Inference from Gene Duplication Events</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Emms</surname><given-names>David M</given-names></name><xref ref-type="aff" rid="msx259-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kelly</surname><given-names>Steven</given-names></name><xref ref-type="corresp" rid="msx259-cor1"/><xref ref-type="aff" rid="msx259-aff1">1</xref><!--<email>steven.kelly@plants.ox.ac.uk</email>--></contrib></contrib-group><aff id="msx259-aff1">
<label>1</label>Department of Plant Sciences, University of Oxford, Oxford, United Kingdom</aff><author-notes><corresp id="msx259-cor1"><label>*</label><bold>Corresponding author:</bold> E-mail: <email>steven.kelly@plants.ox.ac.uk</email>.</corresp><fn id="msx259-FM1"><p>
<bold>Associate editor:</bold> Naruya Saitou</p></fn></author-notes><pub-date pub-type="ppub"><month>12</month><year>2017</year></pub-date><pub-date pub-type="epub" iso-8601-date="2017-09-26"><day>26</day><month>9</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>26</day><month>9</month><year>2017</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>34</volume><issue>12</issue><fpage>3267</fpage><lpage>3278</lpage><permissions><copyright-statement>&#x000a9; The Author 2017. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement><copyright-year>2017</copyright-year><license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="msx259.pdf"/><abstract><title>Abstract</title><p>The correct interpretation of any phylogenetic tree is dependent on that tree being correctly rooted. We present STRIDE, a fast, effective, and outgroup-free method for identification of gene duplication events and species tree root inference in large-scale molecular phylogenetic analyses. STRIDE identifies sets of well-supported in-group gene duplication events from a set of unrooted gene trees, and analyses these events to infer a probability distribution over an unrooted species tree for the location of its root. We show that STRIDE correctly identifies the root of the species tree in multiple large-scale molecular phylogenetic data sets spanning a wide range of timescales and taxonomic groups. We demonstrate that the novel probability model implemented in STRIDE can accurately represent the ambiguity in species tree root assignment for data sets where information is limited. Furthermore, application of STRIDE to outgroup-free inference of the origin of the eukaryotic tree resulted in a root probability distribution that provides additional support for leading hypotheses for the origin of the eukaryotes.</p></abstract><kwd-group kwd-group-type="author"><kwd>phylogenetics</kwd><kwd>phylogenomics</kwd><kwd>tree inference</kwd><kwd>gene duplication</kwd></kwd-group><counts><page-count count="12"/></counts></article-meta></front><body><sec sec-type="intro"><title>Introduction</title><p>The rooting of a phylogenetic tree is critical for the correct interpretation of the tree. For example, the phylogeny for four species (<xref ref-type="fig" rid="msx259-F1">fig. 1<italic>A</italic></xref>) has five possible roots (<xref ref-type="fig" rid="msx259-F1">fig. 1<italic>B</italic>&#x02013;<italic>F</italic></xref>) and each of the different roots corresponds to a different hypothesis as to the evolutionary history of the species. For the presented tree, identifying a wrong branch as the root (e.g., <xref ref-type="fig" rid="msx259-F1">fig. 1<italic>E</italic></xref>) would lead us to conclude that elephants are more closely related to fish and birds than they are to wolves, even though we are using a tree with the correct topology. A species tree only gives the correct evolutionary relationships when rooted correctly (<xref ref-type="fig" rid="msx259-F1">fig. 1<italic>B</italic></xref>). Thus, it is of critical importance to our interpretation of relationships, and the evolutionary history of life on earth, that we have accurate methods of inferring the root of species phylogenies.
</p><fig id="msx259-F1" orientation="portrait" position="float"><label><sc>Fig</sc>. 1.</label><caption><p>Possible roots for a four-taxa species tree. (<italic>A</italic>) Unrooted species tree for four species: elephant, wolf, fish, and bird. (<italic>B</italic>) The correct rooting of the species tree. (<italic>B</italic>&#x02013;<italic>F</italic>) The five possible rooted species trees for the unrooted species tree in <italic>A</italic>.</p></caption><graphic xlink:href="msx259f1"/></fig><p>Correct species tree rooting is also of critical importance for the inference of orthology relationships between genes. Given an unrooted gene tree (<xref ref-type="fig" rid="msx259-F2">fig. 2<italic>A</italic></xref>), knowledge of the correct branching order of the species tree (<xref ref-type="fig" rid="msx259-F1">fig. 1<italic>B</italic></xref>) is required to correctly root the gene tree (<xref ref-type="fig" rid="msx259-F2">fig. 2<italic>B</italic></xref>). An incorrect rooting of the species tree (<xref ref-type="fig" rid="msx259-F1">fig. 1<italic>C</italic>&#x02013;<italic>F</italic></xref>) leads to an incorrect inference of the root of the gene tree (<xref ref-type="fig" rid="msx259-F2">fig. 2<italic>C</italic>&#x02013;<italic>F</italic></xref>), and thus incorrect identification of orthologous genes (<xref ref-type="fig" rid="msx259-F2">fig. 2<italic>G</italic>&#x02013;<italic>H</italic></xref>). Therefore, our ability to compare the biology of species, through comparisons between orthologous genes, is reliant on accurate methods of inferring the root of species phylogenies.
</p><fig id="msx259-F2" orientation="portrait" position="float"><label><sc>Fig</sc>. 2.</label><caption><p>Orthologues inferred from gene trees depend on the root. (<italic>A</italic>) An unrooted gene tree corresponding to an orthogroup with a gene duplication event in the common ancestor of wolf and elephant. Genes from each species are represented by an image of the species. (<italic>B</italic>&#x02013;<italic>F</italic>) The most parsimonious rootings of the gene trees (fewest duplications and losses) for each of the five roots of the species tree, as shown in figure 1<italic>B</italic>&#x02013;<italic>F</italic>. <inline-formula id="IE21"><mml:math id="IM1"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula>&#x02014;gene duplication event, <inline-formula id="IE22"><mml:math id="IM2"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula>&#x02014;gene loss event. (<italic>G</italic>) Orthologues inferred from the incorrect trees <italic>C</italic> and <italic>E</italic>. (<italic>H</italic>) Orthologues inferred from the correctly rooted tree B and also the close to correctly rooted trees <italic>D</italic> and <italic>F</italic>.</p></caption><graphic xlink:href="msx259f2"/></fig><p>Although correct root placement is essential for our ability to interpret phylogenies, almost all models of sequence evolution used for tree inference are time-reversible and produce unrooted phylogenetic trees. In order to identify the root of a phylogeny extra information is required, usually knowledge of an extra species that is a suitable (i.e., closely related) outgroup for the set of species for which the root is unknown. However, outgroup choice is a common source of error in phylogenetic tree inference, with distantly related outgroups leading to inaccurate root placement and distortion of the phylogeny due to long branch attraction (<xref rid="msx259-B11" ref-type="bibr">Felsenstein 1981</xref>; <xref rid="msx259-B2" ref-type="bibr">Berger et al. 2011</xref>). Although time-irreversible models of sequence evolution exist, they do not provide a method for accurately inferring the direction of time in a tree (<xref rid="msx259-B17" ref-type="bibr">Huelsenbeck et al. 2002</xref>; <xref rid="msx259-B34" ref-type="bibr">Williams et al. 2015</xref>). To address this issue, methods have been developed that can simultaneously infer rooted species and gene trees (<xref rid="msx259-B3" ref-type="bibr">Boussau et al. 2013</xref>). However, these methods are computationally expensive and do not scale well to moderate or large species sets. Similarly, methods have been developed to root trees by minimizing a duplication and loss reconciliation cost (<xref rid="msx259-B5" ref-type="bibr">Chen et al. 2000</xref>; <xref rid="msx259-B16" ref-type="bibr">Gorecki and Tiuryn 2007</xref>; <xref rid="msx259-B15" ref-type="bibr">Gorecki et al. 2013</xref>). However, these require a rooted species tree for the reconciliation process.</p><p>&#x0201c;Duplicate gene rooting&#x0201d; has also been proposed as an alternative method for rooting species trees (<xref rid="msx259-B7" ref-type="bibr">Donoghue and Mathews 1998</xref>; <xref rid="msx259-B29" ref-type="bibr">Simmons et al. 2000</xref>). The conceptual basis for this approach is that gene duplication events are time-irreversible, unlike character substitution, and thus indicate the direction of time on the species tree. Specifically, every node in an unrooted, binary gene tree has three branches incident upon it. If the node is a speciation node then any of the three incident branches could be the edge in the direction of the root, with the other two being in the opposite direction. Thus, speciation nodes are uninformative about the direction of time along the tree. For a duplication node, however, the symmetry is broken. Two of the edges will correspond to the two copies of the gene postduplication, whereas the third edge will correspond to the gene preduplication and thus point towards the root of the tree (<xref ref-type="fig" rid="msx259-F2">fig. 2<italic>A</italic></xref>, node marked &#x0201c;D&#x0201d;). In the case of this example tree, it can be inferred that the root of the species tree must be outside of the subtree containing elephant and wolf. In an idealized case (with no effects such as incomplete lineage sorting or lateral gene transfer) the two postduplication branches can be distinguished from the preduplication branch as the postduplication branches contain genes from overlapping species sets. Furthermore, these species sets will be identical if there has been no gene loss or horizontal gene transfer, and the topology of the duplicate subtrees will recapitulate the species tree topology. Thus, if gene duplication nodes can be accurately identified in an unrooted gene tree, then the direction of time can be ascertained for all branches in the postduplication subtrees. The direction of time on these branches determines the direction of time on the corresponding branches of the species tree, and multiple gene duplication events can be aggregated to determine the direction of time across the whole species tree, thus revealing the location of the root.</p><p>Here, we present STRIDE, a novel algorithm for <underline>S</underline>pecies <underline>T</underline>ree <underline>R</underline>oot <underline>I</underline>nference from gene <underline>D</underline>uplication <underline>E</underline>vents. STRIDE identifies sets of well-supported gene duplication events from sets of unrooted gene trees, and analyses these events to infer a probability distribution over an unrooted species tree for the location of the true root. We show that STRIDE correctly identifies the community-accepted root of the majority of species trees. Additionally, we demonstrate that STRIDE effectively captures uncertainty in root placement when data is limited or conflicting. Finally, we demonstrate the utility of STRIDE to challenging phylogenetic problems by providing an outgroup-free root analysis of the origin of the eukaryotes.</p></sec><sec><title>New Approaches</title><p>Here, we present a novel approach to rooting a species tree. Instead of requiring the inclusion of an outgroup species that is already known to be at the root of the species tree, STRIDE roots a species tree with no a priori information as to the location of the root. This is achieved through the identification of well-supported duplication events in a set of unrooted gene trees and from within the clade of species being studied. This removes the need for an outgroup and avoids problems that can arise due to long-branch attraction effects caused by an outgroup species.</p></sec><sec sec-type="results"><title>Results</title><sec><title>STRIDE Identifies the Correct Root of Species Trees Given Simulated Gene Tree Data Sets</title><p>The ability of STRIDE to correctly infer the root of a known species tree was tested using three published, simulated gene tree data sets. The first data set consisted of 2,000 simulated gene trees from 40 species with heterogeneous rates of gene duplication and loss within trees (<xref rid="msx259-B3" ref-type="bibr">Boussau et al. 2013</xref>). The second and third data sets consisted of 12,000 gene trees from 12 species and 7,500 gene trees from 17 species, respectively (<xref rid="msx259-B27" ref-type="bibr">Rasmussen and Kellis 2012</xref>). These two data sets were similar to the first data set but also incorporated incomplete lineage sorting generated using a range of effective population sizes. Since incomplete lineage sorting can lead to misidentification of gene duplication and loss events these latter two data sets provided a good test of STRIDE&#x02019;s robustness in the face of gene-tree/species-tree incongruence. For all three simulated data sets, STRIDE correctly inferred the root of the species tree and assigned it a probability of 100% (<xref ref-type="table" rid="msx259-T1">table 1</xref> and <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and fig. S1&#x02013;S3, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Thus for these simulated data sets the method performed well.
<table-wrap id="msx259-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Summary of Data Sets and Results.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Group</th><th rowspan="1" colspan="1">Species</th><th rowspan="1" colspan="1">Gene Trees</th><th rowspan="1" colspan="1">Informative Dups<xref ref-type="table-fn" rid="tblfn1"><sup>a</sup></xref></th><th rowspan="1" colspan="1">Number of Conflicting Dups<xref ref-type="table-fn" rid="tblfn1"><sup>a</sup></xref></th><th rowspan="1" colspan="1">Number of MP Roots</th><th rowspan="1" colspan="1">Correct MP Root</th><th rowspan="1" colspan="1">Probability for MP Root (%)</th><th rowspan="1" colspan="1">Probability for Correct Root (%)</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Metazoa (sim<xref ref-type="table-fn" rid="tblfn2"><sup>b</sup></xref>)</td><td rowspan="1" colspan="1">40</td><td rowspan="1" colspan="1">2,000</td><td rowspan="1" colspan="1">664</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Drosophila (sim<xref ref-type="table-fn" rid="tblfn2"><sup>b</sup></xref>)</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">12,000</td><td rowspan="1" colspan="1">1,360</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Primates (sim<xref ref-type="table-fn" rid="tblfn2"><sup>b</sup></xref>)</td><td rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">7,500</td><td rowspan="1" colspan="1">1,593</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Birds</td><td rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">14,454</td><td rowspan="1" colspan="1">51</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">15.0</td><td rowspan="1" colspan="1">2.0</td></tr><tr><td rowspan="1" colspan="1">Flies (Diptera)</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">11,688</td><td rowspan="1" colspan="1">279</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Fish</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">16,520</td><td rowspan="1" colspan="1">650</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Fungi</td><td rowspan="1" colspan="1">21</td><td rowspan="1" colspan="1">9,325</td><td rowspan="1" colspan="1">419</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Hymenoptera</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">9,157</td><td rowspan="1" colspan="1">108</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Kinetoplastids</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">9,731</td><td rowspan="1" colspan="1">76</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">55.0</td><td rowspan="1" colspan="1">55.0</td></tr><tr><td rowspan="1" colspan="1">Laurasiatheria</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">1,5804</td><td rowspan="1" colspan="1">135</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">0.0</td></tr><tr><td rowspan="1" colspan="1">Metazoa</td><td rowspan="1" colspan="1">21</td><td rowspan="1" colspan="1">13,017</td><td rowspan="1" colspan="1">2,065</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">48.0</td><td rowspan="1" colspan="1">48.0</td></tr><tr><td rowspan="1" colspan="1">Nematoda</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">8,392</td><td rowspan="1" colspan="1">93</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Primates</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">19,096</td><td rowspan="1" colspan="1">117</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">8.0</td><td rowspan="1" colspan="1">8.0</td></tr><tr><td rowspan="1" colspan="1">Rodents</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">15,485</td><td rowspan="1" colspan="1">22</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">9.0</td><td rowspan="1" colspan="1">0.5</td></tr><tr><td rowspan="1" colspan="1">Plants</td><td rowspan="1" colspan="1">42</td><td rowspan="1" colspan="1">28,356</td><td rowspan="1" colspan="1">7,761</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td></tr><tr><td rowspan="1" colspan="1">Eukaryotes</td><td rowspan="1" colspan="1">45</td><td rowspan="1" colspan="1">16,770</td><td rowspan="1" colspan="1">2,316</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">&#x02014;</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Total simulated</td><td rowspan="1" colspan="1">69</td><td rowspan="1" colspan="1">21,500</td><td rowspan="1" colspan="1">3,617</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">&#x02014;</td></tr><tr><td rowspan="1" colspan="1">Total biological</td><td rowspan="1" colspan="1">254</td><td rowspan="1" colspan="1">187,795</td><td rowspan="1" colspan="1">14,092</td><td rowspan="1" colspan="1">59</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">9</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">&#x02014;</td></tr><tr><td rowspan="1" colspan="1">Total</td><td rowspan="1" colspan="1">323</td><td rowspan="1" colspan="1">209,295</td><td rowspan="1" colspan="1">17,709</td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">&#x02014;</td><td rowspan="1" colspan="1">&#x02014;</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><label>a</label><p>Dups&#x02009;=&#x02009;duplications.</p></fn><fn id="tblfn2"><label>b</label><p>sim&#x02009;=&#x02009;simulated.</p></fn></table-wrap-foot></table-wrap></p><p>Although there are no comparable methods for inferring the probability distribution for the root of a species tree from gene duplication events, there are methods that can identify gene duplication events in an unrooted gene tree if a rooted species tree is provided. It should be noted that these methods need to know the solution to the problem STRIDE is trying to solve in order to identify gene duplication events. However, an analysis of the gene duplication event detection accuracy of STRIDE in the context of these methods is provided in <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and table S1, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. On the three simulated data sets, STRIDE had an overall precision of 99.9% and a recall of 34.8%. By comparison, on the same data sets Notung and DLCpar_search achieved an overall precision of 21.0% and 43.0%, respectively, and an overall recall of 84.0% and 75.3%, respectively (<xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and table S1, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Thus, the precision of STRIDE is high even in the absence of knowledge of the root of the species tree. The recall was lower than the other methods, however it was sufficient to unambiguously pinpoint the location of the root in all three cases (<xref ref-type="table" rid="msx259-T1">table 1</xref> and <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and fig. S1&#x02013;S3, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p></sec><sec><title>Application of STRIDE to Real Species Data Sets</title><p>Simulated data sets generally do not capture all the nuances and difficulties seen in real biological data sets. These nuances include errors in orthogroup inference, alignment inference, and gene tree inference. Thus to demonstrate the utility of STRIDE, a diverse range of groups of species were sampled from throughout the eukaryotic domain (<xref ref-type="table" rid="msx259-T1">table 1</xref>). This included every group of eukaryotes on Ensembl Genomes containing &#x0003e;4 genera (<xref rid="msx259-B36" ref-type="bibr">Yates et al. 2016</xref>). To expand this group of tests, additional sets of genomes were obtained for 47 Birds (<xref rid="msx259-B20" ref-type="bibr">Jarvis et al. 2014</xref>), 42 Green Plants (<xref rid="msx259-B13" ref-type="bibr">Goodstein et al. 2012</xref>) and 16 Kinetoplastids (<xref rid="msx259-B1" ref-type="bibr">Aslett et al. 2010</xref>). In total, this gave 12 species groups with varying levels of taxon sampling and with estimated divergence times ranging from c. 56 My for the Primates (<xref rid="msx259-B8" ref-type="bibr">dos Reis et al. 2014</xref>) to c. 1,500 My for the Green Plants (<xref rid="msx259-B25" ref-type="bibr">Parfrey et al. 2011</xref>). These species sets thus provided a diverse group with which to test the utility of STRIDE. Furthermore, for each of these species sets, there is an accepted consensus on the topology and location of the root of the species tree (<xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). In all cases these topologies and root branches were assumed to be true when STRIDE&#x02019;s performance was assessed. On average, across each of the simulated and real data set in this analysis STRIDE took &#x0223c;18&#x02009;s to run using four cores of an Intel Core i7-4770&#x02009;3.4&#x02009;GHz CPU.</p><p>Orthogroups for each species set were inferred using OrthoFinder (<xref rid="msx259-B10" ref-type="bibr">Emms and Kelly 2015</xref>), and gene trees for each orthogroup were inferred using IQTREE v1.5.3 (<xref rid="msx259-B24" ref-type="bibr">Nguyen et al. 2015</xref>) from a multiple sequence alignment generated using MAFFT L-INS-I v7.305b (<xref rid="msx259-B21" ref-type="bibr">Katoh and Standley 2013</xref>). For each species set, STRIDE was run with a published unrooted species tree (without branch lengths) and the complete set of gene trees inferred from all orthogroups identified by OrthoFinder. The number species, gene trees, informative duplications, and other details are provided in <xref ref-type="table" rid="msx259-T1">table 1</xref>.</p><p>In all 12 test cases, there is a single maximum parsimony root. In nine of the 12 tests this root agreed with the accepted root of the species set (<xref ref-type="table" rid="msx259-T1">table 1</xref>). <xref ref-type="fig" rid="msx259-F3">Figures 3&#x02013;5</xref> present the results of the STRIDE analysis applied to the plant, fungi, and bird data sets. These data sets correspond to the largest, median, and smallest number of informative duplications per species identified by STRIDE. The results for the remaining data sets can be found in <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and figures S4&#x02013;S12, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. For the plant data set, sufficient gene-duplication events were identified for the probability model to assign a probability of 100% to the accepted root separating the algae from the land plants (<xref rid="msx259-B40" ref-type="bibr">Ruhfel et al. 2014</xref>, 14: 23) (<xref ref-type="fig" rid="msx259-F3">fig. 3</xref>). A probability of 100% was also assigned for the correct root in the fungi, even though fewer informative gene duplication events were identified (<xref ref-type="fig" rid="msx259-F4">fig. 4 and</xref><xref ref-type="table" rid="msx259-T1">table 1</xref>). In both the plant and fungal data sets, STRIDE also identified substantial numbers of gene duplication events that support subclades within both species trees (<xref ref-type="fig" rid="msx259-F3">figs. 3 and 4</xref>).
</p><fig id="msx259-F3" orientation="portrait" position="float"><label><sc>Fig</sc>. 3.</label><caption><p>STRIDE analysis applied the set of plant gene trees. (<italic>A</italic>) Numbers of identified gene duplication events are marked on the branches they are observed on and arrows indicate the direction in which the duplication occurred. Gene duplication events are in agreement with the maximum parsimony root of the tree if the arrow points away from the root, and are in green. Those that disagree are in blue. The maximum parsimony root is circled in red and is in agreement with the correct root, marked with a *. (<italic>B</italic>) The probabilities for the location of the root calculated by STRIDE.</p></caption><graphic xlink:href="msx259f3"/></fig><fig id="msx259-F4" orientation="portrait" position="float"><label><sc>Fig</sc>. 4.</label><caption><p>STRIDE analysis applied the set of fungi gene trees. (<italic>A</italic>) Numbers of identified gene duplication events are marked on the branches they are observed on and arrows indicate the direction in which the duplication occurred. Gene duplication events are in agreement with the maximum parsimony root of the tree if the arrow points away from the root, and are in green. Those that disagree are in blue. The maximum parsimony root is circled in red and is in agreement with the correct root, marked with a *. (<italic>B</italic>) The probabilities for the location of the root calculated by STRIDE.</p></caption><graphic xlink:href="msx259f4"/></fig><fig id="msx259-F5" orientation="portrait" position="float"><label><sc>Fig</sc>. 5.</label><caption><p>STRIDE analysis applied the set of Bird gene trees. (<italic>A</italic>) Numbers of identified gene duplication events are marked on the branches they are observed on and arrows indicate the direction in which the duplication occurred. Gene duplication events are in agreement with the maximum parsimony root of the tree if the arrow points away from the root, and are in green. Those that disagree are in blue. The maximum parsimony root is circled in red and is in agreement with the correct root, marked with a *. (<italic>B</italic>) The probabilities for the location of the root calculated by STRIDE, cultured according to the displayed heat map.</p></caption><graphic xlink:href="msx259f5"/></fig><p>Although STRIDE identified the community-accepted root in 75% of the data sets, it failed to identify this root for the bird (<xref ref-type="fig" rid="msx259-F5">fig. 5</xref>), rodent and Laurasiatheria (<xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and figs. S11 and S12, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) data sets. These three data sets had the smallest, second smallest and fourth smallest number of informative gene duplication events per species, respectively (<xref ref-type="table" rid="msx259-T1">table 1</xref>). In addition, while there were no conflicting gene duplication events in the bird data set, the rodent and Laurasiatheria data sets had the highest and fifth highest ratio of conflicting to informative duplications (<xref ref-type="table" rid="msx259-T1">table 1</xref>). Consistent with these observations, analysis of the factors affecting the accuracy of STRIDE revealed that root probability assignment was positively correlated with the number of informative duplications per species (<italic>R</italic><sup>2</sup> = 0.17, <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and fig. S13<italic>A</italic>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) and negatively correlated with the proportion of duplications which were in conflict (<italic>R</italic><sup>2</sup> = 0.24, <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and fig. S13<italic>B</italic>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Furthermore, the proportion of conflicting duplications was negatively correlated with the number of species (<italic>R</italic><sup>2</sup> = 0.36, <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and fig. S13<italic>C</italic>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online), suggesting increased taxon sampling facilitated more accurate identification of gene duplication events. Thus, the ability of STRIDE to detect the true root is affected by taxon sampling and the number of gene duplication events detected in the data set.</p></sec><sec><title>STRIDE Provides Evidence for Location of the Root of the Eukaryotic Tree</title><p>Given the performance of stride on the data sets outlined above it was assessed whether STRIDE could provide insight into one of the most contentious and difficult tree rooting problems in biology, the root of the eukaryotic tree (<xref rid="msx259-B4" ref-type="bibr">Burki 2014</xref>). Here, a set of 45 species that were distributed across the eukaryotic tree were selected. These were subject to orthogroup and gene tree inference as before and the complete set of 16,770 gene trees were submitted for analysis by STRIDE. This identified 2,316 gene duplication events excluding the root from (and supporting the monophyly of) major clades within the eukaryotes including the opisthokonta, fungi, metazoa, and achiplastida (<xref ref-type="fig" rid="msx259-F6">fig. 6<italic>A</italic></xref>). Duplication events supporting further subclades within these major groupings were also abundant (<xref ref-type="fig" rid="msx259-F6">fig. 6<italic>A</italic></xref>). In contrast, other major subclades including amoebazoa, the SAR supergroup, and the excavata, did not receive support from gene duplication events (<xref ref-type="fig" rid="msx259-F6">fig. 6<italic>A</italic></xref>). This lack of gene duplication events meant that STRIDE could not exclude the root of the species tree from the basal branches of these groups and thus could not provide evidence for or against the five most popular placements for the root of the eukaryotic tree (<xref rid="msx259-B4" ref-type="bibr">Burki 2014</xref>). This ambiguity in root assignment is represented effectively in the probabilities assigned to all putative root-spanning branches (<xref ref-type="fig" rid="msx259-F6">fig. 6<italic>B</italic></xref>).
</p><fig id="msx259-F6" orientation="portrait" position="float"><label><sc>Fig</sc>. 6.</label><caption><p>STRIDE analysis applied the set of Eukaryotic gene trees. (<italic>A</italic>) Numbers of identified gene duplication events are marked on the branches they are observed on and arrows indicate which block of the bipartition the duplicate genes occur in. None of the gene duplication events contradict each other. The maximum parsimony roots have red branches, the branches from which the root is excluded are black. (<italic>B</italic>) The probabilities for the location of the root calculated by STRIDE. Major groups of species are marked.</p></caption><graphic xlink:href="msx259f6"/></fig></sec><sec><title>Discussion</title><p>STRIDE is an automated method for identifying and analyzing gene duplication events to infer the root of species trees. Through analysis of simulated and real data sets, we show how the performance of STRIDE is affected by data quantity, data conflict, and taxon sampling. Furthermore, we demonstrate that STRIDE is effective in identifying the root of species trees for the majority of species data sets and effectively captures the ambiguity in root assignment given the input data.</p><p>The aim of STRIDE is to infer a probability distribution over an entire species tree for the location of its root. This aim is different from algorithms that attempt to reconcile gene trees with species trees (<xref rid="msx259-B31" ref-type="bibr">Sz&#x000f6;ll&#x00151;si et al. 2015</xref>) or model duplication and loss processes on a tree (<xref rid="msx259-B14" ref-type="bibr">Gorecki and Eulenstein 2014</xref>). STRIDE identifies and utilizes well-supported gene duplication events and does not evaluate gene loss events for the following reasons. First, gene trees can distinguish parallel duplication events on adjacent branches from a single shared duplication event, which is not possible for gene loss events. Second, the topology of the gene tree postduplication genes can be compared with the species tree to confirm the accuracy of the inference, this cannot be done with gene loss events. Third, most genomes are incomplete and vary considerably in the quality of their annotation leading to high rates of false positive gene loss (<xref rid="msx259-B33" ref-type="bibr">Veeckman et al. 2016</xref>; <xref rid="msx259-B9" ref-type="bibr">Dunne and Kelly 2017</xref>).</p><p>A major advantage of using STRIDE is that sets of species can be analyzed without the inclusion on an outgroup. This is potentially advantageous in situations where inclusion of an outgroup can affect the topology of gene trees inferred for the in-group species (<xref rid="msx259-B2" ref-type="bibr">Berger et al. 2011</xref>). Moreover, if the outgroup is distantly related to the in-group species then additional problems of long branch attraction can lead to incorrect root placement (<xref rid="msx259-B26" ref-type="bibr">Philippe et al. 2011</xref>; <xref rid="msx259-B22" ref-type="bibr">Kuck et al. 2012</xref>; <xref rid="msx259-B28" ref-type="bibr">Salichos and Rokas 2013</xref>). STRIDE is also suitable for large data set analysis and for situations where appropriate outgroups are not available. Although STRIDE as presented is a method for identifying the root of an unrooted species tree, the output from STRIDE can provide a wealth of useful information. For example, STRIDE identifies high confidence gene duplication events and maps these events to branches in a species tree. In the simulated data sets, only two of the 3,617 gene duplication events identified by STRIDE were incorrect. Similarly, in the real biological data sets only 60 of the 17,709 gene duplication events identified by STRIDE were conflicting and hence likely to be incorrect. As gene duplication events provide strong evidence for monophyly of the species that share the gene duplication event. STRIDE can be used to provide additional support to branches in a species tree that might be weakly supported by molecular sequence data. In this context, it is worth noting that STRIDE could also be used to evaluate support for alternative species-tree topologies by providing support for clades from gene duplication events.</p><p>The application of STRIDE to the eukaryotes was able to exclude the root of the eukaryotes from the opisthokonts and from a number of other groups, however STRIDE was unable to uniquely place the root as there were insufficient gene duplication events identified that could exclude the root from other portions of the tree. It is likely that poor taxon sampling for some of the groups (e.g., the amoebozoa and excavata), coupled with genome reduction associated with adaptation to parasitism in many of these species, impeded the discovery of these gene duplication events. With improved taxon sampling STRIDE may ultimately be able to provide further insight as to the location of the root of the eukaryotic tree. Furthermore, as STRIDE produces branch-level probabilities these could be combined with probabilities obtained from other analyses to perform a multi-data-type analysis of the origin of the eukaryotes.</p><p>In summary, STRIDE is a fast and effective method for genome scale phylogenetic analysis that can be used both to identify high confidence gene duplication events and identify the root of species trees without the requirement for an outgroup.</p></sec></sec><sec><title>Materials and Methods</title><sec><title>Problem Definition and Approach</title><p>A branch of an unrooted species tree corresponds to a bipartition that splits the tree&#x02019;s taxa into two blocks. The presence of a well-supported gene duplication that respects the topology of the species tree is a synapamorphy that stipulates that the block in which the duplicates are found is a monophyletic clade. This synapamorphy identifies the direction of time along the branches within this monophyletic clade. The single exception to this is the branch in the unrooted tree corresponding to the root in which time flows in both directions. This is because the branch that spans the root in the unrooted species tree corresponds to two branches in the rooted species tree and both of its corresponding blocks are monophyletic clades (<xref ref-type="fig" rid="msx259-F1">fig. 1<italic>A</italic> and <italic>B</italic></xref>). The method presented here aims to identify this root branch by identifying and analyzing a set of well-supported gene-duplication events. The method identifies the set of well-supported gene duplication events contained within a set of user-supplied gene trees and uses these to infer the location of the root of the species tree. To express uncertainty in the case of limited data or data conflict, the method uses a probabilistic model of gene-duplication events to calculate a probability distribution across the branches of the species tree for the location of the root.</p></sec><sec><title>Inference of Orthogroups and Gene Trees</title><p>For each species set, the protein sequence translations of representative gene models were downloaded from appropriate online databases. These protein sequences were then subject to orthogroup inference using OrthoFinder v1.1.4 (<xref rid="msx259-B10" ref-type="bibr">Emms and Kelly 2015</xref>). The resulting sets of protein sequence orthogroups were aligned using MAFFT L-INS-I v7.305b (<xref rid="msx259-B21" ref-type="bibr">Katoh and Standley 2013</xref>) and subject phylogenetic inference using IQTREE v1.5.3 (<xref rid="msx259-B24" ref-type="bibr">Nguyen et al. 2015</xref>). All methods used their default settings. Parallelization of MAFFT and IQTREE runs was done using GNU Parallel (<xref rid="msx259-B32" ref-type="bibr">Tange 2011</xref>). Alignments were viewed using AliView (<xref rid="msx259-B23" ref-type="bibr">Larsson 2014</xref>). Trees were viewed using Dendroscope (<xref rid="msx259-B19" ref-type="bibr">Huson and Scornavacca 2012</xref>) and drawn using the ETE library (<xref rid="msx259-B18" ref-type="bibr">Huerta-Cepas et al. 2016</xref>).</p></sec><sec><title>Identification of Well-Supported Gene Duplication Events</title><p>Gene-duplication events are phylogenetically informative if they are observed in more than one species. Methods for identifying gene duplication events have previously been proposed that minimize a duplication and loss reconciliation of an unrooted gene tree with a rooted species tree (<xref rid="msx259-B5" ref-type="bibr">Chen et al. 2000</xref>; <xref rid="msx259-B16" ref-type="bibr">Gorecki and Tiuryn 2007</xref>). As STRIDE aims to identify the root of an unrooted species tree a novel method is proposed that does not require a rooted species tree as input. The notation used to describe the algorithm is defined in the following paragraphs. Additionally, a worked example of the algorithm with an accompanying explanatory figure is presented in <xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref>, text 1, and fig. S14, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online.</p><p>An unrooted tree is an unordered pair, <inline-formula id="IE1"><mml:math id="IM3"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE2"><mml:math id="IM4"><mml:mi>N</mml:mi></mml:math></inline-formula> is the set of nodes and <inline-formula id="IE3"><mml:math id="IM5"><mml:mi>E</mml:mi></mml:math></inline-formula> is the set of undirected edges <inline-formula id="IE4"><mml:math id="IM6"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, <inline-formula id="IE5"><mml:math id="IM7"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula>. The set of leaves, <inline-formula id="IE6"><mml:math id="IM8"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, correspond to the taxa (genes or species) in the tree. Each edge in the tree corresponds to a bipartition, <inline-formula id="IE7"><mml:math id="IM9"><mml:mi>K</mml:mi></mml:math></inline-formula>, of the tree&#x02019;s leaf set, splitting this set into two blocks, <inline-formula id="IE8"><mml:math id="IM10"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE9"><mml:math id="IM11"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02282;</mml:mo><mml:mi>L</mml:mi></mml:math></inline-formula>. For a rooted binary tree, we refer to the set of species below the (arbitrarily) left child node of the root by <inline-formula id="IE10"><mml:math id="IM12"><mml:mi>X</mml:mi></mml:math></inline-formula> and the species below the right child node of the root by <inline-formula id="IE11"><mml:math id="IM13"><mml:mi>Y</mml:mi></mml:math></inline-formula>. The sets of species below the grandchild nodes are <inline-formula id="IE12"><mml:math id="IM14"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula id="IE13"><mml:math id="IM15"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula id="IE14"><mml:math id="IM16"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Y</mml:mi></mml:math></inline-formula>. For a gene tree, a set of genes is implicitly regarded as specifying another set, namely the set of species from which those genes come. The set of species in a subtree, <inline-formula id="IE15"><mml:math id="IM17"><mml:mi>t</mml:mi></mml:math></inline-formula>, is denoted <inline-formula id="IE16"><mml:math id="IM18"><mml:mi mathvariant="script">S</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><p>A few additional objects are required to describe the algorithm. The two blocks of a bipartition induce two disjoint subtrees. Let <inline-formula id="IE17"><mml:math id="IM19"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> be the subtree of the species tree corresponding to block, <inline-formula id="IE18"><mml:math id="IM20"><mml:mi>B</mml:mi></mml:math></inline-formula>, rooted on the node separating this subtree from the other subtree. Let <inline-formula id="IE19"><mml:math id="IM21"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>&#x002dc;</mml:mo></mml:mover></mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> be the rooted subtree of the gene tree &#x0201c;hanging&#x0201d; from <inline-formula id="IE20"><mml:math id="IM22"><mml:mi>e</mml:mi></mml:math></inline-formula>. Specifically, if <inline-formula id="IE21a"><mml:math id="IM23"><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>'</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, then removing the edge <inline-formula id="IE22a"><mml:math id="IM24"><mml:mi>e</mml:mi></mml:math></inline-formula> from the original tree gives two subtrees, one containing <inline-formula id="IE23"><mml:math id="IM25"><mml:mi>n</mml:mi></mml:math></inline-formula> and one containing <inline-formula id="IE24"><mml:math id="IM26"><mml:mi>n</mml:mi><mml:mi>'</mml:mi></mml:math></inline-formula>. <inline-formula id="IE25"><mml:math id="IM27"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>&#x002dc;</mml:mo></mml:mover></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the subtree containing, and rooted on <inline-formula id="IE26"><mml:math id="IM28"><mml:mi>n</mml:mi><mml:mi>'</mml:mi></mml:math></inline-formula>. Let <inline-formula id="IE27"><mml:math id="IM29"><mml:mi mathvariant="script">B</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> be the smallest block of a bipartition of the species tree, <inline-formula id="IE28"><mml:math id="IM30"><mml:mi>t</mml:mi></mml:math></inline-formula>, such that <inline-formula id="IE29"><mml:math id="IM31"><mml:mi>S</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="script">B</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, for the set of species, <inline-formula id="IE30"><mml:math id="IM32"><mml:mi>S</mml:mi></mml:math></inline-formula>. Finally, let <inline-formula id="IE31"><mml:math id="IM33"><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> be a function that returns the sets of taxa in the child and grandchild clades for the rooted subtree, <inline-formula id="IE32"><mml:math id="IM34"><mml:mi>t</mml:mi></mml:math></inline-formula>. Namely, <inline-formula id="IE33"><mml:math id="IM35"><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><p>To identify all the well-supported gene duplication events in a set of unrooted gene trees, the algorithm &#x0201c;FindDuplications&#x0201d; (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>) is run in parallel on the set of gene trees and the counts of the gene duplications are aggregated. The &#x0201c;FindDuplications&#x0201d; algorithm traverses an unrooted gene tree and in turn relies on the &#x0201c;Dup&#x0201d; algorithm (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>) to determine if a pair of edges incident on a node in a gene tree correspond to a gene duplication event.
</p><fig id="msx259-F7" orientation="portrait" position="float"><label><sc>Fig</sc> 7.</label><caption><p>The STRIDE algorithm for identifying well-supported gene duplication events in an unrooted gene-tree. For details of the objects in the algorithm see &#x0201c;Methods: Identification of Well-Supported Gene Duplication Events.&#x0201d;</p></caption><graphic xlink:href="msx259f7"/></fig><p>A gene duplication event for a block, <italic>B</italic>, of the species tree provides evidence that this block is a monophyletic clade. Partial gene loss subsequent to a gene duplication event can hamper the identification of the gene duplication event and the assignment of the event to the correct block of the species tree. The algorithm is made robust to this by mapping the observed set of species, <inline-formula id="IE34"><mml:math id="IM36"><mml:mi>S</mml:mi></mml:math></inline-formula>, in a subtree of a gene tree to the smallest block of the species tree, <inline-formula id="IE35"><mml:math id="IM37"><mml:mi>t</mml:mi></mml:math></inline-formula>, containing this species set, <inline-formula id="IE36"><mml:math id="IM38"><mml:mi mathvariant="script">B</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>, Algorithm 1&#x02009;line 5). Nodes with degree higher than three (unresolved polytomies) are excluded since they represent unresolved event in the gene tree (e.g., an amalgamation of several weakly supported bipartitions) and thus do not provide sufficiently strong evidence to accurately infer the gene history. To ensure that there is strong evidence for the gene-duplication event having occurred on the identified branch of the species tree, the presence of genes from each of the expected &#x0201c;grandchild&#x0201d; clades is required (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>, Algorithm 2&#x02009;line 5). Additionally, the local topology of each subtree postduplication is checked to ensure it matches the expected branching structure (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>, Algorithm 2&#x02009;line 6).</p></sec><sec><title>Identifying the Maximum-Parsimony Root of the Species Tree</title><p>A gene duplication on an edge of an unrooted species tree with the duplicates observed in one of the blocks of the corresponding bipartition stipulates the direction of time for all edges in the subtree derived from that bipartition. Given a set of gene duplication events, the branch in the species tree that violates the fewest gene duplication events is identified as the maximum parsimony root. If multiple such branches exist then they are each identified as equally parsimonious. This method is similar to the plateau concept previously described (<xref rid="msx259-B15" ref-type="bibr">Gorecki et al. 2013</xref>).</p></sec><sec><title>Probability Model for the Root of the Species Tree</title><p>For any given set of gene-trees, it is possible that errors in gene-tree inference will lead to false positive inference of gene duplication events that past the filtration criteria. To account for this, a probability model was developed for the location of the root of the tree given the set of (potentially conflicting) gene duplication events identified. The model consisted of two parts. The first part, the branch-level model, calculated the probability that a branch was the root given only the duplications observed in either direction along that branch. The second part, the tree-level model, aggregated all duplications observed across all branches of tree to give the final probability distribution for the location of the root taking into account all information obtained from all gene duplication events observed across the tree.</p><p>At the branch-level, the set of gene duplication events identified on that branch are modeled by two Poisson processes, one giving rise to true positive gene duplications and the other to false positive duplications. On a given branch, <inline-formula id="IE37"><mml:math id="IM39"><mml:mi>i</mml:mi></mml:math></inline-formula>, of a species tree, <italic>m<sub>i</sub></italic> duplications are observed that support time flowing in one direction along the branch, &#x02190;, and <italic>n<sub>i</sub></italic> duplications supporting time flowing in the opposite direction, &#x02192;. The set of duplications on branch <inline-formula id="IE38"><mml:math id="IM40"><mml:mi>i</mml:mi></mml:math></inline-formula> is then written, <inline-formula id="IE39"><mml:math id="IM41"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="&#x02329;" close="&#x0232a;" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, and <italic>D</italic> is the set of duplications observed on all branches of the species tree, <inline-formula id="IE40"><mml:math id="IM42"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi/><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>.</p><p>Let <inline-formula id="IE41"><mml:math id="IM43"><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02190;</mml:mo><mml:mo>,</mml:mo><mml:mi/><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> be the orientation of the branch <inline-formula id="IE42"><mml:math id="IM44"><mml:mi>i</mml:mi></mml:math></inline-formula> of the species tree and let <inline-formula id="IE43"><mml:math id="IM45"><mml:msubsup><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02190;</mml:mo><mml:mo>,</mml:mo><mml:mi/><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> be the orientation of the branch <inline-formula id="IE44"><mml:math id="IM46"><mml:mi>j</mml:mi></mml:math></inline-formula> that would be implied by the root of the tree being branch <inline-formula id="IE45"><mml:math id="IM47"><mml:mi>i</mml:mi></mml:math></inline-formula>. The final tree-level probability distribution <inline-formula id="IE46"><mml:math id="IM48"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> takes into account the complete set of duplications, <inline-formula id="IE47"><mml:math id="IM49"><mml:mi>D</mml:mi></mml:math></inline-formula>, observed on all branches of the tree rather than just the duplications, <inline-formula id="IE48"><mml:math id="IM50"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, observed on a single branch:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal"/><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>That is, the probability distribution for the root given all the gene duplication events on the tree can be expressed in terms of the probabilities for the orientation of each branch given only the gene duplications on that branch; <inline-formula id="IE49"><mml:math id="IM51"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula id="IE50"><mml:math id="IM52"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>&#x02190;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE51"><mml:math id="IM53"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p></sec><sec><title>Poisson Model for Gene Duplications</title><p>To calculate <inline-formula id="IE52"><mml:math id="IM54"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> the duplications observed on a branch are modeled as arising from two Poisson processes. One process describes the number of true positive duplications (corresponding to the actual direction of time along the branch) and the other describes the number of false positive duplications. Let &#x003b1; be a parameter giving the relative frequency of false positives to true positives across all branches of the tree. Then <inline-formula id="IE53"><mml:math id="IM55"><mml:mi>m</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mo>(</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE54"><mml:math id="IM56"><mml:mi>n</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, where &#x003bb; is the expected number of true positives on the branch. We set the total expected number of duplications on the branch from the two Poisson processes to match the actual number observed, <italic>N</italic>. Thus, <inline-formula id="IE55"><mml:math id="IM57"><mml:mi>&#x003bb;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>. The relative rate of false positives to true positives across the whole tree can be estimated from the number conflicting duplications given the maximum parsimony root of the tree. So as not to reward contradictory duplications by creating an expectation for them, we take &#x003b1; to be one tenth of the ratio of the observed conflicting to nonconflicting duplications of the maximum parsimony root. In almost all cases, however, the value of &#x003b1; had no discernible effect on the final probabilities of the model (<xref ref-type="supplementary-material" rid="sup1">supplementary file S1</xref> and fig. S15, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p><p>Bayes&#x02019; rule gives
<disp-formula id="E2"><mml:math id="M2"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula>
where <inline-formula id="IE56"><mml:math id="IM58"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>{</mml:mo><mml:mo>&#x02192;</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02190;</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>o</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The priors are given by <inline-formula id="IE57"><mml:math id="IM59"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula id="IE58"><mml:math id="IM60"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>&#x02190;</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:mi>b</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, where<inline-formula id="IE59"><mml:math id="IM61"><mml:mi/><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula> is the number of branches on an unrooted tree with <inline-formula id="IE60"><mml:math id="IM62"><mml:mi>t</mml:mi></mml:math></inline-formula> taxa. The probability mass function for the Poisson distribution immediately gives <inline-formula id="IE61"><mml:math id="IM63"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02190;</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE62"><mml:math id="IM64"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>|</mml:mo><mml:mo>&#x02192;</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>:
<disp-formula id="E3"><mml:math id="M3"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02190;</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="E4"><mml:math id="M4"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>and,
<disp-formula id="E5"><mml:math id="M5"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02192;</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="E6"><mml:math id="M6"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The branch with the root is more complicated since it actually corresponds to two branches on the rooted tree we are attempting to recover. On these two branches time flows in opposite directions, away from a central root that separates them. We must allow for the <inline-formula id="IE63"><mml:math id="IM65"><mml:mfenced open="&#x02329;" close="&#x0232a;" separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> duplications on the branch to actually correspond to <inline-formula id="IE64"><mml:math id="IM66"><mml:mfenced open="&#x02329;" close="&#x0232a;" separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> duplications on one of the two branches and <inline-formula id="IE65"><mml:math id="IM67"><mml:mfenced open="&#x02329;" close="&#x0232a;" separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> on the other branch (with opposite orientation to the first). The number of false positive duplications, <inline-formula id="IE66"><mml:math id="IM68"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula id="IE67"><mml:math id="IM69"><mml:mi>t</mml:mi></mml:math></inline-formula>, are unknown and therefore must be summed over. Similarly, the location of root could fall at any point along the length of the original branch. If the root were a fraction, <inline-formula id="IE68"><mml:math id="IM70"><mml:mi>x</mml:mi></mml:math></inline-formula>, along the length of the branch then the expected rate of false positive and true positive duplications on that fraction of the branch would be <inline-formula id="IE69"><mml:math id="IM71"><mml:mi>x</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM72"><mml:mi>x</mml:mi><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:math></inline-formula>, respectively, whereas on the other branch the rates would be <inline-formula id="IE71"><mml:math id="IM73"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:math></inline-formula> and <inline-formula id="IE72"><mml:math id="IM74"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:math></inline-formula>. Thus, integrating over the position of the root along the branch and summing over the distribution of the <inline-formula id="IE73"><mml:math id="IM75"><mml:mfenced open="&#x02329;" close="&#x0232a;" separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> duplications between true positives and false positives on the two resulting branches, we find:
<disp-formula id="E7"><label>(2)</label><mml:math id="M7"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>s</mml:mi><mml:mo>;</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>!</mml:mo><mml:mi>t</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Where <inline-formula id="IE74"><mml:math id="IM76"><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mo>,</mml:mo><mml:mo>)</mml:mo><mml:mi/></mml:math></inline-formula>is the beta function.</p><p>The duplications observed in just one species are uninformative as to the location of the root and so should not affect the root probabilities produced by the model. As such, the branch model for terminal branches is modified to only model the number of inward duplications (those supporting the tree minus the species on the terminal branch as a monophyletic clade). The rates <inline-formula id="IE75"><mml:math id="IM77"><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE76"><mml:math id="IM78"><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the observed true positive and false positive rates for inward duplications on the terminal branches for the maximum parsimony root. For the terminal branches, the branch model is:
<disp-formula id="E8"><mml:math id="M8"><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02190;</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>and
<disp-formula id="E9"><mml:math id="M9"><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>The branch-level model takes into account only the duplications observed on a single branch and these probabilities feed into the tree-level model to give the final probabilities for the position of the root (<xref ref-type="fig" rid="msx259-F8">fig. 8</xref>). The behaviour of the branch model is in good agreement with an intuitive understanding of the probabilities that should be assigned to the three possible orientations for a branch given the number of putative duplications observed in either direction (<xref ref-type="fig" rid="msx259-F8">fig. 8<italic>A</italic>&#x02013;<italic>C</italic></xref>). The probability of time flowing to the left/right increases monotonically with the number of putative duplications supporting it. The probability of a branch being a root is highest when the number of putative gene duplications in both directions is the same. Finally, the probability of a branch being a root remains significantly above zero if there is any number of gene duplications in both directions (<xref ref-type="fig" rid="msx259-F8">fig. 8<italic>B</italic> and <italic>C</italic></xref>). This reflects the fact that putative gene duplications supporting the monophyletic nature of both blocks of a bipartition support that bipartition being the root. The fact that there could be a large difference in the number of gene duplications in one direction compared with the other due to different branch lengths on the two sides of the root is accounted for by integrating over the position of the root along the original root branch. Thus, the probability of a branch being a root is&#x02009;&#x0003e;&#x02009;30% when there are 20 duplications in one direction compared with five in the opposite direction (<xref ref-type="fig" rid="msx259-F8">fig. 8<italic>C</italic></xref>). For comparison, the probability of the orientation of the branch being in the direction of the five duplications is vanishingly small (&#x0223c;10<sup>&#x02212;13</sup>). The branch-level probability model thus gives probabilities for each branch taking into account only the duplications observed on that branch. The final probabilities for the root of the tree, taking into account all duplications across the tree are then given by the tree-level model (<xref ref-type="disp-formula" rid="E1">equation (1)</xref>, <xref ref-type="fig" rid="msx259-F8">fig. 8<italic>D</italic> and <italic>E</italic></xref>).
</p><fig id="msx259-F8" orientation="portrait" position="float"><label><sc>Fig</sc>. 8.</label><caption><p>The branch-level probability model employed by STRIDE. These branch-level probabilities are used by the tree probability model to give the overall probabilities for the location of the root of the species tree. (<italic>A</italic>) A single branch in the tree with m/n duplications supporting L/R as monophyletic clades. (<italic>B</italic>) Branch-level model probabilities for position of the root with respect to the branch when m&#x02009;=&#x02009;0 (the model only takes into account duplications on that branch). (<italic>C</italic>) As for B with m&#x02009;=&#x02009;5. (<italic>D</italic>) Hypothetical total number of gene duplication events on the four species phylogeny. One gene duplication event is shared by elephant and dog and two are shared by elephant, dog, and bird. (<italic>E</italic>) The final tree-level model probabilities for the location of the root calculated by STRIDE taking into account all the gene duplication events on all branches in D.</p></caption><graphic xlink:href="msx259f8"/></fig></sec><sec><title>Time-Complexity</title><p>For a set of gene trees containing <inline-formula id="IE77"><mml:math id="IM79"><mml:mi mathvariant="bold-italic">N</mml:mi></mml:math></inline-formula> genes in total from <inline-formula id="IE78"><mml:math id="IM80"><mml:mi mathvariant="bold-italic">n</mml:mi></mml:math></inline-formula> species, the identification of all well-supported gene duplication events can be achieved in time <inline-formula id="IE79"><mml:math id="IM81"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and the calculation of the probabilities in <inline-formula id="IE80"><mml:math id="IM82"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> as described in the following analysis.</p><p>Each gene tree can be analyzed using three traversals of the bipartitions of the gene tree. The first two are preprocessing steps that cache the sets of species either side of each edge in the tree while the third traversal identifies all well-supported gene duplications in the tree (in fact, the second and third traversals can be combined). The three traversals are as follows: With an arbitrary root of the tree, a postorder traversal is performed first to cache, for each edge, the set of species below that edge of the tree, a preorder traversal then caches the set of species above each edge using the data cached in the postorder traversal. This takes <inline-formula id="IE81"><mml:math id="IM83"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for a single gene tree, where <inline-formula id="IE82"><mml:math id="IM84"><mml:mi mathvariant="bold-italic">M</mml:mi></mml:math></inline-formula> is the number of genes in the species tree. For all gene trees this takes <inline-formula id="IE83"><mml:math id="IM85"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. To identify the well-supported gene duplications a tree must be traversed again (visiting the edges in any order). For each edge the algorithm: Determines <inline-formula id="IE84"><mml:math id="IM86"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:math></inline-formula>, the smallest bipartition of the species tree containing the species (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>, Algorithm 1, line 5) in average <inline-formula id="IE85"><mml:math id="IM87"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. For each putative duplication the algorithm checks that at least one gene from each of the expected grandchild clades is present (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>, Algorithm 2, line 5) in average <inline-formula id="IE86"><mml:math id="IM88"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. For each putative duplication, the algorithms checks that each of the actual child clades are subsets of the expected child clades (<xref ref-type="fig" rid="msx259-F7">fig. 7</xref>, Algorithm 2, line 5) in average <inline-formula id="IE87"><mml:math id="IM89"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Thus, the identification of all well-supported gene duplications events in a single gene tree is <inline-formula id="IE88"><mml:math id="IM90"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, and is <inline-formula id="IE89"><mml:math id="IM91"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> for all gene trees since the total number of edges in the set of all gene trees is <inline-formula id="IE90"><mml:math id="IM92"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><p>Having identified the well-supported duplications in all gene trees, the maximum parsimony root can be identified in <inline-formula id="IE91"><mml:math id="IM93"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. In practice, calculating the final probabilities for the location of the root using <xref ref-type="disp-formula" rid="E1">Equations (1)</xref> and <xref ref-type="disp-formula" rid="E7">(2)</xref> is trivial. Although a naive evaluation of <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> requires <inline-formula id="IE92"><mml:math id="IM94"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula>, it can be calculated in time <inline-formula id="IE93"><mml:math id="IM95"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> (<xref rid="msx259-B12" ref-type="bibr">Felsenstein 2004</xref>). For <xref ref-type="disp-formula" rid="E7">Equation (2)</xref>, assuming that the number of duplications per branch of the species tree is proportional to the number of gene families, <inline-formula id="IE94"><mml:math id="IM96"><mml:mfrac bevelled="true"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, then the time-complexity is <inline-formula id="IE95"><mml:math id="IM97"><mml:mi mathvariant="bold-italic">O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p></sec><sec><title>Testing Gene Duplication Event Identification Accuracy</title><p>The gene duplication event identification accuracy was examined on the three simulated data sets, for which the ground truth was known (<xref rid="msx259-B27" ref-type="bibr">Rasmussen and Kellis 2012</xref>; <xref rid="msx259-B3" ref-type="bibr">Boussau et al. 2013</xref>). STRIDE was run as normal using as input the unrooted species tree and the set of unrooted gene trees. For comparison two representative tree reconciliation methods, Notung (<xref rid="msx259-B5" ref-type="bibr">Chen et al. 2000</xref>) and dlcpar_search (<xref rid="msx259-B35" ref-type="bibr">Wu et al. 2014</xref>), were also run on the same data sets. The comparison was not exact since both of these reconciliation methods require a rooted species tree (information not available to STRIDE). Notung was run with the rooted species tree and unrooted gene trees using default parameters and the &#x0201c;&#x02013;root&#x0201d; option, which roots the gene tree on the branch giving the lowest overall reconciliation cost. Dlcpar_search is a more sophisticated tree reconciliation program that aims to give higher precision inference of duplications and losses by also modeling deep coalescence so as to better explain incongruence between the gene tree and the species tree that can arise from incomplete lineage sorting. The program performs a heuristic search for a tree minimizing an overall duplication, loss and coalescence cost. As it also requires that the gene trees be rooted, the companion program &#x0201c;reconroot&#x0201d; was used to first root the gene trees (as recommended, private correspondence) on the branch giving the lowest reconciliation cost when only duplication and loss events are considered. The dlcpar_search method was then run on the rooted species tree and rooted gene trees using default parameters.</p></sec><sec><title>Algorithm Implementation and Availability</title><p>STRIDE is implemented in python. Further information, use instructions, an example data set, and a standalone implementation of the algorithm is available under the University of Oxford Academic Use Licence at <ext-link ext-link-type="uri" xlink:href="https://github.com/davidemms/STRIDE">https://github.com/davidemms/STRIDE</ext-link>, last accessed October 4, 2017. The complete set of gene trees and species trees required to replicate this analysis are provided for download form the Zenodo research data archive at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.581360">https://doi.org/10.5281/zenodo.581360</ext-link>, last accessed October 4, 2017.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>Supplementary Data</label><media xlink:href="msx259_supp.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><title>Acknowledgments</title><p>S.K. is a Royal Society University Research Fellow. This work was supported by the European Union&#x02019;s Horizon 2020 research and innovation program under grant agreement number 637765.</p></ack><ref-list><title>References</title><ref id="msx259-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Aslett</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Aurrecoechea</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Berriman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Brestelli</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Brunk</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>Carrington</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Depledge</surname><given-names>DP</given-names></name>, <name name-style="western"><surname>Fischer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gajria</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>X.</given-names></name></person-group>
<year>2010</year>
<article-title>TriTrypDB: a functional genomic resource for the Trypanosomatidae</article-title>. <source>Nucleic Acids Res.</source><volume>38(suppl_1)</volume>: <fpage>D457</fpage>&#x02013;<lpage>D462</lpage>.<pub-id pub-id-type="pmid">19843604</pub-id></mixed-citation></ref><ref id="msx259-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Berger</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Krompass</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group>
<year>2011</year>
<article-title>Performance, accuracy, and web server for evolutionary placement of short sequence reads under maximum likelihood</article-title>. <source>Syst Biol.</source><volume>60</volume><issue>3</issue>: <fpage>291</fpage>&#x02013;<lpage>302</lpage>.<pub-id pub-id-type="pmid">21436105</pub-id></mixed-citation></ref><ref id="msx259-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Boussau</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Szollosi</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Duret</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Gouy</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tannier</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Daubin</surname><given-names>V.</given-names></name></person-group>
<year>2013</year>
<article-title>Genome-scale coestimation of species and gene trees</article-title>. <source>Genome Res.</source><volume>23</volume><issue>2</issue>: <fpage>323</fpage>&#x02013;<lpage>330</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation></ref><ref id="msx259-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Burki</surname><given-names>F.</given-names></name></person-group>
<year>2014</year>
<article-title>The Eukaryotic Tree of Life from a Global Phylogenomic Perspective</article-title>. <source>Cold Spring Harbor Persp Biol.</source><volume>6</volume><issue>5</issue>: <fpage>a016147.</fpage></mixed-citation></ref><ref id="msx259-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Durand</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Farach-Colton</surname><given-names>M.</given-names></name></person-group>
<year>2000</year>
<article-title>NOTUNG: A program for dating gene duplications and optimizing gene family trees</article-title>. <source>J Comput Biol.</source><volume>7</volume>(<issue>3-4</issue>): <fpage>429</fpage>&#x02013;<lpage>447</lpage>.<pub-id pub-id-type="pmid">11108472</pub-id></mixed-citation></ref><ref id="msx259-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Donoghue</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Mathews</surname><given-names>S.</given-names></name></person-group>
<year>1998</year>
<article-title>Duplicate genes and the root of angiosperms, with an example using phytochrome sequences</article-title>. <source>Mol Phylogenet. Evol.</source><volume>9</volume><issue>3</issue>: <fpage>489</fpage>&#x02013;<lpage>500</lpage>.<pub-id pub-id-type="pmid">9667997</pub-id></mixed-citation></ref><ref id="msx259-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>dos Reis</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Donoghue</surname><given-names>PCJ</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>ZH.</given-names></name></person-group>
<year>2014</year>
<article-title>Neither phylogenomic nor palaeontological data support a Palaeogene origin of placental mammals</article-title>. <source>Biol Lett.</source><volume>10</volume><issue>1</issue>: <fpage>20131003.</fpage><pub-id pub-id-type="pmid">24429684</pub-id></mixed-citation></ref><ref id="msx259-B9"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Dunne</surname><given-names>MP</given-names></name>, <name name-style="western"><surname>Kelly</surname><given-names>S.</given-names></name></person-group>
<year>2017</year> OrthoFiller: utilising data from multiple species to improve the completeness of genome annotations. <italic>bioRxiv</italic>. doi: 10.1101/098566.</mixed-citation></ref><ref id="msx259-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Emms</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Kelly</surname><given-names>S.</given-names></name></person-group>
<year>2015</year>
<article-title>OrthoFinder: solving fundamental biases in whole genome comparisons dramatically improves orthogroup inference accuracy</article-title>. <source>Genome Biol.</source><volume>16</volume><issue>1</issue>:<fpage>157</fpage>.<pub-id pub-id-type="pmid">26243257</pub-id></mixed-citation></ref><ref id="msx259-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group>
<year>1981</year>
<article-title>Evolutionary trees from DNA-sequences: a maximum-likelihood approach</article-title>. <source>J Mol Evol.</source><volume>17</volume><issue>6</issue>: <fpage>368</fpage>&#x02013;<lpage>376</lpage>.<pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation></ref><ref id="msx259-B12"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group>
<year>2004</year>
<source>Inferring phylogenies</source>. 
<publisher-loc>Sunderland (MA</publisher-loc>): 
<publisher-name>Sinauer Associates</publisher-name>.</mixed-citation></ref><ref id="msx259-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Goodstein</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Shu</surname><given-names>SQ</given-names></name>, <name name-style="western"><surname>Howson</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Neupane</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hayes</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Fazo</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Mitros</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Dirks</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Hellsten</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Putnam</surname><given-names>N</given-names></name></person-group>, <etal/><year>2012</year>
<article-title>Phytozome: a comparative platform for green plant genomics</article-title>. <source>Nucleic Acids Res.</source><volume>40</volume>(<issue>Database issue</issue>): <fpage>D1178</fpage>&#x02013;<lpage>D1186</lpage>.<pub-id pub-id-type="pmid">22110026</pub-id></mixed-citation></ref><ref id="msx259-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gorecki</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Eulenstein</surname><given-names>O.</given-names></name></person-group>
<year>2014</year>
<article-title>DrML: probabilistic modeling of gene duplications</article-title>. <source>J Comput Biol.</source><volume>21</volume><issue>1</issue>: <fpage>89</fpage>&#x02013;<lpage>98</lpage>.<pub-id pub-id-type="pmid">24073895</pub-id></mixed-citation></ref><ref id="msx259-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gorecki</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Eulenstein</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Tiuryn</surname><given-names>J.</given-names></name></person-group>
<year>2013</year>
<article-title>Unrooted Tree Reconciliation: A Unified Approach</article-title>. <source>IEEE-ACM Trans Comput Biol Bioinformatics</source><volume>10</volume><issue>2</issue>: <fpage>522</fpage>&#x02013;<lpage>536</lpage>.</mixed-citation></ref><ref id="msx259-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gorecki</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Tiuryn</surname><given-names>J.</given-names></name></person-group>
<year>2007</year>
<article-title>Inferring phylogeny from whole genomes</article-title>. <source>Bioinformatics</source><volume>23</volume><issue>2</issue>: <fpage>E116</fpage>&#x02013;<lpage>E122</lpage>.<pub-id pub-id-type="pmid">17237078</pub-id></mixed-citation></ref><ref id="msx259-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Bollback</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>AM.</given-names></name></person-group>
<year>2002</year>
<article-title>Inferring the root of a phylogenetic tree</article-title>. <source>Syst Biol.</source><volume>51</volume><issue>1</issue>: <fpage>32</fpage>&#x02013;<lpage>43</lpage>.<pub-id pub-id-type="pmid">11943091</pub-id></mixed-citation></ref><ref id="msx259-B18"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Huerta-Cepas</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Serra</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Bork</surname><given-names>P.</given-names></name></person-group>
<year>2016</year>
<article-title>ETE 3: Reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol.</source><volume>33</volume><issue>6</issue>: <fpage>1635</fpage>&#x02013;<lpage>1638</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation></ref><ref id="msx259-B19"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>DH</given-names></name>, <name name-style="western"><surname>Scornavacca</surname><given-names>C.</given-names></name></person-group>
<year>2012</year>
<article-title>Dendroscope 3: an interactive tool for rooted phylogenetic trees and networks</article-title>. <source>Syst Biol.</source><volume>61</volume><issue>6</issue>: <fpage>1061</fpage>&#x02013;<lpage>1067</lpage>.<pub-id pub-id-type="pmid">22780991</pub-id></mixed-citation></ref><ref id="msx259-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jarvis</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Mirarab</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Aberer</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Houde</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ho</surname><given-names>SYW</given-names></name>, <name name-style="western"><surname>Faircloth</surname><given-names>BC</given-names></name>, <name name-style="western"><surname>Nabholz</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Howard</surname><given-names>JT</given-names></name></person-group>, <etal/><year>2014</year>
<article-title>Whole-genome analyses resolve early branches in the tree of life of modern birds</article-title>. <source>Science</source><volume>346</volume><issue>6215</issue>: <fpage>1320</fpage>&#x02013;<lpage>1331</lpage>.<pub-id pub-id-type="pmid">25504713</pub-id></mixed-citation></ref><ref id="msx259-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Standley</surname><given-names>DM.</given-names></name></person-group>
<year>2013</year>
<article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol.</source><volume>30</volume><issue>4</issue>: <fpage>772</fpage>&#x02013;<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation></ref><ref id="msx259-B22"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kuck</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Mayer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wagele</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Misof</surname><given-names>B.</given-names></name></person-group>
<year>2012</year>
<article-title>Long branch effects distort maximum likelihood phylogenies in simulations despite selection of the correct model</article-title>. <source>PLoS One</source><volume>7(5)</volume>:e36593.</mixed-citation></ref><ref id="msx259-B23"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Larsson</surname><given-names>A.</given-names></name></person-group>
<year>2014</year>
<article-title>AliView: a fast and lightweight alignment viewer and editor for large datasets</article-title>. <source>Bioinformatics</source><volume>30</volume><issue>22</issue>: <fpage>3276</fpage>&#x02013;<lpage>3278</lpage>.<pub-id pub-id-type="pmid">25095880</pub-id></mixed-citation></ref><ref id="msx259-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Nguyen</surname><given-names>LT</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>HA</given-names></name>, <name name-style="western"><surname>von Haeseler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Minh</surname><given-names>BQ.</given-names></name></person-group>
<year>2015</year>
<article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>. <source>Mol Biol Evol.</source><volume>32</volume><issue>1</issue>: <fpage>268</fpage>&#x02013;<lpage>274</lpage>.<pub-id pub-id-type="pmid">25371430</pub-id></mixed-citation></ref><ref id="msx259-B25"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Parfrey</surname><given-names>LW</given-names></name>, <name name-style="western"><surname>Lahr</surname><given-names>DJG</given-names></name>, <name name-style="western"><surname>Knoll</surname><given-names>AH</given-names></name>, <name name-style="western"><surname>Katz</surname><given-names>LA.</given-names></name></person-group>
<year>2011</year>
<article-title>Estimating the timing of early eukaryotic diversification with multigene molecular clocks</article-title>. <source>Proc Natl Acad Sci U S A.</source><volume>108</volume><issue>33</issue>: <fpage>13624</fpage>&#x02013;<lpage>13629</lpage>.<pub-id pub-id-type="pmid">21810989</pub-id></mixed-citation></ref><ref id="msx259-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Brinkmann</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lavrov</surname><given-names>DV</given-names></name>, <name name-style="western"><surname>Littlewood</surname><given-names>DTJ</given-names></name>, <name name-style="western"><surname>Manuel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>W&#x000f6;rheide</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Baurain</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Penny</surname><given-names>D.</given-names></name></person-group>
<year>2011</year>
<article-title>Resolving difficult phylogenetic questions: why more sequences are not enough</article-title>. <source>PLoS Biol.</source><volume>9</volume><issue>3</issue>: <fpage>e1000602</fpage>.<pub-id pub-id-type="pmid">21423652</pub-id></mixed-citation></ref><ref id="msx259-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Rasmussen</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Kellis</surname><given-names>M.</given-names></name></person-group>
<year>2012</year>
<article-title>Unified modeling of gene duplication, loss, and coalescence using a locus tree</article-title>. <source>Genome Res.</source><volume>22</volume><issue>4</issue>: <fpage>755</fpage>&#x02013;<lpage>765</lpage>.<pub-id pub-id-type="pmid">22271778</pub-id></mixed-citation></ref><ref id="msx259-B40"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ruhfel</surname><given-names>BR</given-names></name>, <name name-style="western"><surname>Gitzendanner</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Soltis</surname><given-names>PS</given-names></name>, <name name-style="western"><surname>Soltis</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Burleigh</surname><given-names>JG.</given-names></name></person-group>
<year>2014</year>
<article-title>From algae to angiosperms-inferring the phylogeny of green plants (Viridiplantae) from 360 plastid genomes</article-title>. <source>BMC Evol Biol.</source><volume>14</volume>: <fpage>23</fpage>.<pub-id pub-id-type="pmid">24533922</pub-id></mixed-citation></ref><ref id="msx259-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Salichos</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Rokas</surname><given-names>A.</given-names></name></person-group>
<year>2013</year>
<article-title>Inferring ancient divergences requires genes with strong phylogenetic signals</article-title>. <source>Nature</source><volume>497</volume><issue>7449</issue>: <fpage>327</fpage>&#x02013;<lpage>331</lpage>.<pub-id pub-id-type="pmid">23657258</pub-id></mixed-citation></ref><ref id="msx259-B29"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Simmons</surname><given-names>MP</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Nixon</surname><given-names>KC.</given-names></name></person-group>
<year>2000</year>
<article-title>Phylogeny reconstruction using duplicate genes</article-title>. <source>Mol Biol Evol.</source><volume>17</volume><issue>4</issue>: <fpage>469</fpage>&#x02013;<lpage>473</lpage>.<pub-id pub-id-type="pmid">10742039</pub-id></mixed-citation></ref><ref id="msx259-B31"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Sz&#x000f6;ll&#x00151;si</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Tannier</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Daubin</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Boussau</surname><given-names>B.</given-names></name></person-group>
<year>2015</year>
<article-title>The inference of gene trees with species trees</article-title>. <source>Syst Biol.</source><volume>64</volume><issue>1</issue>: <fpage>E42</fpage>&#x02013;<lpage>E62</lpage>.<pub-id pub-id-type="pmid">25070970</pub-id></mixed-citation></ref><ref id="msx259-B32"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tange</surname><given-names>O.</given-names></name></person-group>
<year>2011</year>
<article-title>GNU Parallel&#x02014;the command-line power tool. <italic>;login: The USENIX Mag</italic></article-title>. <volume>36</volume>: <fpage>42</fpage>&#x02013;<lpage>47</lpage>.</mixed-citation></ref><ref id="msx259-B33"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Veeckman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ruttink</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Vandepoele</surname><given-names>K.</given-names></name></person-group>
<year>2016</year>
<article-title>Are we there yet? Reliably estimating the completeness of plant genome sequences</article-title>. <source>Plant Cell</source><volume>28</volume><issue>8</issue>: <fpage>1759</fpage>&#x02013;<lpage>1768</lpage>.<pub-id pub-id-type="pmid">27512012</pub-id></mixed-citation></ref><ref id="msx259-B34"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Williams</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Heaps</surname><given-names>SE</given-names></name>, <name name-style="western"><surname>Cherlin</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Nye</surname><given-names>TMW</given-names></name>, <name name-style="western"><surname>Boys</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Embley</surname><given-names>TM.</given-names></name></person-group>
<year>2015</year>
<article-title>New substitution models for rooting phylogenetic trees</article-title>. <source>Philos Trans Roy Soc B Biol Sci.</source><volume>370</volume><issue>1678</issue>: <fpage>20140336.</fpage></mixed-citation></ref><ref id="msx259-B35"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>YC</given-names></name>, <name name-style="western"><surname>Rasmussen</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Bansal</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Kellis</surname><given-names>M.</given-names></name></person-group>
<year>2014</year>
<article-title>Most parsimonious reconciliation in the presence of gene duplication, loss, and deep coalescence using labeled coalescent trees</article-title>. <source>Genome Res.</source><volume>24</volume><issue>3</issue>: <fpage>475</fpage>&#x02013;<lpage>486</lpage>.<pub-id pub-id-type="pmid">24310000</pub-id></mixed-citation></ref><ref id="msx259-B36"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Yates</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Akanni</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Amode</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Barrell</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Billis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Carvalho-Silva</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Cummins</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Clapham</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gil</surname><given-names>L</given-names></name></person-group>, <etal/><year>2016</year>
<article-title>Ensembl 2016</article-title>. <source>Nucleic Acids Res.</source><volume>44</volume>(<issue>D1</issue>): <fpage>D710</fpage>&#x02013;<lpage>D716</lpage>.<pub-id pub-id-type="pmid">26687719</pub-id></mixed-citation></ref></ref-list></back></article>