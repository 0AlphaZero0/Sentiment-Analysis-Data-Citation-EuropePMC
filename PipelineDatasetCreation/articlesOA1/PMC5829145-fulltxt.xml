<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">J Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">J Math Biol</journal-id><journal-title-group><journal-title>Journal of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0303-6812</issn><issn pub-type="epub">1432-1416</issn><publisher><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5829145</article-id><article-id pub-id-type="publisher-id">1167</article-id><article-id pub-id-type="doi">10.1007/s00285-017-1167-9</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>The combinatorics of discrete time-trees: theory and open problems</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6299-8249</contrib-id><name><surname>Gavryushkin</surname><given-names>Alex</given-names></name><address><email>alex@gavruskin.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9406-730X</contrib-id><name><surname>Whidden</surname><given-names>Chris</given-names></name><address><email>cwhidden@fredhutch.org</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id><name><surname>Matsen</surname><given-names>Frederick A.</given-names><suffix>IV</suffix></name><address><email>matsen@fredhutch.org</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution>Department of Biosystems Science and Engineering, </institution><institution>ETH Z&#x000fc;rich, </institution></institution-wrap>4058 Basel, Switzerland </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 1622</institution-id><institution-id institution-id-type="GRID">grid.270240.3</institution-id><institution>Program in Computational Biology, </institution><institution>Fred Hutchinson Cancer Research Center, </institution></institution-wrap>Seattle, WA 98109 USA </aff></contrib-group><pub-date pub-type="epub"><day>29</day><month>7</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>7</month><year>2017</year></pub-date><pub-date pub-type="ppub"><year>2018</year></pub-date><volume>76</volume><issue>5</issue><fpage>1101</fpage><lpage>1121</lpage><history><date date-type="received"><day>29</day><month>12</month><year>2016</year></date><date date-type="rev-recd"><day>14</day><month>7</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">A <italic>time-tree</italic> is a rooted phylogenetic tree such that all internal nodes are equipped with absolute divergence dates and all leaf nodes are equipped with sampling dates. Such time-trees have become a central object of study in phylogenetics but little is known about the parameter space of such objects. Here we introduce and study a hierarchy of discrete approximations of the space of time-trees from the graph-theoretic and algorithmic point of view. One of the basic and widely used phylogenetic graphs, the <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq1.gif"/></alternatives></inline-formula> graph, is the roughest approximation and bottom level of our hierarchy. More refined approximations discretize the relative timing of evolutionary divergence and sampling dates. We study basic graph-theoretic questions for these graphs, including the size of neighborhoods, diameter upper and lower bounds, and the problem of finding shortest paths. We settle many of these questions by extending the concept of graph grammars introduced by Sleator, Tarjan, and Thurston to our graphs. Although time values greatly increase the number of possible trees, we show that 1-neighborhood sizes remain linear, allowing for efficient local exploration and construction of these graphs. We also obtain upper bounds on the <italic>r</italic>-neighborhood sizes of these graphs, including a smaller bound than was previously known for <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq2.gif"/></alternatives></inline-formula>. Our results open up a number of possible directions for theoretical investigation of graph-theoretic and algorithmic properties of the time-tree graphs. We discuss the directions that are most valuable for phylogenetic applications and give a list of prominent open problems for those applications. In particular, we conjecture that the split theorem applies to shortest paths in time-tree graphs, a property not shared in the general <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq3.gif"/></alternatives></inline-formula> case.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Phylogenetic inference methods</kwd><kwd>Phylogenetic time-tree</kwd><kwd>Nearest neighbor interchange graph</kwd></kwd-group><kwd-group xml:lang="--"><title>Mathematics Subject Classification</title><kwd>92B05</kwd><kwd>68R10</kwd><kwd>68Q25</kwd></kwd-group><funding-group><award-group><funding-source><institution>Marsden Fund of the Royal Society of New Zealand</institution></funding-source><award-id>UOA1324</award-id></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1223057</award-id><award-id>1564137</award-id><principal-award-recipient><name><surname>Matsen</surname><given-names>Frederick A.</given-names><suffix>IV</suffix></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Springer-Verlag GmbH Germany, part of Springer Nature 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">The last 10 years have seen an explosion of methods using sequence data to infer demographic model parameters by sampling phylogenetic trees (Kuhner et&#x000a0;al. <xref ref-type="bibr" rid="CR20">1995</xref>, <xref ref-type="bibr" rid="CR21">1998</xref>, <xref ref-type="bibr" rid="CR19">2000</xref>; Beerli and Felsenstein <xref ref-type="bibr" rid="CR3">2001</xref>; Kuhner <xref ref-type="bibr" rid="CR18">2006</xref>; Drummond et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2002</xref>, <xref ref-type="bibr" rid="CR9">2005</xref>, <xref ref-type="bibr" rid="CR7">2006</xref>; Minin et&#x000a0;al. <xref ref-type="bibr" rid="CR27">2008</xref>). These methods have had an especially significant impact in inferring historical epidemic spreading rates of viruses and other evolutionary parameters of quickly evolving organisms. For example, such methods can be used to infer time to a most recent common ancestor of human HIV group M viruses (Worobey et&#x000a0;al. <xref ref-type="bibr" rid="CR39">2008</xref>; Baele et&#x000a0;al. <xref ref-type="bibr" rid="CR2">2013</xref>). Thus the <italic>time-tree</italic>&#x02014;a rooted phylogenetic tree with all internal nodes equipped with absolute divergence dates&#x02014;has become an important object of investigation. This interpretation of continuous parameters for time-trees stands in contrast to that for classical phylogenetic trees, in which branch lengths quantify the amount of molecular substitution along a branch. Posterior distributions on both time-trees and classical trees are estimated using Markov chain Monte Carlo (MCMC) (Mau and Newton <xref ref-type="bibr" rid="CR26">1997</xref>; Yang and Rannala <xref ref-type="bibr" rid="CR40">1997</xref>; Drummond et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2002</xref>), but with different transition kernels. This paper builds a foundation for a mathematical understanding of time-trees, such as understanding convergence properties of MCMC thereupon.</p><p id="Par3">Although Markov chain Monte Carlo (MCMC) is guaranteed to sample from the true posterior given an infinite run time, it is important to understand mixing properties of the chain, which determine sampling properties for a finite time run. The mixing properties of phylogenetic MCMC have, in the classical unrooted case, been a major area of research from both the theoretical perspective of mixing time bounds (Mossel and Vigoda <xref ref-type="bibr" rid="CR28">2005</xref>, <xref ref-type="bibr" rid="CR29">2006</xref>; &#x00160;tefankovi&#x0010d; and Vigoda <xref ref-type="bibr" rid="CR36">2011</xref>; Spade et&#x000a0;al. <xref ref-type="bibr" rid="CR35">2014</xref>) and the practical perspective of performance on real data (Beiko et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2006</xref>; Ronquist et&#x000a0;al. <xref ref-type="bibr" rid="CR31">2006</xref>; Lakner et&#x000a0;al. <xref ref-type="bibr" rid="CR22">2008</xref>; Whidden and Matsen&#x000a0;IV <xref ref-type="bibr" rid="CR37">2015</xref>). This research has focused on mixing over the set of discrete phylogenetic tree graph structures, because mixing over these discrete structures is the primary obstruction to MCMC convergence.</p><p id="Par4">Time-trees use different MCMC transition kernels than do classical phylogenetic trees. The discrete component of MCMC moves between classical phylogenetic trees are typically determined by their discretization. For example, common moves include <italic>subtree prune and regraft</italic> (SPR) moves, which cut a subtree off and reattach it at another location, and the subset of SPR moves called <italic>nearest-neighbor interchange</italic> (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq4.gif"/></alternatives></inline-formula>) moves. Classically, these are applied without reference to branch lengths. On the other hand, the discrete component of moves between time-trees are defined also in terms of their timing information. For example, Hohna et&#x000a0;al. (<xref ref-type="bibr" rid="CR16">2008</xref>) show that SPR-like moves that reattach subtrees at the same divergence time are more effective than ones that do not. This sort of move cannot be expressed using the type of discretization used thus far in which all continuous information is lost, and so the previous work on MCMC mixing cannot be applied.</p><p id="Par5">However, one can discretize time-trees in a way that does preserve some of the information. For example, by retaining the order of internal nodes backward in time one obtains a so-called <italic>ranked tree</italic> (Semple and Steel <xref ref-type="bibr" rid="CR33">2003</xref>). To make a less rough approximation of a time-tree, one can allow the time periods between nodes of the tree to take only finitely many possible values (&#x000c5;kerborg et&#x000a0;al. <xref ref-type="bibr" rid="CR1">2008</xref>). This results in an object we call a <italic>discrete time-tree</italic>. The graph built on such trees provides a discretization of the space of time-trees, which we call a <italic>discrete time-tree graph</italic>. By a <italic>graph</italic> on a set of trees here and throughout the paper we mean a graph consisting of trees as vertices, with edges connecting pairs of trees that are identical after a given tree rearrangement operation (Semple and Steel <xref ref-type="bibr" rid="CR33">2003</xref>). This graph-theoretic terminology is convenient and has become widespread in recent years (Spade et&#x000a0;al. <xref ref-type="bibr" rid="CR35">2014</xref>; Whidden and Matsen&#x000a0;IV <xref ref-type="bibr" rid="CR37">2015</xref>; Gavryushkin and Drummond <xref ref-type="bibr" rid="CR13">2016</xref>). A sequence of time-trees sampled using MCMC projects to a collection of movements on a graph in which each vertex is a discrete time-tree and each edge is a discrete version of an MCMC move on time-trees.</p><p id="Par6">Although inferential algorithms have applied MCMC on time-trees for over a decade, and graphs corresponding to discretizations of unrooted tree space have been studied for even longer, we are not aware of any work defining graphs from discretization of time-tree spaces or analyzing random walks thereupon. Such a theory would provide a foundation for understanding the behavior of MCMC algorithms on time-trees, as has been done previously for graphs associated with unrooted phylogenetic trees. Up to now, the only discretization of time-tree space is that of ranked trees (Page <xref ref-type="bibr" rid="CR30">1991</xref>; Ford et&#x000a0;al. <xref ref-type="bibr" rid="CR11">2009</xref>; Lambert and Stadler <xref ref-type="bibr" rid="CR23">2013</xref>), and the corresponding graphs have not been studied.</p><p id="Par7">In this paper we initiate the mathematical study of discrete time-tree graphs, obtain basic geometric and graph-theoretic results, and compare these results to those in the classical phylogenetic setting. In particular, we focus on ranked trees, discrete time-trees (as defined above), and the ultrametric versions of those types of trees. We establish size bounds for neighborhoods and diameters in these tree spaces and show how those bounds can be used to develop efficient tree search algorithms such as MCMC. The importance of these basic geometric characteristics in phylogenetics and other areas of evolutionary biology is highlighted in Huber et&#x000a0;al. (<xref ref-type="bibr" rid="CR17">2011</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Time-tree on 6 leaves. Time is measured by non-negative real numbers. If all times are integers, the tree is a discrete time-tree</p></caption><graphic xlink:href="285_2017_1167_Fig1_HTML" id="MO1"/></fig>
</p></sec><sec id="Sec2"><title>Technical introduction</title><p id="Par8">Throughout the paper by a (phylogenetic) <italic>tree</italic> we mean a rooted binary tree with designated leaves, that is, an undirected acyclic graph with the following properties: (1) all nodes have degree 1, 2, or 3; (2) there exists exactly one node of degree 2, this node is called the <italic>root</italic> of the tree; (3) all nodes of degree 1 are labeled by distinct identifiers, these nodes are called <italic>leaves</italic> or <italic>taxa</italic> (singular <italic>taxon</italic>). The <italic>parent</italic> of a node <italic>x</italic> in a tree is the unique node <italic>y</italic> that is both adjacent to <italic>x</italic> and closer to the root of the tree than <italic>x</italic>. Every node of a tree has a parent except for the root, and is called the <italic>child</italic> of that parent.</p><p id="Par9">We fix the number of leaves of the trees and denote this number by <italic>n</italic> throughout the paper. We also assume that each tree with <italic>n</italic> leaves uses the same fixed set of <italic>n</italic> labels to mark the leaves. Hence, we say that two trees are <italic>isomorphic</italic> if they are isomorphic as graphs and the isomorphism maps leaves marked by the same label to each other. We do not distinguish between isomorphic trees, i.e. we <italic>identify</italic> them.</p><p id="Par10">By a <italic>time-tree</italic> (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>) we mean a phylogenetic tree with an absolute time associated with every node of the tree so that the time strictly increases along every path from a leaf to the root: for internal nodes the time is interpreted as (typically estimated) divergence time and for leaves it is the (typically known) sampling time. By &#x0201c;absolute&#x0201d; we clarify that these are not relative times, but rather actual times that can be put on a calendar. We assume that time progresses backward, from the leaves to the root.</p><p id="Par11">A <italic>discrete time-tree</italic> is a tree such that all its nodes are assigned distinct times from the set of non-negative integers and every node has a smaller time than its parent (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Note that this implies that for every pair of nodes <italic>x</italic>,&#x000a0;<italic>y</italic> if the shortest path from the root to <italic>x</italic> passes through <italic>y</italic> then the time of <italic>y</italic> is greater than the time of <italic>x</italic>. Each node is associated with a type of event: internal nodes represent divergence events, while leaf nodes represent the sampling of new taxa. The <italic>rank</italic> of a node is the number of nodes in the tree with strictly smaller time. We say that a pair of nodes <italic>x</italic>,&#x000a0;<italic>y</italic> of a discrete time-tree is an <italic>event interval</italic> if there exists no node <italic>z</italic> such that the time of <italic>z</italic> is between the time of <italic>x</italic> and <italic>y</italic>. Hence, an event interval is an interval between two divergence events, a taxon and a divergence event, or two taxa. Note that taxon events can be younger than divergence nodes, i.e. when the sampling time precedes divergence events on the tree. The difference between the times of <italic>x</italic> and <italic>y</italic> is called the <italic>length</italic> of the interval <italic>x</italic>,&#x000a0;<italic>y</italic>. We identify two discrete time-trees if they are isomorphic as trees and the isomorphism preserves ranks of the nodes as well as event interval lengths.</p><p id="Par12">We are now ready to introduce a hierarchy of discrete time-trees. At the bottom level of our hierarchy is the well-known <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq5.gif"/></alternatives></inline-formula> graph, which does not have timing information. <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq6.gif"/></alternatives></inline-formula> is a graph with the vertices being all trees on <italic>n</italic> leaves. Two trees <italic>T</italic> and <italic>R</italic> are adjacent in <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq7.gif"/></alternatives></inline-formula> if there exists an edge <italic>e</italic> in <italic>T</italic> and an edge <italic>f</italic> in <italic>R</italic> such that both edges are not adjacent to a leaf and the graph obtained from <italic>T</italic> by shrinking <italic>e</italic> to a vertex is isomorphic to the graph obtained from <italic>R</italic> by shrinking <italic>f</italic>. We denote this graph by <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_0$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq8.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq9.gif"/></alternatives></inline-formula> stands for &#x0201c;discrete time-trees&#x0201d;.<fig id="Fig2"><label>Fig. 2</label><caption><p>All possible moves performed on intervals <italic>I</italic> and <italic>J</italic>. Assuming that the length of every event interval is either 1 or 2, the outer trees are all possible neighbors in <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq10.gif"/></alternatives></inline-formula> of the tree in the middle obtained by moves performed on intervals <italic>I</italic> and <italic>J</italic>. The trees on the right are obtained by moves performed on interval <italic>I</italic> and those on the left on <italic>J</italic>
</p></caption><graphic xlink:href="285_2017_1167_Fig2_HTML" id="MO2"/></fig>
</p><p id="Par13">The following graph <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq11.gif"/></alternatives></inline-formula> forms the level <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m &#x0003e; 0$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq12.gif"/></alternatives></inline-formula> of the hierarchy. The set of vertices of the graph is the set of all discrete time-trees on <italic>n</italic> leaves such that every event interval has its length not greater than <italic>m</italic>. Two trees <italic>T</italic> and <italic>R</italic> are adjacent in <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq13.gif"/></alternatives></inline-formula> if <italic>R</italic> can be obtained from <italic>T</italic> by one of three operations: a <italic>length move performed on interval</italic>
<italic>I</italic>, <italic>swapping the rank of two nodes</italic>
<italic>x</italic>
<italic>and</italic>
<italic>y</italic>
<italic>on interval</italic>
<italic>I</italic> or an <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq14.gif"/></alternatives></inline-formula>
<italic>move performed on interval</italic>
<italic>I</italic> (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). A length move changes the length of <italic>I</italic> by 1. Swapping the rank of two nodes swaps the times of the nodes; such a swap is only possible when the nodes bound an event interval <italic>I</italic> of length 1. <italic>R</italic> can be obtained from <italic>T</italic> by an <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq15.gif"/></alternatives></inline-formula> move if there exist event intervals <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_T$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_R$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq17.gif"/></alternatives></inline-formula> of length 1 in <italic>T</italic> and <italic>R</italic>, respectively, such that the graphs obtained by shrinking <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_T$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>I</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_R$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq19.gif"/></alternatives></inline-formula> to vertices are isomorphic and the isomorphism preserves the lengths of the event intervals. In other words, by going from one tree to an adjacent tree in the <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq20.gif"/></alternatives></inline-formula> graph we can either change the length of one event interval by one unit, swap the rank of two nodes bounding an event interval of minimal length, or send the length of an event interval of minimal length down to zero and then resolve the multifurcation to either of the two possible trees. In the latter case, the new interval is of minimal length. See Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> for an example of the full variety of possible moves.<fig id="Fig3"><label>Fig. 3</label><caption><p>Trees <italic>T</italic> and <italic>R</italic> are at <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_2$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq21.gif"/></alternatives></inline-formula> distance 3. To move from <italic>T</italic> to <italic>R</italic> in <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_2$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq22.gif"/></alternatives></inline-formula>, one must decrease the length of interval <italic>I</italic>, swap the ranks of nodes <italic>A</italic> and <italic>C</italic> bounding interval <italic>J</italic>, and perform an <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq23.gif"/></alternatives></inline-formula> move on interval <italic>K</italic>, resolving nodes <italic>C</italic> and <italic>D</italic>
</p></caption><graphic xlink:href="285_2017_1167_Fig3_HTML" id="MO3"/></fig>
</p><p id="Par14">Note that <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_0$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq24.gif"/></alternatives></inline-formula> can be obtained from <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_1$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq25.gif"/></alternatives></inline-formula> by &#x0201c;forgetting&#x0201d; ranks and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_1$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq26.gif"/></alternatives></inline-formula>&#x02014;from <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq27.gif"/></alternatives></inline-formula> by forgetting lengths. In general, the graph structure for <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m &#x0003e; 1$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq28.gif"/></alternatives></inline-formula> can be understood by considering all four-tree diagrams as the four trees on the right in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> and introducing an extra layer of nodes in every tail adjacent to the <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq29.gif"/></alternatives></inline-formula> triangle.</p><p id="Par15">This hierarchy can be seen as a set of discrete refinements of the full space of phylogenetic time-trees, where event intervals can take an arbitrary real value. Indeed, if we allow the lengths of event intervals to take every possible non-negative real value and impose the Euclidean metric on trees with the same ranked topology, then we get the <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="italic">&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq30.gif"/></alternatives></inline-formula>-space introduced by Gavryushkin and Drummond (<xref ref-type="bibr" rid="CR13">2016</xref>). In this case, <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_1$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq31.gif"/></alternatives></inline-formula> is the graph with the vertices being the orthants of <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="italic">&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq32.gif"/></alternatives></inline-formula>-space and the adjacency relation being the relation of &#x0201c;have a shared facet of co-dimension 1.&#x0201d; Similarly <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_0$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq33.gif"/></alternatives></inline-formula> is the adjacency graph on the orthants of BHV space (Billera et&#x000a0;al. <xref ref-type="bibr" rid="CR5">2001</xref>).</p><p id="Par16">The <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq34.gif"/></alternatives></inline-formula> graph on ultrametric trees, that is the set of trees such that each leaf has the same time, is denoted by <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtTu}_m$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi mathvariant="normal">DtTu</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq35.gif"/></alternatives></inline-formula>. The <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_1$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq36.gif"/></alternatives></inline-formula> graph is denoted by <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq37.gif"/></alternatives></inline-formula> and called the <italic>ranked</italic>
<inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq38.gif"/></alternatives></inline-formula> graph; on ultrametric trees we will denote it <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq39.gif"/></alternatives></inline-formula>. The <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm R$$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="normal">R</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq40.gif"/></alternatives></inline-formula> in <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq41.gif"/></alternatives></inline-formula> stands for <italic>ranked</italic> and not for rooted. We emphasize that although this is the <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq42.gif"/></alternatives></inline-formula>
<italic>graph</italic>, <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq43.gif"/></alternatives></inline-formula>
<italic>moves</italic> can be applied to trees in any of the spaces considered (under appropriate conditions). For simplicity, we use the generic identifier <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq44.gif"/></alternatives></inline-formula> to refer to a <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq45.gif"/></alternatives></inline-formula> with an arbitrary <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m &#x0003e; 1$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq46.gif"/></alternatives></inline-formula>.</p><p id="Par17">A graph can also be seen as a metric space where the distance is given by the length of a shortest path, so we will refer to <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq47.gif"/></alternatives></inline-formula> and other graphs introduced above as both, in agreement with Semple and Steel (<xref ref-type="bibr" rid="CR33">2003</xref>).</p></sec><sec id="Sec3"><title>Geometry and complexity of discrete time-trees</title><p id="Par18">We begin by considering the shortest path distance on the graphs. It is well-known that computing distances is NP-hard in <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq48.gif"/></alternatives></inline-formula> (Dasgupta et&#x000a0;al. <xref ref-type="bibr" rid="CR6">2000</xref>). Hence the following question is natural.</p><sec id="FPar1"><title>Problem 1</title><p id="Par19">What is the complexity of computing the distance between two discrete time-trees?</p><p>Although this problem remains open, we make progress towards the solution by establishing several geometric and algorithmic properties of these graphs. First, we demonstrate in the following example that even for caterpillar trees the complexity cannot be derived from that of <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M98"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq49.gif"/></alternatives></inline-formula> distance. A <italic>caterpillar tree</italic> (sometimes called a <italic>ladder tree</italic>) has all leaves connected to a single path from the root. A <italic>cherry</italic> is a pair of taxa adjacent to a common internal node in the tree.</p></sec><sec id="FPar2"><title>Example 2</title><p id="Par21">(see Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) Let <italic>T</italic> be the ultrametric caterpillar tree denoted <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$((((((1, 2), 3), 4), 5), 6), 7)$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq50.gif"/></alternatives></inline-formula> in Newick notation (Felsenstein et&#x000a0;al. <xref ref-type="bibr" rid="CR10">1990</xref>) and <italic>R</italic> be the ultrametric tree ((((((1,&#x000a0;4),&#x000a0;5),&#x000a0;6),&#x000a0;2),&#x000a0;3),&#x000a0;7). Then a shortest <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M102"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq51.gif"/></alternatives></inline-formula> path is given by first making a cherry (2,&#x000a0;3), then moving the cherry up to the split <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1456 \mid 7$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mn>1456</mml:mn><mml:mo>&#x02223;</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq52.gif"/></alternatives></inline-formula>, and then resolving the cherry back. In <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq53.gif"/></alternatives></inline-formula> this path is not shortest, and one shortest path moves the parents of 2 and 3 up independently.</p><p>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Shortest paths in <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq54.gif"/></alternatives></inline-formula> may not be shortest in <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq55.gif"/></alternatives></inline-formula>
</p></caption><graphic xlink:href="285_2017_1167_Fig4_HTML" id="MO4"/></fig>
</p><p>A set of trees <italic>A</italic> is called <italic>convex</italic> if for every pair of trees from <italic>A</italic>, there exists a shortest path between them such that every tree on the path belongs to <italic>A</italic>. Example&#x000a0;<xref ref-type="sec" rid="FPar2">2</xref> can be generalized to show that the set of trees of the form <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\ldots (1, i_2), \ldots , i_{n-1}), n)$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq56.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{i_2, \ldots , i_{n-1}\} = \{2, \ldots , n-1\}$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq57.gif"/></alternatives></inline-formula>, is convex in <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq58.gif"/></alternatives></inline-formula> and is not convex in <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M118"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq59.gif"/></alternatives></inline-formula>. Indeed, the example shows that if two leaves have to be moved up, they can be moved independently along a shortest path. The generalization of this statement to an arbitrary number of leaves implies convexity in <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M120"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq60.gif"/></alternatives></inline-formula>, while the need to group leaves in <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M122"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq61.gif"/></alternatives></inline-formula> as in the previous example shows non-convexity in <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M124"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq62.gif"/></alternatives></inline-formula> space. This basic difference in the structure of the two graphs suggests that the complexity of computing the distance is likely to be different.</p><p>We proceed by establishing basic geometric properties of discrete time-trees.</p></sec><sec id="Sec4"><title>Sizes of neighborhoods</title><p id="Par25">We first bound the number of trees in each graph. As expected, times greatly expand the size of the graphs.</p><sec id="FPar3"><title>Lemma 3</title><p id="Par26">(see Semple and Steel (<xref ref-type="bibr" rid="CR33">2003</xref>)) Let |<italic>V</italic>| be the number of vertices in the graph, then |<italic>V</italic>| is equal to<disp-formula id="Equ3"><graphic xlink:href="285_2017_1167_Equ3_HTML.gif" position="anchor"/></disp-formula>
</p></sec><sec id="FPar4"><title>Proof</title><p id="Par27">The proof for <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M126"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq63.gif"/></alternatives></inline-formula> can be found in Semple and Steel (<xref ref-type="bibr" rid="CR33">2003</xref>). The rest follow using similar arguments. <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M128"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq64.gif"/></alternatives></inline-formula>
</p><p>We continue by tightly bounding the sizes of 1-neighborhoods of various discretizations of the space of time-trees. Each has a 1-neighborhood size that is linear in <italic>n</italic> allowing for efficient local traversal and enumeration, a property of importance for phylogenetic algorithms, e.g. tree proposals in MCMC.</p></sec><sec id="FPar5"><title>Lemma 4</title><p id="Par29">Let <italic>T</italic> be a tree on <italic>n</italic> leaves and <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\deg (T)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo>deg</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq65.gif"/></alternatives></inline-formula> the number of trees adjacent to <italic>T</italic>. Then<disp-formula id="Equ4"><graphic xlink:href="285_2017_1167_Equ4_HTML.gif" position="anchor"/></disp-formula>All bounds are tight.</p></sec><sec id="FPar6"><title>Proof</title><p id="Par30">We prove the bounds by providing exemplar trees with the specified degrees and explaining why no tree can have a greater (or lesser) degree. Recall that <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m &#x0003e; 1$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq66.gif"/></alternatives></inline-formula> is the maximal possible length of an event interval in a tree from <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M134"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq67.gif"/></alternatives></inline-formula>. The lower bound in <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M136"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq68.gif"/></alternatives></inline-formula> is attained by any tree with all event intervals being of length <italic>m</italic>. In this case, <inline-formula id="IEq69"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\deg (T)$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mo>deg</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq69.gif"/></alternatives></inline-formula> is simply the number of event intervals, since every event interval adds 1 to the total degree of the tree. Other trees have the same or more possible event interval changes, showing that this is a lower bound. The upper bound is attained by a caterpillar tree with all intervals short, every taxon being younger than every divergence event, and both taxa in the cherry being younger than at least one other taxon, that is, a caterpillar tree with internal nodes having ranks <inline-formula id="IEq70"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n, \ldots , 2(n-1)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq70.gif"/></alternatives></inline-formula> and the ranks of the taxa in the cherry <inline-formula id="IEq71"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&#x0003c;n-1$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq71.gif"/></alternatives></inline-formula>. In this case, <inline-formula id="IEq72"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\deg (T)$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mo>deg</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq72.gif"/></alternatives></inline-formula> is bounded by the sum of the <inline-formula id="IEq73"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2(n-1)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq73.gif"/></alternatives></inline-formula> possible interval length changes, at most <inline-formula id="IEq74"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2(n-2)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq74.gif"/></alternatives></inline-formula>
<inline-formula id="IEq75"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M150"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq75.gif"/></alternatives></inline-formula> neighbors, and at most <italic>n</italic> rank changes that can occur between the <italic>n</italic> taxa and the root of the cherry. In total, <inline-formula id="IEq76"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\deg (T) \le 2(n-1) + 2(n-2) + n = 5n-6$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mo>deg</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq76.gif"/></alternatives></inline-formula>. Note that this is an upper bound indeed, as each of the <inline-formula id="IEq77"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2(n-2)$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq77.gif"/></alternatives></inline-formula> intervals excluding the most recent can contribute either a rank change or 2 <inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M156"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq78.gif"/></alternatives></inline-formula> moves. The caterpillar tree described above maximizes the number of intervals that contribute 2 <inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M158"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq79.gif"/></alternatives></inline-formula> moves and enables the rest of intervals to contribute a rank change.</p><p id="Par31">For ultrametric trees, the number of event intervals is <inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq80.gif"/></alternatives></inline-formula>, hence they add <inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq81.gif"/></alternatives></inline-formula> to the degree of the caterpillar tree from interval length changes. The number of intervals on which an <inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M164"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq82.gif"/></alternatives></inline-formula> move is possible is <inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-2$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq83.gif"/></alternatives></inline-formula> for ultrametric trees, hence they contribute <inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2(n-2)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq84.gif"/></alternatives></inline-formula> to the degree. In total, this gives the upper bound of <inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3n-5$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mn>3</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq85.gif"/></alternatives></inline-formula> for ultrametric trees.</p><p id="Par32">Every <inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M172"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq86.gif"/></alternatives></inline-formula> move results in two neighbors, so the equality <inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\deg (T) = 2(n-2)$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo>deg</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq87.gif"/></alternatives></inline-formula> follows for the <inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M176"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq88.gif"/></alternatives></inline-formula> graph. Indeed, no <inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq89.gif"/></alternatives></inline-formula> move can be performed on an edge adjacent to a taxon, exactly two <inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M180"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq90.gif"/></alternatives></inline-formula> moves can be performed on every edge between internal nodes (the number of which is <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-2$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq91.gif"/></alternatives></inline-formula>), and no two trees obtained by an <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M184"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq92.gif"/></alternatives></inline-formula> move performed on different edges are identical.</p><p id="Par33">The lower bound in <inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M186"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq93.gif"/></alternatives></inline-formula> is attained by the caterpillar-tree where taxa get ranks <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0, 1, 3, 5, \ldots , 2n-3$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq94.gif"/></alternatives></inline-formula> and internal nodes get ranks <inline-formula id="IEq95"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2, 4, 6, \ldots , 2n-2$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq95.gif"/></alternatives></inline-formula>. In other words, the divergence events alternate with the taxa in the ranked topology of the tree so that if we parse the tree from the present to the past, we meet the nodes in the following order: taxon, taxon, coalescence, taxon, coalescence, taxon, coalescence, and so on. In this case, intervals bounded by a taxon from below add nothing to the degree of the tree and intervals bounded from below by an internal node add one each, hence <inline-formula id="IEq96"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq96.gif"/></alternatives></inline-formula> in total. The upper bound for both <inline-formula id="IEq97"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M194"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M196"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq98.gif"/></alternatives></inline-formula> is obtained in the same way as for <inline-formula id="IEq99"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M198"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq99.gif"/></alternatives></inline-formula>.</p><p id="Par34">For the lower bound in <inline-formula id="IEq100"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M200"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq100.gif"/></alternatives></inline-formula>, we note that the oldest event interval (the one adjacent to the root) necessarily contributes 2 to the degree. Hence the lower bound can be reached by a tree such that no other interval contributes more than 1. The degree of such a tree is <inline-formula id="IEq101"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq101.gif"/></alternatives></inline-formula> in <inline-formula id="IEq102"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M204"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq102.gif"/></alternatives></inline-formula>. <inline-formula id="IEq103"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M206"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq103.gif"/></alternatives></inline-formula>
</p><p>Lemma&#x000a0;<xref ref-type="sec" rid="FPar5">4</xref> gives tight bounds for the number of trees in a 1-neighborhood, while the following theorem gives an upper bound for the number of trees in an <italic>r</italic>-neighborhood. The best known upper bound for <inline-formula id="IEq104"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M208"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq104.gif"/></alternatives></inline-formula> that we are aware of is <inline-formula id="IEq105"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3^{n-2} 2^{4r}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msup><mml:mn>3</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq105.gif"/></alternatives></inline-formula> (Li et&#x000a0;al. <xref ref-type="bibr" rid="CR24">1996</xref>). We obtain a smaller bound for <inline-formula id="IEq106"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M212"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq106.gif"/></alternatives></inline-formula> and, hence, improve the result for <inline-formula id="IEq107"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M214"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq107.gif"/></alternatives></inline-formula> as well.</p></sec><sec id="FPar7"><title>Theorem 5</title><p id="Par36">The number of trees within distance <italic>r</italic> from any given tree is at most<disp-formula id="Equ5"><graphic xlink:href="285_2017_1167_Equ5_HTML.gif" position="anchor"/></disp-formula>
</p></sec><sec id="FPar8"><title>Proof</title><p id="Par37">We describe the proof in detail for <inline-formula id="IEq108"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq108.gif"/></alternatives></inline-formula> and then explain how to modify the proof for the other three graphs. The proof employs the technique by Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>) for counting paths in a graph using a <italic>graph grammar</italic>. A graph grammar is a method of encoding each possible graph as a finite set of productions (described more formally below). Given the grammar, the number of possible productions to the power of the encoding length for a given neighborhood radius gives a simple upper bound on the number of trees in a neighborhood. Specifically, Theorem&#x000a0;2.3 from Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>), adapted to trees, states the following:<list list-type="bullet"><list-item><p id="Par38">Let <italic>T</italic> be a tree with <italic>h</italic> nodes, including all internal nodes and taxa, <inline-formula id="IEq109"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M218"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq109.gif"/></alternatives></inline-formula> be a graph grammar, <italic>d</italic> be the number of vertices in left sides of <inline-formula id="IEq110"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq110.gif"/></alternatives></inline-formula>, and <italic>k</italic> be the maximum number of nodes in any right side of a production of <inline-formula id="IEq111"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M222"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq111.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq112"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R(T, \Gamma , r)$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00393;</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq112.gif"/></alternatives></inline-formula> be the set of graphs obtainable from <italic>T</italic> by derivations in <inline-formula id="IEq113"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M226"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq113.gif"/></alternatives></inline-formula> of length at most <italic>r</italic>. Then <inline-formula id="IEq114"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|R(T, \Gamma , r)| \le (d + 1)^{h+k\cdot r}$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x00393;</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq114.gif"/></alternatives></inline-formula>.</p></list-item></list>We first apply Theorem&#x000a0;2.3 from Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>) and then improve the bound using specific properties of the <inline-formula id="IEq115"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M230"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq115.gif"/></alternatives></inline-formula> graph. We note that since our trees are ranked trees, they possess additional structure (ranking) on top of the tree graph structure, hence we will be applying the same style of argument as in Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>) but to a somewhat different structure.</p><p id="Par39">We now introduce the <italic>graph grammar</italic> for <inline-formula id="IEq116"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M232"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq116.gif"/></alternatives></inline-formula>. Since we will apply the graph grammar to modify trees, we use the graph-theoretic terminology here and recall that a tree is a graph. A graph grammar consists of a finite set of productions <inline-formula id="IEq117"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{L_i \rightarrow _i R_i\}$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq117.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq118"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_i$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq119.gif"/></alternatives></inline-formula> are connected undirected edge-end labeled graphs and <inline-formula id="IEq120"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow _i$$\end{document}</tex-math><mml:math id="M240"><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq120.gif"/></alternatives></inline-formula> is a one-to-one map between half-edges of <inline-formula id="IEq121"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq121.gif"/></alternatives></inline-formula> and those of <inline-formula id="IEq122"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_i$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq122.gif"/></alternatives></inline-formula>. Here, for every edge in the tree we distinguish between its two ends and refer to them as half-edges&#x02014;this is necessary to be able to substitute one subgraph by another in a unique way by connecting corresponding half-edges&#x02014;as in Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>). The productions are then applied to the starting tree <italic>T</italic> to derive all possible trees at <inline-formula id="IEq123"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M246"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq123.gif"/></alternatives></inline-formula> distance up to <italic>r</italic> from <italic>T</italic>. By a <italic>running tree at stage s</italic> we mean the tree obtained after <italic>s</italic> applications of the production rules in the derivation. A production is said to be <italic>ready</italic> at a stage <italic>s</italic> of the derivation if the running tree at stage <italic>s</italic> has a subgraph isomorphic to the left side <inline-formula id="IEq124"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq124.gif"/></alternatives></inline-formula> of the production. A ready production can be applied to the running tree by destroying all nodes corresponding to the left side of the production under the isomorphism and replacing them with the right side <inline-formula id="IEq125"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_i$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq125.gif"/></alternatives></inline-formula> of the production. The map <inline-formula id="IEq126"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow _i$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq126.gif"/></alternatives></inline-formula> of the production then says how to reconnect the right side of the production to the half-edges of the running tree that were created after the destruction. The obtained tree is the new running tree for the next stage <inline-formula id="IEq127"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s+1$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq127.gif"/></alternatives></inline-formula> of the derivation. See Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>) for precise definitions and details.</p><p id="Par40">The graph grammar for <inline-formula id="IEq128"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M256"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq128.gif"/></alternatives></inline-formula> is the grammar <inline-formula id="IEq129"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M258"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq129.gif"/></alternatives></inline-formula> shown on Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. Note that the definition of a graph grammar requires the left sides <inline-formula id="IEq130"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq130.gif"/></alternatives></inline-formula> to be connected and we have a disconnected left side in the third production. We can adapt our graph grammar to fit this requirement by noting that the nodes on the left side of the production must be of consecutive ranks, so we consider those nodes as being adjacent via a second type of adjacency relation by declaring nodes with consecutive ranks to be adjacent. This second type of relation is in addition to the first type of adjacency relation given by the branches of the tree. Furthermore, this second type of adjacency allows us to avoid considering two separate moves for the left and right sister nodes. Indeed, the half-edge labels order the edges to make the distinction between left and right, however since our nodes are ordered via ranking, this ordering of edges is irrelevant. We will further exploit this important property below, where we improve the bound obtained directly from grammar <inline-formula id="IEq131"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M262"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq131.gif"/></alternatives></inline-formula>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Graph grammar <inline-formula id="IEq132"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M264"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq132.gif"/></alternatives></inline-formula> for <inline-formula id="IEq133"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M266"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq133.gif"/></alternatives></inline-formula>. Maps <inline-formula id="IEq134"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow _i$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq134.gif"/></alternatives></inline-formula> are shown by <italic>dashed lines</italic>. In the first two productions, the edge-ends marked by <inline-formula id="IEq135"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M270"><mml:mi mathvariant="italic">&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq135.gif"/></alternatives></inline-formula> and <inline-formula id="IEq136"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M272"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq136.gif"/></alternatives></inline-formula> without <italic>dashed lines</italic> are mapped to each other: <italic>top</italic>
<inline-formula id="IEq137"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M274"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq137.gif"/></alternatives></inline-formula> to <italic>top</italic>
<inline-formula id="IEq138"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M276"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq138.gif"/></alternatives></inline-formula>, <inline-formula id="IEq139"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M278"><mml:mi mathvariant="italic">&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq139.gif"/></alternatives></inline-formula> to <inline-formula id="IEq140"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M280"><mml:mi mathvariant="italic">&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq140.gif"/></alternatives></inline-formula>, <italic>bottom</italic>
<inline-formula id="IEq141"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M282"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq141.gif"/></alternatives></inline-formula> to <italic>bottom</italic>
<inline-formula id="IEq142"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M284"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq142.gif"/></alternatives></inline-formula>. In the last production, edge-ends marked by the same label are mapped to each other. All pairs of nodes on both sides of each production must be of consecutive ranks. The first two productions correspond to an <inline-formula id="IEq143"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M286"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq143.gif"/></alternatives></inline-formula> move, while the last production corresponds to rank change</p></caption><graphic xlink:href="285_2017_1167_Fig5_HTML" id="MO8"/></fig>
</p><p id="Par41">The number of vertices in left sides of <inline-formula id="IEq144"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M288"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq144.gif"/></alternatives></inline-formula> is 6, the maximum number of vertices in any right side of a production of <inline-formula id="IEq145"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M290"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq145.gif"/></alternatives></inline-formula> is 2. Since the number of internal nodes of a tree on <italic>n</italic> leaves in <inline-formula id="IEq146"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M292"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq146.gif"/></alternatives></inline-formula> is <inline-formula id="IEq147"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq147.gif"/></alternatives></inline-formula>, directly applying Theorem&#x000a0;2.3 from Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>) we get the bound of <inline-formula id="IEq148"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7^{n+2r-1}$$\end{document}</tex-math><mml:math id="M296"><mml:msup><mml:mn>7</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq148.gif"/></alternatives></inline-formula>.</p><p id="Par42">This bound can be improved following the techniques described in Sects.&#x000a0;3.2&#x02013;3.4 of (Sleator et&#x000a0;al. <xref ref-type="bibr" rid="CR34">1992</xref>, see also Sect.&#x000a0;5) by bounding the number of possible productions available at a given time by a number smaller than their total. Every node of a tree in any application of a production of grammar <inline-formula id="IEq149"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M298"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq149.gif"/></alternatives></inline-formula> can play either of two roles: top node or bottom node. Hence to indicate that a pair of nodes is ready for being destroyed and replaced using a production, we must specify which node is a top node and which is a bottom node. We use a total of three node-labels (Sleator et&#x000a0;al. <xref ref-type="bibr" rid="CR34">1992</xref> call these &#x0201c;labels of vertices&#x0201d;) to identify these two roles and to distinguish which of the two possible <inline-formula id="IEq150"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M300"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq150.gif"/></alternatives></inline-formula> moves is applied. We claim that three node-labels <italic>a</italic>,&#x000a0;<italic>b</italic>,&#x000a0;<italic>c</italic> is enough to specify which productions can be applied to a given tree. We must redefine the notion of readiness to verify this claim. We say that a pair of consecutive nodes is <italic>ready</italic> if the node-label of the bottom node is <italic>a</italic> and the node-label of the top node is either <italic>b</italic> or <italic>c</italic>. If two consecutive nodes are ready and not connected by an edge in the tree, then only the rank move is possible. If they are, the type of the move is determined by the node-label of the top node. Hence, this notion of readiness uniquely identifies which of the three productions is applied.</p><p id="Par43">Sleator et&#x000a0;al. (<xref ref-type="bibr" rid="CR34">1992</xref>) use a special node-label, called the &#x0201c;zero label&#x0201d;, to mark nodes that should not be destroyed. They also explain how to eliminate the zero label in various cases. In our case, we can use one of the labels that are already in use, namely node-label <italic>a</italic>. That is, to indicate that a node <italic>v</italic> should never be destroyed, we label the node with an <italic>a</italic>. This labeling will indeed preserve the node <italic>v</italic> because of the following. If <italic>w</italic> is the node directly succeeding <italic>v</italic> at some step of the derivation then <italic>w</italic> can only be marked with an <italic>a</italic> and hence the pair <italic>v</italic>,&#x000a0;<italic>w</italic> is not ready. If <italic>w</italic> is the node directly preceding <italic>v</italic> at some step of the derivation then the pair <italic>w</italic>,&#x000a0;<italic>v</italic> is never ready. Hence <italic>v</italic> is preserved in either case.</p><p id="Par44">Thus, all possible configurations encoded by the six nodes on the left sides of the productions of <inline-formula id="IEq151"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M302"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq151.gif"/></alternatives></inline-formula> can be encoded using three node-labels. This implies that the derivation can be encoded by a ternary sequence of length <inline-formula id="IEq152"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1+2r$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq152.gif"/></alternatives></inline-formula>. Indeed, the first <inline-formula id="IEq153"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq153.gif"/></alternatives></inline-formula> entries of the sequence are needed to encode all possible node-labelings of the initial tree, plus two entries are needed for each of the <italic>r</italic> applications of productions because every production creates two new nodes, each of which has to be node-labeled. The number of such strings, <inline-formula id="IEq154"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3^{n-1+2r}$$\end{document}</tex-math><mml:math id="M308"><mml:msup><mml:mn>3</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq154.gif"/></alternatives></inline-formula>, gives the desired improved bound.</p><p id="Par45">The proof for the other three spaces follows similarly.</p><p id="Par46">For <inline-formula id="IEq155"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M310"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq155.gif"/></alternatives></inline-formula>, we extend the graph grammar <inline-formula id="IEq156"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M312"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq156.gif"/></alternatives></inline-formula> by two productions, namely, one for the move when two taxa swap their ranks and one for the move when a taxon and an internal node swap their ranks. Since in both of these productions the only possible type of move is the rank move, two node-labels is enough for these productions. Since the number of (internal and leaf) nodes in an <inline-formula id="IEq157"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M314"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq157.gif"/></alternatives></inline-formula> tree is <inline-formula id="IEq158"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2n - 1$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq158.gif"/></alternatives></inline-formula> and the maximum number of nodes on right sides of the productions is still 2, the desired bound is <inline-formula id="IEq159"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3^{2n-1 + 2r}$$\end{document}</tex-math><mml:math id="M318"><mml:msup><mml:mn>3</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq159.gif"/></alternatives></inline-formula>.</p><p id="Par47">For <inline-formula id="IEq160"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtTu}$$\end{document}</tex-math><mml:math id="M320"><mml:mi mathvariant="normal">DtTu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq160.gif"/></alternatives></inline-formula>, we have to extend the grammar <inline-formula id="IEq161"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M322"><mml:mi mathvariant="normal">&#x00393;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq161.gif"/></alternatives></inline-formula> by two productions, namely, one for increasing the length of the branch between two nodes in the production and one for decreasing. This increases the number of necessary node-labels by one. Indeed, if a production has a long event interval on the left side, three node-labels are enough to indicate whether the event interval length increases or decreases. Alternatively, if a production has a short event interval on the left side, three node-labels are needed for the top node to indicate the type of move to apply: a length increase move, one of the two possible <inline-formula id="IEq162"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M324"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq162.gif"/></alternatives></inline-formula> moves, or a rank swap move. Together, this requires 4 node-labels and the desired bound is <inline-formula id="IEq163"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4^{n-1 + 2r}$$\end{document}</tex-math><mml:math id="M326"><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq163.gif"/></alternatives></inline-formula>.</p><p id="Par48">For <inline-formula id="IEq164"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M328"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq164.gif"/></alternatives></inline-formula>, we extend the grammar constructed for <inline-formula id="IEq165"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtTu}$$\end{document}</tex-math><mml:math id="M330"><mml:mi mathvariant="normal">DtTu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq165.gif"/></alternatives></inline-formula> by four productions, namely, one for the move when two taxa either swap their ranks or increase the interval length between them, one for the move when two taxa either increase or decrease the interval length between them, one for the move when a taxon and an internal node either swap their ranks or increase the interval length between them, and one for the move when a taxon and an internal node either increase or decrease the interval length between them. All these moves require three node-labels, hence the desired bound is <inline-formula id="IEq166"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4^{2n-1 + 2r}$$\end{document}</tex-math><mml:math id="M332"><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq166.gif"/></alternatives></inline-formula>. <inline-formula id="IEq167"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M334"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq167.gif"/></alternatives></inline-formula>
</p></sec></sec><sec id="Sec5"><title>Diameter of the graphs</title><p id="Par49">Since Theorem&#x000a0;<xref ref-type="sec" rid="FPar7">5</xref> bounds the sizes of <italic>r</italic>-neighborhoods by functions of the form <inline-formula id="IEq168"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a^{f(n) + 2r}$$\end{document}</tex-math><mml:math id="M336"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq168.gif"/></alternatives></inline-formula>, the following corollary bounds the diameters of the graphs under consideration from below.</p><sec id="FPar9"><title>Corollary 6</title><p id="Par50">Let <inline-formula id="IEq169"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta (\mathcal {G}), |\mathcal {G}|$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq169.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq170"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _r(\mathcal {G})$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:msub><mml:mi mathvariant="italic">&#x003b4;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq170.gif"/></alternatives></inline-formula> be the diameter, the number of vertices, and the number of vertices within distance <italic>r</italic> from any given vertex in graph <inline-formula id="IEq171"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {G}$$\end{document}</tex-math><mml:math id="M342"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq171.gif"/></alternatives></inline-formula>, respectively. If <inline-formula id="IEq172"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _r(\mathcal {G}) = a^{f(n) + 2r}$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:msub><mml:mi mathvariant="italic">&#x003b4;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq172.gif"/></alternatives></inline-formula> then<disp-formula id="Equ1"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta (\mathcal {G}) \ge \frac{1}{2} \log _a\frac{|\mathcal {G}|}{b}, \end{aligned}$$\end{document}</tex-math><mml:math id="M346" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>log</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="285_2017_1167_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq173"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b = a^{f(n)}$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq173.gif"/></alternatives></inline-formula>. In particular, <inline-formula id="IEq174"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta (\mathrm {RNNIu}) \ge \frac{1}{2} \log _3\frac{(n-1)!\,n!}{6^{n-1}}$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">RNNIu</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>log</mml:mo><mml:mn>3</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:msup><mml:mn>6</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq174.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar10"><title>Proof</title><p id="Par51">We note that every <italic>r</italic> that satisfies the inequality <inline-formula id="IEq175"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _r(\mathcal {G}) &#x0003c; |\mathcal {G}|$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:msub><mml:mi mathvariant="italic">&#x003b4;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq175.gif"/></alternatives></inline-formula> is smaller than the diameter, that is, <inline-formula id="IEq176"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta (\mathcal {G}) &#x0003e; r$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq176.gif"/></alternatives></inline-formula> for all such <italic>r</italic>. By taking <inline-formula id="IEq177"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log _a(\cdot )$$\end{document}</tex-math><mml:math id="M356"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq177.gif"/></alternatives></inline-formula>, the former inequality is equivalent to <inline-formula id="IEq178"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log _ab + 2r &#x0003c; \log _a|\mathcal {G}|$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq178.gif"/></alternatives></inline-formula>, that is, to <inline-formula id="IEq179"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r &#x0003c; \frac{1}{2} \log _a\frac{|\mathcal {G}|}{b}$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>log</mml:mo><mml:mi>a</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq179.gif"/></alternatives></inline-formula>. Hence, the desired inequality. <inline-formula id="IEq180"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M362"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq180.gif"/></alternatives></inline-formula>
</p><p>Now we estimate the diameter of the graphs from above, complementing the above lower bounds. Recall that <inline-formula id="IEq181"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta (\mathcal {G})$$\end{document}</tex-math><mml:math id="M364"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq181.gif"/></alternatives></inline-formula> is the diameter of graph <inline-formula id="IEq182"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {G}$$\end{document}</tex-math><mml:math id="M366"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq182.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar11"><title>Theorem 7</title><p id="Par53">For <inline-formula id="IEq183"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \ge 4$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq183.gif"/></alternatives></inline-formula>, <inline-formula id="IEq184"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta (\mathrm {RNNIu}) \le n^2 - 3n - \displaystyle \frac{5}{8}$$\end{document}</tex-math><mml:math id="M370"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">RNNIu</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>5</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq184.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar12"><title>Proof</title><p id="Par54">Let <italic>T</italic> and <italic>R</italic> be trees in <inline-formula id="IEq185"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M372"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq185.gif"/></alternatives></inline-formula>. We show that there exists a path between them of length <inline-formula id="IEq186"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^2 - 3n - \frac{5}{8}$$\end{document}</tex-math><mml:math id="M374"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>5</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq186.gif"/></alternatives></inline-formula> or shorter. We denote the taxa on one side from the root of <italic>T</italic> by <italic>A</italic> and the rest of the taxa by <italic>B</italic>. Let <inline-formula id="IEq187"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A = A_1 \cup A_2$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq187.gif"/></alternatives></inline-formula> and <inline-formula id="IEq188"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B = B_1 \cup B_2$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq188.gif"/></alternatives></inline-formula> so that the root of <italic>R</italic> splits the taxa into <inline-formula id="IEq189"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1 \cup B_1$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq189.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2 \cup B_2$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq190.gif"/></alternatives></inline-formula>. Note that all <inline-formula id="IEq191"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_i$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq191.gif"/></alternatives></inline-formula>&#x02019;s and <inline-formula id="IEq192"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_i$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq192.gif"/></alternatives></inline-formula>&#x02019;s have to be disjoint. We assume that <inline-formula id="IEq193"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A_1| = |A_2| = |B_1| = |B_2| = \frac{n-1}{4}$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq193.gif"/></alternatives></inline-formula> and denote this number by <italic>s</italic>. We will see later in the proof that this assumption does not restrict the generality of our argument.</p><p id="Par55">We construct the path from <italic>T</italic> to <italic>R</italic> proceeding in the following steps, which are illustrated on Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>. Let <italic>f</italic>(<italic>n</italic>) be the desired upper bound. For move counts in the remainder of this proof, we will allow the &#x0201c;null move&#x0201d; in which no modification is made.<fig id="Fig6"><label>Fig. 6</label><caption><p>An algorithm to compute a (not necessarily shortest) path between discrete time-trees. Although the trees at steps (6) and (7) look identical, the topologies inside the <italic>triangles</italic> are different: those at step (6) correspond to the restriction of <italic>T</italic>, at step (7)&#x02014;of <italic>R</italic>
</p></caption><graphic xlink:href="285_2017_1167_Fig6_HTML" id="MO10"/></fig>
<list list-type="order"><list-item><p id="Par56">Move all the nodes adjacent to taxa in <inline-formula id="IEq194"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq194.gif"/></alternatives></inline-formula> on top of all the other nodes in <italic>T</italic>, apart from the root. The tree restricted to <inline-formula id="IEq195"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq195.gif"/></alternatives></inline-formula> is then a caterpillar tree. This takes <inline-formula id="IEq196"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3s^2$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:mn>3</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq196.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par57">Move the caterpillar tree on <inline-formula id="IEq197"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq197.gif"/></alternatives></inline-formula> to the other side of the root. This takes <inline-formula id="IEq198"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2} s^2 + \frac{1}{2} s$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq198.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par58">Move all the nodes adjacent to taxa in <inline-formula id="IEq199"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_1$$\end{document}</tex-math><mml:math id="M400"><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq199.gif"/></alternatives></inline-formula> on top of all nodes apart from those adjacent to taxa in <inline-formula id="IEq200"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq200.gif"/></alternatives></inline-formula> and the root. The tree restricted to <inline-formula id="IEq201"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_1$$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq201.gif"/></alternatives></inline-formula> is then a caterpillar tree. This takes <inline-formula id="IEq202"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2s^2$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq202.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par59">Swap the caterpillars on <inline-formula id="IEq203"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M408"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq203.gif"/></alternatives></inline-formula> and <inline-formula id="IEq204"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_1$$\end{document}</tex-math><mml:math id="M410"><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq204.gif"/></alternatives></inline-formula>. This takes <inline-formula id="IEq205"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s^2$$\end{document}</tex-math><mml:math id="M412"><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq205.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par60">Move the caterpillar tree on <inline-formula id="IEq206"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_1$$\end{document}</tex-math><mml:math id="M414"><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq206.gif"/></alternatives></inline-formula> to the other side of the root. This takes <inline-formula id="IEq207"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2} s^2 + \frac{1}{2} s$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq207.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par61">Translate the tree restricted to <inline-formula id="IEq208"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_2$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq208.gif"/></alternatives></inline-formula> up to place it between the trees on <inline-formula id="IEq209"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1$$\end{document}</tex-math><mml:math id="M420"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq209.gif"/></alternatives></inline-formula> and <inline-formula id="IEq210"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M422"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq210.gif"/></alternatives></inline-formula>. This takes <inline-formula id="IEq211"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s^2$$\end{document}</tex-math><mml:math id="M424"><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq211.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par62">Convert the tree on <inline-formula id="IEq212"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1 \cup B_2$$\end{document}</tex-math><mml:math id="M426"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq212.gif"/></alternatives></inline-formula> to the corresponding subtree in <italic>R</italic> in terms of topology and relative ranking of nodes within the subtree. This takes 2<italic>f</italic>(<italic>n</italic>&#x000a0;/&#x000a0;4) moves.</p></list-item><list-item><p id="Par63">Translate the tree on <inline-formula id="IEq213"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_2$$\end{document}</tex-math><mml:math id="M428"><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq213.gif"/></alternatives></inline-formula> down so that the tree on <inline-formula id="IEq214"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1 \cup B_2$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq214.gif"/></alternatives></inline-formula> matches the corresponding subtree in <italic>R</italic> in terms of topology and relative ranking of nodes. This takes <inline-formula id="IEq215"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s^2$$\end{document}</tex-math><mml:math id="M432"><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq215.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par64">Merge the tree on <inline-formula id="IEq216"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="M434"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq216.gif"/></alternatives></inline-formula> with the tree on <inline-formula id="IEq217"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_2$$\end{document}</tex-math><mml:math id="M436"><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq217.gif"/></alternatives></inline-formula> so that the tree on <inline-formula id="IEq218"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1 \cup A_2 \cup B_2$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq218.gif"/></alternatives></inline-formula> coincides with that in <italic>R</italic>. This takes <inline-formula id="IEq219"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2s^2$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq219.gif"/></alternatives></inline-formula> moves.</p></list-item><list-item><p id="Par65">Merge the tree on <inline-formula id="IEq220"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_1$$\end{document}</tex-math><mml:math id="M442"><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq220.gif"/></alternatives></inline-formula> with the tree on <inline-formula id="IEq221"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1$$\end{document}</tex-math><mml:math id="M444"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq221.gif"/></alternatives></inline-formula> so that the tree coincides with <italic>R</italic>. This takes <inline-formula id="IEq222"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3s^2$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mn>3</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq222.gif"/></alternatives></inline-formula> moves.</p></list-item></list>In total, we have a recursive equation <inline-formula id="IEq223"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(n) = 14s^2 + s + 2 f(n/4)$$\end{document}</tex-math><mml:math id="M448"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>14</mml:mn><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq223.gif"/></alternatives></inline-formula>.</p><p id="Par66">Assuming that the solution is a polynomial, we see that the polynomial must be of degree 2. It remains to apply the recursive equation to find the coefficients of the polynomial:<disp-formula id="Equ2"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f(n) = n^2 - 3n - \frac{5}{8}. \end{aligned}$$\end{document}</tex-math><mml:math id="M450" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>5</mml:mn><mml:mn>8</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="285_2017_1167_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>It remains to note that the assumption <inline-formula id="IEq224"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A_1| = |A_2| = |B_1| = |B_2| = \frac{n-1}{4}$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq224.gif"/></alternatives></inline-formula> does not increase the distance between <italic>T</italic> and <italic>R</italic>. Indeed, the sets can be chosen so that at most half of the nodes have to cross the root, that is, <inline-formula id="IEq225"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A_2 \cup B_1| \le \frac{n-1}{2}$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02264;</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq225.gif"/></alternatives></inline-formula>. Furthermore, the smaller the size of <inline-formula id="IEq226"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2 \cup B_1$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq226.gif"/></alternatives></inline-formula> the shorter the path. Finally, the total length of the path is maximized when <inline-formula id="IEq227"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A_2| = |B_1|$$\end{document}</tex-math><mml:math id="M458"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq227.gif"/></alternatives></inline-formula> and <inline-formula id="IEq228"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A_1| = |B_2|$$\end{document}</tex-math><mml:math id="M460"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq228.gif"/></alternatives></inline-formula>. <inline-formula id="IEq229"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M462"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq229.gif"/></alternatives></inline-formula>
</p><p>Although we stated and proved the theorem only for the <inline-formula id="IEq230"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M464"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq230.gif"/></alternatives></inline-formula> graph, the idea can be adapted to the other graphs considered here. However, this adaptation goes beyond the scope of this paper.</p><p>We also note that the proof of the theorem provides an efficient algorithm for computing (not necessarily shortest) paths between discrete time-trees. This algorithm can be used for efficient exploration of the space, e.g. via MCMC, where approximate paths can be used to improve mixing by making distant proposals. The algorithm might also be useful to determine if two trees appear to be separated by a valley (e.g. of posterior probability) or if they are rather located on a plateau.</p><p>A non-ranked tree has a symmetry associated with every internal node. Those symmetries can be employed to consider only a single representative from equivalent pairs of trees, such as by using tanglegrams (Matsen et&#x000a0;al. <xref ref-type="bibr" rid="CR25">2015</xref>; Whidden and Matsen <xref ref-type="bibr" rid="CR38">2016</xref>), where a <italic>tanglegram</italic> is a graph formed by identifying the leaves of two phylogenetic trees. However, as the following proposition shows, ranked trees are free from all but one of those symmetries, hence the tanglegram approach is not applicable in this case.</p></sec><sec id="FPar13"><title>Proposition 8</title><p id="Par70">Let <italic>T</italic> be a tree from <inline-formula id="IEq231"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M466"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq231.gif"/></alternatives></inline-formula>, <inline-formula id="IEq232"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtTu}$$\end{document}</tex-math><mml:math id="M468"><mml:mi mathvariant="normal">DtTu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq232.gif"/></alternatives></inline-formula>, <inline-formula id="IEq233"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M470"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq233.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq234"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M472"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq234.gif"/></alternatives></inline-formula> and <inline-formula id="IEq235"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma $$\end{document}</tex-math><mml:math id="M474"><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq235.gif"/></alternatives></inline-formula> a permutation of taxa of <italic>T</italic>. Let <inline-formula id="IEq236"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\sigma $$\end{document}</tex-math><mml:math id="M476"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq236.gif"/></alternatives></inline-formula> be the tree obtained from <italic>T</italic> by permuting the taxa using <inline-formula id="IEq237"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma $$\end{document}</tex-math><mml:math id="M478"><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq237.gif"/></alternatives></inline-formula>. Then <inline-formula id="IEq238"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T = T_\sigma $$\end{document}</tex-math><mml:math id="M480"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq238.gif"/></alternatives></inline-formula> if and only if <inline-formula id="IEq239"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma $$\end{document}</tex-math><mml:math id="M482"><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq239.gif"/></alternatives></inline-formula> is either the identity permutation or a transposition of a pair of taxa that form a cherry in <italic>T</italic>.</p></sec><sec id="FPar14"><title>Proof</title><p id="Par71">The sufficiency is obvious. For the necessity, assume that <inline-formula id="IEq240"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma $$\end{document}</tex-math><mml:math id="M484"><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq240.gif"/></alternatives></inline-formula> transpose taxa <italic>i</italic>,&#x000a0;<italic>j</italic> such that <italic>i</italic>,&#x000a0;<italic>j</italic> is not a cherry in <italic>T</italic>. This implies that <italic>i</italic> and <italic>j</italic> have different parents. Hence <inline-formula id="IEq241"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T \ne T_\sigma $$\end{document}</tex-math><mml:math id="M486"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq241.gif"/></alternatives></inline-formula> because the ranks of the parent of <italic>i</italic> are different in <italic>T</italic> and <inline-formula id="IEq242"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_\sigma $$\end{document}</tex-math><mml:math id="M488"><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">&#x003c3;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq242.gif"/></alternatives></inline-formula>. <inline-formula id="IEq243"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M490"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq243.gif"/></alternatives></inline-formula>
</p><p>These observations suggest that the <inline-formula id="IEq244"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M492"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq244.gif"/></alternatives></inline-formula> graph is geometrically and algorithmically different from the other four graphs.</p></sec></sec><sec id="Sec6"><title>Efficient algorithm for generating <inline-formula id="IEq245"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M494"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq245.gif"/></alternatives></inline-formula> graphs</title><p id="Par73">We now introduce an algorithm to compute the <inline-formula id="IEq246"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M496"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq246.gif"/></alternatives></inline-formula> graph on <italic>n</italic> leaves by extending an algorithm from Whidden and Matsen (<xref ref-type="bibr" rid="CR38">2016</xref>). The input to our algorithm is a set <italic>S</italic> of <inline-formula id="IEq247"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M498"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq247.gif"/></alternatives></inline-formula> trees in the format described by Gavryushkin and Drummond (<xref ref-type="bibr" rid="CR13">2016</xref>) and implemented in Gavryushkin and Drummond (<xref ref-type="bibr" rid="CR12">2015</xref>) (see also Semple and Steel <xref ref-type="bibr" rid="CR33">2003</xref>). The two key requirements of the algorithm are the ability to enumerate the neighbors of a given tree in the <inline-formula id="IEq248"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M500"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq248.gif"/></alternatives></inline-formula> graph, and the ability to determine whether a given tree is already a vertex of the graph. Both of these requirements follow from an efficient unique representation for ranked trees.</p><p id="Par74">A node of a tree is given by the set of taxa that are all descendants of the node. A tree is then given by a sequence of nodes ordered by their ranks. Clearly, this obtained representation is unique. For example, the representation of the tree on Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> is <inline-formula id="IEq249"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\{A\}, \{C\}, \{D\}, \{B\}, \{E\}, \{A,B\}, \{D,E\}, \{C, D, E\}, \{F\}, \{A,B,F\}, \{A,B,C,D,E,F\})$$\end{document}</tex-math><mml:math id="M502"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq249.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq250"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\{A,B\}, \{D,E\}, \{C, D, E\}, \{A,B,F\}, \{A,B,C,D,E,F\})$$\end{document}</tex-math><mml:math id="M504"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq250.gif"/></alternatives></inline-formula> if we make the tree ultrametric by placing all taxa below the most recent divergence event. Using this representation of trees we construct a map <inline-formula id="IEq251"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu : S \rightarrow \omega $$\end{document}</tex-math><mml:math id="M506"><mml:mrow><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo>:</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi mathvariant="italic">&#x003c9;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq251.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq252"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega $$\end{document}</tex-math><mml:math id="M508"><mml:mi mathvariant="italic">&#x003c9;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq252.gif"/></alternatives></inline-formula> is the set of non-negative integers. This map allows us to determine whether or not a tree is already a vertex of the graph. This takes linear time if the map is implemented as a trie. We can also enumerate the neighbors of a tree in <inline-formula id="IEq253"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n^2)$$\end{document}</tex-math><mml:math id="M510"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq253.gif"/></alternatives></inline-formula>-time using Lemma&#x000a0;<xref ref-type="sec" rid="FPar5">4</xref>. The algorithm therefore takes <inline-formula id="IEq254"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(|S|*n^2)$$\end{document}</tex-math><mml:math id="M512"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow/><mml:mo>&#x02217;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq254.gif"/></alternatives></inline-formula>-time. The high-level steps of the algorithm are as follows. See Whidden and Matsen (<xref ref-type="bibr" rid="CR38">2016</xref>) for an analogous proof of correctness.</p><p id="Par75">
<sc>Construct</sc>-<inline-formula id="IEq255"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M514"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq255.gif"/></alternatives></inline-formula>-<sc>Graph</sc>(<italic>S</italic>)<list list-type="order"><list-item><p id="Par76">Let <italic>G</italic> be an empty graph.</p></list-item><list-item><p id="Par77">Let <inline-formula id="IEq256"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M516"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq256.gif"/></alternatives></inline-formula> be an empty mapping from trees to integers.</p></list-item><list-item><p id="Par78">Let <inline-formula id="IEq257"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i = 0$$\end{document}</tex-math><mml:math id="M518"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq257.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par79">For each of the <italic>m</italic> trees:<list list-type="alpha-lower"><list-item><p id="Par80">Add a vertex <italic>i</italic> to <italic>G</italic> representing the current tree <inline-formula id="IEq258"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M520"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq258.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par81">Add <inline-formula id="IEq259"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i \rightarrow i$$\end{document}</tex-math><mml:math id="M522"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq259.gif"/></alternatives></inline-formula> to <inline-formula id="IEq260"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M524"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq260.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par82">For each neighbor <inline-formula id="IEq261"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M526"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq261.gif"/></alternatives></inline-formula> of <inline-formula id="IEq262"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M528"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq262.gif"/></alternatives></inline-formula>:<list list-type="simple"><list-item><label>(j)</label><p id="Par83">If <inline-formula id="IEq263"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M530"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq263.gif"/></alternatives></inline-formula> is in <inline-formula id="IEq264"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {dom}}(\nu )$$\end{document}</tex-math><mml:math id="M532"><mml:mrow><mml:mtext>dom</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq264.gif"/></alternatives></inline-formula> then add an edge <inline-formula id="IEq265"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i, \nu (T_j))$$\end{document}</tex-math><mml:math id="M534"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq265.gif"/></alternatives></inline-formula> to <italic>G</italic>.</p></list-item></list>
</p></list-item><list-item><p id="Par84">
<inline-formula id="IEq266"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i = i + 1$$\end{document}</tex-math><mml:math id="M536"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq266.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p></list-item></list>
</p></sec></sec><sec id="Sec7"><title>Open problems and conjectures</title><p id="Par85">In the previous section we posed Problem&#x000a0;<xref ref-type="sec" rid="FPar1">1</xref>, which asks about the complexity of computing the distance in discrete time-tree graphs. This problem is the primary obstacle for actual biological applications of the introduced graphs. The history of research into computational complexity of phylogenetic graphs is very rich and exciting, in particular for the case of the <inline-formula id="IEq267"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M538"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq267.gif"/></alternatives></inline-formula> graph, with a number of erroneous results being published over the 25 years it took to settle the complexity. See Dasgupta et&#x000a0;al. (<xref ref-type="bibr" rid="CR6">2000</xref>) for a detailed discussion of those publications, some of which claimed that <inline-formula id="IEq268"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M540"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq268.gif"/></alternatives></inline-formula> distance is NP-hard while others claiming that <inline-formula id="IEq269"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M542"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq269.gif"/></alternatives></inline-formula> distance is decidable in polynomial time. The latter claims were mainly based on the so-called Split Theorem which states the following: If a partition of leaves given by an edge is shared between two trees then there exists a shortest <inline-formula id="IEq270"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M544"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq270.gif"/></alternatives></inline-formula> path between the trees such that every tree on the path maintains the partition. These claims were finally refuted by Li et&#x000a0;al. (<xref ref-type="bibr" rid="CR24">1996</xref>), who proved that the Split Theorem does not hold in the <inline-formula id="IEq271"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M546"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq271.gif"/></alternatives></inline-formula> graph. Hence, a natural question that would contribute to understanding Problem&#x000a0;<xref ref-type="sec" rid="FPar1">1</xref> is whether or not the Split Theorem holds in the <inline-formula id="IEq272"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M548"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq272.gif"/></alternatives></inline-formula> graph and other time-tree graphs.</p><sec id="Sec8"><title>Split Theorem</title><p id="Par86">Li et al. (<xref ref-type="bibr" rid="CR24">1996</xref>) used properties of the diameter of the <inline-formula id="IEq273"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M550"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq273.gif"/></alternatives></inline-formula> graph and the sizes of its neighborhoods to provide an example of trees such that every shortest <inline-formula id="IEq274"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M552"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq274.gif"/></alternatives></inline-formula> path between the trees fails to maintain a partition of taxa shared by the origin and destination trees. Specifically, they showed that sorting two caterpillar trees simultaneously is more efficient than sorting them independently, provided the size of the trees is large enough. In the following, we conjecture that the ranked versions of <inline-formula id="IEq275"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M554"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq275.gif"/></alternatives></inline-formula> graph maintain splits along shortest paths. Our conjecture is based on the fact that <inline-formula id="IEq276"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M556"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq276.gif"/></alternatives></inline-formula> does not satisfy the diameter bounds necessary for the argument in Li et&#x000a0;al. (<xref ref-type="bibr" rid="CR24">1996</xref>) to go through&#x02014;see Theorems&#x000a0;<xref ref-type="sec" rid="FPar7">5</xref> and <xref ref-type="sec" rid="FPar11">7</xref>. Indeed, since sorting a caterpillar tree of size <italic>k</italic> in <inline-formula id="IEq277"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M558"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq277.gif"/></alternatives></inline-formula> takes fewer moves than merging two such caterpillar trees and then separating them, the counter-example from Li et&#x000a0;al. (<xref ref-type="bibr" rid="CR24">1996</xref>) does not apply in <inline-formula id="IEq278"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M560"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq278.gif"/></alternatives></inline-formula>. This counter-example using two trees encodes the basic way in which <inline-formula id="IEq279"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M562"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq279.gif"/></alternatives></inline-formula> shortest paths are non-trivial: that one can economize by first grouping leaves into bundles, moving the bundles, and then breaking the bundles apart. Because this basic operation does not provide an advantage in the simplest case of two caterpillar trees in <inline-formula id="IEq280"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M564"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq280.gif"/></alternatives></inline-formula>, we do not believe that it will hold for more complex collections of moves.</p><sec id="FPar15"><title>Conjecture 9</title><p id="Par87">The following is true in all graphs <inline-formula id="IEq281"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M566"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq281.gif"/></alternatives></inline-formula>, <inline-formula id="IEq282"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtTu}$$\end{document}</tex-math><mml:math id="M568"><mml:mi mathvariant="normal">DtTu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq282.gif"/></alternatives></inline-formula>, <inline-formula id="IEq283"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M570"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq283.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq284"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNIu}$$\end{document}</tex-math><mml:math id="M572"><mml:mi mathvariant="normal">RNNIu</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq284.gif"/></alternatives></inline-formula>, but not in <inline-formula id="IEq285"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M574"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq285.gif"/></alternatives></inline-formula>. If a partition of leaves given by an edge is presented in two trees <italic>T</italic> and <italic>R</italic> then the partition is presented in every tree on every shortest path between <italic>T</italic> and <italic>R</italic>.</p></sec></sec><sec id="Sec9"><title>Computing the distance</title><p id="Par88">In this section, we bound the number of neighbors of a tree <italic>x</italic> in the discrete time-tree graphs that are closer than <italic>x</italic> to a given tree <italic>y</italic>, <italic>under the assumption that Conjecture</italic>&#x000a0;<xref ref-type="sec" rid="FPar15">9</xref>
<italic>holds</italic>. We denote trees by lowercase letters to stress the fact that we are considering graphs as metric spaces in this section. We show that the maximum fraction of neighbors that tend closer to <italic>y</italic> grows linearly with respect to <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>). When the graph is seen as a metric space, this property is important for the study of the curvature of the space as well as convergence properties of random walks over the space. This will be useful in future studies analogous to Whidden and Matsen (<xref ref-type="bibr" rid="CR38">2016</xref>). Furthermore, the result provides a further insight into possible approaches to Problem&#x000a0;<xref ref-type="sec" rid="FPar1">1</xref>.</p><sec id="FPar16"><title>Theorem 10</title><p id="Par89">Assume that Conjecture&#x000a0;<xref ref-type="sec" rid="FPar15">9</xref> holds. Let <italic>x</italic> and <italic>y</italic> be two trees and <italic>N</italic>(<italic>x</italic>) a one-neighborhood of <italic>x</italic>. Then the number of trees <inline-formula id="IEq286"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \in N(x)$$\end{document}</tex-math><mml:math id="M576"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq286.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq287"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(u, y) \le d(x, y)$$\end{document}</tex-math><mml:math id="M578"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq287.gif"/></alternatives></inline-formula> is at most<list list-type="simple"><list-item><label>(i)</label><p id="Par90">3<italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) in <inline-formula id="IEq288"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M580"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq288.gif"/></alternatives></inline-formula>,</p></list-item><list-item><label>(ii)</label><p id="Par91">4<italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) in <inline-formula id="IEq289"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_2$$\end{document}</tex-math><mml:math id="M582"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq289.gif"/></alternatives></inline-formula>,</p></list-item><list-item><label>(iii)</label><p id="Par92">5<italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) in <inline-formula id="IEq290"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_m$$\end{document}</tex-math><mml:math id="M584"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq290.gif"/></alternatives></inline-formula> for <inline-formula id="IEq291"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m &#x0003e; 2$$\end{document}</tex-math><mml:math id="M586"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq291.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p></sec><sec id="FPar17"><title>Proof</title><p id="Par93">We first prove the statement for <inline-formula id="IEq292"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}_2$$\end{document}</tex-math><mml:math id="M588"><mml:msub><mml:mi mathvariant="normal">DtT</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq292.gif"/></alternatives></inline-formula>. Let <italic>U</italic> be the set of neighbors <italic>u</italic> of <italic>x</italic> such that <inline-formula id="IEq293"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(u,y) \le d(x,y)$$\end{document}</tex-math><mml:math id="M590"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq293.gif"/></alternatives></inline-formula>, as stated in the theorem. We partition <italic>U</italic> into three sets of trees&#x02014;<italic>I</italic>, <italic>R</italic>, and <italic>L</italic>&#x02014;obtained from <italic>x</italic> by a single <inline-formula id="IEq294"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M592"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq294.gif"/></alternatives></inline-formula> move, rank change, or length change, respectively. We then prove the theorem by bounding the size of each partition by 2<italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>), <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>), and <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>), respectively.</p><p id="Par94">We first consider some basic properties of minimal length paths between <italic>x</italic> and <italic>y</italic>. Observe that at most <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) bipartitions differ between <italic>x</italic> and <italic>y</italic>, as each <inline-formula id="IEq295"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M594"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq295.gif"/></alternatives></inline-formula> operation replaces one bipartition with another (and rank and length changes do not modify bipartitions). Now, Conjecture&#x000a0;<xref ref-type="sec" rid="FPar15">9</xref> implies that no minimal length path from <italic>x</italic> to <italic>y</italic> will replace a bipartition that is common to <italic>x</italic> and <italic>y</italic>.</p><p id="Par95">We are now ready to bound the sizes of each partition <italic>I</italic>, <italic>R</italic>, and <italic>L</italic>. First, consider the subset <italic>I</italic> of closer neighbors obtained via <inline-formula id="IEq296"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M596"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq296.gif"/></alternatives></inline-formula> moves. By our observations above, |<italic>I</italic>| is bounded by the number of <inline-formula id="IEq297"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M598"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq297.gif"/></alternatives></inline-formula> operations that modify one of the at most <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) bipartitions of <italic>x</italic> that are not a bipartition of <italic>y</italic>. There are two neighbors of <italic>x</italic> that lack any given bipartition (obtained by moving either the left or right subtree located below the bipartition). Therefore, <inline-formula id="IEq298"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|I| \le 2d(x,y)$$\end{document}</tex-math><mml:math id="M600"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq298.gif"/></alternatives></inline-formula>.</p><p id="Par96">Second, consider the subset <italic>R</italic> of closer neighbors obtained via rank change moves. These operate either on one of <italic>x</italic>&#x02019;s unique bipartitions or a bipartition common to <italic>x</italic> and <italic>y</italic> that differs in rank. As observed above, the number of unique bipartitions is bounded by the maximum number of <inline-formula id="IEq299"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M602"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq299.gif"/></alternatives></inline-formula> moves on any minimal <italic>x</italic> to <italic>y</italic> path. Any such path must fix the ranks of each common edge. In other words, if <inline-formula id="IEq300"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_1$$\end{document}</tex-math><mml:math id="M604"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq300.gif"/></alternatives></inline-formula> is the number of trees in <italic>U</italic> which are obtained from <italic>x</italic> by a rank move corresponding to a common edge and <inline-formula id="IEq301"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_2$$\end{document}</tex-math><mml:math id="M606"><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq301.gif"/></alternatives></inline-formula> is the number of trees in <italic>U</italic> which are obtained from <italic>x</italic> by a rank move corresponding to a unique edge of <italic>x</italic>, then <inline-formula id="IEq302"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_1 + r_2 \le d(x,y)$$\end{document}</tex-math><mml:math id="M608"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq302.gif"/></alternatives></inline-formula>, because the <inline-formula id="IEq303"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_1$$\end{document}</tex-math><mml:math id="M610"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq303.gif"/></alternatives></inline-formula> moves have to be done along every shortest path from <italic>x</italic> to <italic>y</italic>. Thus, the total size of <italic>R</italic> is bounded by <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>).</p><p id="Par97">The bound of <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) on the number of length changes that can be applied to move <italic>x</italic> closer to <italic>y</italic> follows similarly. Therefore, there are at most <inline-formula id="IEq304"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|I| + |R| + |L| \le 2d(x,y) + d(x,y) + d(x,y) = 4d(x,y)$$\end{document}</tex-math><mml:math id="M612"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq304.gif"/></alternatives></inline-formula> trees <inline-formula id="IEq305"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \in N(x)$$\end{document}</tex-math><mml:math id="M614"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq305.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq306"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(u, y) \le d(x, y)$$\end{document}</tex-math><mml:math id="M616"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq306.gif"/></alternatives></inline-formula>.</p><p id="Par98">The statement for the other two graphs follows similarly: for <inline-formula id="IEq307"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M618"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq307.gif"/></alternatives></inline-formula> we need to count only for trees from <italic>I</italic> and <italic>R</italic>, for <inline-formula id="IEq308"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M620"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq308.gif"/></alternatives></inline-formula> we will have to add 2<italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) instead of <italic>d</italic>(<italic>x</italic>,&#x000a0;<italic>y</italic>) for <italic>L</italic>. <inline-formula id="IEq309"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M622"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq309.gif"/></alternatives></inline-formula>
</p><p>We conclude by noting that most of the results in this paper can be generalized to the class of sampled ancestor trees (Gavryushkina et&#x000a0;al. <xref ref-type="bibr" rid="CR15">2014</xref>), where <inline-formula id="IEq310"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {DtT}$$\end{document}</tex-math><mml:math id="M624"><mml:mi mathvariant="normal">DtT</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq310.gif"/></alternatives></inline-formula> trees are enriched by an extra event called <italic>sampled ancestor</italic>&#x02014;an internal node marked by a taxon with exactly one child. However, currently only a few methods of sampling the space of sampled ancestor trees are known (Gavryushkina et&#x000a0;al. <xref ref-type="bibr" rid="CR14">2016</xref>) and the geometry of the space is poorly understood (Gavryushkin and Drummond <xref ref-type="bibr" rid="CR13">2016</xref>), hence we do not include the generalization here.</p></sec></sec></sec><sec id="Sec10"><title>Discussion</title><p id="Par100">In this paper, we have introduced a hierarchy of discrete time-trees that naturally approximates the full space of phylogenetic time-trees. The first two levels of the hierarchy are the well-known classes of rooted phylogenetic trees and ranked phylogenetic trees. We extend this previous work by considering a novel graph structure, the <inline-formula id="IEq311"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M626"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq311.gif"/></alternatives></inline-formula> graph, on the set of ranked trees. In the same way that the <inline-formula id="IEq312"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M628"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq312.gif"/></alternatives></inline-formula> graph is the discrete component of the full space of phylogenetic trees, the <inline-formula id="IEq313"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M630"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq313.gif"/></alternatives></inline-formula> graph is the simplest discrete component of the full space of time-trees. Hence, the introduced hierarchy fits and refines naturally the classical picture of phylogenetic graphs.</p><p id="Par101">Surprisingly, the geometry of <inline-formula id="IEq314"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M632"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq314.gif"/></alternatives></inline-formula> and <inline-formula id="IEq315"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M634"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq315.gif"/></alternatives></inline-formula> graphs differ in many aspects including the diameter, the sizes of neighborhoods, and the convexity of caterpillar trees. This suggests that the computational complexity of computing distances in the two graphs is likely to be different, at least at the level of certain subgraphs such as the restriction to caterpillar trees. Although the size of discrete ranked graphs are much larger than their <inline-formula id="IEq316"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M636"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq316.gif"/></alternatives></inline-formula> graph counterparts, ranks provide an inherent structure that may serve as a useful avenue of attack for future algorithms.</p><p id="Par102">We introduce and make some initial progress on the computational complexity of calculating the distance between two time-trees (Problem&#x000a0;<xref ref-type="sec" rid="FPar1">1</xref>). This is an important step for further progress in theoretical research as well as computational and biological applications of time-trees. In particular, a better understanding of this problem would have the following applications.</p><sec id="Sec11"><title>Efficient tree search algorithms</title><p id="Par103">Some of the most popular phylogenetic time-tree inference methods utilize the Markov Chain Monte Carlo (MCMC) algorithm to sample a probability distribution over the space of time-trees. The most efficient proposals on time-trees will take into account both local and global geometry of the corresponding space. Our hierarchy of discrete time-trees offers a natural discrete structure of the space used in such tree proposals.</p><p id="Par104">Thus far, the most widely used modifications of trees are <inline-formula id="IEq317"><alternatives><tex-math id="M637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {NNI}$$\end{document}</tex-math><mml:math id="M638"><mml:mi mathvariant="normal">NNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq317.gif"/></alternatives></inline-formula>, SPR, and their variants. The graph distance inherited from these modifications is known to be NP-hard to compute, and although sometimes NP-hard problems can be solved efficiently for practically interesting data sets, this is not the case for these phylogenetic graphs of ranked trees, where the size of tractable problems is an order of magnitude smaller than those that routinely arise in practice. Hence, a computationally tractable phylogenetic graph is a highly relevant and desirable object for the field, and we believe that the <inline-formula id="IEq318"><alternatives><tex-math id="M639">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {RNNI}$$\end{document}</tex-math><mml:math id="M640"><mml:mi mathvariant="normal">RNNI</mml:mi></mml:math><inline-graphic xlink:href="285_2017_1167_Article_IEq318.gif"/></alternatives></inline-formula> graph should have this property.</p></sec><sec id="Sec12"><title>Convergence of phylogenetic algorithms</title><p id="Par105">A tractable phylogenetic distance would greatly assist methods to assess convergence of Bayesian tree inference algorithms based on MCMC and related methods. In other areas of statistics, distance methods are widely used to test for convergence, but the computational complexity of phylogenetic distances makes those methods applicable to only very moderate data sizes. Phylogenetic distances are especially suitable for such applications because they correspond to the distance inherited from the inference algorithm, being based on the same sorts of tree rearrangements.</p><p id="Par106">Another important property for phylogenetic applications is to compute the number of trees that are &#x0201c;equally good&#x0201d; under certain criterion. This intuition is formalized by Sanderson et&#x000a0;al. (<xref ref-type="bibr" rid="CR32">2011</xref>) in the notion of a terrace. To compute the terrace, an efficient tree metric is of crucial importance.</p></sec></sec></body><back><fn-group><fn><p>AG was supported by Marsden Fund of the Royal Society of New Zealand, Grant UOA1324, through the Centre for Computational Evolution, the University of Auckland, where this work has been carried out. This work was done in part while AG was visiting Fred Hutchinson Cancer Research Center. CW and FM were funded by National Science Foundation Awards 1223057 and 1564137. CW is a Simons Foundation Fellow of the Life Sciences Research Foundation. FM supported in part by a Faculty Scholar grant from the Howard Hughes Medical Institute and the Simons Foundation.</p></fn></fn-group><ref-list id="Bib1"><title>References</title><ref id="CR1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>&#x000c5;kerborg</surname><given-names>&#x000d6;</given-names></name><name><surname>Sennblad</surname><given-names>B</given-names></name><name><surname>Lagergren</surname><given-names>J</given-names></name></person-group><article-title>Birth-death prior on phylogeny and speed dating</article-title><source>BMC Evol Biol</source><year>2008</year><volume>8</volume><issue>1</issue><fpage>77</fpage><pub-id pub-id-type="doi">10.1186/1471-2148-8-77</pub-id><pub-id pub-id-type="pmid">18318893</pub-id></element-citation></ref><ref id="CR2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baele</surname><given-names>G</given-names></name><name><surname>Li</surname><given-names>WLS</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Lemey</surname><given-names>P</given-names></name></person-group><article-title>Accurate model selection of relaxed molecular clocks in bayesian phylogenetics</article-title><source>Mol Biol Evol</source><year>2013</year><volume>30</volume><issue>2</issue><fpage>239</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1093/molbev/mss243</pub-id><pub-id pub-id-type="pmid">23090976</pub-id></element-citation></ref><ref id="CR3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beerli</surname><given-names>P</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Maximum likelihood estimation of a migration matrix and effective population sizes in n subpopulations by using a coalescent approach</article-title><source>Proc Natl Acad Sci USA</source><year>2001</year><volume>98</volume><issue>8</issue><fpage>4563</fpage><lpage>4568</lpage><pub-id pub-id-type="doi">10.1073/pnas.081068098</pub-id><pub-id pub-id-type="pmid">11287657</pub-id></element-citation></ref><ref id="CR4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beiko</surname><given-names>RG</given-names></name><name><surname>Keith</surname><given-names>JM</given-names></name><name><surname>Harlow</surname><given-names>TJ</given-names></name><name><surname>Ragan</surname><given-names>MA</given-names></name></person-group><article-title>Searching for convergence in phylogenetic markov chain monte carlo</article-title><source>Syst Biol</source><year>2006</year><volume>55</volume><issue>4</issue><fpage>553</fpage><lpage>565</lpage><pub-id pub-id-type="doi">10.1080/10635150600812544</pub-id><pub-id pub-id-type="pmid">16857650</pub-id></element-citation></ref><ref id="CR5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Billera</surname><given-names>LJ</given-names></name><name><surname>Holmes</surname><given-names>SP</given-names></name><name><surname>Vogtmann</surname><given-names>K</given-names></name></person-group><article-title>Geometry of the space of phylogenetic trees</article-title><source>Adv Appl Math</source><year>2001</year><volume>27</volume><issue>4</issue><fpage>733</fpage><lpage>767</lpage><pub-id pub-id-type="doi">10.1006/aama.2001.0759</pub-id></element-citation></ref><ref id="CR6"><mixed-citation publication-type="other">Dasgupta B, He X, Jiang T, Li M, Tromp J, Zhang L (2000) On computing the nearest neighbor interchange distance. In: Discrete mathematical problems with medical applications: DIMACS workshop discrete mathematical problems with medical applications, 8&#x02013;10 Dec 1999, DIMACS Center, vol 55, p 19. American Mathematical Society</mixed-citation></ref><ref id="CR7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Ho</surname><given-names>SYW</given-names></name><name><surname>Phillips</surname><given-names>MJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name></person-group><article-title>Relaxed phylogenetics and dating with confidence</article-title><source>PLOS Biol</source><year>2006</year><volume>4</volume><issue>5</issue><fpage>e88</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id><pub-id pub-id-type="pmid">16683862</pub-id></element-citation></ref><ref id="CR8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Nicholls</surname><given-names>GK</given-names></name><name><surname>Rodrigo</surname><given-names>AG</given-names></name><name><surname>Solomon</surname><given-names>W</given-names></name></person-group><article-title>Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data</article-title><source>Genetics</source><year>2002</year><volume>161</volume><issue>3</issue><fpage>1307</fpage><lpage>20</lpage><pub-id pub-id-type="pmid">12136032</pub-id></element-citation></ref><ref id="CR9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Shapiro</surname><given-names>B</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name></person-group><article-title>Bayesian coalescent inference of past population dynamics from molecular sequences</article-title><source>Mol Biol Evol</source><year>2005</year><volume>22</volume><issue>5</issue><fpage>1185</fpage><lpage>1192</lpage><pub-id pub-id-type="doi">10.1093/molbev/msi103</pub-id><pub-id pub-id-type="pmid">15703244</pub-id></element-citation></ref><ref id="CR10"><mixed-citation publication-type="other">Felsenstein J, Archie J, Day WH, Maddison W, Meacham C, Rohlf FJ, Swofford D (1986) The newick tree format. <ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip/newicktree.html">http://evolution.genetics.washington.edu/phylip/newicktree.html</ext-link></mixed-citation></ref><ref id="CR11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ford</surname><given-names>D</given-names></name><name><surname>Matsen</surname><given-names>FA</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><article-title>A method for investigating relative timing information on phylogenetic trees</article-title><source>Syst Biol</source><year>2009</year><volume>58</volume><issue>2</issue><fpage>167</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syp018</pub-id><pub-id pub-id-type="pmid">20525576</pub-id></element-citation></ref><ref id="CR12"><mixed-citation publication-type="other">Gavryushkin A, Drummond AJ (2015) Taugeodesic. doi:10.5281/zenodo.47152</mixed-citation></ref><ref id="CR13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gavryushkin</surname><given-names>A</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>The space of ultrametric phylogenetic trees</article-title><source>J Theor Biol</source><year>2016</year><volume>403</volume><fpage>197</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.05.001</pub-id><pub-id pub-id-type="pmid">27188249</pub-id></element-citation></ref><ref id="CR14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gavryushkina</surname><given-names>A</given-names></name><name><surname>Heath</surname><given-names>TA</given-names></name><name><surname>Ksepka</surname><given-names>DT</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name><name><surname>Welch</surname><given-names>D</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Bayesian total-evidence dating reveals the recent crown radiation of penguins</article-title><source>Syst Biol</source><year>2016</year></element-citation></ref><ref id="CR15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gavryushkina</surname><given-names>A</given-names></name><name><surname>Welch</surname><given-names>D</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Bayesian inference of sampled ancestor trees for epidemiology and fossil calibration</article-title><source>PLOS Comput Biol</source><year>2014</year><volume>10</volume><issue>12</issue><fpage>e1003919</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003919</pub-id><pub-id pub-id-type="pmid">25474353</pub-id></element-citation></ref><ref id="CR16"><mixed-citation publication-type="other">Hohna S, Defoin-Platel M, Drummond AJ (2008) Clock-constrained tree proposal operators in bayesian phylogenetic inference. In: 8th IEEE international conference on 8th IEEE international conference on bioinformatics and bioengineering, BIBE 2008, pp 1&#x02013;7. doi:10.1109/BIBE.2008.4696663</mixed-citation></ref><ref id="CR17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>KT</given-names></name><name><surname>Spillner</surname><given-names>A</given-names></name><name><surname>Suchecki</surname><given-names>R</given-names></name><name><surname>Moulton</surname><given-names>V</given-names></name></person-group><article-title>Metrics on multilabeled trees: interrelationships and diameter bounds</article-title><source>IEEE/ACM Trans Comput Biol Bioinform</source><year>2011</year><volume>8</volume><issue>4</issue><fpage>1029</fpage><lpage>1040</lpage><pub-id pub-id-type="doi">10.1109/TCBB.2010.122</pub-id><pub-id pub-id-type="pmid">21116046</pub-id></element-citation></ref><ref id="CR18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhner</surname><given-names>M&#x000a0;K</given-names></name></person-group><article-title>LAMARC 2.0: maximum likelihood and bayesian estimation of population parameters</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><issue>6</issue><fpage>768</fpage><lpage>770</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btk051</pub-id><pub-id pub-id-type="pmid">16410317</pub-id></element-citation></ref><ref id="CR19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhner</surname><given-names>MK</given-names></name><name><surname>Beerli</surname><given-names>P</given-names></name><name><surname>Yamato</surname><given-names>J</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Usefulness of single nucleotide polymorphism data for estimating population parameters</article-title><source>Genetics</source><year>2000</year><volume>156</volume><issue>1</issue><fpage>439</fpage><lpage>447</lpage><pub-id pub-id-type="pmid">10978306</pub-id></element-citation></ref><ref id="CR20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhner</surname><given-names>MK</given-names></name><name><surname>Yamato</surname><given-names>J</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Estimating effective population size and mutation rate from sequence data using Metropolis-Hastings sampling</article-title><source>Genetics</source><year>1995</year><volume>140</volume><issue>4</issue><fpage>1421</fpage><lpage>1430</lpage><pub-id pub-id-type="pmid">7498781</pub-id></element-citation></ref><ref id="CR21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhner</surname><given-names>MK</given-names></name><name><surname>Yamato</surname><given-names>J</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Maximum likelihood estimation of population growth rates based on the coalescent</article-title><source>Genetics</source><year>1998</year><volume>149</volume><issue>1</issue><fpage>429</fpage><lpage>434</lpage><pub-id pub-id-type="pmid">9584114</pub-id></element-citation></ref><ref id="CR22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lakner</surname><given-names>C</given-names></name><name><surname>Van Der Mark</surname><given-names>P</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Larget</surname><given-names>B</given-names></name><name><surname>Ronquist</surname><given-names>F</given-names></name></person-group><article-title>Efficiency of Markov chain Monte Carlo tree proposals in Bayesian phylogenetics</article-title><source>Syst Biol</source><year>2008</year><volume>57</volume><issue>1</issue><fpage>86</fpage><lpage>103</lpage><pub-id pub-id-type="doi">10.1080/10635150801886156</pub-id><pub-id pub-id-type="pmid">18278678</pub-id></element-citation></ref><ref id="CR23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>A</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><article-title>Birth-death models and coalescent point processes: the shape and probability of reconstructed phylogenies</article-title><source>Theor Popul Biol</source><year>2013</year><volume>90</volume><fpage>113</fpage><lpage>128</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2013.10.002</pub-id><pub-id pub-id-type="pmid">24157567</pub-id></element-citation></ref><ref id="CR24"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Tromp</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Cai</surname><given-names>J-Y</given-names></name><name><surname>Wong</surname><given-names>C</given-names></name></person-group><article-title>Some notes on the nearest neighbour interchange distance</article-title><source>Computing and combinatorics. Lecture notes in computer science</source><year>1996</year><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name><fpage>343</fpage><lpage>351</lpage></element-citation></ref><ref id="CR25"><mixed-citation publication-type="other">Matsen IV FA, Billey S, Kas A, Konvalinka M (2015) Tanglegrams: a reduction tool for mathematical phylogenetics. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1507.04784">arXiv:1507.04784</ext-link> [q-bio.PE]</mixed-citation></ref><ref id="CR26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mau</surname><given-names>B</given-names></name><name><surname>Newton</surname><given-names>MA</given-names></name></person-group><article-title>Phylogenetic inference for binary data on dendograms using Markov chain Monte Carlo</article-title><source>J Comput Graph Stat</source><year>1997</year><volume>6</volume><issue>1</issue><fpage>122</fpage><lpage>131</lpage></element-citation></ref><ref id="CR27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minin</surname><given-names>VN</given-names></name><name><surname>Bloomquist</surname><given-names>EW</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name></person-group><article-title>Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics</article-title><source>Mol Biol Evol</source><year>2008</year><volume>25</volume><issue>7</issue><fpage>1459</fpage><lpage>1471</lpage><pub-id pub-id-type="doi">10.1093/molbev/msn090</pub-id><pub-id pub-id-type="pmid">18408232</pub-id></element-citation></ref><ref id="CR28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mossel</surname><given-names>E</given-names></name><name><surname>Vigoda</surname><given-names>E</given-names></name></person-group><article-title>Phylogenetic MCMC algorithms are misleading on mixtures of trees</article-title><source>Science</source><year>2005</year><volume>309</volume><issue>5744</issue><fpage>2207</fpage><lpage>2209</lpage><pub-id pub-id-type="doi">10.1126/science.1115493</pub-id><pub-id pub-id-type="pmid">16195459</pub-id></element-citation></ref><ref id="CR29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mossel</surname><given-names>E</given-names></name><name><surname>Vigoda</surname><given-names>E</given-names></name></person-group><article-title>Limitations of Markov chain Monte Carlo algorithms for Bayesian inference of phylogeny</article-title><source>Ann Appl Probab</source><year>2006</year><volume>16</volume><issue>4</issue><fpage>2215</fpage><lpage>2234</lpage><pub-id pub-id-type="doi">10.1214/105051600000000538</pub-id></element-citation></ref><ref id="CR30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Page</surname><given-names>RDM</given-names></name></person-group><article-title>Random dendrograms and null hypotheses in cladistic biogeography</article-title><source>Syst Zool</source><year>1991</year><volume>40</volume><issue>1</issue><fpage>54</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.2307/2992221</pub-id></element-citation></ref><ref id="CR31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F</given-names></name><name><surname>Larget</surname><given-names>B</given-names></name><name><surname>Huelsenbeck</surname><given-names>J&#x000a0;P</given-names></name><name><surname>Kadane</surname><given-names>J&#x000a0;B</given-names></name><name><surname>Simon</surname><given-names>D</given-names></name><name><surname>van&#x000a0;der Mark</surname><given-names>P</given-names></name></person-group><article-title>Comment on &#x0201c;Phylogenetic MCMC algorithms are misleading on mixtures of trees&#x0201d;</article-title><source>Science</source><year>2006</year><volume>312</volume><issue>5772</issue><fpage>367</fpage><pub-id pub-id-type="doi">10.1126/science.1123622</pub-id><pub-id pub-id-type="pmid">16627724</pub-id></element-citation></ref><ref id="CR32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>MJ</given-names></name><name><surname>McMahon</surname><given-names>MM</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><article-title>Terraces in phylogenetic tree space</article-title><source>Science</source><year>2011</year><volume>333</volume><issue>6041</issue><fpage>448</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1126/science.1206357</pub-id><pub-id pub-id-type="pmid">21680810</pub-id></element-citation></ref><ref id="CR33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Semple</surname><given-names>C</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><source>Phylogenetics</source><year>2003</year><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="CR34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sleator</surname><given-names>DD</given-names></name><name><surname>Tarjan</surname><given-names>RE</given-names></name><name><surname>Thurston</surname><given-names>WP</given-names></name></person-group><article-title>Short encodings of evolving structures</article-title><source>SIAM J Discrete Math</source><year>1992</year><volume>5</volume><issue>3</issue><fpage>428</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1137/0405034</pub-id></element-citation></ref><ref id="CR35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spade</surname><given-names>DA</given-names></name><name><surname>Herbei</surname><given-names>R</given-names></name><name><surname>Kubatko</surname><given-names>LS</given-names></name></person-group><article-title>A note on the relaxation time of two Markov chains on rooted phylogenetic tree spaces</article-title><source>Stati Probab Lett</source><year>2014</year><volume>84</volume><fpage>247</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1016/j.spl.2013.09.017</pub-id></element-citation></ref><ref id="CR36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>&#x00160;tefankovi&#x0010d;</surname><given-names>D</given-names></name><name><surname>Vigoda</surname><given-names>E</given-names></name></person-group><article-title>Fast convergence of Markov chain Monte Carlo algorithms for phylogenetic reconstruction with homogeneous data on closely related species</article-title><source>SIAM J Discrete Math</source><year>2011</year><volume>25</volume><issue>3</issue><fpage>1194</fpage><lpage>1211</lpage><pub-id pub-id-type="doi">10.1137/100790550</pub-id></element-citation></ref><ref id="CR37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whidden</surname><given-names>C</given-names></name><name><surname>Matsen</surname><given-names>FA</given-names><suffix>IV</suffix></name></person-group><article-title>Quantifying MCMC exploration of phylogenetic tree space</article-title><source>Syst Biol</source><year>2015</year><volume>1063&#x02013;5157</volume><fpage>1076</fpage><lpage>836X</lpage></element-citation></ref><ref id="CR38"><mixed-citation publication-type="other">Whidden C, Matsen IV FA (2016) Ricci-Ollivier curvature of the rooted phylogenetic Subtree-Prune-Regraft graph. In: Proceedings of the thirteenth workshop on analytic algorithmics and combinatorics (ANALCO16), pp 106&#x02013;120. url: <ext-link ext-link-type="uri" xlink:href="http://epubs.siam.org/doi/abs/10.1137/1.9781611974324.6">http://epubs.siam.org/doi/abs/10.1137/1.9781611974324.6</ext-link></mixed-citation></ref><ref id="CR39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Worobey</surname><given-names>M</given-names></name><name><surname>Gemmel</surname><given-names>M</given-names></name><name><surname>Teuwen</surname><given-names>DE</given-names></name><name><surname>Haselkorn</surname><given-names>T</given-names></name><name><surname>Kunstman</surname><given-names>K</given-names></name><name><surname>Bunce</surname><given-names>M</given-names></name><name><surname>Muyembe</surname><given-names>J-J</given-names></name><name><surname>Kabongo</surname><given-names>J-MM</given-names></name><name><surname>Kalengayi</surname><given-names>RM</given-names></name><name><surname>Van Marck</surname><given-names>E</given-names></name><name><surname>Gilbert</surname><given-names>MTP</given-names></name><name><surname>Wolinsky</surname><given-names>SM</given-names></name></person-group><article-title>Direct evidence of extensive diversity of HIV-1 in kinshasa by 1960</article-title><source>Nature</source><year>2008</year><volume>455</volume><issue>7213</issue><fpage>661</fpage><lpage>664</lpage><pub-id pub-id-type="doi">10.1038/nature07390</pub-id><pub-id pub-id-type="pmid">18833279</pub-id></element-citation></ref><ref id="CR40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name></person-group><article-title>Bayesian phylogenetic inference using DNA sequences: a Markov chain Monte Carlo method</article-title><source>Mol Biol Evol</source><year>1997</year><volume>14</volume><issue>7</issue><fpage>717</fpage><lpage>724</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025811</pub-id><pub-id pub-id-type="pmid">9214744</pub-id></element-citation></ref></ref-list></back></article>