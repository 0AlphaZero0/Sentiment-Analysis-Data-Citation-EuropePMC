<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">J R Soc Interface</journal-id><journal-id journal-id-type="iso-abbrev">J R Soc Interface</journal-id><journal-id journal-id-type="publisher-id">RSIF</journal-id><journal-id journal-id-type="hwp">royinterface</journal-id><journal-title-group><journal-title>Journal of the Royal Society Interface</journal-title></journal-title-group><issn pub-type="ppub">1742-5689</issn><issn pub-type="epub">1742-5662</issn><publisher><publisher-name>The Royal Society</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6170769</article-id><article-id pub-id-type="pmid">30185544</article-id><article-id pub-id-type="doi">10.1098/rsif.2018.0512</article-id><article-id pub-id-type="publisher-id">rsif20180512</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>1004</subject><subject>44</subject><subject>22</subject></subj-group><subj-group subj-group-type="heading"><subject>Life Sciences–Mathematics interface</subject></subj-group><subj-group subj-group-type="leader"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title><SecTag type="TITLE"><text><SENT sid="0" pm="."><plain>Detection of HIV transmission clusters from phylogenetic trees using a multi-state birth–death model </plain></SENT>
</text></SecTag></article-title><alt-title alt-title-type="short">Detection of HIV transmission clusters from phylogenetic trees using a multi-state birth–death model</alt-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5220-5468</contrib-id><name><surname>Barido-Sottani</surname><given-names>Joëlle</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref><xref ref-type="corresp" rid="cor1"/></contrib><contrib contrib-type="author"><name><surname>Vaughan</surname><given-names>Timothy G.</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6431-535X</contrib-id><name><surname>Stadler</surname><given-names>Tanja</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref></contrib></contrib-group><aff id="af1"><label>1</label><addr-line>Department of Biosystems Science and Engineering</addr-line>, <addr-line>ETH Zürich</addr-line>, <addr-line>Basel</addr-line>, <country>Switzerland</country></aff><aff id="af2"><label>2</label><institution>Swiss Institute of Bioinformatics (SIB)</institution>, <country>Switzerland</country></aff><author-notes><corresp id="cor1">e-mail: <email>joelle.barido-sottani@m4x.org</email></corresp><fn fn-type="other"><p><text><SENT sid="1" pm="."><plain>Electronic supplementary material is available online at https://dx.doi.org/10.6084/m9.figshare.c.4206257. </plain></SENT>
</text></p></fn></author-notes><pub-date pub-type="ppub"><month>9</month><year>2018</year></pub-date><pub-date pub-type="epub"><day>5</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>5</day><month>9</month><year>2018</year></pub-date><volume>15</volume><issue>146</issue><elocation-id>20180512</elocation-id><history><date date-type="received"><day>6</day><month>7</month><year>2018</year></date><date date-type="accepted"><day>13</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>© 2018 The Authors.</copyright-statement><copyright-year>2018</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>Published by the Royal Society under the terms of the Creative Commons Attribution License <uri xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>, which permits unrestricted use, provided the original author and source are credited.</license-p></license><?release-delay 0|0?></permissions><self-uri content-type="pdf" xlink:href="rsif20180512.pdf"/><abstract><p><SecTag type="ABS"><text><SENT sid="2" pm="."><plain>HIV patients form clusters in HIV transmission networks. </plain></SENT>
<SENT sid="3" pm="."><plain>Accurate identification of these transmission clusters is essential to effectively target public health interventions. </plain></SENT>
<SENT sid="4" pm="."><plain>One reason for clustering is that the underlying contact network contains many local communities. </plain></SENT>
<SENT sid="5" pm="."><plain>We present a new maximum-likelihood method for identifying transmission clusters caused by community structure, based on phylogenetic trees. </plain></SENT>
<SENT sid="6" pm="."><plain>The method employs a multi-state birth–death (MSBD) model which detects changes in transmission rate, which are interpreted as the introduction of the epidemic into a new susceptible community, i.e. the formation of a new cluster. </plain></SENT>
<SENT sid="7" pm="."><plain>We show that the MSBD method is able to reliably infer the clusters and the transmission parameters from a pathogen phylogeny based on our simulations. </plain></SENT>
<SENT sid="8" pm="."><plain>In contrast to existing cutpoint-based methods for cluster identification, our method does not require that clusters be monophyletic nor is it dependent on the selection of a difficult-to-interpret cutpoint parameter. </plain></SENT>
<SENT sid="9" pm="."><plain>We present an application of our method to data from the Swiss HIV Cohort Study. </plain></SENT>
<SENT sid="10" pm="."><plain>The method is available as an easy-to-use R package. </plain></SENT>
</text></SecTag></p></abstract><SecTag type="KEYWORD"><kwd-group><kwd>phylodynamics</kwd><kwd>multi-state birth–death model</kwd><kwd>transmission clusters</kwd><kwd>maximum likelihood</kwd></kwd-group></SecTag><funding-group><award-group><funding-source><institution-wrap><institution>FP7 Ideas: European Research Council</institution><institution-id>http://dx.doi.org/10.13039/100011199</institution-id></institution-wrap></funding-source><award-id>PhyPD 335529</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>September, 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><SecTag type="INTRO"><sec id="s1"><label>1.</label><title><text><SENT sid="11" pm="."><plain>Background </plain></SENT>
</text></title><p><text><SENT sid="12" pm="."><plain>Basic epidemiological models rely on the random mixing assumption [1]. </plain></SENT>
<SENT sid="13" pm="."><plain>This requires that each individual in a population has an equal probability of coming into contact with any other individual, which can lead to rapid epidemic spread. </plain></SENT>
<SENT sid="14" pm="."><plain>The random mixing assumption may be appropriate for airborne diseases in small communities. </plain></SENT>
<SENT sid="15" pm="."><plain>For sexually transmitted infections (STIs) such as HIV-1 however, this hypothesis does not hold: STIs spread within sexual contact networks that limit the propagation to a specific subset of individuals. </plain></SENT>
<SENT sid="16" pm="."><plain>Identifying the structure of the sexual contact network has multiple applications, for instance, allowing public health officials to target the populations most vulnerable to infection. </plain></SENT>
</text></p><p><text><SENT sid="17" pm="."><plain>Previous studies have shown that the spread of HIV among men who have sex with men is driven by quick transmission chains, i.e. groups of infected individuals with genetically similar viruses [2,3]. </plain></SENT>
<SENT sid="18" pm="."><plain>We say that patients of such a quick transmission chain form a cluster. </plain></SENT>
<SENT sid="19" pm="."><plain>A cluster is the result of series of infection events very close in time, and their role in spreading the epidemic affects the efficacy of public health policies: the effectiveness of Treatment as Prevention, a policy currently advocated by the WHO [4], will be limited if most of the transmission happens early after infection, before HIV is diagnosed. </plain></SENT>
</text></p><p><text><SENT sid="20" pm="."><plain>One reason for individuals belonging to a quick transmission chain, i.e. for individuals to form a cluster, is that they are part of the same community in the sexual contact network. </plain></SENT>
<SENT sid="21" pm="."><plain>A community is defined as a set of nodes in the sexual contact network such that most or all nodes are connected within a community, but few links exist between communities [5]. </plain></SENT>
<SENT sid="22" pm="."><plain>Communities influence the dynamics of an epidemic: at first, the infection spreads quickly in the community where it has been introduced. </plain></SENT>
<SENT sid="23" pm="."><plain>The rate of transmission then decreases as the population of susceptibles in the community is progressively exhausted [6]. </plain></SENT>
<SENT sid="24" pm="."><plain>Eventually, a new introduction event may occur, where an individual from a previously uninfected community is infected through one of the inter-community connections. </plain></SENT>
<SENT sid="25" pm="."><plain>As the newly infected community is completely susceptible, the rate of transmission then goes up suddenly as new transmission routes open. </plain></SENT>
<SENT sid="26" pm="."><plain>Thus, the community structure of the sexual contact network shapes transmission dynamics and, in turn, leaves a footprint in the phylogeny reconstructed from pathogen genetic sequences of different infected individuals within an epidemic. </plain></SENT>
<SENT sid="27" pm="."><plain>In particular, the community structure induces clusters of individuals in the phylogeny. </plain></SENT>
</text></p><p><text><SENT sid="28" pm="."><plain>Previous studies have found varying degrees of influence of the contact network on the phylogeny. </plain></SENT>
<SENT sid="29" pm="."><plain>Welch [7] found almost no influence of the clustering coefficient of a network on the shape of transmission trees when the degree distribution of the network was kept constant, and Robinson et al. [8] found a modest effect of the degree distribution in the network on the shape of phylogenies reconstructed from simulated genetic data. </plain></SENT>
<SENT sid="30" pm="."><plain>On the other hand, Leventhal et al. [9] and Bohme [10] found that the shapes of phylogenies could be significantly affected by variance in degree distribution and mean path length [9] or in degree correlation and clustering coefficient [10] of the contact network. </plain></SENT>
<SENT sid="31" pm="."><plain>The link between network structures and phylogenies is also affected by viral characteristics such as within-host evolution [11] and recombination [12]. </plain></SENT>
<SENT sid="32" pm="."><plain>Several methods have been proposed to identify structural characteristics, such as connectivity and clustering coefficient, of the population network from a viral phylogeny [13,14]. </plain></SENT>
</text></p><p><text><SENT sid="33" pm="."><plain>Phylogenetic clustering methods aim to find transmission clusters within phylogenies, exploiting the effects that, e.g. contact networks have on phylogenies. </plain></SENT>
<SENT sid="34" pm="."><plain>To this end, a transmission cluster is defined to be a set of individuals belonging to the same transmission chain within a particular community in the contact network. </plain></SENT>
<SENT sid="35" pm="."><plain>We do not investigate other reasons for clustering beyond the contact network. </plain></SENT>
<SENT sid="36" pm="."><plain>Phylogenetic clustering methods, which we will refer to as ‘cutpoint-based’ methods, were evaluated in [15], also under the assumption that clustering is caused by the contact network. </plain></SENT>
<SENT sid="37" pm="."><plain>These cutpoint-based methods differ in how they define the distance between tips of the tree, but they have two major features in common: first, they require a difficult-to-interpret cutpoint parameter to be specified by the user; second, they assume that the clusters are monophyletic in the phylogeny or monophyletic in a tree obtained from hierarchical clustering (Def. </plain></SENT>
<SENT sid="38" pm="."><plain>4 in [15]), i.e. that the most recent common ancestor of all tips belonging to a given cluster has no other descending tips. </plain></SENT>
<SENT sid="39" pm="."><plain>Villandre et al. [15] simulated epidemics and built phylogenetic trees on simulated contact networks, and evaluated the performance of cutpoint-based methods which defined a transmission cluster with cutpoint x as either (i) a clade whose tips are separated by a fixed tree distance of at most x, where tree distance is the sum of branch lengths, (ii) a clade whose elements are separated by a fixed distance of at most x, where distance is the standardized number of different nucleotides between tip sequences, (iii) a clade whose elements are separated by a median pairwise tree distance below x, (with x an arbitrary percentile of the tree's between-tip distance distribution), where tree distance again corresponds to the sum of branch lengths or (iv) a clade in a dendrogram, i.e. an ultrametric tree obtained from the matrix of between-tip tree distances, cut at height x, where the dendrogram was obtained using one of three methods: average linkage, complete linkage or weighted pair-group method of analysis. </plain></SENT>
<SENT sid="40" pm="."><plain>[15] found that the presence of nested, non-monophyletic, clusters in the tree as well as the choice of the cutpoint have a strong impact on the quality of the recovered clusters. </plain></SENT>
<SENT sid="41" pm="."><plain>It also established that the cutpoint values giving the best results for cluster recovery are dependent not only on the distance used but also on the structure of the underlying network. </plain></SENT>
<SENT sid="42" pm="."><plain>Thus, there is a need for a method that does not have these limitations. </plain></SENT>
</text></p><p><text><SENT sid="43" pm="."><plain>Multi-state birth–death (MSBD) models have been widely used to model population structure and analyse phylogenies built from individuals in a structured population [16–19], in phylogeny epidemiological and macroevolutionary applications. </plain></SENT>
<SENT sid="44" pm="."><plain>Thus, in principle, such a model may be used to study the phylogeny produced by a sexual contact network and to infer which tips in a phylogeny belong to which transmission cluster, with birth rates being transmission rates and death rates being removal rates. </plain></SENT>
<SENT sid="45" pm="."><plain>The rationale of the inference is to associate each cluster to a state in the MSBD model, with clusters differing in their transmission dynamics through time. </plain></SENT>
</text></p><p><text><SENT sid="46" pm="."><plain>The Binary State Speciation and Extinction [16] and its extension to multiple states MuSSE, included in the package Diversitree [17], were the first efforts to infer state-specific birth and death rates from ultrametric phylogenies, i.e. trees with all tips sampled at the same point in time, where each tip is assigned to a state. </plain></SENT>
<SENT sid="47" pm="."><plain>In [18], these approaches were extended to non-ultrametric trees. </plain></SENT>
<SENT sid="48" pm="."><plain>More recently, the Beast2 package BDMM [19] allowed the joint reconstruction of a phylogeny and quantification of the parameters of an underlying MSBD model. </plain></SENT>
<SENT sid="49" pm="."><plain>These approaches require the user to specify how many states the model contains and to which state each tip of the phylogeny belongs. </plain></SENT>
<SENT sid="50" pm="."><plain>An exception to the latter is [18], which can integrate over tip states, but does not assign states to tips. </plain></SENT>
</text></p><p><text><SENT sid="51" pm="."><plain>None of the above approaches are directly applicable to the inference of transmission clusters, for two reasons. </plain></SENT>
<SENT sid="52" pm="."><plain>First, the state of tips, i.e. which cluster they belong to, is not known prior to the analysis. </plain></SENT>
<SENT sid="53" pm="."><plain>Second, integrating over the tip states instead of explicitly assigning states to tips means that the partition of tips into clusters cannot be inferred. </plain></SENT>
</text></p><p><text><SENT sid="54" pm="."><plain>The method Bayesian analysis of macroevolutionary mixtures [20] addresses these issues and is able to infer the number of states and to assign each tip to a state. </plain></SENT>
<SENT sid="55" pm="."><plain>Furthermore, the birth- and death-rate parameters associated with each cluster are estimated. </plain></SENT>
<SENT sid="56" pm="."><plain>However, it was designed to be used with macroevolutionary datasets, meaning at the time of writing it could only analyse ultrametric trees. </plain></SENT>
<SENT sid="57" pm="."><plain>For epidemiological datasets, we have non-ultrametric trees as samples are collected through time. </plain></SENT>
<SENT sid="58" pm="."><plain>Furthermore, its results have been called into question, as [21] identified issues regarding the calculation of its likelihood function and its dependency on the user-defined prior for inference of the number of states. </plain></SENT>
</text></p><p><text><SENT sid="59" pm="."><plain>In this paper, we present a new method to identify transmission clusters in a phylogeny built from viral sequences based on the MSBD model. </plain></SENT>
<SENT sid="60" pm="."><plain>We note that other authors [22] conducted a similar clustering study, relying on pure birth models. </plain></SENT>
<SENT sid="61" pm="."><plain>McCloskey &amp; Poon [22] highlight in their acknowledgements section that their study builds upon our ideas which we presented at a conference and outline in the following. </plain></SENT>
<SENT sid="62" pm="."><plain>We assume here that transmission clusters were induced through communities in sexual contact networks. </plain></SENT>
<SENT sid="63" pm="."><plain>When a pathogen spreads through such a contact network, the transmission rate typically increases upon the pathogen entering a new community, as the number of susceptible individuals in the new community is typically larger. </plain></SENT>
<SENT sid="64" pm="."><plain>Our method is designed to detect these ‘jumps’ in transmission rate, which we associate with the formation of a new cluster. </plain></SENT>
<SENT sid="65" pm="."><plain>The method assumes decreasing transmission rates within clusters to account for the depletion of susceptibles. </plain></SENT>
<SENT sid="66" pm="."><plain>In particular, it does not require prior knowledge on the number of clusters or the tip assignment into clusters. </plain></SENT>
<SENT sid="67" pm="."><plain>We evaluate the performance of this new method on the simulated dataset of [15] and compare it to cutpoint-based methods. </plain></SENT>
<SENT sid="68" pm="."><plain>We then apply it to a published HIV phylogeny [14] which was obtained based on 192 sequences from the Swiss HIV Cohort Study (SHCS). </plain></SENT>
<SENT sid="69" pm="."><plain>Finally, we discuss the limitations of the method and planned future work. </plain></SENT>
</text></p></sec></SecTag><SecTag type="METHODS"><sec sec-type="methods" id="s2"><label>2.</label><title><text><SENT sid="70" pm="."><plain>Methods </plain></SENT>
</text></title><sec id="s2a"><label>2.1.</label><title><text><SENT sid="71" pm="."><plain>Model </plain></SENT>
</text></title><p><text><SENT sid="72" pm="."><plain>We assume an MSBD model similar to the model used in the BDMM package [19]. </plain></SENT>
<SENT sid="73" pm="."><plain>The birth–death process starts with one infected individual at time τ &gt; 0 in the past in an ancestral state (i.e. cluster membership) and is stopped at present time 0. </plain></SENT>
<SENT sid="74" pm="."><plain>Thus, we measure time in the backward direction, increasing from the present to the root. </plain></SENT>
<SENT sid="75" pm="."><plain>Without loss of generality, we define the ancestral state to be state 1. </plain></SENT>
<SENT sid="76" pm="."><plain>State changes occur at a per-lineage rate γ. </plain></SENT>
<SENT sid="77" pm="."><plain>Our MSBD model contains an unknown number of states n*. </plain></SENT>
<SENT sid="78" pm="."><plain>We assume identical transition rates between clusters, so that the rate mi,j with which hosts in state i infect hosts in state j is as follows:  </plain></SENT>
</text></p><p><text><SENT sid="79" pm="."><plain>Each individual produces an additional individual at the state- and time-dependent transmission rate λi(t) (function of λ0,i, zi as defined below), and is removed with a state-dependent removal rate μi corresponding to the removal rate or rate of ‘becoming non-infectious’. </plain></SENT>
</text></p><p><text><SENT sid="80" pm="."><plain>The depletion of the susceptible population is modelled by the exponential decay of the transmission rates in the process. </plain></SENT>
<SENT sid="81" pm="."><plain>Each state is associated with a specific initial transmission rate λ0,i and a transmission decay rate zi. λi(t) = λ0,i × ezi(t−t0,i) is the transmission rate of a lineage in state i at time t before the present, where t0,i is the time of the first introduction into state i. </plain></SENT>
<SENT sid="82" pm="."><plain>As t increases into the past, we impose zi ≥ 0 so that the transmission rate decreases towards the present. </plain></SENT>
</text></p><p><text><SENT sid="83" pm="."><plain>The infected individuals are sampled upon removal with a probability σ. </plain></SENT>
<SENT sid="84" pm="."><plain>This birth–death model produces a tree on all infected individuals together with position and times of state changes on the tree, and we obtain the phylogeny by considering the subtree spanned by the sampled infected individuals. </plain></SENT>
<SENT sid="85" pm="."><plain>The phylogeny contains information about the transmission and removal times of the sampled individuals, as well as the positions and times of the state changes, as shown in figure 1. </plain></SENT>
<SENT sid="86" pm="."><plain>We assume that the state changes correspond to introduction events in newly infected clusters, so that all tips inferred to be in the same state belong to the same transmission cluster. Figure 1.Visual representation of the phylogeny under an MSBD model. </plain></SENT>
<SENT sid="87" pm="."><plain>Each state is represented by a colour: the ancestral state, in black, starts at the root and represent the first transmission cluster. </plain></SENT>
<SENT sid="88" pm="."><plain>The other states, in blue, red and green, start at change points along the tree. </plain></SENT>
<SENT sid="89" pm="."><plain>These states represent further transmission clusters in the course of the epidemic, and the state change points represent the introduction of the pathogen into a new community. </plain></SENT>
<SENT sid="90" pm="."><plain>Here tc, tt and ts are the times of, respectively, a state change, transmission and sampling event, as they appear in equation (2.2). </plain></SENT>
</text></p><p><text><SENT sid="91" pm="."><plain>We refer to a node in the phylogeny being either a branching event, a tip, or a state change event. </plain></SENT>
<SENT sid="92" pm="."><plain>Edges in the phylogeny connect any two nodes, so any edge belongs to only one state. </plain></SENT>
</text></p></sec><sec id="s2b"><label>2.2.</label><title><text><SENT sid="93" pm="."><plain>Likelihood function </plain></SENT>
</text></title><p><text><SENT sid="94" pm="."><plain>We now derive the probability density of a phylogeny (including the state changes) given the MSBD parameters, i.e. we derive the likelihood of the parameters given a phylogeny with state changes L(M | T): = pdf(T | M) with pdf being the probability density function. </plain></SENT>
<SENT sid="95" pm="."><plain>A full derivation of all equations can be found in the electronic supplementary material, text §1. </plain></SENT>
</text></p><sec id="s2b1"><label>2.2.1.</label><title><text><SENT sid="96" pm="."><plain>Differential equations </plain></SENT>
</text></title><p><text><SENT sid="97" pm="."><plain>Following [18,19], the likelihood of the model parameters given the phylogeny can be calculated from the differential equations below. </plain></SENT>
<SENT sid="98" pm="."><plain>Equation (2.1) describes the probability pi(t) of a lineage in state i at time t not producing any sampled offspring until the present (referred to extinction probability below). </plain></SENT>
<SENT sid="99" pm="."><plain>Equation (2.2) describes the probability density qi,N(t) of an edge N in state i at time t evolving according to the phylogeny in time interval [t, 0]. </plain></SENT>
</text></p><p><text><SENT sid="100" pm="."><plain>2.1 2.2 </plain></SENT>
</text></p><p><text><SENT sid="101" pm="."><plain>The likelihood of the model parameter given a phylogeny starting at root time τ with initial state I is qI,N(τ), meaning the full likelihood can be calculated from equation (2.2). </plain></SENT>
<SENT sid="102" pm="."><plain>We can also obtain the likelihood per edge by defining the edge likelihood function fN = qi,N(tb)/qi,N(te) for an edge N in state i with start time tb and end time te. fN follows the differential equation in equation (2.2) with initial condition fN(te) = 1. </plain></SENT>
<SENT sid="103" pm="."><plain>The full likelihood of the model M given the phylogeny T is then obtained by multiplying the likelihoods of all edges as shown in equation (2.3), where n is the number of states (including the root state) in the tree, Ni is the set of edges in state i, Ti the set of transmission events in state i and Si the set of tips in state i. 2.3 </plain></SENT>
</text></p><p><text><SENT sid="104" pm="."><plain>This likelihood function can be applied to trees with or without a root edge, i.e. trees starting with one lineage or two at time τ. </plain></SENT>
</text></p></sec></sec><sec id="s2c"><label>2.3.</label><title><text><SENT sid="105" pm="."><plain>Approximations to the likelihood function </plain></SENT>
</text></title><p><text><SENT sid="106" pm="."><plain>The model as described so far is mathematically rigorous; however, performing a maximum-likelihood (ML) inference on this model is computationally complex. </plain></SENT>
<SENT sid="107" pm="."><plain>As a result, we now introduce several approximations. </plain></SENT>
</text></p><sec id="s2c1"><label>2.3.1.</label><title><text><SENT sid="108" pm="."><plain>Ignoring state changes in unsampled subtrees </plain></SENT>
</text></title><p><text><SENT sid="109" pm="."><plain>The equations for p and fN do not have an analytical solution. </plain></SENT>
<SENT sid="110" pm="."><plain>Numerical integration is computationally expensive and can be unstable for certain parameters. </plain></SENT>
<SENT sid="111" pm="."><plain>We thus make the assumption that no state changes happen in the unsampled parts of the tree, meaning all state changes occur on lineages that are observed in the final tree. </plain></SENT>
<SENT sid="112" pm="."><plain>With this assumption, the master equation for pi(t) changes to equation (2.4). 2.4 </plain></SENT>
</text></p></sec><sec id="s2c2"><label>2.3.2.</label><title><text><SENT sid="113" pm="."><plain>Simplifying the number of states </plain></SENT>
</text></title><p><text><SENT sid="114" pm="."><plain>As the real number of states in the underlying network n* is unknown, we need to estimate it. </plain></SENT>
<SENT sid="115" pm="."><plain>However, once the approximation described in the previous section is applied, this parameter only appears in the likelihood in the factor (γ/(n* −1))n−1, so maximizing the likelihood is equivalent to minimizing n*. </plain></SENT>
<SENT sid="116" pm="."><plain>We further assume that each migration enters a previously not visited state, i.e. n* ≥ n. </plain></SENT>
<SENT sid="117" pm="."><plain>Together, the ML estimate will always be n* = n. </plain></SENT>
<SENT sid="118" pm="."><plain>Thus, we fix n* = n in the inference. </plain></SENT>
</text></p></sec><sec id="s2c3"><label>2.3.3.</label><title><text><SENT sid="119" pm="."><plain>Time discretization </plain></SENT>
</text></title><p><text><SENT sid="120" pm="."><plain>Equations (2.4) and (2.2) have an analytical solution for constant transmission and removal rates, but not necessarily for time-dependent rates. </plain></SENT>
<SENT sid="121" pm="."><plain>To obtain a closed form solution, we use time discretization and assume that the transmission rates can be considered locally constant on small enough intervals. </plain></SENT>
<SENT sid="122" pm="."><plain>The grid size used for the discretization is fixed across the tree and needs to be specified by the user. </plain></SENT>
<SENT sid="123" pm="."><plain>A smaller size will improve the accuracy of the likelihood calculation but also increase the computational cost. </plain></SENT>
</text></p><sec id="s2c3a"><label>2.3.3.1.</label><title><text><SENT sid="124" pm="."><plain>Time discretization for p </plain></SENT>
</text></title><p><text><SENT sid="125" pm="."><plain>A closed form of the extinction probability and the likelihood function can be obtained for piecewise constant transmission and removal rates. </plain></SENT>
<SENT sid="126" pm="."><plain>Assuming constant rates in equation (2.4), and a generic initial condition pi(tIC) = VIC (rather than the initial condition pi(0) = 1), we obtain an analytic solution of equation (2.4) 2.5This solution can be verified by differentiating the solution and substituting the result into equation (2.4). </plain></SENT>
</text></p><p><text><SENT sid="127" pm="."><plain>To obtain pi(t) using this time discretization, we divide the time interval [τ; 0] into a grid. </plain></SENT>
<SENT sid="128" pm="."><plain>Starting with pi(0) = 1, we can then evaluate pi using equation (2.5) in each grid interval going backwards in time, using as initial value the solution of the previous grid interval. </plain></SENT>
</text></p></sec><sec id="s2c3b"><label>2.3.3.2.</label><title><text><SENT sid="129" pm="."><plain>Time discretization for fN </plain></SENT>
</text></title><p><text><SENT sid="130" pm="."><plain>A closed-form solution of the edge-likelihood function fN can now be calculated, for a small time interval [tl; tl−1] on an edge N in state i. </plain></SENT>
<SENT sid="131" pm="."><plain>This expression uses the value of pi(tl−1), calculated as explained above. </plain></SENT>
<SENT sid="132" pm="."><plain>We define fN(t, tl−1) = qi,N(t)/qi,N(tl−1), and obtain 2.6with c, xi and yi as defined in equation (2.5). </plain></SENT>
</text></p><p><text><SENT sid="133" pm="."><plain>This expression for fN(t, tl−1) is a solution of the differential equation (2.2) on the interval [tl, tl−1] with fN(tl−1) = 1, assuming the rates λi are constant in this interval and using the approximate function pi(t) from equation (2.5). </plain></SENT>
<SENT sid="134" pm="."><plain>This can be easily verified by differentiating equation (2.6) and substituting the resulting (d/dt)fN(tl, tl−1) into the differential equation (2.2). </plain></SENT>
<SENT sid="135" pm="."><plain>We then have . </plain></SENT>
</text></p><p><text><SENT sid="136" pm="."><plain>Equations (2.5) and (2.6) are identical in form to the expressions used in the birth–death skyline model [23], with the piecewise constant birth rate variation being governed by the exponential decay mechanism described earlier. </plain></SENT>
</text></p></sec></sec></sec><sec id="s2d"><label>2.4.</label><title><text><SENT sid="137" pm="."><plain>Algorithm </plain></SENT>
</text></title><p><text><SENT sid="138" pm="."><plain>We now present an algorithm which identifies the cluster configuration and associated parameters that maximize the likelihood in equation (2.3) for a particular phylogeny T. </plain></SENT>
<SENT sid="139" pm="."><plain>More details can be found in the electronic supplementary material, text §2. </plain></SENT>
</text></p><sec id="s2d1"><label>2.4.1.</label><title><text><SENT sid="140" pm="."><plain>Maximum-likelihood search </plain></SENT>
</text></title><p><text><SENT sid="141" pm="."><plain>We use a greedy approach to add state changes until no further improvement of the likelihood can be obtained. </plain></SENT>
<SENT sid="142" pm="."><plain>New ML estimates are obtained for all transmission, decay, removal and state change rates each time a new state change is added, but the positions and times of previous state changes are fixed. </plain></SENT>
</text></p><p><text><SENT sid="143" pm="."><plain>Once a configuration has been found in which no more state changes can be added to improve the likelihood, we will attempt to recursively remove all the states from this configuration. </plain></SENT>
<SENT sid="144" pm="."><plain>This step is designed to compensate partly for the fact that the greedy approach never goes back on previous state change assignments, and so can end up in sub-optimal configurations. </plain></SENT>
</text></p><p><text><SENT sid="145" pm="."><plain>Once no further improvements of the likelihood can be obtained by either adding or removing a state, the method will return the best fitting model found, including the state configuration and the ML estimates for all parameters. </plain></SENT>
</text></p><p><text><SENT sid="146" pm="."><plain>The full algorithm is as follows: (1)Find the most likely parameters for a one-state birth–death model (i.e. with identical birth and death rates across the tree).(2)For all edges in the tree: (a)add a state change on this edge, then(b)find the most likely parameters (i.e. transmission, removal and state change rates) for this state configuration, then(c)keep this configuration as candidate if its likelihood is higher than previously tested configurations with n + 1 states.(3)If a configuration with n + 1 states was found that is more likely than the configuration with n states, keep it and go back to step 2.(4)For each state change in the configuration:(a)remove this state change.(b)find the most likely parameters for this state configuration, and(c)if the configuration without this state was more likely than the previous configuration, keep it.(5)If at least one state was removed, go back to step 4.(6)Otherwise, end and record the most likely model. </plain></SENT>
</text></p></sec><sec id="s2d2"><label>2.4.2.</label><title><text><SENT sid="147" pm="."><plain>Time positions of state changes </plain></SENT>
</text></title><p><text><SENT sid="148" pm="."><plain>The model and the likelihood function allow for state changes to be placed anywhere on an edge. </plain></SENT>
<SENT sid="149" pm="."><plain>However, comparing the likelihood values between configurations with different numbers of states is a problem in an ML framework, as the parameter spaces are of different sizes: indeed, the time of introduction into the n + 1th cluster is an additional continuous parameter. </plain></SENT>
<SENT sid="150" pm="."><plain>To allow an optimization across different numbers of states, we thus limit the positioning of state changes to predetermined discrete positions on edges: they can be positioned at either 10%, 50% or 90% of the length of the edge they are on. </plain></SENT>
<SENT sid="151" pm="."><plain>An intermediate option is also available, which will test all three predetermined options and keep the most likely. </plain></SENT>
</text></p><p><text><SENT sid="152" pm="."><plain>In the actual epidemic, an introduction event is always simultaneous with a transmission event, which is not possible under our MSBD model. </plain></SENT>
<SENT sid="153" pm="."><plain>However, cluster introduction events can be placed close to transmission events in the tree, so this should not affect the accuracy of the inference. </plain></SENT>
<SENT sid="154" pm="."><plain>Furthermore, due to incomplete sampling, the introduction events may actually fall on branches. </plain></SENT>
</text></p></sec></sec><sec id="s2e"><label>2.5.</label><title><text><SENT sid="155" pm="."><plain>Implementation </plain></SENT>
</text></title><p><text><SENT sid="156" pm="."><plain>The likelihood calculation and ML inference are implemented as the publicly available R package ML.MSBD. </plain></SENT>
<SENT sid="157" pm="."><plain>The package takes as input a phylogenetic tree with branches in units of time, in the phylo format implemented by the package APE [24]. </plain></SENT>
<SENT sid="158" pm="."><plain>Partial results of the inference are automatically saved after each optimization step, so that an interrupted run can be resumed at any point. </plain></SENT>
<SENT sid="159" pm="."><plain>The full results returned include the best estimates for the number and positions of cluster introductions, as well as all initial transmission rates, transmission decay rates and removal rates of each state. </plain></SENT>
<SENT sid="160" pm="."><plain>Furthermore, we return the ML values for each number of states n up to  where  is the ML inferred number of states. </plain></SENT>
<SENT sid="161" pm="."><plain>An evaluation of the performance of the package can be found in the electronic supplementary material, text §5. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="RESULTS"><sec id="s3"><label>3.</label><title><text><SENT sid="162" pm="."><plain>Results </plain></SENT>
</text></title><sec id="s3a"><label>3.1.</label><title><text><SENT sid="163" pm="."><plain>Cluster inference on simulated data </plain></SENT>
</text></title><sec id="s3a1"><label>3.1.1.</label><title><text><SENT sid="164" pm="."><plain>Dataset </plain></SENT>
</text></title><p><text><SENT sid="165" pm="."><plain>We use a simulated dataset produced by Villandre et al. [15], which contains simulated epidemics on three different types of networks, A, B and C. </plain></SENT>
<SENT sid="166" pm="."><plain>The network structure A is composed of 13 communities of 20 subjects each, with each community being a fully connected graph and one bridge linking any two communities. </plain></SENT>
</text></p><p><text><SENT sid="167" pm="."><plain>The network structure B consists of one central community of size 60, representing a main sexual contact network, connected by single bridges to 25 communities of size 20. </plain></SENT>
<SENT sid="168" pm="."><plain>Each small community is a fully connected graph. </plain></SENT>
<SENT sid="169" pm="."><plain>These small communities represent disjoint sexual contact subnetworks in a population of interest. </plain></SENT>
</text></p><p><text><SENT sid="170" pm="."><plain>The network structure C contains 100 communities, whose size was sampled from a distribution obtained from a phylogeny of the SHCS dataset (see [15] for details). </plain></SENT>
<SENT sid="171" pm="."><plain>To ensure that all communities are accessible, they are first linked in a chain. </plain></SENT>
<SENT sid="172" pm="."><plain>Additional bridges are then created by connecting any two vertices belonging to different communities with probability 0.00075. </plain></SENT>
</text></p><p><text><SENT sid="173" pm="."><plain>In all network types, edges between communities are weighted with a weight of 0.25, 0.5, 0.75 or 1, meaning that the rate of transmission on these edges is respectively 25%, 50%, 75% and 100% of the transmission rate on within-community edges. </plain></SENT>
</text></p><p><text><SENT sid="174" pm="."><plain>Epidemics were simulated on these networks starting from one random introduction in A networks, one random introduction in the main community in B networks, and two random introductions in C networks. </plain></SENT>
<SENT sid="175" pm="."><plain>All infected individuals were sampled upon removal and a transmission tree was built from the sampled tips. </plain></SENT>
<SENT sid="176" pm="."><plain>Thus, there is no phylogenetic uncertainty in this dataset: the tree represents exactly the simulated epidemic. </plain></SENT>
<SENT sid="177" pm="."><plain>For each type of network (A,B,C) and each weighting scheme (w = 0.25, 0.5, 0.75 or 1), 300 epidemics were simulated, for a total dataset of 3600 trees. </plain></SENT>
</text></p><p><text><SENT sid="178" pm="."><plain>Network structure B was designed to correspond best to the monophyletic assumption of the cutpoint-based clustering methods: the epidemic starts in the main cluster and the smaller communities are not connected with each other, so all infections originating from the same introduction will be grouped in a single clade. </plain></SENT>
<SENT sid="179" pm="."><plain>Network structure A, on the other hand, allows for the possibility of multiple introductions in the same community and onward transmission in further communities inducing nested clusters, thus breaking some of the assumptions of the cutpoint-based methods. </plain></SENT>
<SENT sid="180" pm="."><plain>More details about the networks are presented in the electronic supplementary material, text §3. </plain></SENT>
</text></p></sec><sec id="s3a2"><label>3.1.2.</label><title><text><SENT sid="181" pm="."><plain>Comparison of our method with cutpoint-based methods </plain></SENT>
</text></title><p><text><SENT sid="182" pm="."><plain>We ran our ML inference on the trees to assign states to tips, and interpret different states as different transmission clusters. </plain></SENT>
<SENT sid="183" pm="."><plain>In accordance with the simulation conditions, we set σ = 1 in the inference. </plain></SENT>
<SENT sid="184" pm="."><plain>The removal rates μi are assumed independent of the community, and so were set to the same value μ for all states. </plain></SENT>
<SENT sid="185" pm="."><plain>The time positions of the state changes were fixed using the intermediate option of testing positions at 10%, 50% and 90% of the length of the edges. </plain></SENT>
</text></p><p><text><SENT sid="186" pm="."><plain>The correspondence between the real network communities and the clusters inferred from the tree was assessed using the adjusted Rand index (ARI) [25,26]. </plain></SENT>
<SENT sid="187" pm="."><plain>This index measures the number of pairs of tips which are clustered identically in both clusterings, i.e. either in the same cluster or in two different clusters in both arrangements, compared to the number of pairs which are clustered differently. </plain></SENT>
<SENT sid="188" pm="."><plain>The ARI ranges from −1 to 1: a value of 1 indicates a perfect match of the inferred clustering to the truth, a value of 0 indicates that the inferred clustering matches the truth no better than a clustering drawn at random, and negative values indicate that the inferred clustering is worse than would be expected by chance. </plain></SENT>
</text></p><p><text><SENT sid="189" pm="."><plain>We compare the results from our method to the results obtained by Villandre et al. [15] using cutpoint-based clustering methods. </plain></SENT>
</text></p><p><text><SENT sid="190" pm="."><plain>Figure 2 and electronic supplementary material, figure S2 show the scores obtained by our MSBD method on the simulated A,B,C networks compared to the scores of the cutpoint-based clustering methods, respectively, for weights w = 0.25 and w = 1 and for weights w = 0.5 and w = 0.75. </plain></SENT>
<SENT sid="191" pm="."><plain>All methods used the same cutpoints values, except for the method based on Definition 3 (Def. </plain></SENT>
<SENT sid="192" pm="."><plain>3). </plain></SENT>
<SENT sid="193" pm="."><plain>Data corresponding to this method were rescaled to fit in the same figure. Figure 2.Comparison of the average ARI obtained by the different clustering methods in function of the cutpoint on networks A (parts A1,A2), B (parts B1,B2) and C (parts C1,C2). </plain></SENT>
<SENT sid="194" pm="."><plain>For each network, the first column (part 1) shows the results for weight w = 0.25 and the second column (part 2) for w = 1. </plain></SENT>
<SENT sid="195" pm="."><plain>Our proposed MSBD method is not dependent on a cutpoint. </plain></SENT>
<SENT sid="196" pm="."><plain>The cutpoint for Definition 3. is shown on the top x-axis, the cutpoints for all other definitions are shown on the bottom x-axis. </plain></SENT>
</text></p><p><text><SENT sid="197" pm="."><plain>As shown in [15], the results of the cutpoint-based methods are highly variable and good scores can only be obtained from a narrow range of cutpoints. </plain></SENT>
<SENT sid="198" pm="."><plain>In addition, the best cutpoint value is highly dependent on the underlying network structure: in methods other than Def. </plain></SENT>
<SENT sid="199" pm="."><plain>3, the best scores are obtained for a cutpoint of c ≈ 0.15 for networks A, c ≈ 0.03 for networks B and c ≈ 0.02 for networks C. </plain></SENT>
<SENT sid="200" pm="."><plain>For Def. </plain></SENT>
<SENT sid="201" pm="."><plain>3, the best score is obtained for c ≈ 0.05 for networks A, c ≈ 0.16 for networks B and c ≈ 0.04 for networks C. </plain></SENT>
<SENT sid="202" pm="."><plain>We define the ‘peak range’ of cutpoints for each method, network structure and weighting scheme as the range of cutpoints which give a score that is at least 75% of the best score obtained for any cutpoint. </plain></SENT>
<SENT sid="203" pm="."><plain>With this definition, the peak ranges are very narrow, with an average length of, respectively, 0.008, 0.015 and 0.016 for networks A, B and C in methods other than Def. </plain></SENT>
<SENT sid="204" pm="."><plain>3. </plain></SENT>
<SENT sid="205" pm="."><plain>The peak ranges obtained with Def. </plain></SENT>
<SENT sid="206" pm="."><plain>3 are much wider, but a direct comparison is difficult due to the different definition used for the cutpoint. </plain></SENT>
<SENT sid="207" pm="."><plain>In all methods, the peak ranges for networks A and C on the one hand, and B on the other hand have very little overlap and the best cutpoint for B is never found in the peak range of either A or C, and vice versa. </plain></SENT>
<SENT sid="208" pm="."><plain>In conclusion, it is impossible to get good results from all network types with any single cutpoint value. </plain></SENT>
</text></p><p><text><SENT sid="209" pm="."><plain>In addition, the cutpoint-based methods are sensitive to network features and in particular limited by the monophyletic assumption. </plain></SENT>
<SENT sid="210" pm="."><plain>In both the A and C networks, the best score obtained by any cutpoint-based method is ≈ 0.45 for the weighting scheme w = 0.25 and ≈ 0.55 for w = 1, whereas it goes up to ≈ 0.85 and ≈ 0.9, respectively, in networks B. </plain></SENT>
<SENT sid="211" pm="."><plain>An example of inference on a tree with nested cluster introductions is shown in electronic supplementary material, figure S3. </plain></SENT>
</text></p><p><text><SENT sid="212" pm="."><plain>In comparison, the MSBD method performs less well on B networks, with an average score of 0.73 for w = 0.25 and 0.49 for w = 1. </plain></SENT>
<SENT sid="213" pm="."><plain>However, it performs much better on A networks, with an average score of 0.64 for w = 0.25 and 0.53 for w = 1. </plain></SENT>
<SENT sid="214" pm="."><plain>The worst results are obtained on the C networks, where the average score is ≈ 0.2 for all weights, less than half the best scores obtained by cutpoint-based methods. </plain></SENT>
</text></p><p><text><SENT sid="215" pm="."><plain>The low scores obtained on the C networks point to a potential limitation of our method on the number of clusters that can be inferred from a tree. </plain></SENT>
<SENT sid="216" pm="."><plain>The trees simulated on the C networks contain clusters that have on average fewer elements and a higher proportion of very small clusters than the trees simulated on the A and B networks. </plain></SENT>
<SENT sid="217" pm="."><plain>These clusters may be harder to detect due to their low signal. </plain></SENT>
<SENT sid="218" pm="."><plain>This is supported by the number of inferred clusters shown in electronic supplementary material, table S1, which shows that the MSBD inference infers the correct number of clusters for networks A and B, but strongly underestimates it in networks C. </plain></SENT>
<SENT sid="219" pm="."><plain>To confirm this hypothesis, we calculated the scores obtained by the MSBD method when excluding all tips that belonged to a cluster with strictly less than eight tips. </plain></SENT>
<SENT sid="220" pm="."><plain>The results are shown in figure 2 (dotted line). </plain></SENT>
<SENT sid="221" pm="."><plain>The proportion of tips excluded by applying this criterion is shown in table 1. </plain></SENT>
<SENT sid="222" pm="."><plain>The scores of all network structures and all weighting schemes improved when applying this criterion. </plain></SENT>
<SENT sid="223" pm="."><plain>The improvement increased with the proportion of tips belonging to the excluded clusters, supporting our hypothesis that the MSBD method has difficulty identifying them. </plain></SENT>
<SENT sid="224" pm="."><plain>In particular, the MSBD scores on the C network structure for weight ≥0.5 increase to a level on par with the best scores obtained by cutpoint-based methods. Table 1.Percentage (%) of tips belonging to clusters with strictly less than eight tips, per network structure and weighting scheme.network typeABCw = 0.259.09.933.9w = 0.515.316.044.6w = 0.7521.720.851.4w = 125.122.255.5 </plain></SENT>
</text></p></sec></sec><sec id="s3b"><label>3.2.</label><title><text><SENT sid="225" pm="."><plain>Quality of the parameter inference </plain></SENT>
</text></title><p><text><SENT sid="226" pm="."><plain>To evaluate the performance of our MSBD method beyond cluster identification, we simulated several datasets of 200 trees each under the MSBD process, with various parameter combinations. </plain></SENT>
<SENT sid="227" pm="."><plain>Simulations were done using Gillespie's algorithm [27] for forward simulation of stochastic processes. </plain></SENT>
<SENT sid="228" pm="."><plain>Birth–death trees were simulated to have either one state (γ = 0) or multiple states sharing the same birth, birth decay and death rates (γ &gt; 0). </plain></SENT>
<SENT sid="229" pm="."><plain>Tips were sampled upon removal and the process was run until the tree reached 50 sampled tips. </plain></SENT>
<SENT sid="230" pm="."><plain>The MSBD method was then applied directly to the simulated trees. </plain></SENT>
<SENT sid="231" pm="."><plain>Because these trees were not built from network simulations, we did not try to assess the quality of the cluster inference, but we focused on the quality of the parameter inference and on whether our method can adequately distinguish between trees that contain several states and trees that do not. </plain></SENT>
</text></p><p><text><SENT sid="232" pm="."><plain>The results are summarized in table 2. </plain></SENT>
<SENT sid="233" pm="."><plain>We can see that although the MSBD method is able to consistently infer multiple states when they are present, it will also wrongly detect one additional state in around 25% of the trees that only contain one state. </plain></SENT>
<SENT sid="234" pm="."><plain>This may be a problem of noise, where due to the stochasticity of the simulation one subtree is slightly more likely when attributed different rates than the rest of the tree. </plain></SENT>
<SENT sid="235" pm="."><plain>This problem can be alleviated by looking at the difference in the inferred transmission rates of each state, which are also estimated by our method: a smaller difference is more likely to be indicative of noise. </plain></SENT>
<SENT sid="236" pm="."><plain>As previously noted, the method also tends to underestimate the number of states in multi-state trees, mostly because it cannot detect states with only a few tips. Table 2.Parameter inference on simulated datasets. </plain></SENT>
<SENT sid="237" pm="."><plain>Each dataset contains 200 trees of 50 tips each, simulated under an MSBD process using Gillespie's algorithm. </plain></SENT>
<SENT sid="238" pm="."><plain>Transmission rates are averaged over the entire tree.dataset parametersλ0 = 25, z = 12, μ = 1, γ = 0λ0 = 25, z = 15, μ = 1, γ = 0λ0 = 10, z = 1, μ = 5, γ = 0.5λ0 = 10, z = 2, μ = 5, γ = 0.5average number of clusterssimulated114.956.38&gt;5 individuals, simulated111.922.49inferred1.221.252.432.65average transmission ratesimulated1.090.866.955.40inferred1.541.387.526.20median absolute error0.370.490.750.78average removal ratesimulated1.01.05.05.0inferred0.880.914.644.50median absolute error0.210.200.730.71 </plain></SENT>
</text></p><p><text><SENT sid="239" pm="."><plain>Regarding the parameter inference, the method has a slight bias towards overestimating the transmission rate and underestimating the removal rate. </plain></SENT>
<SENT sid="240" pm="."><plain>This is potentially due to our simulation process being conditioned on reaching 50 tips, which could bias datasets in favour of trees showing apparent higher diversification rates [28]. </plain></SENT>
<SENT sid="241" pm="."><plain>Overall, the absolute error on the inferred parameters remains low compared to the true values, both in datasets with one cluster and in datasets with multiple clusters. </plain></SENT>
</text></p><p><text><SENT sid="242" pm="."><plain>We performed a similar analysis on datasets simulated with incomplete sampling σ = 0.75 or σ = 0.5, shown in electronic supplementary material, tables S4 and S5 (electronic supplementary material, text §6). </plain></SENT>
<SENT sid="243" pm="."><plain>The accuracy of the parameter inferences decreases with lower sampling proportions, in particular in the transmission rate estimates. </plain></SENT>
<SENT sid="244" pm="."><plain>However, the relative error remains low and the MSBD parameter estimates remain reliable even with lower sampling proportions. </plain></SENT>
</text></p><p><text><SENT sid="245" pm="."><plain>In conclusion, the parameter inference from the MSBD method is reliable, although it suffers from noise when applied to trees which contain only one state. </plain></SENT>
</text></p></sec><sec id="s3c"><label>3.3.</label><title><text><SENT sid="246" pm="."><plain>Cluster inference on HIV dataset </plain></SENT>
</text></title><p><text><SENT sid="247" pm="."><plain>In this section, we analyse a tree used in another study of the correlation between sexual networks and tree features [14]. </plain></SENT>
<SENT sid="248" pm="."><plain>HIV-1 subtype B pol sequences were obtained from the SHCS 192. </plain></SENT>
<SENT sid="249" pm="."><plain>While the Swiss epidemic includes a mixture of population risk groups including heterosexuals, injecting drug users and MSM, only viral samples from MSM were analysed. </plain></SENT>
<SENT sid="250" pm="."><plain>A large cluster including almost 200 sampled individuals who predominantly lived or sought treatment in the Zürich area was identified from an ML phylogeny of the complete dataset. </plain></SENT>
<SENT sid="251" pm="."><plain>The phylogeny of this cluster was then obtained by fitting a SIR-type pairwise epidemic model to this sub-epidemic while simultaneously inferring the tree from the sequence data in BEAST2. </plain></SENT>
<SENT sid="252" pm="."><plain>We re-analyse the maximum clade credibility tree provided for that cluster in the supporting information of [14]. </plain></SENT>
</text></p><p><text><SENT sid="253" pm="."><plain>The results of the MSBD analysis are shown in figure 3a. </plain></SENT>
<SENT sid="254" pm="."><plain>Three sub-clusters are identified in the tree, one with a higher base transmission rate than in the backbone of the tree, and two with similar base transmission rates which are lower than in the backbone of the tree. Figure 3.Analysis of the empirical HIV tree. </plain></SENT>
<SENT sid="255" pm="."><plain>Comparison of the clusters obtained with MSBD (a) or with Cluster Picker with a bootstrap threshold of 0.0 and a genetic distance threshold of 1.5% (b), 4.5% (c) and 8% (d). </plain></SENT>
</text></p><p><text><SENT sid="256" pm="."><plain>We compare our results to results obtained using the software Cluster Picker [29] and PhyloPart [30], phylogenetic cutpoint-based method which detect clusters based on a combination of bootstrap support at the nodes and respectively genetic distance between tip sequences or patristic distances. </plain></SENT>
<SENT sid="257" pm="."><plain>Genetic sequences were generated for the tree using the software SeqGen [31] (see electronic supplementary material, text §4 for more details). </plain></SENT>
</text></p><p><text><SENT sid="258" pm="."><plain>The results of Cluster Picker are shown in figure 3 and the results of PhyloPart in electronic supplementary material, figure S4. </plain></SENT>
<SENT sid="259" pm="."><plain>As both led to similar results, we will only discuss the results for Cluster Picker here. </plain></SENT>
<SENT sid="260" pm="."><plain>As with other cutpoint-based methods, the results depend strongly on the user-defined values. </plain></SENT>
<SENT sid="261" pm="."><plain>We used three different cutpoint values for the genetic distance: 1.5%, 4.5% and 8%. </plain></SENT>
<SENT sid="262" pm="."><plain>4.5% is the default value proposed by Cluster Picker and is the higher bound of the range recommended by Cluster Picker for HIV data, whereas 1.5% is the lower bound of the recommended range. </plain></SENT>
<SENT sid="263" pm="."><plain>For the bootstrap support threshold, we used the value 0.0. </plain></SENT>
<SENT sid="264" pm="."><plain>With this value, the bootstrap support is disregarded entirely, which mimics the behaviour of the methods studied by [15]. </plain></SENT>
<SENT sid="265" pm="."><plain>The results are shown in figure 3. </plain></SENT>
<SENT sid="266" pm="."><plain>We observe that the number of identified clusters is strongly dependent on the cutpoint values, in keeping with the results obtained by [15]. </plain></SENT>
<SENT sid="267" pm="."><plain>The size of the identified clusters varies also widely, even within the bounds of the recommended range of cutpoints. </plain></SENT>
</text></p><p><text><SENT sid="268" pm="."><plain>One interesting thing to note is that the cluster pattern identified by MSBD cannot be obtained by Cluster Picker even when varying the threshold used. </plain></SENT>
<SENT sid="269" pm="."><plain>Cutpoint thresholds which include all of the (non-root) clusters detected by MSBD typically include additional small clusters which are not supported by the MSBD model. </plain></SENT>
<SENT sid="270" pm="."><plain>On the other hand, reducing the threshold to avoid these spurious clusters causes Cluster Picker to miss clusters supported by MSBD. </plain></SENT>
</text></p></sec></sec></SecTag><SecTag type="DISCUSS"><sec id="s4"><label>4.</label><title><text><SENT sid="271" pm="."><plain>Discussion </plain></SENT>
</text></title><p><text><SENT sid="272" pm="."><plain>We have introduced a novel method of identifying transmission clusters from a phylogeny, based on an MSBD model. </plain></SENT>
<SENT sid="273" pm="."><plain>This model is designed to identify transmission clusters induced by a pathogen spreading in a contact network with communities. </plain></SENT>
<SENT sid="274" pm="."><plain>Transmission clusters are defined as all individuals belonging to a transmission chain within a single community. </plain></SENT>
<SENT sid="275" pm="."><plain>It will be an interesting future work to investigate the ability of the MSBD model to infer clusters formed due to other dynamics such as superspreading. </plain></SENT>
<SENT sid="276" pm="."><plain>Beyond HIV, our method is applicable to any epidemic where the transmission dynamics are governed by a contact network structure. </plain></SENT>
</text></p><p><text><SENT sid="277" pm="."><plain>Our likelihood function makes two important assumptions: the first one is that each community is entered precisely once, and the second one is that unsampled subtrees, i.e. subtrees that do not appear in the reconstructed phylogeny, do not contain cluster introduction events. </plain></SENT>
<SENT sid="278" pm="."><plain>The implementation also relies on a time discretization which approximates all transmission rates as locally constant on small time intervals. </plain></SENT>
<SENT sid="279" pm="."><plain>A similar discretization can be applied to extend our method to time-dependent removal rates, which are not currently supported. </plain></SENT>
</text></p><p><text><SENT sid="280" pm="."><plain>This new method has a few key differences compared to the cutpoint-based clustering methods. </plain></SENT>
<SENT sid="281" pm="."><plain>Firstly, it is not restricted to monophyletic clades and can thus find clusters that are nested within one another in the phylogeny. </plain></SENT>
<SENT sid="282" pm="."><plain>As a result, our method clearly outperformed the others on simulated networks which were designed specifically to violate the monophyletic assumption. </plain></SENT>
<SENT sid="283" pm="."><plain>This issue is particularly problematic in datasets that have been sampled over an extended period of time, as nested introduction events are more likely to appear there. </plain></SENT>
</text></p><p><text><SENT sid="284" pm="."><plain>Secondly, as the MSBD method is model-based, it does not rely on an arbitrary cutpoint to be chosen by the user. </plain></SENT>
<SENT sid="285" pm="."><plain>Instead, we look for significant changes in transmission rates. </plain></SENT>
<SENT sid="286" pm="."><plain>While our method does involve approximations, our simulation studies show that these do not destroy the statistical signal for cluster detection. </plain></SENT>
<SENT sid="287" pm="."><plain>The use of a likelihood function also gives an estimate of the statistical significance of each detected cluster and allows us to easily score and compare different cluster partitions. </plain></SENT>
<SENT sid="288" pm="."><plain>Moreover, as the parameters of the model are biologically meaningful, they are therefore easier to potentially fix or interpret in an objective way. </plain></SENT>
</text></p><p><text><SENT sid="289" pm="."><plain>The intuitive reason for these two key differences of MSBD to cutpoint-based methods is that the MSBD method looks at relative changes in branch lengths, while cutpoint-based methods cluster individuals up to a particular distance in absolute branch lengths. </plain></SENT>
<SENT sid="290" pm="."><plain>Thus, the cutpoint-based methods only find monophyletic clusters. </plain></SENT>
<SENT sid="291" pm="."><plain>Furthermore, branch lengths on a different scale (e.g. all distances are multiplied by 100) require a different cutpoint. </plain></SENT>
<SENT sid="292" pm="."><plain>On the other hand, the MSBD method uses likelihood statistics to determine if the relative branch length changes are significant, indicating a new cluster. </plain></SENT>
</text></p><p><text><SENT sid="293" pm="."><plain>Avoidance of a cutpoint parameter is an important advantage. </plain></SENT>
<SENT sid="294" pm="."><plain>Villandre et al. [15] showed that the quality of the detection achieved by phylogenetic cutpoint-based clustering methods is highly sensitive to the value of this parameter, regardless of underlying contact network type. </plain></SENT>
<SENT sid="295" pm="."><plain>In particular, they showed that it is impossible to define a single cutpoint value as adequate for all network types, even for the same pathogen. </plain></SENT>
<SENT sid="296" pm="."><plain>Cluster Picker recommends cutpoints between 0.015 and 0.045 for HIV based on previous empirical studies of HIV. </plain></SENT>
<SENT sid="297" pm="."><plain>However, our results show that very different cluster partitions can be obtained at the two ends of this range. </plain></SENT>
<SENT sid="298" pm="."><plain>Cutpoint values will further be impacted by the evolutionary rate and other epidemiological dynamics, meaning these guidelines cannot be easily transferred to another pathogen. </plain></SENT>
<SENT sid="299" pm="."><plain>The chosen cutpoint value is strongly linked with the number of clusters inferred by cutpoint-based methods, thus obtaining the correct clusters requires prior knowledge of the true number of clusters. </plain></SENT>
</text></p><p><text><SENT sid="300" pm="."><plain>Overall, while our method may not perform as well on certain types of network as phylogenetic cutpoint-based methods were we to know the optimal cutpoint in advance, it outperforms the cutpoint-based methods on a wide range of cutpoints on simulated datasets following our assumptions on pathogen spread. </plain></SENT>
<SENT sid="301" pm="."><plain>Furthermore, while there exist other non-phylogenetic clustering methods, such as HIV-TRACE [32], which can detect non-monophyletic clusters, these methods still require specification of a cutpoint parameter and we expect that they suffer from the same issues as the phylogenetic cutpoint-based methods. </plain></SENT>
</text></p><p><text><SENT sid="302" pm="."><plain>MSBD methods have a strong limitation on the size of clusters that can be inferred from a tree. </plain></SENT>
<SENT sid="303" pm="."><plain>This is seen from the low scores obtained on the fragmented type C networks and the improvements obtained when only investigating if clusters of a certain size are inferred. </plain></SENT>
<SENT sid="304" pm="."><plain>Contrary to the cutpoint-based methods, which can handle arbitrary numbers and sizes of clusters, our method can only add clusters when there is a strong signal for them and thus performs worse than cutpoint-based methods in datasets with many small clusters. </plain></SENT>
<SENT sid="305" pm="."><plain>Again, this comparison relies on knowing the optimal cutpoint, and as said above, this knowledge is typically not available. </plain></SENT>
</text></p><p><text><SENT sid="306" pm="."><plain>Another limitation of the current implementation is its computational cost, which limits the size of the trees that can be analysed. </plain></SENT>
<SENT sid="307" pm="."><plain>(Current run time is on the order of CPU-days for a few hundred tips.) In contrast to cutpoint-based methods, the MSBD method thus cannot handle datasets containing tens of thousands of sequences. </plain></SENT>
<SENT sid="308" pm="."><plain>Future work will focus on implementing the algorithm in parallel and exploring other possible approximations, with the aim of increasing speed without lowering precision. </plain></SENT>
<SENT sid="309" pm="."><plain>Making use of the insight that the MSBD method employs the information on changes in relative branch lengths may be a future guide to fast but accurate methods. </plain></SENT>
</text></p><p><text><SENT sid="310" pm="."><plain>In the future, we plan to implement our model in a Bayesian framework, which will allow us to explore the number and positions of clusters in a more rigorous way by using reversible jumps instead of multiple rounds of optimization. </plain></SENT>
<SENT sid="311" pm="."><plain>Some approximations could be removed in this framework, such as the assumption that n = n* or the fixed positions of state changes on edges. </plain></SENT>
<SENT sid="312" pm="."><plain>Moreover, estimating the uncertainty around the various estimated parameters is problematic in an ML framework, in particular for the positions and number of state changes. </plain></SENT>
</text></p><p><text><SENT sid="313" pm="."><plain>This is compounded by the fact that the current method uses a timed phylogeny as input, and thus relies strongly on this phylogeny being inferred correctly. </plain></SENT>
<SENT sid="314" pm="."><plain>This also means that the uncertainty associated with the phylogenetic inference cannot be integrated in the cluster inference. </plain></SENT>
<SENT sid="315" pm="."><plain>Again, a Bayesian framework could solve this issue by allowing a joint inference of the phylogeny and the clusters, using the MSBD as a model-based prior on the transmission tree. </plain></SENT>
</text></p><p><text><SENT sid="316" pm="."><plain>In summary, in spite of the limitations discussed, our results clearly show that an approach based on a statistical model for cluster detection can overcome some important deficiencies of previous approaches. </plain></SENT>
<SENT sid="317" pm="."><plain>In particular, the assumption of clusters being monophyletic can be dropped, and the sensitivity to non-biological cutpoint parameters can be completely avoided. </plain></SENT>
</text></p></sec></SecTag><SecTag type="SUPPL"><sec sec-type="supplementary-material"><title><text><SENT sid="318" pm="."><plain>Supplementary Material </plain></SENT>
</text></title><supplementary-material content-type="local-data" id="SD1"><caption><title><text><SENT sid="319" pm="."><plain>Supplementary text </plain></SENT>
</text></title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rsif20180512supp1.pdf" orientation="portrait" id="d35e1884" position="anchor"/></supplementary-material></sec></SecTag><SecTag type="SUPPL"><sec sec-type="supplementary-material"><title><text><SENT sid="320" pm="."><plain>Supplementary Material </plain></SENT>
</text></title><supplementary-material content-type="local-data" id="SD2"><caption><title><text><SENT sid="321" pm="."><plain>Code files </plain></SENT>
</text></title></caption><media mimetype="application" mime-subtype="tar" xlink:href="rsif20180512si002.tar" orientation="portrait" id="d35e1892" position="anchor"/></supplementary-material></sec></SecTag><SecTag type="SUPPL"><sec sec-type="supplementary-material"><title><text><SENT sid="322" pm="."><plain>Supplementary Material </plain></SENT>
</text></title><supplementary-material content-type="local-data" id="SD3"><caption><title><text><SENT sid="323" pm="."><plain>Data files </plain></SENT>
</text></title></caption><media mimetype="application" mime-subtype="tar" xlink:href="rsif20180512si003.tar" orientation="portrait" id="d35e1900" position="anchor"/></supplementary-material></sec></SecTag></body><back><SecTag type="ACK_FUND"><ack><title>Acknowledgements</title><p><text4fund><text><SENT sid="324" pm="."><plain>We thank Dr Luc Villandré for his help with using the network simulation dataset. </plain></SENT>
</text></text4fund></p></ack></SecTag><sec id="s5"><title>Data accessibility</title><p>All analyses, pre- and post-processing of the datasets were done using custom R scripts. These scripts and the datasets are included in the electronic supplementary material.</p></sec><SecTag type="AUTH_CONT"><sec id="s6"><title>Authors' contributions</title><p>J.B.S. implemented the model, performed the simulations, analysed the data and wrote the manuscript. T.V. analysed the data and wrote the manuscript. T.S. conceived of the study, designed the study, coordinated the study and wrote the manuscript.</p></sec></SecTag><SecTag type="COMP_INT"><sec id="s7" sec-type="COI-statement"><title>Competing interests</title><p>We declare we have no competing interests.</p></sec></SecTag><SecTag type="ACK_FUND"><sec id="s8"><title>Funding</title><p><text4fund><text><SENT sid="325" pm="."><plain>J.B.S. and T.S. are supported, in part, by the European Research Council under the Seventh Framework Programme of the European Commission (PhyPD: grant agreement no. 335529). </plain></SENT>
</text></text4fund></p></sec></SecTag><SecTag type="REF"><ref-list><title>References</title><ref id="RSIF20180512C1"><text><SENT sid="326" pm="."><plain>1AllenLJS 2008 In An introduction to stochastic epidemic models. </plain></SENT>
<SENT sid="327" pm="."><plain>In Mathematical epidemiology. </plain></SENT>
<SENT sid="328" pm="."><plain>Lecture Notes in Mathematics, vol. </plain></SENT>
<SENT sid="329" pm="."><plain>1945 (eds BrauerF, van den DriesscheP, WuJ), pp. 81–130. Berlin, Germany: Springer. </plain></SENT>
</text></ref><ref id="RSIF20180512C2"><text><SENT sid="330" pm="."><plain>2BrennerBG et al. 2007 High rates of forward transmission events after acute/early HIV-1 infection. J. </plain></SENT>
<SENT sid="331" pm="."><plain>Infect. </plain></SENT>
<SENT sid="332" pm="."><plain>Dis. 195, 951–959. </plain></SENT>
<SENT sid="333" pm="."><plain>(10.1086/512088)17330784 </plain></SENT>
</text></ref><ref id="RSIF20180512C3"><text><SENT sid="334" pm="."><plain>3BrenneBG et al. 2011 Transmission clustering drives the onward spread of the HIV epidemic among men who have sex with men in Quebec. J. </plain></SENT>
<SENT sid="335" pm="."><plain>Infect. </plain></SENT>
<SENT sid="336" pm="."><plain>Dis. 204, 1115–1119. </plain></SENT>
<SENT sid="337" pm="."><plain>(10.1093/infdis/jir468)21881127 </plain></SENT>
</text></ref><ref id="RSIF20180512C4"><text><SENT sid="338" pm="."><plain>4World Health Organization. 2012 Antiretroviral treatment as prevention (TASP) of HIV and TB. World Health Organization. </plain></SENT>
</text></ref><ref id="RSIF20180512C5"><text><SENT sid="339" pm="."><plain>5GirvanM, NewmanMEJ 2002 Community structure in social and biological networks. Proc. </plain></SENT>
<SENT sid="340" pm="."><plain>Natl Acad. </plain></SENT>
<SENT sid="341" pm="."><plain>Sci. </plain></SENT>
<SENT sid="342" pm="."><plain>USA 99, 7821–7826. </plain></SENT>
<SENT sid="343" pm="."><plain>(10.1073/pnas.122653799)12060727 </plain></SENT>
</text></ref><ref id="RSIF20180512C6"><text><SENT sid="344" pm="."><plain>6LeventhalGE, GünthardHF, BonhoefferS, StadlerT 2014 Using an epidemiological model for phylogenetic inference reveals density dependence in HIV transmission. Mol. </plain></SENT>
<SENT sid="345" pm="."><plain>Biol. </plain></SENT>
<SENT sid="346" pm="."><plain>Evol. 31, 6–17. </plain></SENT>
<SENT sid="347" pm="."><plain>(10.1093/molbev/mst172)24085839 </plain></SENT>
</text></ref><ref id="RSIF20180512C7"><text><SENT sid="348" pm="."><plain>7WelchD 2011 Is network clustering detectable in transmission trees? Viruses 3, 659–676. </plain></SENT>
<SENT sid="349" pm="."><plain>(10.3390/v3060659)21731813 </plain></SENT>
</text></ref><ref id="RSIF20180512C8"><text><SENT sid="350" pm="."><plain>8RobinsonK, FysonN, CohenT, FraserC, ColijnC 2013 How the dynamics and structure of sexual contact networks shape pathogen phylogenies. PLoS Comput. </plain></SENT>
<SENT sid="351" pm="."><plain>Biol. 9, 1–15. </plain></SENT>
<SENT sid="352" pm="."><plain>(10.1371/journal.pcbi.1003105) </plain></SENT>
</text></ref><ref id="RSIF20180512C9"><text><SENT sid="353" pm="."><plain>9LeventhalGE et al. 2012 Inferring epidemic contact structure from phylogenetic trees. PLoS Comput. </plain></SENT>
<SENT sid="354" pm="."><plain>Biol. 8, 1–10. </plain></SENT>
<SENT sid="355" pm="."><plain>(10.1371/journal.pcbi.1002413)22629235 </plain></SENT>
</text></ref><ref id="RSIF20180512C10"><text><SENT sid="356" pm="."><plain>10BohmeCN 2017 Effects of contact network structure on epidemic transmission trees: implications for data required to estimate network structure. Stat. </plain></SENT>
<SENT sid="357" pm="."><plain>Med. 37, 236–248. </plain></SENT>
<SENT sid="358" pm="."><plain>(10.1002/sim.7259)28192859 </plain></SENT>
</text></ref><ref id="RSIF20180512C11"><text><SENT sid="359" pm="."><plain>11GiardinaF, Romero-SeversonEO, AlbertJ, BrittonT, LeitnerT 2017 Inference of transmission network structure from HIV phylogenetic trees. PLoS Comput. </plain></SENT>
<SENT sid="360" pm="."><plain>Biol. 13, 1–22. </plain></SENT>
<SENT sid="361" pm="."><plain>(10.1371/journal.pcbi.1005316) </plain></SENT>
</text></ref><ref id="RSIF20180512C12"><text><SENT sid="362" pm="."><plain>12SongH et al. 2018 Tracking HIV-1 recombination to resolve its contribution to HIV-1 evolution in natural infection. Nat. </plain></SENT>
<SENT sid="363" pm="."><plain>Commun. 9, 1928 (10.1038/s41467-018-04217-5)29765018 </plain></SENT>
</text></ref><ref id="RSIF20180512C13"><text><SENT sid="364" pm="."><plain>13McCloskeyRM, LiangRH, PoonAFY 2016 Reconstructing contact network parameters from viral phylogenies. Virus Evol. 2, vew029 (10.1093/ve/vew029)27818787 </plain></SENT>
</text></ref><ref id="RSIF20180512C14"><text><SENT sid="365" pm="."><plain>14RasmussenDA, KouyosR, GünthardHF, StadlerT 2017 Phylodynamics on local sexual contact networks. PLoS Comput. </plain></SENT>
<SENT sid="366" pm="."><plain>Biol. 13, 1–23. </plain></SENT>
<SENT sid="367" pm="."><plain>(10.1371/journal.pcbi.1005448) </plain></SENT>
</text></ref><ref id="RSIF20180512C15"><text><SENT sid="368" pm="."><plain>15VillandreL, StephensDA, LabbeA, GünthardHF, KouyosR, StadlerT, Swiss HIV Cohort Study. 2016 Assessment of overlap of phylogenetic transmission clusters and communities in simple sexual contact networks: applications to HIV-1. PLoS ONE 11, e0148459 (10.1371/journal.pone.0148459)26863322 </plain></SENT>
</text></ref><ref id="RSIF20180512C16"><text><SENT sid="369" pm="."><plain>16MaddisonWP, MidfordPE, OttoSP 2007 Estimating a binary character's effect on speciation and extinction. Syst. </plain></SENT>
<SENT sid="370" pm="."><plain>Biol. 56, 701–710. </plain></SENT>
<SENT sid="371" pm="."><plain>(10.1080/10635150701607033)17849325 </plain></SENT>
</text></ref><ref id="RSIF20180512C17"><text><SENT sid="372" pm="."><plain>17FitzJohnRG 2012 Diversitree: comparative phylogenetic analyses of diversification in R. Methods Ecol. </plain></SENT>
<SENT sid="373" pm="."><plain>Evol. 3, 1084–1092. </plain></SENT>
<SENT sid="374" pm="."><plain>(10.1111/j.2041-210X.2012.00234.x) </plain></SENT>
</text></ref><ref id="RSIF20180512C18"><text><SENT sid="375" pm="."><plain>18StadlerT, BonhoefferS 2013 Uncovering epidemiological dynamics in heterogeneous host populations using phylogenetic methods. Phil. </plain></SENT>
<SENT sid="376" pm="."><plain>Trans. </plain></SENT>
<SENT sid="377" pm="."><plain>R. </plain></SENT>
<SENT sid="378" pm="."><plain>Soc. </plain></SENT>
<SENT sid="379" pm="."><plain>B 368, 20120198 (10.1098/rstb.2012.0198)23382421 </plain></SENT>
</text></ref><ref id="RSIF20180512C19"><text><SENT sid="380" pm="."><plain>19KühnertD, StadlerT, VaughanTG, DrummondAJ 2016 Phylodynamics with migration: a computational framework to quantify population structure from genomic data. Mol. </plain></SENT>
<SENT sid="381" pm="."><plain>Biol. </plain></SENT>
<SENT sid="382" pm="."><plain>Evol. 33, 2102–2116. </plain></SENT>
<SENT sid="383" pm="."><plain>(10.1093/molbev/msw064)27189573 </plain></SENT>
</text></ref><ref id="RSIF20180512C20"><text><SENT sid="384" pm="."><plain>20RaboskyDL, SantiniF, EastmanJ, SmithSA, SidlauskasB, ChangJ, AlfaroME 2013 Rates of speciation and morphological evolution are correlated across the largest vertebrate radiation. Nat. </plain></SENT>
<SENT sid="385" pm="."><plain>Commun. 4, 1958 (10.1038/ncomms2958)23739623 </plain></SENT>
</text></ref><ref id="RSIF20180512C21"><text><SENT sid="386" pm="."><plain>21MooreBR, HöhnaS, MayMR, RannalaB, HuelsenbeckJP 2016 Critically evaluating the theory and performance of Bayesian analysis of macroevolutionary mixtures. Proc. </plain></SENT>
<SENT sid="387" pm="."><plain>Natl Acad. </plain></SENT>
<SENT sid="388" pm="."><plain>Sci. </plain></SENT>
<SENT sid="389" pm="."><plain>USA 113, 9569–9574. </plain></SENT>
<SENT sid="390" pm="."><plain>(10.1073/pnas.1518659113)27512038 </plain></SENT>
</text></ref><ref id="RSIF20180512C22"><text><SENT sid="391" pm="."><plain>22McCloskeyRM, PoonAF 2017 A model-based clustering method to detect infectious disease transmission outbreaks from sequence variation. PLoS Comput. </plain></SENT>
<SENT sid="392" pm="."><plain>Biol. 13, e1005868 (10.1371/journal.pcbi.1005868)29131825 </plain></SENT>
</text></ref><ref id="RSIF20180512C23"><text><SENT sid="393" pm="."><plain>23StadlerT, KühnertD, BonhoefferS, DrummondAJ 2013 Birth–death skyline plot reveals temporal changes of epidemic spread in HIV and hepatitis C virus (HCV). Proc. </plain></SENT>
<SENT sid="394" pm="."><plain>Natl Acad. </plain></SENT>
<SENT sid="395" pm="."><plain>Sci. </plain></SENT>
<SENT sid="396" pm="."><plain>USA 110, 228–233. </plain></SENT>
<SENT sid="397" pm="."><plain>(10.1073/pnas.1207965110)23248286 </plain></SENT>
</text></ref><ref id="RSIF20180512C24"><text><SENT sid="398" pm="."><plain>24ParadisE, ClaudeJ, StrimmerK 2004 APE: analyses of phylogenetics and evolution in R language. Bioinformatics 20, 289–290. </plain></SENT>
<SENT sid="399" pm="."><plain>(10.1093/bioinformatics/btg412)14734327 </plain></SENT>
</text></ref><ref id="RSIF20180512C25"><text><SENT sid="400" pm="."><plain>25RandWM 1971 Objective criteria for the evaluation of clustering methods. J. </plain></SENT>
<SENT sid="401" pm="."><plain>Am. </plain></SENT>
<SENT sid="402" pm="."><plain>Stat. </plain></SENT>
<SENT sid="403" pm="."><plain>Assoc. 66, 846–850. </plain></SENT>
<SENT sid="404" pm="."><plain>(10.1080/01621459.1971.10482356) </plain></SENT>
</text></ref><ref id="RSIF20180512C26"><text><SENT sid="405" pm="."><plain>26HubertL, ArabieP 1985 Comparing partitions. J. </plain></SENT>
<SENT sid="406" pm="."><plain>Classif. 2, 193–218. </plain></SENT>
<SENT sid="407" pm="."><plain>(10.1007/bf01908075) </plain></SENT>
</text></ref><ref id="RSIF20180512C27"><text><SENT sid="408" pm="."><plain>27GillespieDT 1977 Exact stochastic simulation of coupled chemical reactions. J. </plain></SENT>
<SENT sid="409" pm="."><plain>Phys. </plain></SENT>
<SENT sid="410" pm="."><plain>Chem. 81, 2340–2361. </plain></SENT>
<SENT sid="411" pm="."><plain>(10.1021/j100540a008) </plain></SENT>
</text></ref><ref id="RSIF20180512C28"><text><SENT sid="412" pm="."><plain>28StadlerT 2012 How can we improve accuracy of macroevolutionary rate estimates? Syst. </plain></SENT>
<SENT sid="413" pm="."><plain>Biol. 62, 321–329. </plain></SENT>
<SENT sid="414" pm="."><plain>(10.1093/sysbio/sys073)22962038 </plain></SENT>
</text></ref><ref id="RSIF20180512C29"><text><SENT sid="415" pm="."><plain>29Ragonnet-CroninM, HodcroftE, HuéS, FearnhillE, DelpechV, BrownAJ, LycettS 2013 Automated analysis of phylogenetic clusters. BMC Bioinform. 14, 317 (10.1186/1471-2105-14-317) </plain></SENT>
</text></ref><ref id="RSIF20180512C30"><text><SENT sid="416" pm="."><plain>30ProsperiMCF et al.2011 A novel methodology for large-scale phylogeny partition. Nat. </plain></SENT>
<SENT sid="417" pm="."><plain>Commun. 2, 321 (10.1038/ncomms1325)21610724 </plain></SENT>
</text></ref><ref id="RSIF20180512C31"><text><SENT sid="418" pm="."><plain>31RambautA, GrassNC 1997 Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees. Bioinformatics 13, 235 (10.1093/bioinformatics/13.3.235) </plain></SENT>
</text></ref><ref id="RSIF20180512C32"><text><SENT sid="419" pm="."><plain>32Kosakovsky PondSL, WeaverS, Leigh BrownAJ, WertheimJO 2018 HIV-TRACE (TRAnsmission Cluster Engine): a tool for large scale molecular epidemiology of HIV-1 and other rapidly evolving pathogens. Mol. </plain></SENT>
<SENT sid="420" pm="."><plain>Biol. </plain></SENT>
<SENT sid="421" pm="."><plain>Evol. 35, 1812–1819. </plain></SENT>
<SENT sid="422" pm="."><plain>(10.1093/molbev/msy016)29401317 </plain></SENT>
</text></ref></ref-list></SecTag></back></article>
