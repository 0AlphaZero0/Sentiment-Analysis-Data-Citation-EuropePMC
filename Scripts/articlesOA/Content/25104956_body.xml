<sec id="s1"><title>1. Introduction</title><p>Tuberculosis (TB) is an infectious disease caused by the bacteria <italic>Mycobacterium tuberculosis</italic> (<italic>Mtb</italic>) that affects millions of people worldwide. While a small fraction of individuals who are exposed to <italic>Mtb</italic> either completely clear the infection or develop active disease, the majority enter a state of latency, in which an immunological response to <italic>Mtb</italic> antigens is present (typically diagnosed by a positive response to a skin test) but there is no clinical evidence of infection. However, there is not a clear delineation between latent and active infection, with levels of bacterial activity encompassing a latency spectrum that varies considerably among individuals (Barry et al., <xref rid="B3" ref-type="bibr">2009</xref>; Delogu et al., <xref rid="B8" ref-type="bibr">2013</xref>). This considerably complicates the diagnosis and proactive treatment of TB infection, as currently available tests cannot differentiate individuals who are at low risk of disease progression from those who are highly susceptible to developing active disease. For this reason, there is much interest in the identification of diagnostic biomarkers that can predict reactivation of latent TB (Wallis et al., <xref rid="B27" ref-type="bibr">2010</xref>; Walzl et al., <xref rid="B28" ref-type="bibr">2011</xref>; Ottenhoff et al., <xref rid="B22" ref-type="bibr">2012</xref>).</p><p>One approach for studying the progression of <italic>Mtb</italic> infection from initial exposure to latency is through controlled time-course experiments. Non-human primates (NHPs), such as rhesus or cynomolgus macaques, display a continuum of TB infection which cannot be reproduced in other animal models (Capuano et al., <xref rid="B6" ref-type="bibr">2003</xref>; Dutta et al., <xref rid="B9" ref-type="bibr">2010</xref>; Mehra et al., <xref rid="B21" ref-type="bibr">2010</xref>, <xref rid="B20" ref-type="bibr">2011</xref>, <xref rid="B19" ref-type="bibr">2013</xref>) and are therefore optimally suited for this type of research. In experiments conducted at the Tulane National Primate Research Center (TNPRC), a set of 17 rhesus macaques were exposed to a low dose of <italic>Mtb</italic> bacteria and monitored for clinical signs of disease. Subsets of the animals were then euthanized at scheduled time points, and granulomas taken from their lungs were analyzed for gene expression using microarrays. While in an ideal setting the combined expression profiles produced from this experiment would provide a valuable snapshot into the processes by which latency is established at the genomic level, this would require that all of our subjects have a common experience of infection. In our study, a review of the clinical profiles associated with the animals revealed considerable variability in the nature of their respective illnesses, with some subjects exhibiting no clinical signs of infection and others presenting symptoms associated with severe disease. Based on this heterogeneity, we considered that an integrated analysis of our gene expression data that incorporated each animal's clinical history would provide greater insights into the genetic processes associated with the establishment of latent infection than one which considered only the length of exposure associated with each profile.</p><p>The term <italic>clinico-genomic modeling</italic> describes a large class of methods that seek to integrate data from high-throughput experiments with clinical information, typically for diagnostic or prognostic purposes (Gevaert et al., <xref rid="B11" ref-type="bibr">2006</xref>). For example, a recent study of primary breast cancer recurrence demonstrated that the incorporation of traditional clinical risk factors improved disease outcome predictions over statistical classification tree models that only used genomic data (Pittman et al., <xref rid="B23" ref-type="bibr">2004</xref>). However, to our knowledge ours is the first effort to incorporate longitudinal clinical data from a controlled experiment in the identification of genomic biomarkers from gene expression profiles.</p><p>We first incorporate a number of clinical covariates to model disease progression for each subject using a Bayesian hierarchical B-spline approach. Our methods are similar to those used in the development of longitudinal models for lung function in children observed in the presence of varying levels of ambient air pollution (Berhane and Molitor, <xref rid="B4" ref-type="bibr">2008</xref>), although in our setting the response variable is an unobserved disease severity score rather than a measured quantity. From our estimated clinical trajectories, we can visualize and quantitatively compare the progression from exposure to latent infection in each of our subjects. We then incorporate disease severity estimates derived from these curves along with temporal information to identify genes that are significantly associated with either or both of these predictors. Our results demonstrate that the incorporation of clinical data significantly increases the amount of information extracted from the expression profiles and is consistent with other recent efforts to identify biomarkers for TB susceptibility.</p></sec><sec id="s2"><title>2. Materials and methods</title><sec><title>2.1. Experimental design</title><p>Seventeen Indian rhesus macaques were exposed to 100 cfu <italic>Mtb</italic> CDC1551 via <italic>Mtb</italic> aerosol, a dose which is known to induce latent TB based on prior research (Dutta et al., <xref rid="B9" ref-type="bibr">2010</xref>). The animals were randomly assigned to time points at 2-week intervals for experimental euthanasia, at which point their lungs were biopsied and granuloma lesions were extracted. The experiment was conducted using previously established protocols (Dutta et al., <xref rid="B9" ref-type="bibr">2010</xref>; Mehra et al., <xref rid="B20" ref-type="bibr">2011</xref>), and all procedures were approved by the TNPRC Institutional Animal Care and Use Committee (IACUC) and the Tulane University Institutional Biosafety Committee (IBC). During the course of the post-exposure period, the subjects were routinely weighed and monitored for body temperature at regular intervals, with temperature reported as the change from a pre-exposure baseline (denoted by TMP) and weight reported as a percentage of the pre-exposure weight (denoted by WT). C-reactive protein (CRP), a known indicator of TB infection, was also monitored, and chest X-rays were taken at tri-weekly intervals and scored by a TNPRC radiologist on a 0&#x02013;3 scale based on visual evidence of lesions (CXR). Gene expression profiles for extracted granulomas were assayed using Agilent TNPRC Macaca mulatta 4 x 44k Arrays (GPL10183) and scanned using the GenePix 4000B Scanner. All data files are available for download via the GEO Data Series GSE56919.</p></sec><sec><title>2.2. Hierarchical B-spline models</title><p>We use piecewise polynomials to estimate the trajectory of the unobserved disease progression <italic>z</italic>(<italic>t</italic>) as a linear combination of a set of B-Spline basis functions (de Boor, <xref rid="B7" ref-type="bibr">1993</xref>). We restrict <italic>z</italic>(<italic>t</italic>) to the family of non-negative cubic polynomials on [0, &#x003c4;<sub>1</sub>] and [&#x003c4;<sub>1</sub>, &#x003c4;<sub>2</sub>], where 0 &#x0003c; &#x003c4;<sub>1</sub> &#x0003c; &#x003c4;<sub>2</sub>, with continuous second derivatives globally on [0, &#x003c4;<sub>2</sub>]. Then <italic>z</italic>(<italic>t</italic>) can be expressed as <italic>z</italic>(<italic>t</italic>) = <italic>c</italic><sub>0</sub><italic>B</italic><sub>0,3</sub>(<italic>t</italic>) + <italic>c</italic><sub>1</sub><italic>B</italic><sub>1,3</sub>(<italic>t</italic>) + <italic>c</italic><sub>2</sub><italic>B</italic><sub>2,3</sub>(<italic>t</italic>) + <italic>c</italic><sub>3</sub><italic>B</italic><sub>3,3</sub>(<italic>t</italic>) + <italic>c</italic><sub>4</sub><italic>B</italic><sub>4,3</sub>(<italic>t</italic>) where {<italic>c</italic><sub>0</sub>, <italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, <italic>c</italic><sub>3</sub>, <italic>c</italic><sub>4</sub>} is a set of non-negative coefficients and {<italic>B</italic><sub>0,3</sub>(<italic>t</italic>), <italic>B</italic><sub>1,3</sub>(<italic>t</italic>), <italic>B</italic><sub>2,3</sub>(<italic>t</italic>), <italic>B</italic><sub>3,3</sub>(<italic>t</italic>), <italic>B</italic><sub>4,3</sub>(<italic>t</italic>)} is the set of B spline basis functions. For each subject, &#x003c4;<sub>2</sub> is the duration of time from exposure to euthanasia and is known for each subject, while &#x003c4;<sub>1</sub> is an interior transition point (or &#x0201c;knot&#x0201d;) that is estimated. We use the notation <italic>z</italic>(<italic>t</italic>|<bold>&#x003b8;</bold>) where <bold>&#x003b8;</bold> = (<italic>c</italic><sub>0</sub>, <italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, <italic>c</italic><sub>3</sub>, <italic>c</italic><sub>4</sub>, &#x003c4;<sub>1</sub>, &#x003c4;<sub>2</sub>).</p><p>The four variables WT, TMP, CRP, and CXR were measured longitudinally for the <italic>n<sub>s</sub></italic> = 17 experimental subjects. To reduce the high degree of fluctuation in CRP measurements, we discretized the observations to fall into one of three ordered groups based on previous clinical observations: Level 1 for CRP = 0; Level 2 for 0&#x0003c;CRP&#x0003c;=10; and Level 3 for CRP &#x0003e;10.</p><p>Let <italic>y</italic><sub><italic>vil</italic></sub> be the value of the <italic>v</italic>th variable for the <italic>i</italic>th subject at the time point <italic>t</italic><sub><italic>vil</italic></sub>, where <italic>v</italic> = 1, 2, 3, 4 (which correspond to WT, TMP, CRP, and CXR, respectively), <italic>i</italic> = 1, 2, &#x000b7; &#x000b7; &#x000b7;, <italic>n<sub>s</sub></italic> and <italic>l</italic> = 1, 2, &#x000b7; &#x000b7; &#x000b7;, <italic>n<sub>vi</sub></italic> denotes the time points observed for the corresponding subject and variable. At the initial time of <italic>Mtb</italic> exposure for each subject, we set <italic><bold>y</bold></italic><sub><italic>i</italic>0</sub> = {100, 0, 0, 0}, denoting the baseline state for each subject <italic>i</italic>. Let <italic>Y</italic> = <italic>y<sub>vil</sub></italic> be the array of all observations for all subjects.</p><p>We define the following hierarchical model for the relationship between the observed clinical variables and unobserved disease state <italic>z</italic>(<italic>t</italic>|<bold>&#x003b8;</bold>):</p><p>For <italic>i</italic> = 1, 2, &#x02026;, <italic>n<sub>s</sub></italic>:</p><disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003b8;</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;for&#x000a0;</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>2</mml:mn><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003b8;</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;for&#x000a0;</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>31</mml:mn></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003b8;</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;for&#x000a0;</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;and&#x000a0;</mml:mtext><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>41</mml:mn></mml:mrow></mml:msub><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003b8;</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;for&#x000a0;</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;and&#x000a0;</mml:mtext><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>Random errors &#x003f5;<sub><italic>vil</italic></sub> ~ <italic>N</italic>(0, &#x003c3;<sup>2</sup><sub><italic>v</italic></sub>), <italic>v</italic> = 1, 2 are independent for each subject and variable. Equations (3, 4) are proportional odds models (Agresti, <xref rid="B1" ref-type="bibr">2002</xref>) for the discretized CRP <italic>y</italic><sub>3<italic>il</italic></sub> &#x02208; {0, 1, 2} and the CXR <italic>y</italic><sub>4<italic>il</italic></sub> &#x02208; {0, 1, 2, 3} in which logit<inline-formula><mml:math id="M5"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and &#x003b2;<sub><italic>g</italic></sub> and &#x003b1;<sub><italic>h</italic></sub> are non-decreasing in <italic>g</italic> and <italic>h</italic>. The parameters <italic>b<sub>vj</sub></italic> and &#x003c3;<sup>2</sup><sub><italic>v</italic></sub> are common for all subjects while <bold>&#x003b8;</bold><sub><italic>i</italic></sub> represents the effects specific to subject <italic>i</italic>, and we assume that the measurements <italic>y</italic><sub><italic>vil</italic></sub>, <italic>v</italic> = 1, 2, 3, 4 are conditionally independent given <italic>b<sub>vj</sub></italic>, &#x003c3;<sup>2</sup><sub><italic>v</italic></sub>, and <bold>&#x003b8;</bold><sub><italic>i</italic></sub>.</p><p>We note that the slopes <italic>b</italic><sub><italic>v</italic>1</sub> and the disease states <italic>z</italic>(<italic>t<sub>vil</sub></italic>|<bold>&#x003b8;</bold><sub><italic>i</italic></sub>) are not individually identifiable in our model since they only appear as a product. However, this is simply a matter of scaling and does not impact our ability to compare estimated disease trajectories across subjects.</p><sec><title>2.2.1. Parameter estimation</title><p>Let <bold>&#x003b8;</bold><sub><italic>i</italic></sub> = (<italic>c</italic><sub><italic>i</italic>0</sub>,<italic>c</italic><sub><italic>i</italic>1</sub>,<italic>c</italic><sub><italic>i</italic>2</sub>,<italic>c</italic><sub><italic>i</italic>3</sub>,<italic>c</italic><sub><italic>i</italic>4</sub>, &#x003c4;<sub><italic>i</italic>1</sub>, &#x003c4;<sub><italic>i</italic>2</sub>) be the parameter vector for subject <italic>i</italic>. The disease progression function for the <italic>i</italic>th subject <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is defined on the interval [0, &#x003c4;<sub><italic>i</italic>2</sub>], in which &#x003c4;<sub><italic>i</italic>2</sub> is set to be the final time point, corresponding to the last measurement for any of the four clinical covariates. We assume that the pre-exposure disease state <italic>z</italic>(0|<bold>&#x003b8;</bold><sub><italic>i</italic></sub>) = 0, so we set <italic>c</italic><sub><italic>i</italic>0</sub> = 0. Therefore, among the components of <bold>&#x003b8;</bold><sub><italic>i</italic></sub>, we need only estimate <italic>c</italic><sub><italic>i</italic>1</sub>,<italic>c</italic><sub><italic>i</italic>2</sub>,<italic>c</italic><sub><italic>i</italic>3</sub>,<italic>c</italic><sub><italic>i</italic>4</sub>, &#x003c4;<sub><italic>i</italic>1</sub>.</p><p>The intercepts <italic>b</italic><sub>10</sub>, <italic>B</italic><sub>20</sub>, &#x003b2;<sub>0</sub>, &#x003b2;<sub>1</sub>, &#x003b1;<sub>0</sub>, &#x003b1;<sub>1</sub>, &#x003b1;<sub>2</sub> in Equations (1&#x02013;4) determine the distribution of the corresponding clinical variables given the disease state is 0. Since initial values for WT and TMP were constant for all subjects at 100 and 0, respectively, the intercept terms <italic>b</italic><sub>10</sub>, <italic>b</italic><sub>20</sub> were also fixed. Intercepts for the CRP and CXR probabilities at disease state 0 were also set to reflect the fact that pre-exposure measurements for these variables were fixed at 0 for all subjects. Values for the vector {&#x003b2;<sub>0</sub>, &#x003b2;<sub>1</sub>, &#x003b1;<sub>0</sub>, &#x003b1;<sub>1</sub>, &#x003b1;<sub>2</sub>} were set to be {5, 9, 5, 9, 13}, corresponding to the initial state probability <inline-formula><mml:math id="M6"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mi>X</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.993</mml:mn></mml:mrow></mml:math></inline-formula> (while these were somewhat arbitrary choices, we note that adjustments to these initial values were observed to have a negligible impact on the fitted models).</p><p>The remaining parameters are {<italic><bold>b</bold></italic>, <bold>&#x003c3;</bold><sup>2</sup>, <bold>&#x003b8;</bold><sub>1</sub>, &#x000b7; &#x000b7; &#x000b7;, <bold>&#x003b8;</bold><sub><italic>n<sub>s</sub></italic></sub>} where <italic><bold>b</bold></italic> = (<italic>b</italic><sub>11</sub>, <italic>b</italic><sub>21</sub>, <italic>b</italic><sub>31</sub>, <italic>b</italic><sub>41</sub>), <bold>&#x003c3;</bold><sup>2</sup> = (&#x003c3;<sup>2</sup><sub>1</sub>, &#x003c3;<sup>2</sup><sub>2</sub>), and <bold>&#x003b8;</bold><sub><italic>i</italic></sub> = (<italic>c</italic><sub><italic>i</italic>1</sub>, <italic>c</italic><sub><italic>i</italic>2</sub>, <italic>c</italic><sub><italic>i</italic>3</sub>, <italic>c</italic><sub><italic>i</italic>4</sub>, &#x003c4;<sub><italic>i</italic>1</sub>) for <italic>i</italic> = 1, 2, &#x000b7; &#x000b7; &#x000b7;, <sub><italic>n</italic><sub><italic>s</italic></sub></sub>. Equations (1&#x02013;4) specify that the WT and TMP values <italic>y</italic><sub>1<italic>il</italic></sub> and <italic>y</italic><sub>2<italic>il</italic></sub> are normally distributed while <italic>y</italic><sub>3<italic>il</italic></sub> and <italic>y</italic><sub>4<italic>il</italic></sub> have multinomial distributions. Using the conditional independence of the clinical variables, the joint likelihood function of the parameters <italic>L</italic>(<italic><bold>b</bold></italic>, <bold>&#x003c3;</bold><sup>2</sup>, <bold>&#x003b8;</bold><sub>1</sub>, &#x000b7; &#x000b7; &#x000b7;, <bold>&#x003b8;</bold><sub><italic>n<sub>s</sub></italic></sub>|<italic><bold>y</bold></italic>) is just the product of the marginal likelihoods.</p><p>We set prior distributions for these parameters to reflect our biological intuition and imposed boundary constraints to account for the lack of identifiability associated with our model. As we expect that increasing disease severity should be associated with weight loss, elevated body temperature, and/or higher levels of CRP and CXR, we use truncated diffuse normal priors on the slopes: <italic>b</italic><sub>11</sub> ~ <italic>N</italic>(0, 100)<italic>I</italic><sub>[&#x02212;10,0]</sub>, <italic>b</italic><sub>21</sub> ~ <italic>N</italic>(0, 100)<italic>I</italic><sub>[0,10]</sub>, <italic>b</italic><sub>31</sub> ~ <italic>N</italic>(0, 100)<italic>I</italic><sub>[&#x02212;10,0]</sub>, <italic>b</italic><sub>41</sub> ~ <italic>N</italic>(0, 100)<italic>I</italic><sub>[&#x02212;10,0]</sub>, where <italic>N</italic>(&#x003bc;<sub>0</sub>, &#x003be;<sup>2</sup><sub>0</sub>)<italic>I</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub> is the truncated normal distribution with mean &#x003bc;<sub>0</sub> and variance &#x003be;<sup>2</sup><sub>0</sub> whose support is the interval [<italic>a</italic>, <italic>b</italic>]. These priors, which correspond to the scaled normal distribution with support on the interval between the mean and one standard deviation to its right or left, place higher weight on values close to 0 but are not highly restrictive. For the variance parameters, prior distributions were motivated by preliminary inspection of the observed variability in the data and bounds were set to constrain the estimates to a reasonable range of values: 1/&#x003c3;<sup>2</sup><sub>1</sub> ~ <italic>U</italic>[0.001, 0.6], 1/&#x003c3;<sup>2</sup><sub>2</sub> ~ <italic>U</italic>[1, 25]. Priors for the basis functions were defined by &#x003c4;<sub><italic>i</italic>1</sub> ~ <italic>U</italic>[0, &#x003c4;<sub><italic>i</italic>2</sub>], and <italic>c<sub>ij</sub></italic> ~ <italic>N</italic>(0, 10)<italic>I</italic><sub>[0,+&#x0221e;)</sub> for <italic>j</italic> &#x02208; 1, 2, 3, 4.</p><p>We estimated the parameters by sampling from the posterior distribution using MCMC as implemented in WinBUGS (Lunn et al., <xref rid="B18" ref-type="bibr">2000</xref>). After a burn-in period of 1000 iterations, we ran the MCMC algorithm for 15,000 iterations and thinned the chain by taking every third point to produce an effectively uncorrelated sample of <italic>T</italic> = 5000 points from the posterior distribution.</p></sec><sec><title>2.2.2. Simulation study</title><p>To test our method's ability to accurately estimate the progression of a specified disease trajectory from observed clinical covariates, we constructed 4 hypothetical disease scenarios and then simulated associated observations for WT, TMP, CRP, and CXR.</p><p>Our simulations represented the following cases: (1) progression to severe illness; (2) asymptomatic infection; (3) recovery following acute illness, and (4) gradual progression to moderate illness. Given a specified disease trajectory, we generated 100 simulated datasets of weekly clinical observations according to Equations (1&#x02013;4). At each time point, WT and TMP observations were randomly generated from the normal distributions determined by Equations (1, 2) and the categorical CRP and CXR observations were taken to be the level with the maximum probability determined by Equations (3, 4). We set the intercepts <italic>b</italic><sub>10</sub> = 100, <italic>b</italic><sub>20</sub> = 0, &#x003b2;<sub>0</sub> = 5, &#x003b2;<sub>1</sub> = 9, &#x003b1;<sub>0</sub> = 5, &#x003b1;<sub>1</sub> = 9, &#x003b1;<sub>2</sub> = 13 as above. The slopes were set to be <italic>b</italic><sub>11</sub> = &#x02212;2, <italic>b</italic><sub>21</sub> = 0.6, <italic>b</italic><sub>31</sub> = &#x02212;3, <italic>b</italic><sub>41</sub> = &#x02212;3.5 and the precisions were set to be 1/&#x003c3;<sup>2</sup><sub>1</sub> = 0.11 and 1/&#x003c3;<sup>2</sup><sub>2</sub> = 2. These parameters were picked so that the simulated values resembled the observed measurements in our TB experimental data.</p><p>For each simulated dataset, we sampled from the posterior distributions of the parameters (including slopes, precisions and subject-specific parameters <italic>c</italic><sub><italic>i</italic>1</sub>,<italic>c</italic><sub><italic>i</italic>2</sub>,<italic>c</italic><sub><italic>i</italic>3</sub>,<italic>c</italic><sub><italic>i</italic>4</sub>,&#x003c4;<sub><italic>i</italic>1</sub>) via MCMC. Due to the large number of samples in our study, we reduced our computational requirements to include a burn-in period of 50 iterations and then we retained every third sample of the following 1000 iterations. The empirical median of the posterior distribution for each parameter was chosen as its estimate, and these were then used to generate the estimated trajectories of the disease state for the four subjects.</p></sec></sec><sec><title>2.3. Linear models for gene expression profiles</title><p>Following estimation of the disease trajectories for each subject, we employed linear models to detect genes that are significantly associated with disease features.</p><p>In this setting, we fit gene-wise models as described in Smyth (<xref rid="B26" ref-type="bibr">2004</xref>), in which the response variables were the normalized log expression value associated with gene <italic>g</italic> for each of the <italic>i</italic> subjects and the covariates were derived from the estimated trajectory <italic>&#x01e91;</italic><sub><italic>i</italic></sub>(<italic>t</italic>).</p><p>Our two-channel microarray data included expression levels of 44,449 gene probes for 17 subjects, arranged in a loop design that included other control samples. We analyzed the two channels individually, normalized the arrays using the Bioconductor packages LIMMA and OLIN (Smyth, <xref rid="B25" ref-type="bibr">2005</xref>; Futschik, <xref rid="B10" ref-type="bibr">2012</xref>), and extracted the data for the samples of interest.</p><p>To focus our attention on genes that would likely be associated with disease progression, we removed probes that showed insufficient variability across the subjects. Letting <italic>u</italic><sub>gi</sub> denote the <italic>log</italic><sub>2</sub> expression level for the <italic>g</italic>th gene probe of the <italic>i</italic>th subject, we used the following filtering criterion: exclude the <italic>g</italic>th gene probe from the analysis if (max<sub><italic>i</italic></sub><italic>u<sub>gi</sub></italic> &#x02212; min<sub><italic>i</italic></sub>
<italic>u</italic><sub><italic>gi</italic></sub>) &#x0003c; 1.5.</p><p>For <italic>J</italic> clinical features <italic>Z</italic><sub>1</sub>, <italic>Z</italic><sub>2</sub>, &#x000b7; &#x000b7; &#x000b7;, <italic>Z<sub>J</sub></italic> as predictors of the expression profiles for the <italic>G</italic> probes remaining after the filtering step, we fit models of the form</p><disp-formula id="E5"><label>(5)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003b2;</mml:mi></mml:mstyle><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mi>g</mml:mi></mml:msub><mml:mtext>&#x000a0;and&#x000a0;</mml:mtext><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mi>g</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><p>for each <italic>g</italic> = 1, 2, &#x000b7; &#x000b7; &#x000b7;, <italic>G</italic> where <italic><bold>u</bold><sub>g</sub></italic> = (<italic>u</italic><sub><italic>g</italic>1</sub>, <italic>u</italic><sub><italic>g</italic>2</sub>, &#x000b7; &#x000b7; &#x000b7;, <italic>u<sub>gS</sub></italic>)<sup><italic>T</italic></sup> &#x02208; &#x0211d;<sup><italic>S</italic></sup>, the <italic>S</italic> &#x000d7; (<italic>J</italic> + 1) design matrix <inline-formula><mml:math id="M8"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x022ef;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x022ef;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x022ef;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <bold>&#x003b2;</bold><sub><italic>g</italic></sub> = (&#x003bc;<sub><italic>g</italic></sub>, &#x003b1;<sub><italic>g</italic>1</sub>, &#x003b1;<sub>g2</sub>, &#x000b7; &#x000b7; &#x000b7;, &#x003b1;<sub><italic>gJ</italic></sub>)<sup><italic>T</italic></sup>. The intercept &#x003bc;<sub><italic>g</italic></sub> is the mean expression level for the <italic>g</italic>th probe across the subjects and &#x003b1;<sub><italic>g</italic>1</sub>, &#x003b1;<sub><italic>g</italic>2</sub>, &#x000b7; &#x000b7; &#x000b7;, &#x003b1;<sub><italic>gJ</italic></sub> are the slopes of the <italic>J</italic> clinical features for the <italic>g</italic>th probe.</p><p>We determined that a particular gene probe was significantly associated with the covariate combination <italic>Z</italic><sub>1</sub>, <italic>Z</italic><sub>2</sub>, &#x000b7; &#x000b7; &#x000b7;, <italic>Z<sub>J</sub></italic> if the <italic>p</italic>-values of the individual <italic>t</italic>-tests for the <italic>J</italic> covariates were all less than 0.05 and the <italic>p</italic>-value of the overall model <italic>F</italic> test <italic>H</italic><sub>0</sub>: &#x003b1;<sub><italic>g</italic>1</sub> = &#x003b1;<sub><italic>g</italic>2</sub> = &#x000b7; &#x000b7; &#x000b7; &#x003b1;<sub><italic>gJ</italic></sub> = 0 was less than 0.01. Given a set of competing models, the model with the smallest overall <italic>p</italic>-value for which all coefficients met the &#x003b1; = 0.05 significance level was selected as the best model for that probe.</p><p>Probe-level results were aggregated to the set of unique Agilent probe IDs. Because pairs of replicate probes occasionally were best fit by models with differing parameterizations, the statistical significance of the pooled coefficients was calculated by taking the geometric mean of the observed <italic>p</italic>-values (which were automatically assigned to the value 1 for any covariates that were not included in the best-fitting model for a given probe) and we reset any model coefficients that were not associated with aggregate <italic>p</italic>-values of 0.05 or less to be equal to 0.</p><p>Hierarchical clustering was performed in R to classify the unique probe IDs with respect to the scaled matrix of fitted model coefficients, using the Euclidean distance and Ward's minimum variance method.</p></sec><sec><title>2.4. Bioinformatics analysis</title><p>Agilent probe IDs that were significantly associated with a fitted clinical model were mapped to annotated genes or genomic regions using the DAVID Gene ID conversion tool (Huang et al., <xref rid="B14" ref-type="bibr">2009a</xref>,<xref rid="B15" ref-type="bibr">b</xref>). Subsequently, the set of all unique mapped gene IDs was uploaded to the DAVID suite and analyzed for functional annotation. Our threshold for statistical significance of enriched terms was a Benjamini-Hochberg adjusted <italic>p</italic>-value of 0.05 or less.</p><p>The set of significantly enriched SP-PIR keywords was analyzed to determine whether representation of associated genes was equally distributed across the model-derived gene clusters. For each keyword, we conducted a Chi-Square goodness of fit test for the cluster distributions based on the null hypothesis of no association and calculated the associated <italic>p</italic>-values with adjustment for multiple testing using the Benjamini-Hochberg correction.</p></sec></sec><sec id="s3"><title>3. Results</title><p>Data for three of the subjects included in our study were found to be anomalous. In one case, terminal illness required immediate euthanasia, and in the two others we observed aberrant expression profiles suggesting experimental error. Data for these subjects were discarded and the results presented here correspond to the 14 remaining subjects.</p><sec><title>3.1. Modeling of simulated trajectories</title><p>The results from our simulation study are shown in Figure <xref ref-type="fig" rid="F1">1</xref>. The 100 estimated trajectories for each of the four cases were compared to the true disease trajectory. As mentioned previously, the disease state is not identifiable and is unique only up to a constant. Therefore, the comparison was done in relative terms to see whether our modeling approach can recover the &#x0201c;shape&#x0201d; of the disease state trajectories. Specifically, suppose <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is the true trajectory and <italic>&#x01e91;</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is any one of the 100 estimated trajectories for the <italic>i</italic>th case where <italic>i</italic> = 1, 2, 3, 4. We expect that there exists a scaling constant &#x003b3; such that &#x003b3; <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) &#x02248; <italic>&#x01e91;</italic><sub><italic>i</italic></sub>(<italic>t</italic>) for all <italic>i</italic>, and the right panel of Figure <xref ref-type="fig" rid="F1">1</xref> displays a plot of the 100 estimated trajectories <italic>&#x01e91;</italic><sub><italic>i</italic></sub>(<italic>t</italic>) against the scaled true trajectory &#x003b3; <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>). In each case, our simulations faithfully recovered the underlying trajectory, thereby demonstrating the ability of our approach to accurately estimate model parameters in practice.</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Left:</bold> An illustration of the simulated clinical observations for WT, TMP, CRP, and CXR associated with trajectories representing rapid disease progression (subject 1), minimal infection (subject 2), infection followed by recovery (subject 3), and gradually progressing infection (subject 4). <bold>Right:</bold> Estimated disease state trajectories for 100 simulated datasets (green curves) and the associated scaled true trajectory (black curve) for each of the four cases.</p></caption><graphic xlink:href="fgene-05-00240-g0001"/></fig></sec><sec><title>3.2. Fitted trajectories for clinical profiles</title><p>The left panel of Figure <xref ref-type="fig" rid="F2">2</xref> displays the observed clinical variables for four typical subjects: HC90, HC20, HB74, FR67. The CRP used in the plot is the discretized CRP. Hierarchical B-Spline models Equations (1&#x02013;4) were fitted for each of the subjects as described. Following MCMC estimation, we obtained empirical posterior distributions for the common effects parameters, as shown in Figure <xref ref-type="fig" rid="F3">3</xref> and summarized in Table <xref ref-type="table" rid="T1">1</xref>.</p><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>Left:</bold> Observed clinical variables for four typical subjects: HC90, HC20, HB74, FR67. CRP values are binned into 3 groups, corresponding to absent, low, or high CRP levels. <bold>Right:</bold> Estimated disease trajectories from Bayesian hierarchical B-Spline models incorporating the four clinical covariates.</p></caption><graphic xlink:href="fgene-05-00240-g0002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>The empirical densities of posterior distributions of the slopes <italic>b</italic><sub>11</sub> (WT), <italic>b</italic><sub>21</sub> (TMP), <italic>b</italic><sub>31</sub> (CRP), <italic>b</italic><sub>41</sub> (CXR)</bold>.</p></caption><graphic xlink:href="fgene-05-00240-g0003"/></fig><table-wrap id="T1" position="float"><label>Table 1</label><caption><p><bold>Distributions of parameter estimates</bold>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1"><bold>Parameter</bold></th><th align="center" rowspan="1" colspan="1"><bold>Mean</bold></th><th align="center" rowspan="1" colspan="1"><bold><italic>SD</italic></bold></th><th align="center" rowspan="1" colspan="1"><bold>2.5%</bold></th><th align="center" rowspan="1" colspan="1"><bold>Median</bold></th><th align="center" rowspan="1" colspan="1"><bold>97.5%</bold></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1"><italic>b</italic><sub>11</sub> (weight)</td><td align="center" rowspan="1" colspan="1">&#x02212;0.1026</td><td align="center" rowspan="1" colspan="1">0.0874</td><td align="center" rowspan="1" colspan="1">&#x02212;0.3228</td><td align="center" rowspan="1" colspan="1">&#x02212;0.0804</td><td align="center" rowspan="1" colspan="1">&#x02212;0.0032</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>b</italic><sub>21</sub> (temperature)</td><td align="center" rowspan="1" colspan="1">0.0885</td><td align="center" rowspan="1" colspan="1">0.0324</td><td align="center" rowspan="1" colspan="1">0.0285</td><td align="center" rowspan="1" colspan="1">0.0875</td><td align="center" rowspan="1" colspan="1">0.1549</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>b</italic><sub>31</sub> (CRP)</td><td align="center" rowspan="1" colspan="1">&#x02212;1.9971</td><td align="center" rowspan="1" colspan="1">0.2141</td><td align="center" rowspan="1" colspan="1">&#x02212;2.4630</td><td align="center" rowspan="1" colspan="1">&#x02212;1.9860</td><td align="center" rowspan="1" colspan="1">&#x02212;1.6160</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>b</italic><sub>41</sub> (CXR)</td><td align="center" rowspan="1" colspan="1">&#x02212;2.5587</td><td align="center" rowspan="1" colspan="1">0.2746</td><td align="center" rowspan="1" colspan="1">&#x02212;3.1631</td><td align="center" rowspan="1" colspan="1">&#x02212;2.5420</td><td align="center" rowspan="1" colspan="1">&#x02212;2.0809</td></tr><tr><td align="left" rowspan="1" colspan="1">1/&#x003c3;<sup>2</sup><sub>1</sub> (weight)</td><td align="center" rowspan="1" colspan="1">0.0437</td><td align="center" rowspan="1" colspan="1">0.0043</td><td align="center" rowspan="1" colspan="1">0.0357</td><td align="center" rowspan="1" colspan="1">0.0436</td><td align="center" rowspan="1" colspan="1">0.0525</td></tr><tr><td align="left" rowspan="1" colspan="1">1/&#x003c3;<sup>2</sup><sub>2</sub> (temperature)</td><td align="center" rowspan="1" colspan="1">1.3532</td><td align="center" rowspan="1" colspan="1">0.1358</td><td align="center" rowspan="1" colspan="1">1.0950</td><td align="center" rowspan="1" colspan="1">1.3465</td><td align="center" rowspan="1" colspan="1">1.6340</td></tr></tbody></table></table-wrap><p>While all parameters were statistically significant, estimated trajectories, as shown in the right panel of Figure <xref ref-type="fig" rid="F2">2</xref>, were more sensitive to changes in CRP and CXR than to those in TMP and WT. Table <xref ref-type="table" rid="T2">2</xref> summarizes certain key features of the fitted trajectories for each subject. Time post-exposure <italic>T</italic> is defined by the time from initial exposure to euthanasia, final severity <italic>S</italic> is the value from the fitted disease trajectory at the final time point, onset time <italic>O</italic> is the time when the subject initially reaches a specified severity level (which here was taken as 1.4 based on estimated severity scores associated with symptomatic illness), and the maximum severity <italic>M</italic> is the highest value attained for a given trajectory.</p><table-wrap id="T2" position="float"><label>Table 2</label><caption><p><bold>Features of fitted disease trajectories</bold>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1"><bold>Subject</bold></th><th align="center" rowspan="1" colspan="1"><bold>Time post-exposure</bold></th><th align="center" rowspan="1" colspan="1"><bold>Final severity</bold></th><th align="center" rowspan="1" colspan="1"><bold>Onset time</bold></th><th align="center" rowspan="1" colspan="1"><bold>Maximum severity</bold></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">BV21</td><td align="center" rowspan="1" colspan="1">15.0</td><td align="center" rowspan="1" colspan="1">2.95</td><td align="center" rowspan="1" colspan="1">8.1</td><td align="center" rowspan="1" colspan="1">2.97</td></tr><tr><td align="left" rowspan="1" colspan="1">CA75</td><td align="center" rowspan="1" colspan="1">15.1</td><td align="center" rowspan="1" colspan="1">1.96</td><td align="center" rowspan="1" colspan="1">12.0</td><td align="center" rowspan="1" colspan="1">1.96</td></tr><tr><td align="left" rowspan="1" colspan="1">FE10</td><td align="center" rowspan="1" colspan="1">23.0</td><td align="center" rowspan="1" colspan="1">2.20</td><td align="center" rowspan="1" colspan="1">5.0</td><td align="center" rowspan="1" colspan="1">2.20</td></tr><tr><td align="left" rowspan="1" colspan="1">FJ05</td><td align="center" rowspan="1" colspan="1">26.0</td><td align="center" rowspan="1" colspan="1">2.10</td><td align="center" rowspan="1" colspan="1">22.1</td><td align="center" rowspan="1" colspan="1">2.10</td></tr><tr><td align="left" rowspan="1" colspan="1">FR67</td><td align="center" rowspan="1" colspan="1">16.1</td><td align="center" rowspan="1" colspan="1">0.95</td><td align="center" rowspan="1" colspan="1">12.0</td><td align="center" rowspan="1" colspan="1">1.43</td></tr><tr><td align="left" rowspan="1" colspan="1">HA77</td><td align="center" rowspan="1" colspan="1">12.0</td><td align="center" rowspan="1" colspan="1">3.84</td><td align="center" rowspan="1" colspan="1">1.1</td><td align="center" rowspan="1" colspan="1">3.86</td></tr><tr><td align="left" rowspan="1" colspan="1">HB74</td><td align="center" rowspan="1" colspan="1">26.0</td><td align="center" rowspan="1" colspan="1">2.06</td><td align="center" rowspan="1" colspan="1">6.6</td><td align="center" rowspan="1" colspan="1">2.06</td></tr><tr><td align="left" rowspan="1" colspan="1">HC20</td><td align="center" rowspan="1" colspan="1">21.0</td><td align="center" rowspan="1" colspan="1">6.77</td><td align="center" rowspan="1" colspan="1">2.9</td><td align="center" rowspan="1" colspan="1">6.77</td></tr><tr><td align="left" rowspan="1" colspan="1">HC38</td><td align="center" rowspan="1" colspan="1">9.0</td><td align="center" rowspan="1" colspan="1">6.25</td><td align="center" rowspan="1" colspan="1">1.7</td><td align="center" rowspan="1" colspan="1">6.59</td></tr><tr><td align="left" rowspan="1" colspan="1">HC90</td><td align="center" rowspan="1" colspan="1">25.0</td><td align="center" rowspan="1" colspan="1">0.76</td><td align="center" rowspan="1" colspan="1">1.3</td><td align="center" rowspan="1" colspan="1">2.56</td></tr><tr><td align="left" rowspan="1" colspan="1">HG80</td><td align="center" rowspan="1" colspan="1">5.0</td><td align="center" rowspan="1" colspan="1">2.86</td><td align="center" rowspan="1" colspan="1">1.4</td><td align="center" rowspan="1" colspan="1">2.88</td></tr><tr><td align="left" rowspan="1" colspan="1">HJ01</td><td align="center" rowspan="1" colspan="1">21.0</td><td align="center" rowspan="1" colspan="1">3.91</td><td align="center" rowspan="1" colspan="1">3.7</td><td align="center" rowspan="1" colspan="1">4.04</td></tr><tr><td align="left" rowspan="1" colspan="1">HJ91</td><td align="center" rowspan="1" colspan="1">17.0</td><td align="center" rowspan="1" colspan="1">2.92</td><td align="center" rowspan="1" colspan="1">8.7</td><td align="center" rowspan="1" colspan="1">3.05</td></tr><tr><td align="left" rowspan="1" colspan="1">HJ93</td><td align="center" rowspan="1" colspan="1">9.0</td><td align="center" rowspan="1" colspan="1">4.51</td><td align="center" rowspan="1" colspan="1">2.9</td><td align="center" rowspan="1" colspan="1">4.51</td></tr></tbody></table></table-wrap></sec><sec><title>3.3. Linear models for gene expression</title><p>After preliminary filtering, 14,504 candidate gene probes were retained for further investigation. Not surprisingly, preliminary analysis indicated that the predictors in Table <xref ref-type="table" rid="T2">2</xref> were highly correlated, and so we chose to focus our attention on two of the least correlated predictors, time post-exposure <italic>T</italic> and final severity <italic>S</italic>. For each of these probes, the best-fitting regression model was chosen from among models containing all subsets of linear and quadratic terms for <italic>T</italic> as well as a linear term for <italic>S</italic>. A total of 9130 probes were significantly associated with at least one of these models, and 8453 of these corresponded to annotated genes or genomic regions as identified by the DAVID Gene ID conversion tool. The probe level results were then aggregated to represent a set of 4864 unique Agilent probe IDs. As shown in Table <xref ref-type="table" rid="T3">3</xref>, the great majority of genes (93%) were significantly associated only with post-exposure time <italic>T</italic>, with the remaining 7% associated with either severity <italic>S</italic> alone or with both <italic>S</italic> and <italic>T</italic>.</p><table-wrap id="T3" position="float"><label>Table 3</label><caption><p><bold>Best-fitting models for 4864 Unique Agilent Probe IDs</bold>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1"><bold>Clinical covariates</bold></th><th align="left" rowspan="1" colspan="1"><bold>Number of significantly associated genes</bold></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1"><italic>T<sub>i</sub></italic></td><td align="center" rowspan="1" colspan="1">367</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>T<sub>i</sub></italic><sup>2</sup></td><td align="center" rowspan="1" colspan="1">3959</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>T<sub>i</sub></italic>, <italic>T<sub>i</sub></italic><sup>2</sup></td><td align="center" rowspan="1" colspan="1">188</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>S<sub>i</sub></italic></td><td align="center" rowspan="1" colspan="1">145</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>T<sub>i</sub></italic>, <italic>S<sub>i</sub></italic></td><td align="center" rowspan="1" colspan="1">25</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>T<sub>i</sub></italic><sup>2</sup>, <italic>S<sub>i</sub></italic></td><td align="center" rowspan="1" colspan="1">151</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>T<sub>i</sub></italic>, <italic>T<sub>i</sub></italic><sup>2</sup>, <italic>S<sub>i</sub></italic></td><td align="center" rowspan="1" colspan="1">29</td></tr></tbody></table></table-wrap><p>Hierarchical clustering was performed on the scaled set of estimated model parameters to determine subsets of probe IDs that had the most similar characteristics with respect to their fitted models. Following visual inspection, we determined that 6 clusters were sufficient to adequately classify the results, as shown in Figure <xref ref-type="fig" rid="F4">4</xref>.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>Hierarchical clustering of unique probe IDs based on fitted model coefficients</bold>. All coefficients were scaled prior to analysis to assign equal weight to each covariate. Red values denote coefficients that are positively associated with increases in the given covariates at the &#x003b1; = 0.05 significance level, while values in blue denote significant negatively associated coefficients.</p></caption><graphic xlink:href="fgene-05-00240-g0004"/></fig><p>The largest cluster (which we denote Cluster 1) contained 2165 probes which mapped to 1950 distinct gene IDs. These expression profiles were predominantly characterized by quadratic increases in gene expression over time <italic>T</italic> (with linear increases in the remaining few). Cluster 2 contained 102 probes that displayed a parabolic trend, initially increasing and then decreasing in expression over time. These mapped to 100 distinct gene IDs. Cluster 3 (251 probes, 247 unique gene IDs) included probes whose expression significantly increased as a function of severity score <italic>S</italic>. Approximately half of these probes were also significantly associated with time <italic>T</italic>, either as a quadratic or linear term. Cluster 4 was the second largest (1891 probes, 1818 unique gene IDs) and exclusively included probes whose expression decreased as a quadratic function of time <italic>T</italic>. Cluster 5 was the smallest of the clusters, containing 74 probes mapping to 73 unique gene IDs. Expression profiles for probes in this cluster were all negatively associated with disease severity <italic>S</italic>, and the majority of these were also significantly associated with time <italic>T</italic>. Finally, Cluster 6 (381 probes, 373 gene IDs) included probes whose expression decreased linearly as a function of <italic>T</italic>.</p></sec><sec><title>3.4. Functional associations</title><p>The set of all unique gene IDs included in the six clusters was imported into the DAVID bioinformatics tool suite and analyzed for functional annotation. We found that this subset was significantly enriched for 181 GO Biological Process (BP) terms, 50 Cellular Component (CC) terms, 7 GO Molecular Function (MF) terms, 8 KEGG Pathways, 77 Swiss-Prot Protein Information Resource (SP-PIR) Keywords, and 5 UniProt Sequence Annotation (UP-SEQ) Features. To avoid redundancy, we present results for the 56 statistically significant SP-PIR keywords that were unambiguously defined in the Swiss-Prot controlled vocabulary of keywords (<ext-link ext-link-type="uri" xlink:href="http://www.uniprot.org/docs/keywlist">www.uniprot.org/docs/keywlist</ext-link>). Figure <xref ref-type="fig" rid="F5">5</xref> displays these terms along with the relative proportion of gene IDs included within each expression profile cluster. Based on the observed numbers of gene IDs in each cluster, if the gene IDs represented by a given keyword were randomly associated with the set of six clusters we would expect the percentage of gene IDs by cluster to be distributed as follows: 42.4% in Cluster 1, 2.2% in Cluster 2, 5.5% in Cluster 3, 39.7% in Cluster 4, 1.6% in Cluster 5, and 8.6% in Cluster 6. Chi-Square tests for random association of enriched genes with cluster membership identified 24 terms that were consistent with the expected cluster distribution, while the remaining 32 terms deviated significantly from the expected proportions. For a few terms, the deviations reflected an imbalance of gene IDs associated with quadratic temporal increases or decreases (Clusters 2 and 4), which would be expected to be observed in nearly equal proportions. For example, for the keyword &#x0201c;Hormone&#x0201d; 31 of 33 gene IDs were associated with Cluster 2 (<italic>p</italic> = 0.005) while 14 of the 15 gene IDs associated with the keyword &#x0201c;Ubiquinone&#x0201d; were contained in Cluster 4.</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>Enriched SP-PIR keywords for the set of unique gene IDs associated with post-exposure time <italic>T</italic> and/or final severity score <italic>S</italic> at the &#x003b1; = 0.05 significance level</bold>. For each keyword, the distribution of associated genes by model cluster is displayed using colored bars, with Cluster 1 on the left (light blue) and Cluster 6 on the right (yellow).</p></caption><graphic xlink:href="fgene-05-00240-g0005"/></fig><p>Of particular interest were the keywords that exhibited significant over-representation of genes associated with disease severity score, represented by Clusters 3 and 5. For the keyword inflammatory response, 6 of the 32 included gene IDs (17.6%) were severity-associated (CCL2, CCL11, CCL20, CXCL1, CXCL3, and TLR8), and over 10% of the gene IDs mapped to the keywords &#x0201c;activator,&#x0201d; &#x0201c;chemotaxis,&#x0201d; &#x0201c;chromosomal rearrangement,&#x0201d; &#x0201c;cytokine,&#x0201d; &#x0201c;electron transport,&#x0201d; &#x0201c;endosome,&#x0201d; and &#x0201c;SH3 domain&#x0201d; were included in Clusters 3 or 5. While relatively few genes were significantly down-regulated with increased severity, an interesting inclusion was the chemokine CXCR5. Recent studies have demonstrated that CXCR5 activity is essential for TB immune response (Gopal et al., <xref rid="B12" ref-type="bibr">2013</xref>; Slight et al., <xref rid="B24" ref-type="bibr">2013</xref>), and our results suggest that expression of this chemokine may be deficient in our most symptomatic subjects. CCL2, a chemokine which was positively associated with severity in our analysis, has also been proposed as a biomarker based on experimental findings demonstrating that expression of this gene was elevated for the more severe cases within a group of human patients (Hasan et al., <xref rid="B13" ref-type="bibr">2009</xref>; Hussain et al., <xref rid="B16" ref-type="bibr">2011</xref>; Ansari et al., <xref rid="B2" ref-type="bibr">2013</xref>).</p><p>To put our results in a larger context, we compared our transcription profiles with those identified in recent studies seeking to identify TB expression biomarkers. In 2010, researchers published a list of 393 transcripts that were found to effectively discriminate between cases of active and latent TB in blood samples (Berry et al., <xref rid="B5" ref-type="bibr">2010</xref>). We downloaded this list, which included 376 distinct gene IDs, and matched it to our set of 1950 genes that were significantly associated with <italic>T</italic> and/or <italic>S</italic>. We found an overlap of 106 genes and applied hierarchical clustering to the expression profiles associated with this subset. The results, shown in Figure <xref ref-type="fig" rid="F6">6</xref>, clearly separated five of our subjects from the others. Interestingly, these correspond to five of the six lowest scoring cases using our fitted severity models, all of which had very low CXR scores, 0 CRP values, and low or undetectable levels of bacteria upon autopsy. A very low-scoring subject on our severity scale that was not included in this group was CA75, an animal which demonstrated considerable weight loss despite an absence of other clinical symptoms and whose expression profile more closely resembled those of some of the more symptomatic subjects. Overall, we found that there was a significant difference in both time post-exposure and severity score between the subjects in the two clusters, although the temporal association may be due to the fact that the three animals that were studied for over 24 weeks were also coincidentally among the least symptomatic cases. We also performed a hierarchical clustering analysis on the set of profiles for 168 temporal- and/or severity associated genes included in a list of 409 gene IDs identified in a recent aggregate analysis of TB expression biomarkers identified in 7 prior studies (Joosten et al., <xref rid="B17" ref-type="bibr">2013</xref>) and obtained identical clusters, suggesting that our results are fairly robust.</p><fig id="F6" position="float"><label>Figure 6</label><caption><p><bold>Heatmap of expression profiles for 106 genes significantly associated with post-exposure time <italic>T</italic> and/or final severity score <italic>S</italic> and included in a set of 393 transcripts that were previously reported to effectively discriminate between cases of active and latent TB in blood samples (Berry et al., <xref rid="B5" ref-type="bibr">2010</xref>)</bold>. Hierarchical clustering of the samples on the basis of this subset separates 5 of the 6 least severe cases in our sample from the remaining 9 cases.</p></caption><graphic xlink:href="fgene-05-00240-g0006"/></fig></sec></sec><sec id="s4"><title>4. Discussion</title><p>The majority of clinico-genomic modeling efforts to date have emphasized the aggregation of clinical and genetic data in the prediction of binary disease outcomes. However, for infectious diseases such as TB that are associated with a spectrum of conditions, such an approach is unlikely to illuminate the subtle variations in genetic function that might predispose one individual to develop a more severe infection than another. As our experimental data clearly demonstrate, the progression from <italic>Mtb</italic> exposure to the development of latent infection is a far from uniform process. Even in controlled experiments such as ours, reactions vary considerably and the clinical response is difficult to predict. Therefore, the analysis of gene expression profiles to understand the development of latent infection will be of limited value unless such variation is taken into account.</p><p>Despite the obvious benefits of incorporating clinical data in this setting, little work has been done to facilitate such analyses by effectively aggregating a set of disparate longitudinal clinical measurements in a practical and intuitive way. To contribute to this important area of research, we have applied Bayesian hierarchical B-Spline models to the estimation of disease trajectories. Our fitted estimates provide helpful summaries of the clinical profiles of each of our subjects and enable the direct incorporation of aspects of the individual disease progressions in a quantitative form. Furthermore, the modeling of continuous disease trajectories offers a great deal of analytical flexibility. While in our particular study we concluded that the duration of time post-exposure and the estimated severity of disease at the time of euthanasia were the most important explanatory factors for variation in gene expression, one might imagine that in other settings different aspects of an estimated disease trajectory would be more predictive. For example, the frequency of bouts of acute illness might be more relevant for some conditions, while for others the time to recovery might be of particular interest.</p><p>As an alternative to predicting disease outcomes, we have focused our attention on the incorporation of clinical profiles in the identification of biomarkers associated with observed disease severity. Our results demonstrate that, even with a fairly limited set of subjects, our approach can identify key genes that have been shown to be factors in TB prognosis. This illustrates the potential of such integrated analyses for not only TB, but for a variety of complicated diseases in which subjects are monitored over time. While controlled experiments such as ours are, of course, limited to the laboratory setting, the ability to incorporate longitudinal clinical profiles in the analysis of gene expression data from human subjects is certainly an option in many observational studies and clinical trials. The estimation of individual disease trajectories in such studies would not only enable significant improvements in both the sensitivity and specificity of biomarker identification beyond current approaches, but would also provide insights into personalized treatment strategies.</p></sec><sec><title>Author contributions</title><p>Qingyang Luo developed and implemented the models, analyzed the clinical and gene expression data, and contributed to the manuscript. Smriti Mehra infected the animals and collected samples. Nadia A. Golden produced the microarray data. Deepak Kaushal directed the primate experiments and contributed to the manuscript. Michelle R. Lacey directed the modeling project, performed the bioinformatics analysis, and revised and finalized the manuscript.</p><sec><title>Conflict of interest statement</title><p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p></sec></sec>