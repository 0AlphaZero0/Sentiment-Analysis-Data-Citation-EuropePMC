<sec sec-type="intro" id="s1"><title>Introduction</title><p>In general, the first step of the natural history of tuberculosis (TB) is characterized by the infection of alveolar macrophages (AMs) with <italic>Mycobacterium tuberculosis</italic> (Mtb). The bacilli are able to grow intracellularly until they destroy the AM and are then able to infect neighboring cells from close alveolar spaces. As Mtb is a slow grower, with a doubling time of around 24 h, this process lasts for around 1 week (Cardona, <xref rid="B4" ref-type="bibr">2010</xref>). Destruction of the AM can be controlled by the AM itself through a process of apoptosis, or blocked by the bacilli, causing necrosis of the AM. This is a very important process as it determines both the intracellular bacillary concentration tolerated by the AM and the inflammatory response triggered (Lee et al., <xref rid="B26" ref-type="bibr">2006</xref>). This process is also known to be influenced by the initial bacillary load phagocytosed by the AM, with a higher load increasing the probability that necrosis is induced (Lee et al., <xref rid="B26" ref-type="bibr">2006</xref>). Data from different experimental models in laboratory animals indicate that the immune response appears 2&#x02013;3 weeks after low-dose aerosol challenge (Vilaplana et al., <xref rid="B32" ref-type="bibr">2014</xref>). This is a Th1 cellular immune response, thus requiring a proliferation of specific lymphocytes in hilar lymph-nodes (North and Jung, <xref rid="B29" ref-type="bibr">2004</xref>) that will be attracted toward the infected site if a sufficiently high inflammatory response is triggered to do so (Bru and Cardona, <xref rid="B2" ref-type="bibr">2010</xref>; Cardona and Ivanyi, <xref rid="B6" ref-type="bibr">2011</xref>; Vilaplana et al., <xref rid="B32" ref-type="bibr">2014</xref>).</p><p>In the majority of cases this response is sufficient to control the infection, which results in lesions with a diameter of &#x0003c; 1 mm that finally encapsulate and are reabsorbed or calcify, thus killing the bacilli in the necrotic tissue (Gil et al., <xref rid="B14" ref-type="bibr">2010</xref>). It has been demonstrated that drainage of the bacilli is possible until this encapsulation process takes place, thus allowing an endogenous reinfection of the AM that is responsible for maintaining the latent tuberculosis infection (LTBI), although the majority of drainage occurs via the gastrointestinal duct, thus finally resulting in complete elimination of the bacilli (Cardona, <xref rid="B4" ref-type="bibr">2010</xref>). Equally, the window of opportunity between AM infection and the attraction of specific lymphocytes to the infection site allows exogenous reinfection even once the immune response is set, thus having a marked influence in countries with a high TB incidence (Cardona and Vilaplana, <xref rid="B7" ref-type="bibr">2014</xref>). All in all, this process does not hamper the health status of LTBI subjects. The problem is that in a small percentage of cases (around 10%), there is no infection control and the lesions reach a size of at least 10 mm, thus causing the TB to become active. There is currently no clear explanation of the mechanisms responsible for this.</p><p>Recent data obtained by different groups and using different experimental approaches have demonstrated a key role for neutrophils in the induction of TB (Berry et al., <xref rid="B1" ref-type="bibr">2010</xref>; Eum, <xref rid="B11" ref-type="bibr">2010</xref>; Green et al., <xref rid="B16" ref-type="bibr">2010</xref>). The murine model using C3HeB/FeJ has provided a great deal of information in this respect as it is possible to reproduce human-like lesions, inducing liquefaction thanks to its ability to accumulate neutrophils (Yan et al., <xref rid="B33" ref-type="bibr">2006</xref>; Driver et al., <xref rid="B9" ref-type="bibr">2012</xref>; Harper et al., <xref rid="B20" ref-type="bibr">2012</xref>; Irwin et al., <xref rid="B21" ref-type="bibr">2014</xref>; Marzo et al., <xref rid="B28" ref-type="bibr">2014</xref>). We have been able to demonstrate that this process requires the accumulation of different lesions that, once coalesced, can induce TB lesions quickly enough to avoid the encapsulation and isolation of small lesions (Marzo et al., <xref rid="B28" ref-type="bibr">2014</xref>; Vilaplana and Cardona, <xref rid="B31" ref-type="bibr">2014</xref>). A detailed review of human lesions in the pre-antibiotic era has also confirmed this view (Cardona, <xref rid="B5" ref-type="bibr">2015</xref>).</p><p>Despite all the experimental observations discussed above, the natural history of tuberculosis is not yet fully understood. In particular, the factors that cause a latent infection to evolve toward active disease still form part of a conceptual hypothesis that is far from being demonstrated. Consequently, a great deal of research effort has been expended in this direction and the use of models that could help to unravel these dynamics is, therefore, essential.</p><p>A model is a simplified representation or description of a system. The degree of complexity, i.e., factors and processes to be taken into account, and the spatio-temporal scale depend on the question that the model aims to address. The kind of modeling form and strategy must also be chosen accordingly. In fact, mathematical models can be classified according to different criteria (e.g., empirical or mechanistic, spatially explicit or implicit, and continuous or discrete, amongst others; Haefner, <xref rid="B19" ref-type="bibr">2005</xref>). The strategy used to build them may be either top-down or bottom-up. A top-down strategy would cover, for instance, the description of a certain system's dynamics by means of global differential equations. This strategy is useful and powerful when the heterogeneities of the system are not relevant to the problem addressed, and if the variables addressed fit the continuum hypothesis. The bottom-up strategy requires the parts of the system, and the interactions among them, to be modeled in order to reproduce the whole-system dynamics. This is an interesting approach whenever emergent behaviors are expected to arise. Individual-based and Agent-based models (AbM) are examples of bottom-up computational approaches. Grimm (<xref rid="B17" ref-type="bibr">1999</xref>) defines AbM as &#x0201c;simulation models that treat individuals as unique and discrete entities which have at least one property in addition to age that changes during the life cycle.&#x0201d; They have been widely used in ecology and in microbiology (Kreft et al., <xref rid="B25" ref-type="bibr">2013</xref>).</p><p>In the past decade, the use of mathematical modeling in TB research has increased a great deal (Kirschner et al., <xref rid="B24" ref-type="bibr">2010</xref>; Zwerling et al., <xref rid="B34" ref-type="bibr">2015</xref>). These models aim to describe the dynamics of tuberculosis infection on different spatio-temporal scales, from the molecular-intracellular level up to the epidemiological scale, covering the granuloma, the tissue, and the different organs involved, among others (Guzzetta et al., <xref rid="B18" ref-type="bibr">2011</xref>; Kasaie et al., <xref rid="B22" ref-type="bibr">2013</xref>; Gong et al., <xref rid="B15" ref-type="bibr">2015</xref>; Linderman et al., <xref rid="B27" ref-type="bibr">2015</xref>). Depending on the problem addressed, bottom-up, top-down, or hybrid approaches have been used as modeling strategies (Bru and Cardona, <xref rid="B2" ref-type="bibr">2010</xref>; Vilaplana et al., <xref rid="B32" ref-type="bibr">2014</xref>; Cilfone et al., <xref rid="B8" ref-type="bibr">2015</xref>). Mathematical models have been shown to be an essential tool to interpret experimental results and disentangle tuberculosis natural history (Kirschner and Linderman, <xref rid="B23" ref-type="bibr">2009</xref>).</p><p>This paper is focused on a spatial scale slightly superior to granuloma. In fact, we propose a study of the spatial relationship between close TB lesions. This is an important issue in the effort to improve understanding of the connection between properties of neighboring granulomas and their extension through the lung. To do this, we have built an AbM aimed at understanding experimental information from an animal model. In particular, the purpose of this paper is to evaluate the role of local inflammation, dissemination and coalescence of lesions in the progression to active disease in a mice model by means of an AbM.</p></sec><sec sec-type="materials and methods" id="s2"><title>Materials and methods</title><sec><title>Summary of previous experimental results</title><p>Marzo et al. (<xref rid="B28" ref-type="bibr">2014</xref>) reported several series of experiments in which the evolution of tuberculosis lesions in C3HeB/FeJ female mice was studied. Six-eight-week-old specific-pathogen-free mice were infected with 2 &#x000d7; 10<sup>4</sup> Colony Forming Units of <italic>M. tuberculosis</italic> H37Rv Pasteur strain via the caudal vein. They were then euthanized at various time points in order to analyze different parameters related with TB infection dynamics (number and/or size of tuberculosis lesions, and total affected area, among others). Six animals were included per time point. A macroscopic image of lesions in a mouse lung obtained in these experiments is shown in Figure <xref ref-type="fig" rid="F1">1A</xref>.</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>(A)</bold> Macroscopic image of the lung at day 30; <bold>(B)</bold> Microscopic image of <italic>paraffined</italic> slides of infected mice lungs; <bold>(C)</bold> snapshot of a 3D view of the simulation system, each sphere representing a lesion; <bold>(D)</bold> snapshot of a 2D slide of the simulation system, each circle representing a slide of a lesion. Simulations used parameters of panel B (<bold>Table 1</bold>).</p></caption><graphic xlink:href="fmicb-07-00033-g0001"/></fig><p>Some of these experimental results were used to establish the basis of the mathematical model we present here and to calibrate it. In particular, we focused on those experiments related to the evolution of the number of tuberculosis lesions and affected area in infected mice lungs. These measurements were obtained by microscopy after fixing lungs in 10% buffered formalin, embedding lung lobes in paraffin, cutting them into 5-&#x003bc;m slides, and staining them with Masson trichromic (MTC). An example of a microscopy image taken from an MTC-stained recut is shown in Figure <xref ref-type="fig" rid="F1">1B</xref>. One of the reported series that will subsequently be denoted as series A aimed to track the temporal evolution of the number of tuberculosis lesions and total affected area. Another of the experimental series that will subsequently be denoted as series B was focused on the area distribution of lesions on a specific day.</p><p>In series A, measurements were carried out on days 21, 23, 26, 28, 30, 31, 32, and 33 post-infection in order to study the dynamics of the experimental model. The number of animals for each sampling day was variable (from 1 to 6). The observations that are of interest for the present study were:<list list-type="order"><list-item><p>The dynamics of lesions depended on the mice species and on the treatment applied. In this study, we will focus on the behavior of the infection in female C3HeB/FeJ mice (6&#x02013;8 weeks old) without any specific drug treatment.</p></list-item><list-item><p>C3HeB/FeJ is an animal model of active TB that reacts against <italic>Mycobacterium tuberculosis</italic> with an exaggerated inflammatory response. Experimental measurements showed that the affected area increased exponentially.</p></list-item><list-item><p>The number of observed lesions initially increased, thereby suggesting that a few bacilli or infected macrophages can escape from mature lesions and generate new infection foci.</p></list-item><list-item><p>In addition, after a few days the number of lesions started fluctuating. At this point, microscopy observations allowed the identification of big lesions comprising several sub-lesions, thus suggesting a coalescence phenomenon between lesions that had come into contact.</p></list-item></list></p><p>These experimental results are presented graphically in the first figure of the cited article (Marzo et al., <xref rid="B28" ref-type="bibr">2014</xref>).</p><p>In series B, measurements were carried out on days 21 and 28 to specifically determine the individual areas of all detected lesions and thus obtain the lesion area distributions. In this case, the mean lesion area was 0.266 mm<sup>2</sup> at day 21 and 3.36 mm<sup>2</sup> at day 28. The area distribution at day 21 followed an exponentially decreasing shape.</p></sec><sec><title>The mathematical model: Bubble model</title><p>This model was built with the aim of understanding the experimental results mentioned above and, therefore, to suggest an objective explanation of the dynamics observed. The main features to be taken into account were that (i) affected area increases almost exponentially; (ii) the number of lesions initially increases and then fluctuates; and (iii) the lesion area distribution follows a negative exponential at day 21, with the exponent of the fitting being the inverse of the mean area. The first and second observations were considered in the model design, and the third one was expected to emerge as a result of model simulations.</p><p>Given this context, we chose the bottom-up AbM strategy as the most appropriate, the lesion being the agent to be modeled. Therefore, the lesion was taken as a black box whose individual behavior is the result of processes on other scales that are not specifically modeled. According to the experimental information, the temporal scale was fixed at a few weeks.</p><p>The hypotheses used to construct the model were as follows: (1) lesions grow logistically due to the inflammatory reaction, the maximum being given by physical space limitations; (2) new lesions can appear as a result of the escape of extracellular bacilli or infected macrophages from older lesions, according to the endogenous reinfection theory; and (3) lesions can merge when they are close enough, showing a coalescence behavior. The third hypothesis is why we call this model the &#x0201c;Bubble model,&#x0201d; as preliminary versions were inspired on the coalescence between soap bubbles which, like the lesions observed, are spherical and have an internal overpressure that is inversely proportional to their radius. This overpressure inside a bubble (&#x00394;<italic>P</italic>) is governed by the Young-Laplace equation, which states, that &#x00394;<italic>P</italic> = 2&#x000b7;&#x003c3;&#x000b7;<italic>r</italic><sup>&#x02212;1</sup>, &#x003c3; being the surface tension and <italic>r</italic> being the radius of the spherical bubble. This relationship between radius and pressure causes two bubbles to fuse when they come into contact as the air in the smallest bubble/lesion (with a higher overpressure) is pushed into the bigger one (with a smaller pressure inside; Escolar and Escolar, <xref rid="B10" ref-type="bibr">2004</xref>).</p><p>As mentioned above, the lesions were taken as the main entities of the model and treated individually, as in an agent-based model (Ferrer et al., <xref rid="B12" ref-type="bibr">2008</xref>). This kind of model allows the study of macroscopic emergent behaviors on the basis of agents' dynamics and interactions. The variables assigned to each lesion included their position in a 3D space (<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>, and <italic>z</italic><sub><italic>i</italic></sub>, in mm), their size (radius <italic>r</italic><sub><italic>i</italic></sub>, in mm), their area in the intersection with a certain plane <italic>j</italic> (<italic>A</italic><sub><italic>i, j</italic></sub>, in mm<sup>2</sup>), in an attempt to mimic their area in experimental cuts, and their age, expressed as the time since apparition (<italic>T</italic><sub><italic>i</italic></sub>, in days). The subindex <italic>i</italic> refers to a certain lesion of the system. According to experimental observations (Marzo et al., <xref rid="B28" ref-type="bibr">2014</xref>), all lesions were considered as spheres.</p><p>The processes that drive the dynamics of these individual lesions were modeled as follows (Figure <xref ref-type="fig" rid="F2">2</xref>). Most of parameters of the mathematical functions used for describing such processes were affected by a certain noise, where indicated.</p><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>Flow chart of the computer code</bold>.</p></caption><graphic xlink:href="fmicb-07-00033-g0002"/></fig><sec><title>Lesion position and age</title><p>Lesions were considered to be fixed in space, with their center at the spatial point that is initially assigned to them. Their age was considered to increase linearly with time.</p></sec><sec><title>Lesion growth</title><p>In general, an increase in lesion radius would initially be driven by an increase in its bacterial load and subsequently modulated according to the inflammatory response (which would accelerate such an increase) and the immune response (which could accelerate or decelerate this increase, and even produce a decrease in volume). In the case of C3HeB/FeJ mice, the inflammatory reaction is exaggerated. Consequently, the effective growth of lesions was modeled through a logistic growth in the surface of the lesions <italic>S</italic> (Haefner, <xref rid="B19" ref-type="bibr">2005</xref>), as this growth is mainly result of an accumulation of cells in it (Equation 1):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mtable class="eqnarray" columnalign="right center left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mfrac><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p><italic>S</italic><sub><italic>max</italic></sub> and &#x003b1; would be the maximum surface and growth rate, respectively. If we want to deal with the radius as the main variable, we can re-write Equation (1) to give Equation (2):
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mtable class="eqnarray" columnalign="right center left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Consequently, the equivalent growth curve for a particular lesion's radius <italic>r</italic><sub><italic>i</italic></sub> was modeled as shown in Equation (3).</p><disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mtable class="eqnarray" columnalign="right center left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>&#x003bd;</mml:mi></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>In simulations, the constant <italic>v</italic><sub><italic>i</italic></sub> (in day<sup>&#x02212;1</sup>) was randomly assigned to each lesion using a normal distribution around a mean value, <inline-formula><mml:math id="M4"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>. This mean value was fixed after a parameterization process. The existence of a maximum radius (<italic>R</italic><sub><italic>j, i</italic></sub>) is due to spatial (physical) and biological limitations, and it was allowed to acquire two different values below (<italic>j</italic> = 1) and above (<italic>j</italic> = 2) a certain threshold (<italic>r</italic><sub><italic>thres, i</italic></sub> = <italic>R</italic><sub>1, <italic>i</italic></sub>), in order to allow the growth of large, coalesced lesions (i.e., an individual lesion could grow to a certain value, <italic>R</italic><sub>1, <italic>i</italic></sub>, never reaching this maximum asymptotic value, but a large lesion arising from the coalescence of two or more lesions could grow to a larger radius, <italic>R</italic><sub>2, <italic>i</italic></sub>).</p></sec><sec><title>Lesion coalescence</title><p>The joining of two neighboring lesions (e.g., <italic>L</italic><sub><italic>m</italic></sub> and <italic>L</italic><sub><italic>n</italic></sub>) was modeled as a two-step process. When the distance between their centers, <italic>d</italic><sub><italic>mn</italic></sub>, is lower than the sum of their radii, <italic>r</italic><sub><italic>m</italic></sub>+<italic>r</italic><sub><italic>n</italic></sub>, they keep growing individually but are considered as one unit (with two sub-lesions) in the total count. Once this distance is less than the largest radius, either <italic>r</italic><sub><italic>m</italic></sub> or <italic>r</italic><sub><italic>n</italic></sub>, an effective merging between them is considered. In this case, the radius of the joined lesion is equal to <inline-formula><mml:math id="M5"><mml:mroot><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mroot></mml:math></inline-formula>, (i.e., it is equal to the radius of a sphere whose volume is the sum of the volumes of the two constituent spheres) and its center is located at the same point as the center of the previous biggest lesion.</p></sec><sec><title>Daughter lesions</title><p>In the model, a lesion with an age of between 14 and 28 days was supposed to be able to generate other lesions. We assumed a model based on a certain probability of generating a new lesion as a function of <italic>mother</italic>'s age and radius. This probability of generating new visible lesions was considered to decrease linearly with the <italic>mother</italic>'s age (<italic>T</italic><sub><italic>i</italic></sub>(<italic>t</italic>)) and increase linearly with radius (<italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>)). Thus, the number of daughter lesions emerging from a particular lesion at a certain time, <italic>N</italic><sub><italic>daughter, i</italic></sub>(<italic>t</italic>), is determined as follows (Eq 4):
<disp-formula id="E4"><label>(4)</label><mml:math id="M6"><mml:mtable class="eqnarray" columnalign="right center left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>u</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mn>2</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>-</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>14</mml:mn><mml:mtext>days</mml:mtext></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02200;</mml:mo><mml:msub><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mn>14</mml:mn><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>s</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mn>28</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>The resulting number is truncated in order to provide an integer amount of daughters that can be <italic>N</italic><sub><italic>daughter, i</italic></sub>(<italic>t</italic>)&#x02265;0. The parameters &#x003c1;<sub><italic>i</italic></sub> (adimensional) and <italic>r</italic><sub><italic>min</italic></sub> (in mm) are an individual probability resulting from a mean probability (<inline-formula><mml:math id="M7"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>) and a minimum radius, both of which are fixed in the parameterization process. The distance from the mother lesion at which daughter lesions appear (<italic>d</italic><sub><italic>daughter</italic></sub>, in mm) was considered to decrease exponentially (Equation 5).</p><disp-formula id="E5"><label>(5)</label><mml:math id="M8"><mml:mtable class="eqnarray" columnalign="right center left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>u</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mi>&#x00393;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>&#x00393;(10, 0.1) is the mathematical gamma distribution with the appropriate parameters for describing a negative exponential. The constant &#x003b4;<sub>0</sub> (in mm) was also determined during the parameterization process.</p></sec></sec><sec><title>Model implementation and scheduling</title><p>The mathematical model was implemented in Matlab&#x000ae; in order to run it, evaluate its behavior and determine the role and value of the most important parameters. The time step was fixed at half a day, and the 3D space was fixed as a cube with an edge of 8 mm. These spatial dimensions were chosen according to the real size of analyzed lungs. Nevertheless, since we lacked 3D spatial structure data about these lungs, we decided not to provide spatial-specific structure to the model and we used the cube for simplicity.</p><p>The need to compare the results obtained with microscopy measurements required the implementation of a specific protocol to analyze simulation results. Although the model was run in a 3D space where lesions were considered as spheres, the results were analyzed on a random 2D slide of this 3D system, as shown in Figure <xref ref-type="fig" rid="F1">1</xref>. This emulates the experimental procedure consisting of cutting the lungs into slides and analyzing these slides with the microscope. In fact, another key point to take into consideration when comparing simulations with experiments arises from this lack of spatial data about each experimental slide, i.e., we do not know where this slide was located in the original lung. This is why the simulation slide for analysis was randomly chosen. The consequence is that it was not possible to compare the quantitative behavior of experimental and simulation extensive variables, which depend on the global size of the system. Instead, intensive variables (i.e., those that do not depend on the slide size) had to be used for this purpose.</p><p>It is important to note that most of the parameters in the model were affected by Gaussian noise, as mentioned above, such that they could vary slightly from lesion to lesion, from time to time, and/or from mouse to mouse. This stochasticity allows the simulator to provide the variety of behaviors observed in all experimental measurements with a single model. In fact, each individual simulation was considered as emulating one mouse. Simulation series were therefore scheduled according to the number of experimental measurements in each case.</p><p>Another important point related with model implementation arises from the fact that lesions are not observable by microscopy until they have a diameter of 0.15 mm, which occurs at the age of 14 days, approximately. Thus, the simulations started with observable lesions at day 14. This is equivalent to considering the lesions from the moment at which they can be measured experimentally.</p><p>The simulation schedule involved three main steps or series of simulations: (i) an initial set of simulations with preliminary parameters in order to test the qualitative behavior of the model; (ii) a series of simulations specially designed for carrying out a sensitivity analysis and parameter estimation; and (iii) a series of simulations to validate and test the implications of the model.</p><sec><title>Initial conditions</title><p>The initial conditions for simulations were fixed as follows. The initial number of lesions was set at 50 or 100, depending on the simulation series. All of them were randomly distributed in the considered space, and their initial age and size were assigned as 14 days and 0.15 mm, respectively, with Gaussian noise.</p></sec></sec><sec><title>Sensitivity analysis and parameter estimation</title><p>The sensitivity analysis and parameter estimation followed an iterative process that entailed successive simulations in order to (i) delimit the ranges where parameters and outcome results made biological sense, and (ii) identify those parameters that were more sensitive. Once these ranges were fixed, we designed a final series of simulations to perform a grid search within these intervals and find the best values for the most sensitive parameters.</p><p>As a result of the initial scanning, we found that the most relevant parameters were the mean growth rate of lesions, <inline-formula><mml:math id="M14"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>, the individual mean probability for determining the number of daughters, <inline-formula><mml:math id="M15"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>, and the mean distance at which daughter lesions appear, &#x003b4;<sub>0</sub>. Then, in order to estimate the best values, we chose the following objective function (Equation 6) as indicator on the basis of the experimental information available.</p><disp-formula id="E6"><label>(6)</label><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="right center left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>&#x02211;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula><p><inline-formula><mml:math id="M17"><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> correspond to the mean area of lesions in a slide measured in experiments (<italic>exp</italic>) and simulations (<italic>sim</italic>) at different time points <italic>t</italic>. As we worked with two experimental series, we estimated two parameter sets in order to minimize the corresponding objective functions. The values obtained are shown in Table <xref ref-type="table" rid="T1">1</xref>. The differences between the values obtained for series A and B are in the range of experimental variability, which was relevant.</p><table-wrap id="T1" position="float"><label>Table 1</label><caption><p><bold>Parameters of the model after the parameter estimation process</bold>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top" align="left" rowspan="1" colspan="1"><bold>parameter</bold></th><th valign="top" align="left" rowspan="1" colspan="1"><bold>Description</bold></th><th valign="top" align="center" rowspan="1" colspan="1"><bold>Value (A)</bold></th><th valign="top" align="center" rowspan="1" colspan="1"><bold>Value (B)</bold></th><th valign="top" align="left" rowspan="1" colspan="1"><bold>Units</bold></th></tr></thead><tbody><tr><td valign="top" align="left" rowspan="1" colspan="1"><inline-formula><mml:math id="M9"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>&#x003bd;</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula></td><td valign="top" align="left" rowspan="1" colspan="1">Mean value for growth parameter (Equation 3)</td><td valign="top" align="center" rowspan="1" colspan="1">0.17</td><td valign="top" align="center" rowspan="1" colspan="1">0.14</td><td valign="top" align="left" rowspan="1" colspan="1">day<sup>&#x02212;1</sup></td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1"><inline-formula><mml:math id="M10"><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top" align="left" rowspan="1" colspan="1">Mean maximum radius before merging (Equation 3)</td><td valign="top" align="center" rowspan="1" colspan="1">1.0</td><td valign="top" align="center" rowspan="1" colspan="1">1.0</td><td valign="top" align="left" rowspan="1" colspan="1">mm</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1"><inline-formula><mml:math id="M11"><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>2</mml:mn></mml:mstyle></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top" align="left" rowspan="1" colspan="1">Mean maximum radius after merging (Equation 3)</td><td valign="top" align="center" rowspan="1" colspan="1">20</td><td valign="top" align="center" rowspan="1" colspan="1">10</td><td valign="top" align="left" rowspan="1" colspan="1">mm</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1"><inline-formula><mml:math id="M12"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula></td><td valign="top" align="left" rowspan="1" colspan="1">Mean value for daughter lesion probability (Equation 4)</td><td valign="top" align="center" rowspan="1" colspan="1">0.8</td><td valign="top" align="center" rowspan="1" colspan="1">0.8</td><td valign="top" align="left" rowspan="1" colspan="1">&#x02013;</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1"><inline-formula><mml:math id="M13"><mml:msub><mml:mrow><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top" align="left" rowspan="1" colspan="1">Mean minimum radius of lesions (Equation 4)</td><td valign="top" align="center" rowspan="1" colspan="1">0.15</td><td valign="top" align="center" rowspan="1" colspan="1">0.15</td><td valign="top" align="left" rowspan="1" colspan="1">mm</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1">&#x003b4;<sub>0</sub></td><td valign="top" align="left" rowspan="1" colspan="1">Constant for determining the distance at which a daughter lesion appears (Equation 5)</td><td valign="top" align="center" rowspan="1" colspan="1">1.5</td><td valign="top" align="center" rowspan="1" colspan="1">1.0</td><td valign="top" align="left" rowspan="1" colspan="1">mm</td></tr></tbody></table><table-wrap-foot><p><italic>Columns A and B are parameters obtained from fittings to experimental series A and B, respectively</italic>.</p></table-wrap-foot></table-wrap></sec></sec><sec sec-type="results" id="s3"><title>Results</title><sec><title>The Bubble model explains the general dynamics of lesions</title><p>Figure <xref ref-type="fig" rid="F1">1</xref> shows two snapshots of the simulations (Figures <xref ref-type="fig" rid="F1">1C,D</xref>) together with two images taken from the experimental results (Figures <xref ref-type="fig" rid="F1">1A,B</xref>). As mentioned above, a key point of the comparison between experiments and simulations is that the microscopic analysis was performed in randomly selected <italic>paraffined slides</italic> of the infected lungs. In fact, as can be seen in Figure <xref ref-type="fig" rid="F1">1</xref>, the number of lesions in the lung as a whole may be between one and two orders of magnitude higher than the number lesions observed in a single slide. In addition, there is a lack of information about the position of the experimentally analyzed slides in the original lung. Thus, it is not possible to extrapolate the quantitative behavior of extensive variables like the total affected area, since the geometrical constraints of experimental measurements were not homogeneous. In order to calibrate and validate the model, we decided to use intensive variables like the mean area of lesions, which are independent of the geometry of the slide considered.</p><p>All simulations reported fluctuations in the number of lesions in an intersection plane <italic>j</italic>. The number, intensity, and slope of these fluctuations depended on the simulation and the slide concerned, as can be seen in Figure <xref ref-type="fig" rid="F3">3</xref>. The variety of patterns observed include single (Figures <xref ref-type="fig" rid="F3">3A,B,D</xref>) and multiple (Figures <xref ref-type="fig" rid="F3">3C,E,F</xref>) fluctuations, slight (Figure <xref ref-type="fig" rid="F3">3E</xref>) and deep (Figure <xref ref-type="fig" rid="F3">3A</xref>) fluctuations, or smooth (Figure <xref ref-type="fig" rid="F3">3B</xref>) and abrupt (Figure <xref ref-type="fig" rid="F3">3D</xref>) fluctuations, amongst others.</p><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>Evolution of the number of lesions in a single slide</bold>. Results from six independent simulations <bold>(A&#x02013;F)</bold> obtained using the parameters for series <bold>A (</bold>Table <xref ref-type="table" rid="T1">1</xref><bold>)</bold>. Different fluctuation patterns can be observed for this variable.</p></caption><graphic xlink:href="fmicb-07-00033-g0003"/></fig><p>As mentioned above, the evolution of the total affected area cannot be compared numerically since spatial dimensions are not homogeneous between lung samples. As such, the variables that can be quantitatively compared are those which are intensive, as is the case of the mean area of lesions. Both the experiments and the simulations showed an exponential increase in this variable, as can be seen in Figure <xref ref-type="fig" rid="F4">4</xref>. Exponential fittings to both data series provided similar values for slopes and independent terms, as well as good correlation coefficients (<italic>R</italic><sup>2</sup> &#x0003e; 0.9).</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>Evolution of the mean area of lesions: experimental data (red triangles) and simulation results (blue circles), both corresponding to series A (Table <xref ref-type="table" rid="T1">1</xref>)</bold>. Exponential fittings to simulation results and experimental data are shown (dotted lines). Two outlying experimental data-points were not taken into account for the fitting.</p></caption><graphic xlink:href="fmicb-07-00033-g0004"/></fig></sec><sec><title>The negative exponential distribution of areas meets the maximum entropy principle</title><p>A proof of consistency of a model may arise from the fact that results that have not been looked for are in accordance with experimental observations. In this case, an analysis of the experimental results for series B (Marzo et al., <xref rid="B28" ref-type="bibr">2014</xref>) suggests that the areas of individual lesions at day 21, when the infection is still far from fully occupying the lungs, are exponentially distributed. At this point, the system has been allowed to evolve without specific physical constraints. An analysis of the simulation results at day 21 also shows an exponential distribution of the area distribution. This was not specifically imposed on the model and was not taken into account for calibration, thus meaning that it is a proof of consistency. Figure <xref ref-type="fig" rid="F5">5</xref> shows both distributions with exponential fittings and regression coefficients, which are <italic>R</italic><sup>2</sup> &#x0003e; 0.9 in both cases. The constants fitted to the simulation results have the same order of magnitude as those fitted to experimental results (11% deviation in the exponent and 7% in the intersection).</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>Distribution of individual lesion areas at day 21 for the experimental data (red triangles, up) and the simulation results (blue circles, down), with the exponential fittings</bold>. Both correspond to series B.</p></caption><graphic xlink:href="fmicb-07-00033-g0005"/></fig><p>Now let us consider the distribution of a specific variable among the components of a system (e.g., in this case the variable concerned is the mean area, and the distribution gathers the frequency of lesions in each area interval, as shown in Figure <xref ref-type="fig" rid="F5">5</xref>). The diversity of this system according to this variable can be assessed using Shannon's diversity index, <inline-formula><mml:math id="M19"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:munder class="msub"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo class="qopname">log</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<italic>k</italic> = 1&#x02215;log2), with <italic>p</italic><sub><italic>i</italic></sub> being the frequency of the system's components in each bin of the distribution considered according to the maximum entropy principle, the maximization of this index with the appropriate constraints provides the distribution that maximizes the diversity of the system. The exponential distribution is characteristic of a system that maximizes entropy with the only constraint of limited energetic resources (Ferrer et al., <xref rid="B13" ref-type="bibr">2011</xref>).</p><p>In the case of lesion growth in the infected mice, the results show that while inflammation can evolve without more constraints, the system tends to a maximum diversity (exponential) distribution. In addition to the correlation coefficients, an indicator for a distribution to be exponential is that the exponent of the curve is equal to the inverse of the distribution's mean value. A detailed analysis of the experimental distribution provides an exponent of 3.218 mm<sup>&#x02212;2</sup>, with its inverse (0.31 mm<sup>2</sup>) being close to the mean area of 0.27 mm<sup>2</sup> (13% deviation). Similarly, the simulation results provide an exponent of 3.594 mm<sup>&#x02212;2</sup>, the inverse of which (0.28 mm<sup>2</sup>) is also close to the mean value of the area (0.26 mm<sup>2</sup>, 5% deviation). Once the infection gets totally out of control and the affected area achieves a high value, the physical limitations of the lungs add new constraints and the area distribution is no longer exponential, as occurs at day 28.</p></sec><sec><title>Local inflammation, dissemination and coalescence of lesions are key for the progression toward active tuberculosis</title><p>Finally, we designed an additional series of <italic>in silico</italic> experiments to assess the importance of the model's hypotheses. To this end, we individually removed each hypothesis from the model and ran a simulation. We considered no endogenous reinfection in the first run (no daughters), a 10-fold decrease in the intensity of the inflammatory response in the second one (slow inflammation) and an absence of coalescence in the third one (no coalescence). We studied the effects on the already reported variables (number of lesions in a slide, evolution of the mean area and distribution of individual lesions' areas at day 21). The obtained outcomes are shown in Figure <xref ref-type="fig" rid="F6">6</xref>.</p><fig id="F6" position="float"><label>Figure 6</label><caption><p><bold>Dynamics of the three variables studied (number of lesions&#x02014;left, mean area evolution&#x02014;center, area distribution at day 21&#x02014;right) when removing one of the hypotheses from the model [no dissemination&#x02014;top (A&#x02013;C), slow inflammatory response&#x02014;middle (D&#x02013;F), no coalescence&#x02014;bottom (G&#x02013;I)]</bold>. Light empty symbols and dotted lines correspond to the results obtained with the complete model, using parameters of panel A (Table <xref ref-type="table" rid="T1">1</xref>). Figures <xref ref-type="fig" rid="F6">6E,H</xref> are enlarged in Figure <xref ref-type="fig" rid="F7">7</xref>.</p></caption><graphic xlink:href="fmicb-07-00033-g0006"/></fig><p>The absence of endogenous reinfection provides the expected stability in terms of number of lesions, with the small increase in this value being due to the growth of a lesion from a neighboring intersection plane and slight decreases being related to coalescence between lesions. In this case, the mean area increases to higher values with respect to the previous simulations, as can be expected if the number of lesions remains approximately constant and the lesion area keeps increasing. The area distribution at day 21 suggests that endogenous reinfection is a necessary mechanism for lesions to grow via coalescence: if no new lesions appear, fewer fusions between neighboring lesions take place and the dominant mechanism for them to grow is the inflammatory response.</p><p>A 10-fold decrease in the intensity of the inflammatory response markedly reduces the dynamics of the system. In fact, and as can be observed in Figure <xref ref-type="fig" rid="F7">7</xref>, the increase in mean area exists but is very small. As a consequence, the lesions are unable to fully develop and generate new lesions. The third run demonstrates that, in addition to the inflammatory response, coalescence is an essential mechanism for lesions to grow. Even though the number of lesions increases constantly, their mean size remains smaller than in the bubble model simulations (Figure <xref ref-type="fig" rid="F7">7</xref>).</p><fig id="F7" position="float"><label>Figure 7</label><caption><p><bold>Enlargement of Figures <xref ref-type="fig" rid="F6">6E,H</xref>, showing the small increase in mean are with a small inflammatory response (E) and with no coalescence (H)</bold>.</p></caption><graphic xlink:href="fmicb-07-00033-g0007"/></fig></sec></sec><sec sec-type="discussion" id="s4"><title>Discussion</title><p>We have built a mathematical model that takes into account three processes that may be considered key factors for the progression of a TB infection toward active disease, namely high inflammatory response, endogenous reinfection, and coalescence between lesions. This model was implemented in a computer code in order to validate and quantify the role of these processes. A confirmation of the bubble model's plausibility is that it considers the individual dynamics and interactions of lesions, and the macroscopic behavior emerges. Thus, the positive results we obtained demonstrate the essential role of local inflammation, endogenous reinfection, and coalescence, as shown in Figure <xref ref-type="fig" rid="F6">6</xref>, and opens up new perspectives in the natural history of tuberculosis. In fact, using the bubble model we have transformed theories such as the dynamic hypothesis (Cardona, <xref rid="B3" ref-type="bibr">2009</xref>), which suggests endogenous reinfection, into quantifiable and comparable models. Although we assumed a logistic growth of lesions, similar growth models (e.g., Gompertz model) with an initial exponential growth and an asymptotic maximum would provide similar results.</p><p>The ultimate aim of this model is to achieve a complete understanding of the mechanisms that prevent a TB infection from evolving toward active disease or accelerating this process. Therefore, an updated model should be capable of describing both a latent infection and active disease by simply changing some of the parameters or physical constraints involved. At this point, the bubble model correctly describes active disease in C3HeB/FeJ mice, an animal that reacts to Mtb with an exaggerated inflammatory response, and could easily be calibrated with data from similar experiments with mice. In fact, calibration of this model using experimental data from an animal model of latent infection should be the following step. Nevertheless, this will probably require inclusion of the immune response in the growth curve for individual lesions and the consideration of calcification dynamics.</p><p>Our results did not reveal a relevant function of mouse lung geometry. They are structurally simple, without septa inside, and they are sufficiently small to allow a rapid infection of the whole space. Nevertheless, in order to progress toward an understanding of the natural history of TB in the human body, the geometry of more complex lungs should be taken into account. In this sense, the role of spatial structures such as the bronchial tree in the endogenous reinfection process, or intralobular septae and encapsulation of the lesions (Gil et al., <xref rid="B14" ref-type="bibr">2010</xref>; Cardona, <xref rid="B5" ref-type="bibr">2015</xref>), should be tackled. Animal models such as minipigs or goats could provide valuable information about the role of lung geometry on the progression of TB (Parent, <xref rid="B30" ref-type="bibr">2015</xref>). In a similar way to the hypothesis tests presented in this paper, the implementation of such a geometry in the mathematical model should allow an assessment of its relevance.</p></sec><sec id="s5"><title>Author contributions</title><p>CP designed and implemented the model, designed and carried out the simulations and <italic>in silico</italic> experiments, analyzed, and discussed the results and leaded the writing of the manuscript. CV analyzed experimental data, designed the model and the <italic>in silico</italic> experiments, analyzed and discussed the results, and critically revised the manuscript. JV designed and implemented the model, analyzed and discussed the obtained results, and critically revised the manuscript. EM analyzed experimental data, designed the model, and critically revised the manuscript. PC conceived and co-leaded this research project, analyzed experimental data, designed the model and the <italic>in silico</italic> experiments, analyzed and discussed the obtained results, and participated in the writing of the manuscript. DL conceived and leaded this research project, designed the model and the <italic>in silico</italic> experiments, analyzed and discussed the obtained results, and participated in the writing of the manuscript.</p><sec><title>Conflict of interest statement</title><p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p></sec></sec>